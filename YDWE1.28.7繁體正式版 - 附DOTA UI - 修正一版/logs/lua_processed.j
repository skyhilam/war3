//===========================================================================
// 
// |CFFFF0000信長之野望16.3B2 反開圖V42
// 
//   Warcraft III map script
//   Generated by the Warcraft III World Editor
//   Date: Thu Jan 14 19:50:56 2016
//   Map Author: 空
// 
//===========================================================================
//***************************************************************************
//*
//*  Global Variables
//*
//***************************************************************************
library YDTriggerSaveLoadSystem initializer Init
globals
       hashtable YDHT
endglobals
	private function Init takes nothing returns nothing
		set YDHT = InitHashtable() 
	endfunction
endlibrary
globals
    // User-defined
    integer udg_KickVotesYes = 0
    group array udg_tmpUG
    integer array udg_A_temp_Number
    location array udg_tmpP
    force udg_tmpPF = null
    unit array udg_last_selected_unit
    unit array udg_S01_hero_of_player
    string array udg_S03_color_of_players
    real array udg_S02_revival_time
    unit array udg_tactic_unit1
    unit array udg_tactic_unit2
    integer array udg_S01_hero_list
    integer array udg_S03_number_kill
    integer udg_tmpItemtype = 0
    integer array udg_item_soul
    unit array udg_tmpU
    integer udg_B11_T_I = 0
    unit udg_B11_U = null
    unit array udg_B16T_Unit
    real array udg_CP_revival_time
    integer array udg_CP_revival_unittype
    location array udg_CP_revival_P
    location udg_Ravage = null
    location udg_TempPoint = null
    location udg_Temp_P1 = null
    location udg_Temp_P2 = null
    location array udg_B35_TemP
    unit array udg_B34_HERO
    unit udg_B07_HERO = null
    boolean udg_single_player = false
    unit udg_A36_HERO = null
    integer udg_A36E_Number = 0
    unit udg_A27_HERO = null
    unit udg_A31_HERO = null
    unit array udg_C20E_Target
    unit array udg_C18W_Target
    location udg_A_Common_temp1 = null
    unit udg_A_item_A01 = null
    unit udg_A_item_a02 = null
    unit udg_A_item_A03 = null
    location udg_A_common_temp2 = null
    location udg_A_common_temp3 = null
    unit udg_A_common_HERO = null
    integer udg_soilder = 0
    unit array udg_B34E_target
    boolean array udg_B31_B
    integer udg_S20_Number = 0
    integer udg_S02_Number = 0
    group udg_A_common_group = null
    unit array udg_A32E_target
    integer array udg_A_TOOL
    item array udg_A_TOOL2
    unit array udg_B07E_Creat
    unit udg_A30_HERO = null
    unit array udg_A28W_creat
    unit array udg_A36E_Creat
    location udg_A_common_temp4 = null
    location udg_A_common_temp5 = null
    unit udg_A35_HERO = null
    integer udg_A35_time = 0
    integer udg_A35_Magic = 0
    integer udg_A35E_Magic2 = 0
    integer udg_A35T_Demage = 0
    multiboard udg_DMB = null
    integer udg_time_h = 0
    integer udg_time_m = 0
    integer udg_time_s = 0
    integer array udg_S05_time
    integer array udg_Kill_Comboo
    timer array udg_S11_timer
    integer array udg_S12_Building
    integer array udg_S13_time
    string array udg_S12_Picture
    integer array udg_S17_kill_H_num
    integer array udg_S18_die_Number
    integer udg_S30_3_Number = 0
    integer udg_S30_3_Number2 = 0
    integer udg_S20_Auto_Number = 0
    integer array udg_S20_horse_soilfer_num
    integer array udg_New_01
    integer udg_S40_number = 0
    timer array udg_S40_Timer
    integer array udg_S300_Number
    integer array udg_S11_Money_Number
    integer array udg_A25_I
    real udg_B040_R = 0
    real array udg_B24_R
    real array udg_C14_R
    boolean array udg_C23_B
    integer array udg_C24R_I
    real array udg_resist_damage_R
    boolean udg_tmpB = false
    item udg_tmpItem = null
    real array udg_tmpR
    effect udg_B040_E = null
    timer udg_tmpTimer = null
    integer array udg_A19_Item
    hashtable udg_A36_H = null
    group udg_A35_UG = null
    group udg_B36_UG = null
    unit udg_B040_HERO = null
    hashtable udg_tactic_H = null
    hashtable udg_assist_H = null
    string array udg_N01_name
    string array udg_N01_name2
    string array udg_N01_name3
    boolean udg_B040T_demage = false
    boolean array udg_il02_B
    integer udg_tactic_Q_I = 0
    group udg_A_common_group2 = null
    integer array udg_B30R_I
    hashtable udg_sl_H = null
    force udg_sl_F = null
    integer array udg_sl_I
    real array udg_sl_period
    timer array udg_sl_timer
    string array udg_sl_S
    integer udg_B040_R_I = 0
    unit udg_B040_R_U = null
    integer udg_Delete_time = 0
    trigger array udg_Delete_trigger
    integer udg_Delete_time2 = 0
    group udg_A28E_UG = null
    integer array udg_Surrende_vote
    unit array udg_B06_E_target
    integer array udg_B06_E_I
    unit array udg_C17W_creat
    string udg_tmpS
    unit udg_B040T_Target = null
    group udg_A27T_UG = null
    integer udg_die_money = 0
    integer udg_Kick_time = 0
    unit udg_B040W_creat = null
    integer array udg_Tactics_Skill_List
    real array udg_Tactics_Skill_Mana
    string array udg_real_name
    unit udg_C40_Hero = null
    location array udg_S20_Point
    boolean array udg_item_strom_book
    integer array udg_A26T_Item
    boolean array udg_New_sign
    boolean array udg_anti_gegi_B
    boolean array udg_KickVotesYes_ture
    location array udg_A_common_TemP
    group array udg_A_common_Group
    unit array udg_A_common_Hero
    real array udg_C12R_area
    timer array udg_B34E_timer
    timer udg_A31R_timer = null
    hashtable udg_mana_bug_H = null
    group array udg_Tacitc_group
    unit array udg_S16_U
    integer udg_KickTime = 0
    timer array udg_C25T_timer
    real array udg_C05W_stun
    boolean udg_V_TURE = false
    unit array udg_C40W_Creat
    destructable array udg_C40W_Creat_tree
    location udg_C40W_point = null
    real array udg_CP_angel
    group udg_CP_group = null
    real udg_C27R_demage = 0
    boolean array udg_V_True2
    integer udg_Pay_money = 0
    boolean array udg_C15D_check
    integer array udg_C40E_time
    integer array udg_Hero_Number_ReviveTime
    timer array udg_A_timer
    timer array udg_Delay_Check
    force array udg_Players_group
    boolean udg_High_Boolen = false
    integer udg_Pay_Money2 = 0
    integer array udg_Tokisaki_Kurumi
    unit udg_C29E_Creat = null
    unit udg_C29_HERO = null
    unit udg_C29_Creat2 = null
    integer array udg_A13T_table
    boolean array udg_get_wood
    group array udg_AI_Units
    integer udg_AH = 0
    item array udg_C14E_ItemCheck
    integer array udg_C14E_TargetHeroItem
    integer udg_C14E_Int = 0
    integer udg_exp = 0
    integer udg_HIGH = 0
    integer array udg_B07_ability
    unit array udg_A_TTarget
    effect array udg_A_ASpecialEffect
    real array udg_A_ADamage_value
    boolean array udg_A_Boolen
    unit array udg_A_TLastCreat
    unit array udg_A_AHERO
    integer array udg_A_TValue
    boolean udg_KnockBack_Boolean1 = false
    real udg_KnockBack_Angle = 0
    real udg_KnockBack_Dist = 0
    real udg_KnockBack_Speed = 0
    real udg_KnockBack_Time = 0
    unit udg_KnockBack_Unit = null
    real udg_KnockBack_Interval = 0
    trigger udg_KnockBack_Trigger = null
    boolean udg_KnockBack_Boolean2 = false
    real udg_KnockBack_Rate = 0
    trigger array udg_AUD_Trigger
    integer udg_AUD_time = 0
    group udg_AUD_Group = null
    real array udg_X
    real array udg_Y
    real array udg_Angel
    boolean array udg_B06R_B
    trigger array udg_Hero_Trigger
    boolean array udg_B03_B
    unit udg_A08_HERO = null
    group udg_AUD_Group2 = null
    boolean array udg_C22T_check
    dialog udg_Click = null
    integer udg_F_MS_XH = 0
    integer array udg_SJ
    integer array udg_Xt_yx_lx
    integer udg_XYX = 0
    real array udg_A_WJ_GD
    unit udg_B06_HERO = null
    force udg_globals = null
    boolean udg_krm_llOI = false
    player array udg_X_PlayerA
    player array udg_X_PlayerB
    boolean udg_X_Observer = false
    integer udg_TempInteger = 0
    trigger udg_Trigger_null = null
    integer array udg_C19T_Index
    integer array udg_C19T_LV
    boolean array udg_auto
    boolean array udg_omamori_Check
    unit udg_omamori_u1 = null
    unit udg_omamori_u2 = null
    group array udg_MH_group
    boolean array udg_Assist_true
    integer udg_Assist_I = 0
    boolean array udg_B36R_B
    integer array udg_B08R_I2
    boolean array udg_B08R_true2
    boolean array udg_B11_R_T
    integer array udg_B11_R_I2
    integer array udg_B11_T_I2
    boolean array udg_B12R_B
    unit array udg_B13_Creat2
    integer array udg_B13T_Count2
    unit array udg_B18T_soul2
    unit array udg_B19_DOG2
    unit array udg_B19_HERO
    boolean array udg_B21T_B
    boolean array udg_A_B
    group array udg_B25_group2
    boolean array udg_B25R_B
    effect array udg_B26R_SE2
    boolean array udg_B26R_B
    group array udg_B33D_G
    real udg_real = 0
    effect array udg_B33R_E
    effect array udg_B33T_E
    integer array udg_B34_I
    integer array udg_B34_I2
    effect array udg_B34W_E
    boolean array udg_B34W_B
    boolean array udg_B34E_B
    boolean array udg_B35R_B
    integer udg_AA = 0
    group array udg_B36W_G
    unit array udg_B37W_U
    group array udg_C01T_G
    timer array udg_C01T_T
    string udg_Lighting_sring
    real udg_Lighting_x0 = 0
    real udg_Lighting_y0 = 0
    real udg_Lighting_x1 = 0
    real udg_Lighting_y1 = 0
    real udg_Lighting_cr = 0
    real udg_Lighting_cg = 0
    real udg_Lighting_cb = 0
    real udg_Lighting_ca = 0
    unit udg_Lighting_u1 = null
    unit udg_Lighting_u2 = null
    real udg_Lighting_t1 = 0
    real udg_Lighting_t2 = 0
    real udg_Lighting_tf = 0
    boolean udg_Lighting_bud = false
    trigger udg_Lighting_trigger = null
    integer udg_Lighting_I = 0
    lightning udg_Lighting_light = null
    boolean udg_Lighting_B = false
    trigger udg_Lighting_trigger2 = null
    integer udg_Lighting_I2 = 0
    boolean array udg_C07W_B
    real array udg_C07W_Damage
    timer array udg_C12E_T
    integer array udg_C14W_I
    integer array udg_C14T_I
    real array udg_C14R_damage
    real array udg_C14T_I3
    real array udg_C14T_I2
    real array udg_C14T_I4
    boolean array udg_D_B
    integer udg_ChainAbility_a = 0
    string udg_ChainAbility_s
    integer udg_ChainAbility_a2 = 0
    string udg_ChainAbility_s2
    integer udg_ChainAbility_fu = 0
    integer udg_ChainAbility_fu2 = 0
    real udg_ChainAbility_r = 0
    integer udg_ChainAbility_j = 0
    real udg_ChainAbility_v = 0
    integer udg_ChainAbility_m = 0
    real array udg_C18T_dmg
    real array udg_C18T_ManaCheck
    real array udg_C18T_DmgBonus
    boolean array udg_C23R_B
    boolean array udg_C24R_B
    unit array udg_C25W_Target
    integer array udg_C25W_I
    unit udg_ChainAbility_U = null
    real udg_ChainAbility_t = 0
    boolean udg_ChainAbility_b = false
    timer array udg_C25W_Timer
    real array udg_C25R_heal
    timer array udg_C26D_Timer
    real array udg_C26W_R
    real array udg_I1
    real array udg_I2
    real array udg_A05R_R
    boolean array udg_A05R_B
    effect array udg_A05R_SE
    boolean array udg_A06T_B
    integer array udg_A06T_I
    integer array udg_A06D_I
    real array udg_A08R_R
    hashtable udg_ROSE_HASH = null
    integer array udg_A12R_I
    unit array udg_A12R_U
    integer array udg_A18T_I
    effect array udg_A18T_E
    unit array udg_A24E_U
    real array udg_A24E_R
    integer array udg_A24E_I
    location array udg_A24E_P1
    location array udg_A24E_P2
    lightning array udg_A24E_l
    integer array udg_A24T_I
    real array udg_A24T_A
    group array udg_A24T_G
    trigger array udg_A25_Trigger
    real array udg_A27W_R2
    real array udg_A27W_R1
    group array udg_A27W_G
    real array udg_A27W_A
    integer array udg_A27W_I
    hashtable udg_A28_H = null
    real array udg_A27T_damage
    integer array udg_A27T_I
    boolean array udg_A28R_B
    timer array udg_A29R_T
    timer array udg_A30R_T
    integer array udg_A30R_I
    effect array udg_A30R_SE
    real array udg_A31R_damage
    location array udg_A32E_P1
    lightning array udg_udg_A32E_l
    effect array udg_A32E_SE
    integer array udg_A32E_R
    integer array udg_A32E_I
    location array udg_A32E_P2
    lightning array udg_A32E_l
    group array udg_A33T_G
    boolean array udg_A35E_B
    integer array udg_A36E_I
    hashtable udg_B07_H = null
    group array udg_B26R_G
    group array udg_B32W_G
    unit udg_KnockBack_Unit2 = null
    integer udg_KnockBack_I2 = 0
    group array udg_Group
    trigger array udg_C14R_Trigger
    group array udg_C17W_G
    group array udg_C10W_G
    hashtable udg_C18_H = null
    group array udg_C19T_AttactGroup
    boolean array udg_C19T_Boolean
    unitpool udg_UnitPool = null
    boolean udg_Crazy_B = false
    string array udg_Test_Order
    force array udg_Force
    player array udg_Player
    location array udg_X_Point
    boolean array udg_Strong_Soilder_B
    itempool udg_item_pool = null
    integer array udg_Kill_Comboo_T
    hashtable udg_Item_H = null
    hashtable udg_Item_H2 = null
    group udg_item35_G = null
    itempool udg_item 035 = null
    item array udg_Item30_ITT
    trigger array udg_AI_Trigger
    unit array udg_AI_HERO
    boolean array udg_B03E_B
    boolean udg_MO_B = false
    boolean udg_CRAZY_B = false
    timer array udg_B08R_T
    integer array udg_Item_Pool_ID
    timer array udg_Catch_Damage_T
    hashtable udg_Trigger_H = null
    hashtable udg_Soul_H = null
    region array udg_Click_Rect
    boolean udg_New_Assist = false
    unit array udg_AbilityAvailable
    // Generated
    rect gg_rct_ADS = null
    rect gg_rct_AL = null
    rect gg_rct_AMS = null
    rect gg_rct_AUS = null
    rect gg_rct_BDS = null
    rect gg_rct_BL = null
    rect gg_rct_BMS = null
    rect gg_rct_BUS = null
    rect gg_rct_DM = null
    rect gg_rct_UM = null
    rect gg_rct_APIG = null
    rect gg_rct_BPIG = null
    rect gg_rct_HERO_A__________u = null
    rect gg_rct_HERO_B__________u = null
    rect gg_rct_Hero_D_______u = null
    rect gg_rct_D__________u = null
    rect gg_rct_M2__________u = null
    rect gg_rct_M__________u = null
    rect gg_rct_M_______u = null
    rect gg_rct_UP__________u = null
    rect gg_rct______________u = null
    rect gg_rct__________2 = null
    rect gg_rct________________u = null
    rect gg_rct_____________u = null
    rect gg_rct___________________1 = null
    rect gg_rct___________________2 = null
    rect gg_rct___________________3 = null
    rect gg_rct___________________4 = null
    rect gg_rct_FU_Walk_Around_A2 = null
    rect gg_rct_FU_Walk_Around_A4 = null
    rect gg_rct_FU_Walk_Around_B4 = null
    rect gg_rct_FU_Walk_Around_B2 = null
    rect gg_rct________DB = null
    rect gg_rct________DA = null
    rect gg_rct________MB = null
    rect gg_rct________MA = null
    rect gg_rct________UB = null
    rect gg_rct________UA = null
    rect gg_rct_AMH = null
    rect gg_rct_A_UP_Turn = null
    rect gg_rct_A_Middle_Turn = null
    rect gg_rct_A_DOWN_Turn2 = null
    rect gg_rct___________________a = null
    rect gg_rct___________________b = null
    rect gg_rct___________________C = null
    rect gg_rct___________________D = null
    rect gg_rct___________________F = null
    rect gg_rct_5 = null
    rect gg_rct_2 = null
    rect gg_rct_3 = null
    rect gg_rct_4 = null
    rect gg_rct_FU_Walk_Around_A1 = null
    rect gg_rct_FU_Walk_Around_A3 = null
    rect gg_rct_FU_Walk_Around_B1 = null
    rect gg_rct_FU_Walk_Around_B3 = null
    rect gg_rct______________041 = null
    rect gg_rct_AMH_RANGE1 = null
    rect gg_rct_______u = null
    rect gg_rct_______2 = null
    rect gg_rct_______3 = null
    rect gg_rct_______4 = null
    rect gg_rct_______5 = null
    rect gg_rct_______6 = null
    rect gg_rct_______7 = null
    rect gg_rct_______8 = null
    rect gg_rct_B______1 = null
    rect gg_rct_B______2 = null
    rect gg_rct_B______3 = null
    rect gg_rct_C______1 = null
    rect gg_rct_C______2 = null
    rect gg_rct_C______3 = null
    rect gg_rct_C______4 = null
    rect gg_rct_C______5 = null
    rect gg_rct_C______6 = null
    rect gg_rct_AMH_RANGE2 = null
    rect gg_rct_AMH_RANGE3 = null
    rect gg_rct_AMH_RANGE4 = null
    sound gg_snd_P012521 = null
    string gg_snd_HeroicVictory
    sound gg_snd_Horse1 = null
    sound gg_snd_Horse2 = null
    sound gg_snd_Horse3 = null
    sound gg_snd_BansheeDeath = null
    sound gg_snd_ObsidianStatueMorph = null
    sound gg_snd_ClanInvitation = null
    sound gg_snd_double_kill = null
    sound gg_snd_firstblood = null
    sound gg_snd_ownage = null
    sound gg_snd_triple_kill = null
    sound gg_snd_ultrakill = null
    sound gg_snd_PlaceAncestralGuardian = null
    sound gg_snd_GoodJob = null
    sound gg_snd_NecropolisUpgrade2 = null
    sound gg_snd_Rescue = null
    sound gg_snd_Warning = null
    trigger gg_trg____________________012 = null
    trigger gg_trg____________________010 = null
    trigger gg_trg____________________007 = null
    trigger gg_trg____________________009 = null
    trigger gg_trg____________________005 = null
    trigger gg_trg_Wheather = null
    trigger gg_trg_AI = null
    trigger gg_trg_Bizzar_J = null
    trigger gg_trg_TIME_TEST = null
    trigger gg_trg_SL_System = null
    trigger gg_trg_Kick_sys_A = null
    trigger gg_trg_Kick_sys_B = null
    trigger gg_trg_Player_Name_Init = null
    trigger gg_trg_Player_VIP_Check = null
    trigger gg_trg_Player_Name_System = null
    trigger gg_trg_Auto_Choose_System = null
    trigger gg_trg_Surrender_Init = null
    trigger gg_trg_Surrender_vote_for_A = null
    trigger gg_trg_Surrender_vote_for_A_2 = null
    trigger gg_trg_Surrender_vote_for_A_3 = null
    trigger gg_trg_Surrender_vote_for_B = null
    trigger gg_trg_Surrender_vote_for_B_2 = null
    trigger gg_trg_Surrender_vote_for_B_3 = null
    trigger gg_trg_RP = null
    trigger gg_trg_MulitiBoard_Init = null
    trigger gg_trg_Player_Leave = null
    trigger gg_trg_GetPlayerNumber = null
    trigger gg_trg_Random_Hero = null
    trigger gg_trg_CRAZY = null
    trigger gg_trg_AH_Mode = null
    trigger gg_trg_Select_Hero = null
    trigger gg_trg_Hero_Init = null
    trigger gg_trg_Hero_Pool_Init = null
    trigger gg_trg_Hero_Pool_Init_________3 = null
    trigger gg_trg_Delete_Delete_time1_time2 = null
    trigger gg_trg_Handle_INIT = null
    trigger gg_trg_Test_Handle = null
    trigger gg_trg_Handle = null
    trigger gg_trg_Test_Handle________2 = null
    trigger gg_trg_Test_Handle_______u = null
    trigger gg_trg_NAJITEST = null
    trigger gg_trg____________________002 = null
    trigger gg_trg_ANTI_HKE = null
    trigger gg_trg____________________004 = null
    trigger gg_trg____________________004_______u = null
    trigger gg_trg_Get_last_selected_unit = null
    trigger gg_trg_LV = null
    trigger gg_trg_GOLD = null
    trigger gg_trg_CD = null
    trigger gg_trg_HM = null
    trigger gg_trg_Test_Lua = null
    trigger gg_trg_HKETEST = null
    trigger gg_trg_new_fast = null
    trigger gg_trg_new_rs = null
    trigger gg_trg_AH_TEST = null
    trigger gg_trg_CR_TEST = null
    trigger gg_trg_ESC_______u = null
    trigger gg_trg_test_AI = null
    trigger gg_trg_itt_pool_init = null
    trigger gg_trg_itt_init = null
    trigger gg_trg_DMG = null
    trigger gg_trg_DEAD = null
    trigger gg_trg_test_init = null
    trigger gg_trg_Check_Stop = null
    trigger gg_trg____________________008 = null
    trigger gg_trg____________________008_______u = null
    trigger gg_trg_test_item = null
    trigger gg_trg_New_Assist = null
    trigger gg_trg_ISSUE = null
    trigger gg_trg_DMG________2 = null
    trigger gg_trg_test_AI________3 = null
    trigger gg_trg____________________015 = null
    trigger gg_trg____________________014 = null
    trigger gg_trg_test_AI________2 = null
    trigger gg_trg_C14E_DEBUG = null
    trigger gg_trg_test_AI_______u = null
    trigger gg_trg_NOCD = null
    trigger gg_trg_test_init________2 = null
    trigger gg_trg_test_init_______u = null
    trigger gg_trg_test7 = null
    trigger gg_trg_TIME = null
    trigger gg_trg_Time2 = null
    trigger gg_trg_Kill_Hero_By_Null_Test = null
    trigger gg_trg_DMG_______u = null
    trigger gg_trg_DMG_INIT = null
    trigger gg_trg_GO = null
    trigger gg_trg_RES = null
    trigger gg_trg_SYS = null
    trigger gg_trg_SPELL = null
    trigger gg_trg_ATK = null
    trigger gg_trg_wulishanghai = null
    trigger gg_trg_fashushanghai = null
    trigger gg_trg_HP = null
    trigger gg_trg_test10 = null
    trigger gg_trg_test10_______u = null
    trigger gg_trg_testDOWN = null
    trigger gg_trg_testRIGHT = null
    trigger gg_trg_testUP = null
    trigger gg_trg_test14 = null
    trigger gg_trg_test17 = null
    trigger gg_trg_test18 = null
    trigger gg_trg_test18_______u = null
    trigger gg_trg_test15 = null
    trigger gg_trg_test_Uint = null
    trigger gg_trg_Test_AI = null
    trigger gg_trg_226 = null
    trigger gg_trg_233 = null
    trigger gg_trg_235 = null
    trigger gg_trg_221 = null
    trigger gg_trg_232 = null
    trigger gg_trg_______AI_______u = null
    trigger gg_trg_JASS_TOOL = null
    trigger gg_trg_test = null
    trigger gg_trg_Prize2s = null
    trigger gg_trg_Prize150s = null
    trigger gg_trg_End_Game_A = null
    trigger gg_trg_End_Game_B = null
    trigger gg_trg_Tower_be_Destoried = null
    trigger gg_trg_Die_Basic_Guards = null
    trigger gg_trg_Die_Advanced_Guards = null
    trigger gg_trg_Barracks_are_Destoried = null
    trigger gg_trg_Game_OverA = null
    trigger gg_trg_Game_OverB = null
    trigger gg_trg_boom = null
    trigger gg_trg_Castle_Anti_Magic = null
    trigger gg_trg_Walk_around_Initi = null
    trigger gg_trg_Walk_around = null
    trigger gg_trg_Army_Turn_MO_OB = null
    trigger gg_trg_Army_Turn_Normal = null
    trigger gg_trg_Army_Born_01 = null
    trigger gg_trg____________________013 = null
    trigger gg_trg____________________011 = null
    trigger gg_trg_Army_Born_02 = null
    trigger gg_trg_Army_Born_03 = null
    trigger gg_trg_Army_Born_01_OB = null
    trigger gg_trg_Army_Born_02__OB = null
    trigger gg_trg_Army_Born_03__OB = null
    trigger gg_trg_Army_Born_01_MO = null
    trigger gg_trg_Army_Born_02__MO = null
    trigger gg_trg_Army_Born_03__MO = null
    trigger gg_trg_Army = null
    trigger gg_trg_Upgrades_01 = null
    trigger gg_trg_Upgrades_02 = null
    trigger gg_trg_Upgrades_03 = null
    trigger gg_trg_0S = null
    trigger gg_trg_5S = null
    trigger gg_trg_15S = null
    trigger gg_trg_50S = null
    trigger gg_trg_1200S = null
    trigger gg_trg_CP_revival_init = null
    trigger gg_trg_CP_revival_start = null
    trigger gg_trg_Boss_die = null
    trigger gg_trg_Boss_Walk = null
    trigger gg_trg_Commotion_A = null
    trigger gg_trg_Commotion_A_spawn = null
    trigger gg_trg_Commotion_B = null
    trigger gg_trg_AMH_DEAD = null
    trigger gg_trg_AMH_TEST = null
    trigger gg_trg_AMH2 = null
    trigger gg_trg_AMH________u = null
    trigger gg_trg_Init_Amh = null
    trigger gg_trg_Init_Amh_______u = null
    trigger gg_trg_Amh = null
    trigger gg_trg____________________020 = null
    trigger gg_trg_MH_UP_______u = null
    trigger gg_trg_MH_Debug = null
    trigger gg_trg_MH_B_Sec = null
    trigger gg_trg_lightning = null
    trigger gg_trg____________________018 = null
    trigger gg_trg_D = null
    trigger gg_trg_pick_for_AB = null
    trigger gg_trg_pickoff = null
    trigger gg_trg_pickon = null
    trigger gg_trg_mana_bug_remove = null
    trigger gg_trg_mana_bug_return = null
    trigger gg_trg____________________006 = null
    trigger gg_trg_Anti_Team_Attack = null
    trigger gg_trg_Anti_Exit_Map = null
    trigger gg_trg_No_HotSpring_A = null
    trigger gg_trg_No_HotSpring_B = null
    trigger gg_trg_Game_Init = null
    trigger gg_trg_Player_Unit_Dead = null
    trigger gg_trg_Computer_Unit_Dead = null
    trigger gg_trg_Hero_Unit_Dead = null
    trigger gg_trg_Hero_Demaged = null
    trigger gg_trg_KnockBack = null
    trigger gg_trg_DooConv = null
    trigger gg_trg_AUD_UP = null
    trigger gg_trg_AUD_Group = null
    trigger gg_trg_AUD_GUI = null
    trigger gg_trg_ChainAbility = null
    trigger gg_trg_illegal = null
    trigger gg_trg_AMH = null
    trigger gg_trg_MH = null
    trigger gg_trg_MH_UP = null
    trigger gg_trg_AMH_DEBUG = null
    trigger gg_trg_init_OB = null
    trigger gg_trg_Observer_Support = null
    trigger gg_trg_Tactics_Init = null
    trigger gg_trg_thirty_seconds_before_tactic_MP_recover = null
    trigger gg_trg_Click = null
    trigger gg_trg_MO = null
    trigger gg_trg_HIGH = null
    trigger gg_trg_SM = null
    trigger gg_trg_NEW = null
    trigger gg_trg_SM_______u = null
    trigger gg_trg_Combination_Table222 = null
    trigger gg_trg_Combination_Init = null
    trigger gg_trg_Hero_Spell_Item_Ability = null
    trigger gg_trg_Unit_Drop_or_Sell_Item = null
    trigger gg_trg_Unit_Pick_Item = null
    trigger gg_trg_Unit_Summend = null
    trigger gg_trg_Unit_Use_Item = null
    trigger gg_trg_Unit_Spell_Cast = null
    trigger gg_trg_Unit_Additional_Item_Ability = null
    trigger gg_trg_Combination_Init_HASH_I = null
    trigger gg_trg_Combination_Init_HASH_II = null
    trigger gg_trg_Combination_Core = null
    trigger gg_trg_Item18A = null
    trigger gg_trg_Item20B = null
    trigger gg_trg_Item22B = null
    trigger gg_trg_Item13_DemageA = null
    trigger gg_trg_B01T = null
    trigger gg_trg_B02W = null
    trigger gg_trg_B02E_R_T = null
    trigger gg_trg_B03 = null
    trigger gg_trg_B03E_damage = null
    trigger gg_trg_B03E_kill = null
    trigger gg_trg_B03R_start = null
    trigger gg_trg_B04 = null
    trigger gg_trg_B05R_Learn = null
    trigger gg_trg_B05R = null
    trigger gg_trg_B06 = null
    trigger gg_trg_B06R = null
    trigger gg_trg_B07 = null
    trigger gg_trg_B07_Upgrade = null
    trigger gg_trg_B07E = null
    trigger gg_trg_B07E_drop = null
    trigger gg_trg_B07E_die = null
    trigger gg_trg_B07E_spell = null
    trigger gg_trg_B07R_learn = null
    trigger gg_trg_B08 = null
    trigger gg_trg_B08_E = null
    trigger gg_trg_B08_R_learn = null
    trigger gg_trg_B08_R_add = null
    trigger gg_trg_B08_R_reduce_damage = null
    trigger gg_trg_B10 = null
    trigger gg_trg_B10R_learn = null
    trigger gg_trg_B10R = null
    trigger gg_trg_B10T = null
    trigger gg_trg_B11 = null
    trigger gg_trg_B11D = null
    trigger gg_trg_B11W = null
    trigger gg_trg_B11E = null
    trigger gg_trg_B11_R_learn = null
    trigger gg_trg_B11_R_start = null
    trigger gg_trg_B11_R_damage = null
    trigger gg_trg_B11_T_start = null
    trigger gg_trg_B11_T_add = null
    trigger gg_trg_B12 = null
    trigger gg_trg_B12D = null
    trigger gg_trg_B12D_stop = null
    trigger gg_trg_B12W = null
    trigger gg_trg_B12R_learn = null
    trigger gg_trg_B12R_attack_start = null
    trigger gg_trg_B12_R_recover = null
    trigger gg_trg_B13 = null
    trigger gg_trg_B13D = null
    trigger gg_trg_B13W = null
    trigger gg_trg_B13R = null
    trigger gg_trg_B13T = null
    trigger gg_trg_B14 = null
    trigger gg_trg_B14W = null
    trigger gg_trg_B14W_attack = null
    trigger gg_trg_B14E = null
    trigger gg_trg_B14R = null
    trigger gg_trg_B14T = null
    trigger gg_trg_B15E = null
    trigger gg_trg_B16 = null
    trigger gg_trg_B16W = null
    trigger gg_trg_B16E = null
    trigger gg_trg_B16R_learn = null
    trigger gg_trg_B16R = null
    trigger gg_trg_B16T_Start = null
    trigger gg_trg_B17 = null
    trigger gg_trg_B17E = null
    trigger gg_trg_B17R_learn = null
    trigger gg_trg_B17R = null
    trigger gg_trg_B17T = null
    trigger gg_trg_B18 = null
    trigger gg_trg_B18_Upgrade = null
    trigger gg_trg_B18W = null
    trigger gg_trg_B18E = null
    trigger gg_trg_B18E_HeroDie = null
    trigger gg_trg_B18R = null
    trigger gg_trg_B18T = null
    trigger gg_trg_B19 = null
    trigger gg_trg_B19D_level = null
    trigger gg_trg_B19D_summon = null
    trigger gg_trg_B19D_summon_ability_stop = null
    trigger gg_trg_B19D_summon_ability = null
    trigger gg_trg_B19D_summon_die = null
    trigger gg_trg_B19W_learn = null
    trigger gg_trg_B19W = null
    trigger gg_trg_B19E = null
    trigger gg_trg_B19T = null
    trigger gg_trg_B21 = null
    trigger gg_trg_B21E = null
    trigger gg_trg_B21R_Upgrade = null
    trigger gg_trg_B21R = null
    trigger gg_trg_B21T = null
    trigger gg_trg_B22 = null
    trigger gg_trg_B22R = null
    trigger gg_trg_B22T = null
    trigger gg_trg_B23 = null
    trigger gg_trg_B23E = null
    trigger gg_trg_B23R = null
    trigger gg_trg_B24 = null
    trigger gg_trg_B24_W = null
    trigger gg_trg_B24R = null
    trigger gg_trg_B24T = null
    trigger gg_trg_B25 = null
    trigger gg_trg_B25W = null
    trigger gg_trg_B25E = null
    trigger gg_trg_B25R_learn = null
    trigger gg_trg_B25R = null
    trigger gg_trg_B26 = null
    trigger gg_trg_B26W_learn = null
    trigger gg_trg_B26W = null
    trigger gg_trg_B26E_learn = null
    trigger gg_trg_B26E = null
    trigger gg_trg_B26R_learn = null
    trigger gg_trg_B26T = null
    trigger gg_trg_B27 = null
    trigger gg_trg_B27R_U = null
    trigger gg_trg_B28 = null
    trigger gg_trg_B28_Upgrade = null
    trigger gg_trg_B28W = null
    trigger gg_trg_B28T = null
    trigger gg_trg_B29 = null
    trigger gg_trg_B29W = null
    trigger gg_trg_B29E = null
    trigger gg_trg_B29R = null
    trigger gg_trg_B30 = null
    trigger gg_trg_B30E = null
    trigger gg_trg_B30R = null
    trigger gg_trg_B30R_count = null
    trigger gg_trg_B30T_learn = null
    trigger gg_trg_B30T = null
    trigger gg_trg_B31 = null
    trigger gg_trg_B31D = null
    trigger gg_trg_B31W = null
    trigger gg_trg_B31E = null
    trigger gg_trg_B31_R_enable = null
    trigger gg_trg_B31T = null
    trigger gg_trg_B32 = null
    trigger gg_trg_B32W = null
    trigger gg_trg_B32W_use = null
    trigger gg_trg_B32E = null
    trigger gg_trg_B32R_learn = null
    trigger gg_trg_B32T = null
    trigger gg_trg_B33 = null
    trigger gg_trg_B33_Hero_lv_up = null
    trigger gg_trg_B33_D_Learn = null
    trigger gg_trg_B33_D_add_to_group = null
    trigger gg_trg_B33_D_remove_from_group = null
    trigger gg_trg_B33_D_reduce_damage = null
    trigger gg_trg_B33_W = null
    trigger gg_trg_B33_E = null
    trigger gg_trg_B33_R = null
    trigger gg_trg_B33_R_STOP = null
    trigger gg_trg_B33_T_start = null
    trigger gg_trg_B33_T_end = null
    trigger gg_trg_B34 = null
    trigger gg_trg_B34W = null
    trigger gg_trg_B34E_cast = null
    trigger gg_trg_B34E_stop = null
    trigger gg_trg_B34T_damage = null
    trigger gg_trg_B35 = null
    trigger gg_trg_B35W = null
    trigger gg_trg_B35E = null
    trigger gg_trg_B35R_learn = null
    trigger gg_trg_B35R_attack = null
    trigger gg_trg_B35T = null
    trigger gg_trg_B36 = null
    trigger gg_trg_B36_W_start = null
    trigger gg_trg_B36W_end = null
    trigger gg_trg_B36E = null
    trigger gg_trg_B36R_effect = null
    trigger gg_trg_B36T = null
    trigger gg_trg_B37 = null
    trigger gg_trg_B37W = null
    trigger gg_trg_B37W_move = null
    trigger gg_trg_B37E = null
    trigger gg_trg_B37R_learn = null
    trigger gg_trg_B37R = null
    trigger gg_trg_B37T_start = null
    trigger gg_trg_A01 = null
    trigger gg_trg_A01_D_reduce_damage = null
    trigger gg_trg_A01_W = null
    trigger gg_trg_A01_E = null
    trigger gg_trg_A01_R = null
    trigger gg_trg_A01_T = null
    trigger gg_trg_A02E = null
    trigger gg_trg_A03W = null
    trigger gg_trg_A03R = null
    trigger gg_trg_A03R_Learn = null
    trigger gg_trg_A04 = null
    trigger gg_trg_A04W = null
    trigger gg_trg_A04W_summend = null
    trigger gg_trg_A04R_start = null
    trigger gg_trg_A04T = null
    trigger gg_trg_A04T_end = null
    trigger gg_trg_A05 = null
    trigger gg_trg_A05W = null
    trigger gg_trg_A05_E = null
    trigger gg_trg_A05_R_learn = null
    trigger gg_trg_A05_R = null
    trigger gg_trg_A05_R_2 = null
    trigger gg_trg_A05_T = null
    trigger gg_trg_A06 = null
    trigger gg_trg_A07 = null
    trigger gg_trg_A07D = null
    trigger gg_trg_A07R_learn = null
    trigger gg_trg_A08 = null
    trigger gg_trg_A08R = null
    trigger gg_trg_A09 = null
    trigger gg_trg_A09D = null
    trigger gg_trg_A09D_stop = null
    trigger gg_trg_A09W = null
    trigger gg_trg_A09E = null
    trigger gg_trg_A09E_effect = null
    trigger gg_trg_A09R = null
    trigger gg_trg_A09T_learn = null
    trigger gg_trg_A10 = null
    trigger gg_trg_A10W = null
    trigger gg_trg_A10R_learn = null
    trigger gg_trg_A10R = null
    trigger gg_trg_A10T_start = null
    trigger gg_trg_A11 = null
    trigger gg_trg_A11D = null
    trigger gg_trg_A11W = null
    trigger gg_trg_A11E = null
    trigger gg_trg_A11T = null
    trigger gg_trg_A12 = null
    trigger gg_trg_A12W_start = null
    trigger gg_trg_A12W_end = null
    trigger gg_trg_A12E = null
    trigger gg_trg_A12R_Learn = null
    trigger gg_trg_A12R = null
    trigger gg_trg_A12T = null
    trigger gg_trg_A13 = null
    trigger gg_trg_A13R = null
    trigger gg_trg_A13T = null
    trigger gg_trg_A14W = null
    trigger gg_trg_A15 = null
    trigger gg_trg_A15R = null
    trigger gg_trg_A15T = null
    trigger gg_trg_A16 = null
    trigger gg_trg_A16D = null
    trigger gg_trg_A16E = null
    trigger gg_trg_A16R_learn = null
    trigger gg_trg_A16R_summon = null
    trigger gg_trg_A16T_start = null
    trigger gg_trg_A17 = null
    trigger gg_trg_A17E = null
    trigger gg_trg_A17R = null
    trigger gg_trg_A17T = null
    trigger gg_trg_A18 = null
    trigger gg_trg_A18D = null
    trigger gg_trg_A18E = null
    trigger gg_trg_A18R = null
    trigger gg_trg_A18T_Time = null
    trigger gg_trg_A18T_Demage = null
    trigger gg_trg_A19 = null
    trigger gg_trg_A19W = null
    trigger gg_trg_A19W_______u = null
    trigger gg_trg_A19E = null
    trigger gg_trg_A19R = null
    trigger gg_trg_A20 = null
    trigger gg_trg_A20W = null
    trigger gg_trg_A20E = null
    trigger gg_trg_A20R = null
    trigger gg_trg_A20T = null
    trigger gg_trg_A20T_creat = null
    trigger gg_trg_A21 = null
    trigger gg_trg_A21W = null
    trigger gg_trg_A21R = null
    trigger gg_trg_A21T = null
    trigger gg_trg_A22 = null
    trigger gg_trg_A22W = null
    trigger gg_trg_A22W_learn = null
    trigger gg_trg_A22W_attack = null
    trigger gg_trg_A22R = null
    trigger gg_trg_A22T = null
    trigger gg_trg_A22T_stop = null
    trigger gg_trg_A23 = null
    trigger gg_trg_A23W = null
    trigger gg_trg_A23T_learn = null
    trigger gg_trg_A23T = null
    trigger gg_trg_A24 = null
    trigger gg_trg_A24W = null
    trigger gg_trg_A24W_stop = null
    trigger gg_trg_A24E = null
    trigger gg_trg_A24R = null
    trigger gg_trg_A24T = null
    trigger gg_trg_A25 = null
    trigger gg_trg_A25_E = null
    trigger gg_trg_A26 = null
    trigger gg_trg_A26_E = null
    trigger gg_trg_A26_T = null
    trigger gg_trg_A27 = null
    trigger gg_trg_A27W = null
    trigger gg_trg_A27E = null
    trigger gg_trg_A27T = null
    trigger gg_trg_A28 = null
    trigger gg_trg_A28W_learn = null
    trigger gg_trg_A28W_start = null
    trigger gg_trg_A28E = null
    trigger gg_trg_A28R = null
    trigger gg_trg_A28R_attacked = null
    trigger gg_trg_A29 = null
    trigger gg_trg_A29W = null
    trigger gg_trg_A29E = null
    trigger gg_trg_A29R_START = null
    trigger gg_trg_A29_T = null
    trigger gg_trg_A30 = null
    trigger gg_trg_A30R = null
    trigger gg_trg_A30T_learn = null
    trigger gg_trg_A30T = null
    trigger gg_trg_A31 = null
    trigger gg_trg_A31E = null
    trigger gg_trg_A31R = null
    trigger gg_trg_A31_T_start = null
    trigger gg_trg_A32 = null
    trigger gg_trg_A32W = null
    trigger gg_trg_A32E = null
    trigger gg_trg_A33 = null
    trigger gg_trg_A33W = null
    trigger gg_trg_A33E_Special = null
    trigger gg_trg_A33_R_enable = null
    trigger gg_trg_A33_R__reduce_damage = null
    trigger gg_trg_A33T = null
    trigger gg_trg_A34 = null
    trigger gg_trg_A34HERO_D = null
    trigger gg_trg_A34Hero_cast = null
    trigger gg_trg_A34_W_start = null
    trigger gg_trg_A34_E = null
    trigger gg_trg_A34_R_enable = null
    trigger gg_trg_A34T_Learn = null
    trigger gg_trg_A34_T = null
    trigger gg_trg_A35 = null
    trigger gg_trg_A35_D_count = null
    trigger gg_trg_A35D = null
    trigger gg_trg_A35W = null
    trigger gg_trg_A35W_knock = null
    trigger gg_trg_A35E = null
    trigger gg_trg_A35E_PLAY = null
    trigger gg_trg_A35R = null
    trigger gg_trg_A35T = null
    trigger gg_trg_A35T_damage_DD = null
    trigger gg_trg_A36 = null
    trigger gg_trg_A36E_init = null
    trigger gg_trg_A36E = null
    trigger gg_trg_A36_R_resist_damage = null
    trigger gg_trg_C01 = null
    trigger gg_trg_C01_Hero_LV_UP = null
    trigger gg_trg_C01W = null
    trigger gg_trg_C01R_learn = null
    trigger gg_trg_C01R = null
    trigger gg_trg_C03 = null
    trigger gg_trg_C03W = null
    trigger gg_trg_C03E = null
    trigger gg_trg_C03R = null
    trigger gg_trg_C03T = null
    trigger gg_trg_C04W = null
    trigger gg_trg_C05 = null
    trigger gg_trg_C05D = null
    trigger gg_trg_C05W = null
    trigger gg_trg_C05R = null
    trigger gg_trg_C05T = null
    trigger gg_trg_C06 = null
    trigger gg_trg_C06W = null
    trigger gg_trg_C06E = null
    trigger gg_trg_C06T = null
    trigger gg_trg_C07 = null
    trigger gg_trg_C07W_PLAY = null
    trigger gg_trg_C07E_START = null
    trigger gg_trg_C07R = null
    trigger gg_trg_C09 = null
    trigger gg_trg_C09W = null
    trigger gg_trg_C09E = null
    trigger gg_trg_C09R_learn = null
    trigger gg_trg_C10 = null
    trigger gg_trg_C10W_Spell_for_target = null
    trigger gg_trg_C10R_Attack_Unit = null
    trigger gg_trg_C11T = null
    trigger gg_trg_C12 = null
    trigger gg_trg_C12W = null
    trigger gg_trg_C12E_start = null
    trigger gg_trg_C12E_stop = null
    trigger gg_trg_C12R = null
    trigger gg_trg_C12R_stop = null
    trigger gg_trg_C13R = null
    trigger gg_trg_C13T = null
    trigger gg_trg_C14 = null
    trigger gg_trg_C14D = null
    trigger gg_trg_C14W_start = null
    trigger gg_trg_C14W = null
    trigger gg_trg_C14R_learn = null
    trigger gg_trg_C14R_attack = null
    trigger gg_trg_C14R = null
    trigger gg_trg_C14T = null
    trigger gg_trg_C15 = null
    trigger gg_trg_C15D_check = null
    trigger gg_trg_C15D_effect = null
    trigger gg_trg_C15W = null
    trigger gg_trg_C15R = null
    trigger gg_trg_C16 = null
    trigger gg_trg_C16E = null
    trigger gg_trg_C16R = null
    trigger gg_trg_C17 = null
    trigger gg_trg_C17W = null
    trigger gg_trg_C17E = null
    trigger gg_trg_C17R = null
    trigger gg_trg_C17T = null
    trigger gg_trg_C18 = null
    trigger gg_trg_C18T = null
    trigger gg_trg_C19 = null
    trigger gg_trg_C19E = null
    trigger gg_trg_C19T = null
    trigger gg_trg_C20 = null
    trigger gg_trg_C20W = null
    trigger gg_trg_C20W_stop = null
    trigger gg_trg_C20D = null
    trigger gg_trg_C20E = null
    trigger gg_trg_C20R_learn = null
    trigger gg_trg_C20T = null
    trigger gg_trg_C22 = null
    trigger gg_trg_C22W = null
    trigger gg_trg_C22D = null
    trigger gg_trg_C22E = null
    trigger gg_trg_C22R = null
    trigger gg_trg_C22T = null
    trigger gg_trg_C22T_check = null
    trigger gg_trg_C23 = null
    trigger gg_trg_C23W = null
    trigger gg_trg_C23E = null
    trigger gg_trg_C23R = null
    trigger gg_trg_C23R_enable = null
    trigger gg_trg_C23R_reduce_damage = null
    trigger gg_trg_C23T = null
    trigger gg_trg_C24 = null
    trigger gg_trg_C24_W = null
    trigger gg_trg_C24E_check = null
    trigger gg_trg_C24E = null
    trigger gg_trg_C24R_learn = null
    trigger gg_trg_C24R = null
    trigger gg_trg_C24R_attack_start = null
    trigger gg_trg_C24T = null
    trigger gg_trg_C25 = null
    trigger gg_trg_C25_learn = null
    trigger gg_trg_C25W = null
    trigger gg_trg_C25W2 = null
    trigger gg_trg_C25W2_attack = null
    trigger gg_trg_C25_E = null
    trigger gg_trg_C25R = null
    trigger gg_trg_C25T = null
    trigger gg_trg_C26 = null
    trigger gg_trg_C26D = null
    trigger gg_trg_C26W = null
    trigger gg_trg_C26E = null
    trigger gg_trg_C26R = null
    trigger gg_trg_C26T = null
    trigger gg_trg_C27 = null
    trigger gg_trg_C27W = null
    trigger gg_trg_C27E = null
    trigger gg_trg_C27R_learn = null
    trigger gg_trg_C27R = null
    trigger gg_trg_C27T = null
    trigger gg_trg_C40 = null
    trigger gg_trg_C40_W = null
    trigger gg_trg_C40W = null
    trigger gg_trg_C40E = null
    trigger gg_trg_C40_T = null
    trigger gg_trg_C28_init = null
    trigger gg_trg_C28 = null
    trigger gg_trg_C29 = null
    trigger gg_trg____________________001 = null
    trigger gg_trg____________________003 = null
    trigger gg_trg_C29W = null
    trigger gg_trg_C29E = null
    trigger gg_trg_C29D = null
    trigger gg_trg_C29D_Stop = null
    trigger gg_trg_C29R = null
    trigger gg_trg________________u = null
    trigger gg_trg_Game_Start = null
    trigger gg_trg_Game_Start_______u = null
    trigger gg_trg_F9 = null
    trigger gg_trg_JASS_INIT = null
    trigger gg_trg_Point_Init = null
    unit gg_unit_n00R_0603 = null
    unit gg_unit_nten_0010 = null
    unit gg_unit_nten_0011 = null
    unit gg_unit_nten_0012 = null
    unit gg_unit_otrb_0013 = null
    unit gg_unit_otrb_0014 = null
    unit gg_unit_otrb_0015 = null
    unit gg_unit_hvlt_0017 = null
    unit gg_unit_hvlt_0018 = null
    unit gg_unit_hvlt_0019 = null
    unit gg_unit_hvlt_0020 = null
    unit gg_unit_hvlt_0021 = null
    unit gg_unit_nfoh_0022 = null
    unit gg_unit_nbld_0142 = null
    unit gg_unit_owtw_0026 = null
    unit gg_unit_owtw_0027 = null
    unit gg_unit_owtw_0028 = null
    unit gg_unit_owtw_0029 = null
    unit gg_unit_owtw_0030 = null
    unit gg_unit_owtw_0031 = null
    unit gg_unit_owtw_0032 = null
    unit gg_unit_owtw_0033 = null
    unit gg_unit_owtw_0034 = null
    unit gg_unit_owtw_0035 = null
    unit gg_unit_owtw_0036 = null
    unit gg_unit_owtw_0037 = null
    unit gg_unit_owtw_0038 = null
    unit gg_unit_owtw_0039 = null
    unit gg_unit_owtw_0040 = null
    unit gg_unit_owtw_0041 = null
    unit gg_unit_owtw_0042 = null
    unit gg_unit_owtw_0043 = null
    unit gg_unit_owtw_0044 = null
    unit gg_unit_owtw_0045 = null
    unit gg_unit_owtw_0046 = null
    unit gg_unit_owtw_0047 = null
    unit gg_unit_n00R_0359 = null
    unit gg_unit_owtw_0104 = null
    unit gg_unit_ngad_0060 = null
    unit gg_unit_e00P_0444 = null
    unit gg_unit_ndrk_0582 = null
    unit gg_unit_h00Y_0816 = null
    unit gg_unit_n00R_0122 = null
    unit gg_unit_ndrk_0128 = null
    unit gg_unit_ngad_0068 = null
    unit gg_unit_h01O_0634 = null
    unit gg_unit_nsko_0178 = null
    unit gg_unit_h01P_0633 = null
    unit gg_unit_n025_0588 = null
    unit gg_unit_owtw_0090 = null
    unit gg_unit_n00R_0599 = null
    unit gg_unit_n00R_0601 = null
    unit gg_unit_n00R_0600 = null
    unit gg_unit_ntn2_0372 = null
    unit gg_unit_ntn2_0009 = null
    unit gg_unit_h01R_0805 = null
    unit gg_unit_h026_0732 = null
    unit gg_unit_h01Q_0016 = null
    unit gg_unit_n00R_0356 = null
    unit gg_unit_n00R_0357 = null
    unit gg_unit_n00R_0358 = null
    unit gg_unit_nfoh_0366 = null
    unit gg_unit_hvlt_0367 = null
    unit gg_unit_hvlt_0368 = null
    unit gg_unit_hvlt_0369 = null
    unit gg_unit_hvlt_0370 = null
    unit gg_unit_hvlt_0371 = null
    unit gg_unit_n00R_0602 = null
    unit gg_unit_nten_0388 = null
    unit gg_unit_nten_0389 = null
    unit gg_unit_otrb_0390 = null
    unit gg_unit_otrb_0391 = null
    unit gg_unit_otrb_0392 = null
    unit gg_unit_nten_0393 = null
    unit gg_unit_o007_0394 = null
    unit gg_unit_o007_0395 = null
    unit gg_unit_o007_0396 = null
    unit gg_unit_o007_0397 = null
    unit gg_unit_o007_0398 = null
    unit gg_unit_o007_0399 = null
    unit gg_unit_o007_0400 = null
    unit gg_unit_o007_0401 = null
    unit gg_unit_o007_0402 = null
    unit gg_unit_o007_0403 = null
    unit gg_unit_o007_0404 = null
    unit gg_unit_o007_0405 = null
    unit gg_unit_o007_0406 = null
    unit gg_unit_o007_0407 = null
    unit gg_unit_o007_0408 = null
    unit gg_unit_o007_0409 = null
    unit gg_unit_o007_0410 = null
    unit gg_unit_o007_0411 = null
    unit gg_unit_o007_0412 = null
    unit gg_unit_o007_0413 = null
    unit gg_unit_o007_0414 = null
    unit gg_unit_o007_0415 = null
    unit gg_unit_o007_0416 = null
    unit gg_unit_o007_0417 = null
    unit gg_unit_h01L_0813 = null
    unit gg_unit_h01N_0815 = null
    unit gg_unit_n021_0064 = null
    unit gg_unit_e00V_0577 = null
    unit gg_unit_ntav_0363 = null
    unit gg_unit_n01L_0362 = null
    unit gg_unit_n00J_0364 = null
    unit gg_unit_n000_0365 = null
    unit gg_unit_n01I_0583 = null
    unit gg_unit_n001_0584 = null
    unit gg_unit_e00O_0325 = null
    unit gg_unit_n01N_0589 = null
    unit gg_unit_e00D_0301 = null
endglobals
function InitGlobals takes nothing returns nothing
    local integer i = 0
    set udg_KickVotesYes = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_tmpUG[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_temp_Number[i] = 0
        set i = i + 1
    endloop
    set udg_tmpPF = CreateForce()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S03_color_of_players[i] = ""
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S02_revival_time[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S03_number_kill[i] = 0
        set i = i + 1
    endloop
    set udg_B11_T_I = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_CP_revival_time[i] = 0
        set i = i + 1
    endloop
    set udg_single_player = false
    set udg_A36E_Number = 0
    set udg_soilder = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B31_B[i] = false
        set i = i + 1
    endloop
    set udg_S20_Number = 0
    set udg_S02_Number = 0
    set udg_A_common_group = CreateGroup()
    set udg_A35_time = 0
    set udg_A35_Magic = 0
    set udg_A35E_Magic2 = 0
    set udg_A35T_Demage = 0
    set udg_time_h = 0
    set udg_time_m = 0
    set udg_time_s = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S05_time[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Kill_Comboo[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S11_timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S12_Building[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S13_time[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S12_Picture[i] = ""
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S17_kill_H_num[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S18_die_Number[i] = 0
        set i = i + 1
    endloop
    set udg_S30_3_Number = 0
    set udg_S30_3_Number2 = 0
    set udg_S20_Auto_Number = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S20_horse_soilfer_num[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_New_01[i] = 0
        set i = i + 1
    endloop
    set udg_S40_number = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S40_Timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S300_Number[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_S11_Money_Number[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A25_I[i] = 0
        set i = i + 1
    endloop
    set udg_B040_R = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B24_R[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C14_R[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C23_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C24R_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_resist_damage_R[i] = 0
        set i = i + 1
    endloop
    set udg_tmpB = false
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_tmpR[i] = 0
        set i = i + 1
    endloop
    set udg_tmpTimer = CreateTimer()
    set udg_A35_UG = CreateGroup()
    set udg_B36_UG = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_N01_name[i] = ""
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_N01_name2[i] = ""
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_N01_name3[i] = ""
        set i = i + 1
    endloop
    set udg_B040T_demage = false
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_il02_B[i] = false
        set i = i + 1
    endloop
    set udg_tactic_Q_I = 0
    set udg_A_common_group2 = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B30R_I[i] = 0
        set i = i + 1
    endloop
    set udg_sl_F = CreateForce()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_sl_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_sl_period[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_sl_timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_sl_S[i] = ""
        set i = i + 1
    endloop
    set udg_B040_R_I = 0
    set udg_Delete_time = 0
    set udg_Delete_time2 = 0
    set udg_A28E_UG = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Surrende_vote[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B06_E_I[i] = 0
        set i = i + 1
    endloop
    set udg_tmpS = ""
    set udg_A27T_UG = CreateGroup()
    set udg_die_money = 0
    set udg_Kick_time = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Tactics_Skill_Mana[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_real_name[i] = ""
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_item_strom_book[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_New_sign[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_anti_gegi_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_KickVotesYes_ture[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_common_Group[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C12R_area[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B34E_timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set udg_A31R_timer = CreateTimer()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Tacitc_group[i] = CreateGroup()
        set i = i + 1
    endloop
    set udg_KickTime = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C25T_timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C05W_stun[i] = 0
        set i = i + 1
    endloop
    set udg_V_TURE = false
    set udg_CP_group = CreateGroup()
    set udg_C27R_demage = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_V_True2[i] = false
        set i = i + 1
    endloop
    set udg_Pay_money = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C15D_check[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C40E_time[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Hero_Number_ReviveTime[i] = -1
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Delay_Check[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Players_group[i] = CreateForce()
        set i = i + 1
    endloop
    set udg_High_Boolen = false
    set udg_Pay_Money2 = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Tokisaki_Kurumi[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_get_wood[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_AI_Units[i] = CreateGroup()
        set i = i + 1
    endloop
    set udg_AH = 0
    set udg_C14E_Int = 0
    set udg_exp = 0
    set udg_HIGH = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_ADamage_value[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_Boolen[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_TValue[i] = 0
        set i = i + 1
    endloop
    set udg_KnockBack_Boolean1 = false
    set udg_KnockBack_Dist = 0
    set udg_KnockBack_Speed = 0
    set udg_KnockBack_Time = 0
    set udg_KnockBack_Interval = 0
    set udg_KnockBack_Boolean2 = false
    set udg_KnockBack_Rate = 0
    set udg_AUD_time = 0
    set udg_AUD_Group = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_X[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Y[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B06R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B03_B[i] = false
        set i = i + 1
    endloop
    set udg_AUD_Group2 = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C22T_check[i] = false
        set i = i + 1
    endloop
    set udg_Click = DialogCreate()
    set udg_F_MS_XH = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_SJ[i] = 0
        set i = i + 1
    endloop
    set udg_XYX = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_WJ_GD[i] = 0
        set i = i + 1
    endloop
    set udg_globals = CreateForce()
    set udg_krm_llOI = false
    set udg_X_Observer = false
    set udg_TempInteger = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C19T_Index[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C19T_LV[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_auto[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_omamori_Check[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 11)
        set udg_MH_group[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Assist_true[i] = false
        set i = i + 1
    endloop
    set udg_Assist_I = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B36R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B08R_I2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B08R_true2[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B11_R_T[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B11_R_I2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B11_T_I2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B12R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B13T_Count2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B21T_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B25_group2[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B25R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B26R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B33D_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set udg_real = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B34_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B34_I2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B34W_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B34E_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B35R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B36W_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C01T_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C01T_T[i] = CreateTimer()
        set i = i + 1
    endloop
    set udg_Lighting_sring = ""
    set udg_Lighting_x0 = 0
    set udg_Lighting_y0 = 0
    set udg_Lighting_x1 = 0
    set udg_Lighting_y1 = 0
    set udg_Lighting_cr = 0
    set udg_Lighting_cg = 0
    set udg_Lighting_cb = 0
    set udg_Lighting_ca = 0
    set udg_Lighting_t1 = 0
    set udg_Lighting_t2 = 0
    set udg_Lighting_tf = 0
    set udg_Lighting_bud = false
    set udg_Lighting_I = 0
    set udg_Lighting_B = false
    set udg_Lighting_I2 = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C07W_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C07W_Damage[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C12E_T[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C14W_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C14T_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C14R_damage[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C14T_I3[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C14T_I2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C14T_I4[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_D_B[i] = false
        set i = i + 1
    endloop
    set udg_ChainAbility_a = 0
    set udg_ChainAbility_s = ""
    set udg_ChainAbility_a2 = 0
    set udg_ChainAbility_s2 = ""
    set udg_ChainAbility_fu = 0
    set udg_ChainAbility_fu2 = 0
    set udg_ChainAbility_r = 0
    set udg_ChainAbility_j = 0
    set udg_ChainAbility_v = 0
    set udg_ChainAbility_m = 0
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C18T_dmg[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C18T_ManaCheck[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C18T_DmgBonus[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C23R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C24R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C25W_I[i] = 0
        set i = i + 1
    endloop
    set udg_ChainAbility_t = 0
    set udg_ChainAbility_b = false
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C25W_Timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C25R_heal[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C26D_Timer[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C26W_R[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_I1[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_I2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A05R_R[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A05R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A06T_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A06T_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A06D_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A08R_R[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A12R_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A18T_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A24E_R[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A24E_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A24T_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A24T_A[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A24T_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A27W_R2[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A27W_R1[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A27W_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A27W_A[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A27W_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A27T_damage[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A27T_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A28R_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A29R_T[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A30R_T[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A30R_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A31R_damage[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A32E_R[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A32E_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A33T_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A35E_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_A36E_I[i] = 0
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B26R_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B32W_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set udg_KnockBack_I2 = 0
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Group[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C17W_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C10W_G[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C19T_AttactGroup[i] = CreateGroup()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_C19T_Boolean[i] = false
        set i = i + 1
    endloop
    set udg_Crazy_B = false
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Test_Order[i] = ""
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Force[i] = CreateForce()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Strong_Soilder_B[i] = false
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Kill_Comboo_T[i] = 0
        set i = i + 1
    endloop
    set udg_item35_G = CreateGroup()
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B03E_B[i] = false
        set i = i + 1
    endloop
    set udg_MO_B = false
    set udg_CRAZY_B = false
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_B08R_T[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 10)
        set udg_Catch_Damage_T[i] = CreateTimer()
        set i = i + 1
    endloop
    set i = 0
    loop
        exitwhen (i > 1)
        set udg_Click_Rect[i] = CreateRegion()
        set i = i + 1
    endloop
    set udg_New_Assist = false
endfunction
//***************************************************************************
//*
//*  Unit Item Tables
//*
//***************************************************************************
function Unit000178_DropItems takes nothing returns nothing
    local widget trigWidget = null
    local unit trigUnit = null
    local integer itemID = 0
    local boolean canDrop = true
    set trigWidget = bj_lastDyingWidget
    if (trigWidget == null) then
        set trigUnit = GetTriggerUnit()
    endif
    if (trigUnit != null) then
        set canDrop = not IsUnitHidden(trigUnit)
        if (canDrop and GetChangingUnit() != null) then
            set canDrop = (GetChangingUnitPrevOwner() == Player(PLAYER_NEUTRAL_AGGRESSIVE))
        endif
    endif
    if (canDrop) then
        // Item set 0
        call RandomDistReset( )
        call RandomDistAddItem( 'ankh', 100 )
        set itemID = RandomDistChoose( )
        if (trigUnit != null) then
            call UnitDropItem( trigUnit, itemID )
        else
            call WidgetDropItem( trigWidget, itemID )
        endif
    endif
    set bj_lastDyingWidget = null
    call DestroyTrigger(GetTriggeringTrigger())
endfunction
//***************************************************************************
//*
//*  Sounds
//*
//***************************************************************************
function InitSounds takes nothing returns nothing
    set gg_snd_P012521 = CreateSound( "Abilities\\Spells\\Human\\StormBolt\\ThunderBoltMissileDeath.wav", false, true, true, 10, 10, "SpellsEAX" )
    call SetSoundParamsFromLabel( gg_snd_P012521, "StormBolt" )
    call SetSoundDuration( gg_snd_P012521, 2236 )
    set gg_snd_HeroicVictory = "Sound\\Music\\mp3Music\\HeroicVictory.mp3"
    set gg_snd_Horse1 = CreateSound( "Units\\Human\\KnightNoRider\\KnightNoRiderWarcry1.wav", false, true, true, 10, 10, "SpellsEAX" )
    call SetSoundParamsFromLabel( gg_snd_Horse1, "KnightNoRiderWarcry" )
    call SetSoundDuration( gg_snd_Horse1, 2217 )
    call SetSoundChannel( gg_snd_Horse1, 13 )
    call SetSoundPitch( gg_snd_Horse1, 1.1 )
    call SetSoundDistances( gg_snd_Horse1, 6000.0, 10000.0 )
    call SetSoundDistanceCutoff( gg_snd_Horse1, 3000.0 )
    set gg_snd_Horse2 = CreateSound( "Units\\Human\\KnightNoRider\\KnightNoRiderYes2.wav", false, true, true, 10, 10, "SpellsEAX" )
    call SetSoundParamsFromLabel( gg_snd_Horse2, "KnightNoRiderYes" )
    call SetSoundDuration( gg_snd_Horse2, 2101 )
    call SetSoundChannel( gg_snd_Horse2, 13 )
    call SetSoundPitch( gg_snd_Horse2, 1.1 )
    call SetSoundDistances( gg_snd_Horse2, 6000.0, 10000.0 )
    call SetSoundDistanceCutoff( gg_snd_Horse2, 3000.0 )
    set gg_snd_Horse3 = CreateSound( "Units\\Human\\KnightNoRider\\KnightNoRiderYesAttack1.wav", false, true, true, 10, 10, "SpellsEAX" )
    call SetSoundParamsFromLabel( gg_snd_Horse3, "KnightNoRiderYesAttack" )
    call SetSoundDuration( gg_snd_Horse3, 1800 )
    call SetSoundChannel( gg_snd_Horse3, 13 )
    call SetSoundPitch( gg_snd_Horse3, 1.1 )
    call SetSoundDistances( gg_snd_Horse3, 6000.0, 10000.0 )
    call SetSoundDistanceCutoff( gg_snd_Horse3, 3000.0 )
    set gg_snd_BansheeDeath = CreateSound( "Units\\Undead\\Banshee\\BansheeDeath.wav", false, true, true, 10, 10, "DefaultEAXON" )
    call SetSoundParamsFromLabel( gg_snd_BansheeDeath, "BansheeDeath" )
    call SetSoundDuration( gg_snd_BansheeDeath, 2380 )
    set gg_snd_ObsidianStatueMorph = CreateSound( "Units\\Undead\\ObsidianStatue\\ObsidianStatueMorph.wav", false, true, true, 10, 10, "SpellsEAX" )
    call SetSoundParamsFromLabel( gg_snd_ObsidianStatueMorph, "ObsidianStatueMorph" )
    call SetSoundDuration( gg_snd_ObsidianStatueMorph, 3384 )
    set gg_snd_ClanInvitation = CreateSound( "Sound\\Interface\\ClanInvitation.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_ClanInvitation, "ClanInvitation" )
    call SetSoundDuration( gg_snd_ClanInvitation, 4296 )
    set gg_snd_double_kill = CreateSound( "war3mapImported\\double_kill.mp3", false, false, false, 10, 10, "" )
    call SetSoundDuration( gg_snd_double_kill, 2012 )
    call SetSoundChannel( gg_snd_double_kill, 0 )
    call SetSoundVolume( gg_snd_double_kill, 127 )
    call SetSoundPitch( gg_snd_double_kill, 1.0 )
    set gg_snd_firstblood = CreateSound( "war3mapImported\\firstblood.mp3", false, false, false, 10, 10, "" )
    call SetSoundDuration( gg_snd_firstblood, 1568 )
    call SetSoundChannel( gg_snd_firstblood, 0 )
    call SetSoundVolume( gg_snd_firstblood, 127 )
    call SetSoundPitch( gg_snd_firstblood, 1.0 )
    set gg_snd_ownage = CreateSound( "war3mapImported\\ownage.mp3", false, false, false, 10, 10, "" )
    call SetSoundDuration( gg_snd_ownage, 2586 )
    call SetSoundChannel( gg_snd_ownage, 0 )
    call SetSoundVolume( gg_snd_ownage, 127 )
    call SetSoundPitch( gg_snd_ownage, 1.0 )
    set gg_snd_triple_kill = CreateSound( "war3mapImported\\triple_kill.mp3", false, false, false, 10, 10, "" )
    call SetSoundDuration( gg_snd_triple_kill, 1907 )
    call SetSoundChannel( gg_snd_triple_kill, 0 )
    call SetSoundVolume( gg_snd_triple_kill, 127 )
    call SetSoundPitch( gg_snd_triple_kill, 1.0 )
    set gg_snd_ultrakill = CreateSound( "war3mapImported\\ultrakill.mp3", false, false, false, 10, 10, "" )
    call SetSoundDuration( gg_snd_ultrakill, 1881 )
    call SetSoundChannel( gg_snd_ultrakill, 0 )
    call SetSoundVolume( gg_snd_ultrakill, 127 )
    call SetSoundPitch( gg_snd_ultrakill, 1.0 )
    set gg_snd_PlaceAncestralGuardian = CreateSound( "Units\\Orc\\HealingWard\\PlaceAncestralGuardian.wav", false, true, true, 10, 10, "SpellsEAX" )
    call SetSoundParamsFromLabel( gg_snd_PlaceAncestralGuardian, "HealingWardBirth" )
    call SetSoundDuration( gg_snd_PlaceAncestralGuardian, 3063 )
    set gg_snd_GoodJob = CreateSound( "Sound\\Interface\\GoodJob.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_GoodJob, "GoodJob" )
    call SetSoundDuration( gg_snd_GoodJob, 2548 )
    set gg_snd_NecropolisUpgrade2 = CreateSound( "Buildings\\Undead\\Necropolis\\NecropolisUpgrade2.wav", false, true, true, 10, 10, "DefaultEAXON" )
    call SetSoundParamsFromLabel( gg_snd_NecropolisUpgrade2, "Necropolisu2What" )
    call SetSoundDuration( gg_snd_NecropolisUpgrade2, 5824 )
    set gg_snd_Rescue = CreateSound( "Sound\\Interface\\Rescue.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_Rescue, "Rescue" )
    call SetSoundDuration( gg_snd_Rescue, 3796 )
    set gg_snd_Warning = CreateSound( "Sound\\Interface\\Warning.wav", false, false, false, 10, 10, "" )
    call SetSoundParamsFromLabel( gg_snd_Warning, "Warning" )
    call SetSoundDuration( gg_snd_Warning, 1904 )
endfunction
//***************************************************************************
//*
//*  Unit Creation
//*
//***************************************************************************
//===========================================================================
function CreateBuildingsForPlayer0 takes nothing returns nothing
    local player p = Player(0)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0017 = CreateUnit( p, 'hvlt', 7744.0, -7552.0, 270.000 )
    set gg_unit_n00R_0122 = CreateUnit( p, 'n00R', 7744.0, -7424.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer0 takes nothing returns nothing
    local player p = Player(0)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer1 takes nothing returns nothing
    local player p = Player(1)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0018 = CreateUnit( p, 'hvlt', 7872.0, -7552.0, 270.000 )
    set gg_unit_n00R_0356 = CreateUnit( p, 'n00R', 7872.0, -7424.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer1 takes nothing returns nothing
    local player p = Player(1)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer2 takes nothing returns nothing
    local player p = Player(2)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0019 = CreateUnit( p, 'hvlt', 8000.0, -7552.0, 270.000 )
    set gg_unit_n00R_0357 = CreateUnit( p, 'n00R', 8000.0, -7424.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer2 takes nothing returns nothing
    local player p = Player(2)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer3 takes nothing returns nothing
    local player p = Player(3)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0020 = CreateUnit( p, 'hvlt', 7744.0, -7936.0, 270.000 )
    set gg_unit_n00R_0358 = CreateUnit( p, 'n00R', 7744.0, -7808.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer3 takes nothing returns nothing
    local player p = Player(3)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer4 takes nothing returns nothing
    local player p = Player(4)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0021 = CreateUnit( p, 'hvlt', 7872.0, -7936.0, 270.000 )
    set gg_unit_n00R_0359 = CreateUnit( p, 'n00R', 7872.0, -7808.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer4 takes nothing returns nothing
    local player p = Player(4)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer5 takes nothing returns nothing
    local player p = Player(5)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0367 = CreateUnit( p, 'hvlt', -7808.0, 7488.0, 270.000 )
    set gg_unit_n00R_0599 = CreateUnit( p, 'n00R', -7872.0, 7552.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer5 takes nothing returns nothing
    local player p = Player(5)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer6 takes nothing returns nothing
    local player p = Player(6)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0368 = CreateUnit( p, 'hvlt', -7744.0, 7616.0, 270.000 )
    set gg_unit_n00R_0600 = CreateUnit( p, 'n00R', -7808.0, 7680.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer6 takes nothing returns nothing
    local player p = Player(6)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer7 takes nothing returns nothing
    local player p = Player(7)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0369 = CreateUnit( p, 'hvlt', -7680.0, 7744.0, 270.000 )
    set gg_unit_n00R_0601 = CreateUnit( p, 'n00R', -7744.0, 7808.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer7 takes nothing returns nothing
    local player p = Player(7)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer8 takes nothing returns nothing
    local player p = Player(8)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0370 = CreateUnit( p, 'hvlt', -7552.0, 7744.0, 270.000 )
    set gg_unit_n00R_0602 = CreateUnit( p, 'n00R', -7616.0, 7808.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer8 takes nothing returns nothing
    local player p = Player(8)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer9 takes nothing returns nothing
    local player p = Player(9)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_hvlt_0371 = CreateUnit( p, 'hvlt', -7424.0, 7744.0, 270.000 )
    set gg_unit_n00R_0603 = CreateUnit( p, 'n00R', -7488.0, 7808.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer9 takes nothing returns nothing
    local player p = Player(9)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'h01D', -6336.0, 7936.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 7936.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01D', -7040.0, -7808.0, 270.000 )
    set u = CreateUnit( p, 'h01D', 6336.0, 7936.0, 270.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer10 takes nothing returns nothing
    local player p = Player(10)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'n00M', 6746.9, -7749.0, 45.000 )
    set u = CreateUnit( p, 'n002', 6586.7, -7587.7, 45.000 )
    set u = CreateUnit( p, 'n00N', 6668.0, -7676.3, 45.000 )
    set gg_unit_ntn2_0009 = CreateUnit( p, 'ntn2', 6208.0, -6400.0, 270.000 )
    call IssueImmediateOrder( gg_unit_ntn2_0009, "" )
    set gg_unit_nten_0010 = CreateUnit( p, 'nten', 6656.0, -3456.0, 270.000 )
    set gg_unit_nten_0011 = CreateUnit( p, 'nten', 4800.0, -4992.0, 270.000 )
    set gg_unit_nten_0012 = CreateUnit( p, 'nten', 3392.0, -6400.0, 270.000 )
    set gg_unit_otrb_0013 = CreateUnit( p, 'otrb', -192.0, -6336.0, 270.000 )
    set gg_unit_otrb_0014 = CreateUnit( p, 'otrb', 2624.0, -3392.0, 270.000 )
    set gg_unit_otrb_0015 = CreateUnit( p, 'otrb', 6400.0, -832.0, 270.000 )
    set gg_unit_nfoh_0022 = CreateUnit( p, 'nfoh', 7296.0, -7616.0, 270.000 )
    set u = CreateUnit( p, 'n00D', 6520.0, -7504.0, 45.000 )
    set u = CreateUnit( p, 'ngwr', 7200.0, -4640.0, 270.000 )
    set u = CreateUnit( p, 'ngwr', 3936.0, -6944.0, 270.000 )
    set gg_unit_owtw_0026 = CreateUnit( p, 'owtw', 2880.0, -6656.0, 270.000 )
    set gg_unit_owtw_0027 = CreateUnit( p, 'owtw', 2240.0, -6656.0, 270.000 )
    set gg_unit_owtw_0028 = CreateUnit( p, 'owtw', 2240.0, -6080.0, 270.000 )
    set gg_unit_owtw_0029 = CreateUnit( p, 'owtw', 2880.0, -6080.0, 270.000 )
    set gg_unit_owtw_0030 = CreateUnit( p, 'owtw', -896.0, -5952.0, 270.000 )
    set gg_unit_owtw_0031 = CreateUnit( p, 'owtw', -896.0, -6656.0, 270.000 )
    set gg_unit_owtw_0032 = CreateUnit( p, 'owtw', -3072.0, -6016.0, 270.000 )
    set gg_unit_owtw_0033 = CreateUnit( p, 'owtw', -3072.0, -6656.0, 270.000 )
    set gg_unit_owtw_0034 = CreateUnit( p, 'owtw', 2240.0, -2560.0, 270.000 )
    set gg_unit_owtw_0035 = CreateUnit( p, 'owtw', 1728.0, -3008.0, 270.000 )
    set gg_unit_owtw_0036 = CreateUnit( p, 'owtw', 3456.0, -3776.0, 270.000 )
    set gg_unit_owtw_0037 = CreateUnit( p, 'owtw', 4672.0, -4480.0, 270.000 )
    set gg_unit_owtw_0038 = CreateUnit( p, 'owtw', 2944.0, -4288.0, 270.000 )
    set gg_unit_owtw_0039 = CreateUnit( p, 'owtw', 4224.0, -4992.0, 270.000 )
    set gg_unit_owtw_0040 = CreateUnit( p, 'owtw', 6336.0, -2560.0, 270.000 )
    set gg_unit_owtw_0041 = CreateUnit( p, 'owtw', 6336.0, -3072.0, 270.000 )
    set gg_unit_owtw_0042 = CreateUnit( p, 'owtw', 6976.0, -3072.0, 270.000 )
    set gg_unit_owtw_0043 = CreateUnit( p, 'owtw', 6976.0, -2560.0, 270.000 )
    set gg_unit_owtw_0044 = CreateUnit( p, 'owtw', 6080.0, -192.0, 270.000 )
    set gg_unit_owtw_0045 = CreateUnit( p, 'owtw', 6720.0, -192.0, 270.000 )
    set gg_unit_owtw_0046 = CreateUnit( p, 'owtw', 5952.0, 2880.0, 270.000 )
    set gg_unit_owtw_0047 = CreateUnit( p, 'owtw', 6720.0, 2880.0, 270.000 )
    set u = CreateUnit( p, 'hgra', 6528.0, 2432.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 6912.0, -1216.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 5888.0, -1216.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -2560.0, -6592.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 2560.0, -3968.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 384.0, -5760.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 448.0, -6848.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 1984.0, -3328.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'n00I', 6831.3, -7829.6, 45.000 )
    set u = CreateUnit( p, 'h022', 1920.0, -5760.0, 270.000 )
    set u = CreateUnit( p, 'h022', 2048.0, -5632.0, 270.000 )
    set u = CreateUnit( p, 'h022', 2176.0, -5504.0, 270.000 )
    set u = CreateUnit( p, 'h022', 3200.0, -4864.0, 270.000 )
    set u = CreateUnit( p, 'h022', 3328.0, -4736.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -2496.0, 270.000 )
    set u = CreateUnit( p, 'h022', 3456.0, -4608.0, 270.000 )
    set u = CreateUnit( p, 'h022', 4544.0, -3520.0, 270.000 )
    set u = CreateUnit( p, 'h022', 4672.0, -3392.0, 270.000 )
    set u = CreateUnit( p, 'h022', 4800.0, -3264.0, 270.000 )
    set u = CreateUnit( p, 'h022', 4928.0, -3136.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5056.0, -3008.0, 270.000 )
    set gg_unit_owtw_0090 = CreateUnit( p, 'owtw', 3776.0, -4608.0, 270.000 )
    set u = CreateUnit( p, 'h017', 7104.0, -2048.0, 270.000 )
    set u = CreateUnit( p, 'h017', 6080.0, -2048.0, 270.000 )
    set u = CreateUnit( p, 'h017', 6208.0, -2048.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 5184.0, -3200.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 7040.0, -6528.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 6208.0, -7168.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 6464.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h02I', 5504.0, -5632.0, 270.000 )
    set gg_unit_owtw_0104 = CreateUnit( p, 'owtw', 4288.0, -4096.0, 270.000 )
    set u = CreateUnit( p, 'h017', 7232.0, -2048.0, 270.000 )
    set u = CreateUnit( p, 'hhou', 4416.0, -5504.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 1856.0, -6656.0, 270.000 )
    set u = CreateUnit( p, 'hgra', 4800.0, -5888.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'h022', 3584.0, -4480.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3392.0, 270.000 )
    set u = CreateUnit( p, 'hbla', 6080.0, -4544.0, 270.000 )
    set u = CreateUnit( p, 'harm', 3712.0, -5632.0, 270.000 )
    set u = CreateUnit( p, 'hlum', 6752.0, -5088.0, 270.000 )
    set u = CreateUnit( p, 'hhou', 5696.0, -3392.0, 270.000 )
    set u = CreateUnit( p, 'hhou', 4288.0, -7040.0, 270.000 )
    set gg_unit_ndrk_0128 = CreateUnit( p, 'ndrk', 7488.0, -5696.0, 270.000 )
    set u = CreateUnit( p, 'hgra', 5184.0, -6272.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 5504.0, -6592.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 2624.0, -2688.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 5824.0, -5056.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 6208.0, -5440.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 6528.0, -5760.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'h01M', 7168.0, -5760.0, 270.000 )
    set u = CreateUnit( p, 'hhou', 5632.0, -4736.0, 270.000 )
    set u = CreateUnit( p, 'h021', 7360.0, -2112.0, 270.000 )
    set u = CreateUnit( p, 'h021', 7488.0, -2240.0, 270.000 )
    set u = CreateUnit( p, 'h021', 7616.0, -2368.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -2624.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -2752.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -2880.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3008.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3136.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3264.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3520.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3648.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3776.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -3904.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4032.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4160.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4416.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4544.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4672.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4288.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4800.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -4928.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5056.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5184.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5312.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5440.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5568.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5696.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5824.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -5952.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -6080.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 7680.0, -6336.0, 270.000 )
    set u = CreateUnit( p, 'h022', 7616.0, -6464.0, 270.000 )
    set u = CreateUnit( p, 'h017', 7488.0, -6528.0, 270.000 )
    set u = CreateUnit( p, 'h017', 7360.0, -6528.0, 270.000 )
    set u = CreateUnit( p, 'h017', 7232.0, -6528.0, 270.000 )
    set u = CreateUnit( p, 'h022', 7104.0, -6592.0, 270.000 )
    set u = CreateUnit( p, 'h022', 6976.0, -6720.0, 270.000 )
    set u = CreateUnit( p, 'h022', 6400.0, -7296.0, 270.000 )
    set u = CreateUnit( p, 'h022', 6272.0, -7424.0, 270.000 )
    set u = CreateUnit( p, 'h017', 6144.0, -7488.0, 270.000 )
    set u = CreateUnit( p, 'h017', 6016.0, -7488.0, 270.000 )
    set u = CreateUnit( p, 'h017', 5888.0, -7488.0, 270.000 )
    set u = CreateUnit( p, 'h017', 5760.0, -7488.0, 270.000 )
    set u = CreateUnit( p, 'h017', 5632.0, -7488.0, 270.000 )
    set u = CreateUnit( p, 'h017', 5504.0, -7488.0, 270.000 )
    set u = CreateUnit( p, 'h021', 5376.0, -7424.0, 270.000 )
    set u = CreateUnit( p, 'h017', 5248.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 5120.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4992.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4864.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4736.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4608.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4480.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4352.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4224.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 4096.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3968.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3840.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3712.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3584.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3456.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3328.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3200.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3072.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2944.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2816.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2688.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2560.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2432.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2304.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2176.0, -7360.0, 270.000 )
    set u = CreateUnit( p, 'h021', 2048.0, -7296.0, 270.000 )
    set u = CreateUnit( p, 'h021', 1920.0, -7168.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 1856.0, -7040.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 1856.0, -6912.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 1856.0, -6784.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 1856.0, -5888.0, 270.000 )
    set u = CreateUnit( p, 'h01U', 1856.0, -6016.0, 270.000 )
    set u = CreateUnit( p, 'h022', 2304.0, -5376.0, 270.000 )
    set u = CreateUnit( p, 'h022', 2432.0, -5248.0, 270.000 )
    set u = CreateUnit( p, 'h022', 2560.0, -5120.0, 270.000 )
    set u = CreateUnit( p, 'h022', 2688.0, -4992.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2816.0, -4928.0, 270.000 )
    set u = CreateUnit( p, 'h017', 2944.0, -4928.0, 270.000 )
    set u = CreateUnit( p, 'h017', 3072.0, -4928.0, 270.000 )
    set u = CreateUnit( p, 'h022', 4288.0, -3776.0, 270.000 )
    set u = CreateUnit( p, 'h022', 4416.0, -3648.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5184.0, -2880.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5312.0, -2752.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5440.0, -2624.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5568.0, -2496.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5696.0, -2368.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5824.0, -2240.0, 270.000 )
    set u = CreateUnit( p, 'h022', 5952.0, -2112.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 4864.0, -6656.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 1920.0, -6720.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 1984.0, -6208.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 3648.0, -4480.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 4224.0, -3904.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 1600.0, -3264.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 2560.0, -2432.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -1024.0, -6784.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -1024.0, -5824.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -3200.0, -6080.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -3200.0, -6656.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 6080.0, 3072.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 6656.0, 3072.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 5696.0, -64.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 7040.0, -128.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 6336.0, -2240.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 6976.0, -2240.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 6336.0, -3520.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 5696.0, -5568.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 4800.0, -5248.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 3456.0, -6656.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer10 takes nothing returns nothing
    local player p = Player(10)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'ospw', 6124.4, -6045.8, 130.000 )
    set u = CreateUnit( p, 'hpea', 4936.5, -5732.0, 38.784 )
    set u = CreateUnit( p, 'hpea', 5300.7, -6106.5, 40.000 )
    set u = CreateUnit( p, 'hpea', 5588.6, -6370.8, 40.000 )
    set u = CreateUnit( p, 'hfoo', 5284.2, -3987.4, 80.000 )
    set u = CreateUnit( p, 'hfoo', 5527.0, -3988.8, 80.000 )
    set u = CreateUnit( p, 'hfoo', 5530.4, -4096.6, 80.000 )
    set u = CreateUnit( p, 'hfoo', 5413.2, -4097.2, 80.000 )
    set u = CreateUnit( p, 'hhes', 7490.6, -5948.2, 20.007 )
    set u = CreateUnit( p, 'hhes', 7230.6, -5863.3, 80.444 )
    set u = CreateUnit( p, 'hhes', 7261.9, -6231.2, 245.343 )
    set u = CreateUnit( p, 'o01U', 4549.9, -6783.3, 132.962 )
    set gg_unit_e00D_0301 = CreateUnit( p, 'e00D', 5887.4, -6464.6, 269.963 )
    call SetUnitColor( gg_unit_e00D_0301, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'hpea', 6011.0, -5500.5, 208.054 )
    set gg_unit_e00O_0325 = CreateUnit( p, 'e00O', 6342.6, -6047.5, 271.236 )
    call SetUnitColor( gg_unit_e00O_0325, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'hpea', 6269.6, -5815.6, 208.054 )
    set u = CreateUnit( p, 'hpea', 1698.8, -5945.7, 180.000 )
    set u = CreateUnit( p, 'hpea', 1733.8, -3179.1, 120.000 )
    set u = CreateUnit( p, 'hpea', 42.7, -7069.5, 270.000 )
    set u = CreateUnit( p, 'hpea', -1103.9, -6663.7, 180.000 )
    set u = CreateUnit( p, 'hfoo', 5288.9, -4097.3, 80.000 )
    set u = CreateUnit( p, 'hpea', 6899.4, -32.6, 90.000 )
    set u = CreateUnit( p, 'hpea', 4186.3, -3695.8, 120.000 )
    set u = CreateUnit( p, 'hpea', 5643.0, -5169.7, 208.054 )
    set u = CreateUnit( p, 'hpea', 6335.8, -1976.5, 90.000 )
    set u = CreateUnit( p, 'hpea', 6973.5, -1991.9, 90.000 )
    set u = CreateUnit( p, 'hpea', 5340.2, -3511.4, 222.000 )
    set u = CreateUnit( p, 'o01U', 4627.1, -6701.7, 132.962 )
    set u = CreateUnit( p, 'o01U', 4722.6, -6609.5, 134.082 )
    set u = CreateUnit( p, 'o01U', 5097.3, -7201.9, 133.045 )
    set u = CreateUnit( p, 'hpea', 1708.5, -6568.5, 180.000 )
    set u = CreateUnit( p, 'hpea', -1093.3, -5948.7, 180.000 )
    set u = CreateUnit( p, 'hpea', 3530.1, -4374.7, 120.000 )
    set u = CreateUnit( p, 'hpea', 5824.0, -48.7, 90.000 )
    set u = CreateUnit( p, 'hpea', 6028.9, -4745.3, 222.000 )
    set u = CreateUnit( p, 'hpea', 2428.6, -2476.4, 120.000 )
    set u = CreateUnit( p, 'hfoo', 5405.1, -3989.5, 80.000 )
    set u = CreateUnit( p, 'ospw', 5899.4, -6249.1, 130.000 )
    set u = CreateUnit( p, 'h015', 6972.6, -4928.2, 180.000 )
    set u = CreateUnit( p, 'h015', 5409.2, -3763.9, 250.000 )
    set u = CreateUnit( p, 'o01U', 7176.2, -6117.4, 163.780 )
    set u = CreateUnit( p, 'hpea', 5477.9, -945.2, 244.750 )
    set gg_unit_h01P_0633 = CreateUnit( p, 'h01P', 6902.8, -5974.0, 93.410 )
    set gg_unit_h026_0732 = CreateUnit( p, 'h026', 6678.5, -2802.4, 270.000 )
    set gg_unit_h01N_0815 = CreateUnit( p, 'h01N', 4194.3, -4594.6, 280.000 )
    set gg_unit_h00Y_0816 = CreateUnit( p, 'h00Y', 2588.3, -6434.4, 280.000 )
endfunction
//===========================================================================
function CreateBuildingsForPlayer11 takes nothing returns nothing
    local player p = Player(11)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'n00M', -7392.2, 6730.9, 45.000 )
    set u = CreateUnit( p, 'n002', -7213.9, 6555.8, 45.000 )
    set u = CreateUnit( p, 'n00N', -7307.9, 6638.0, 45.000 )
    set u = CreateUnit( p, 'n00D', -7129.6, 6454.2, 45.000 )
    set u = CreateUnit( p, 'n00I', -7476.5, 6830.5, 45.000 )
    set u = CreateUnit( p, 'h01M', -5184.0, 6720.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 4672.0, 270.000 )
    set gg_unit_nfoh_0366 = CreateUnit( p, 'nfoh', -7424.0, 7232.0, 270.000 )
    set gg_unit_ntn2_0372 = CreateUnit( p, 'ntn2', -5952.0, 5696.0, 270.000 )
    set u = CreateUnit( p, 'hgra', -6272.0, 4992.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -5952.0, 4608.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -5632.0, 4288.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -5184.0, 5824.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -4800.0, 5440.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -4480.0, 5120.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -6656.0, 1280.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -5760.0, 1280.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -6528.0, -2112.0, 270.000 )
    set u = CreateUnit( p, 'hgra', -3520.0, 1216.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -4096.0, 1792.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -2752.0, 2112.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', 1600.0, 6336.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -1344.0, 6784.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set u = CreateUnit( p, 'hgra', -1280.0, 5888.0, 270.000 )
    call IssueImmediateOrder( u, "" )
    call IssueImmediateOrder( u, "" )
    set gg_unit_nten_0388 = CreateUnit( p, 'nten', -3776.0, 6208.0, 270.000 )
    set gg_unit_nten_0389 = CreateUnit( p, 'nten', -4608.0, 4416.0, 270.000 )
    set gg_unit_otrb_0390 = CreateUnit( p, 'otrb', -6208.0, 896.0, 270.000 )
    set gg_unit_otrb_0391 = CreateUnit( p, 'otrb', -3456.0, 1920.0, 270.000 )
    set gg_unit_otrb_0392 = CreateUnit( p, 'otrb', -704.0, 6336.0, 270.000 )
    set gg_unit_nten_0393 = CreateUnit( p, 'nten', -6208.0, 3904.0, 270.000 )
    set gg_unit_o007_0394 = CreateUnit( p, 'o007', -6560.0, 2976.0, 270.000 )
    set gg_unit_o007_0395 = CreateUnit( p, 'o007', -6560.0, 3552.0, 270.000 )
    set gg_unit_o007_0396 = CreateUnit( p, 'o007', -5920.0, 3552.0, 270.000 )
    set gg_unit_o007_0397 = CreateUnit( p, 'o007', -5920.0, 2976.0, 270.000 )
    set gg_unit_o007_0398 = CreateUnit( p, 'o007', -6560.0, 224.0, 270.000 )
    set gg_unit_o007_0399 = CreateUnit( p, 'o007', -5856.0, 224.0, 270.000 )
    set gg_unit_o007_0400 = CreateUnit( p, 'o007', -6816.0, -2592.0, 270.000 )
    set gg_unit_o007_0401 = CreateUnit( p, 'o007', -6112.0, -2592.0, 270.000 )
    set gg_unit_o007_0402 = CreateUnit( p, 'o007', -3168.0, 1184.0, 270.000 )
    set gg_unit_o007_0403 = CreateUnit( p, 'o007', -2656.0, 1632.0, 270.000 )
    set gg_unit_o007_0404 = CreateUnit( p, 'o007', -4000.0, 2272.0, 270.000 )
    set gg_unit_o007_0405 = CreateUnit( p, 'o007', -3424.0, 2848.0, 270.000 )
    set gg_unit_o007_0406 = CreateUnit( p, 'o007', -4128.0, 3360.0, 270.000 )
    set gg_unit_o007_0407 = CreateUnit( p, 'o007', -4512.0, 3744.0, 270.000 )
    set gg_unit_o007_0408 = CreateUnit( p, 'o007', -4000.0, 4256.0, 270.000 )
    set gg_unit_o007_0409 = CreateUnit( p, 'o007', -3680.0, 3808.0, 270.000 )
    set gg_unit_o007_0410 = CreateUnit( p, 'o007', 2208.0, 6432.0, 270.000 )
    set gg_unit_o007_0411 = CreateUnit( p, 'o007', 2208.0, 5728.0, 270.000 )
    set gg_unit_o007_0412 = CreateUnit( p, 'o007', -288.0, 6752.0, 270.000 )
    set gg_unit_o007_0413 = CreateUnit( p, 'o007', -288.0, 5984.0, 270.000 )
    set gg_unit_o007_0414 = CreateUnit( p, 'o007', -3424.0, 6560.0, 270.000 )
    set gg_unit_o007_0415 = CreateUnit( p, 'o007', -3424.0, 5792.0, 270.000 )
    set gg_unit_o007_0416 = CreateUnit( p, 'o007', -2848.0, 5792.0, 270.000 )
    set gg_unit_o007_0417 = CreateUnit( p, 'o007', -2848.0, 6624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -6656.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -6784.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -6912.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h021', -7040.0, 2688.0, 270.000 )
    set u = CreateUnit( p, 'h021', -7168.0, 2816.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 2944.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3072.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3200.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3328.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3456.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3584.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3712.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3840.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 3968.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4096.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4224.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4352.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4480.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4608.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4736.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4864.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 4992.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 5120.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 5248.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 5376.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 5504.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -7232.0, 5632.0, 270.000 )
    set u = CreateUnit( p, 'h022', -7168.0, 5760.0, 270.000 )
    set u = CreateUnit( p, 'h022', -7040.0, 5888.0, 270.000 )
    set u = CreateUnit( p, 'h022', -6912.0, 6016.0, 270.000 )
    set u = CreateUnit( p, 'h022', -6784.0, 6144.0, 270.000 )
    set u = CreateUnit( p, 'h022', -6208.0, 6720.0, 270.000 )
    set u = CreateUnit( p, 'h022', -6080.0, 6848.0, 270.000 )
    set u = CreateUnit( p, 'h022', -5952.0, 6976.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5824.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5568.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5696.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5440.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5312.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5184.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5056.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4928.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4800.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4544.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4672.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4416.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4288.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4160.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4032.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3904.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3776.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3648.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3520.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3392.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3264.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3136.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -3008.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -2880.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h017', -2752.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h021', -2624.0, 6976.0, 270.000 )
    set u = CreateUnit( p, 'h021', -2496.0, 6848.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 6592.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 6720.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 5824.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 5696.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 5568.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 5440.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 5312.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 5184.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 5056.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 4928.0, 270.000 )
    set u = CreateUnit( p, 'h01U', -2432.0, 4800.0, 270.000 )
    set u = CreateUnit( p, 'h022', -2496.0, 4544.0, 270.000 )
    set u = CreateUnit( p, 'h022', -2624.0, 4416.0, 270.000 )
    set u = CreateUnit( p, 'h022', -2752.0, 4288.0, 270.000 )
    set u = CreateUnit( p, 'h022', -2880.0, 4160.0, 270.000 )
    set u = CreateUnit( p, 'h022', -3008.0, 4032.0, 270.000 )
    set u = CreateUnit( p, 'h022', -3136.0, 3904.0, 270.000 )
    set u = CreateUnit( p, 'h022', -3264.0, 3776.0, 270.000 )
    set u = CreateUnit( p, 'h022', -3392.0, 3648.0, 270.000 )
    set u = CreateUnit( p, 'h022', -4096.0, 3072.0, 270.000 )
    set u = CreateUnit( p, 'h022', -4224.0, 2944.0, 270.000 )
    set u = CreateUnit( p, 'h022', -4352.0, 2816.0, 270.000 )
    set u = CreateUnit( p, 'h022', -4480.0, 2688.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4608.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4736.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4864.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -4992.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5120.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5248.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5376.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5504.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5632.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h017', -5760.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6976.0, 6400.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6080.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6080.0, 6720.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6848.0, 5952.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -5248.0, 5120.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -4736.0, 5824.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -4032.0, 6208.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -2496.0, 6592.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -2496.0, 5696.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -3520.0, 3712.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -4096.0, 3200.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -5888.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6528.0, 2624.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6208.0, -2752.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6720.0, -2752.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -5696.0, 128.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6656.0, 128.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -3392.0, 960.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -2368.0, 1920.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -1472.0, 6912.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -128.0, 5952.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -128.0, 6720.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 2368.0, 6400.0, 270.000 )
    set u = CreateUnit( p, 'h01M', 2368.0, 5824.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -4352.0, 4544.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -5504.0, 3136.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6528.0, 3968.0, 270.000 )
    set u = CreateUnit( p, 'h01M', -6848.0, 5504.0, 270.000 )
    set u = CreateUnit( p, 'ngwr', -4256.0, 6560.0, 270.000 )
    set u = CreateUnit( p, 'ngwr', -6880.0, 4384.0, 270.000 )
    set u = CreateUnit( p, 'hbla', -3648.0, 5120.0, 270.000 )
    set u = CreateUnit( p, 'hlum', -4768.0, 6496.0, 270.000 )
    set u = CreateUnit( p, 'harm', -5440.0, 3840.0, 270.000 )
    set u = CreateUnit( p, 'hhou', -4800.0, 3392.0, 270.000 )
    set u = CreateUnit( p, 'hhou', -6848.0, 4736.0, 270.000 )
    set u = CreateUnit( p, 'hhou', -4032.0, 5440.0, 270.000 )
    set u = CreateUnit( p, 'hhou', -3968.0, 4800.0, 270.000 )
    set u = CreateUnit( p, 'h02I', -5248.0, 4928.0, 270.000 )
    set gg_unit_ndrk_0582 = CreateUnit( p, 'ndrk', -5632.0, 6848.0, 270.000 )
endfunction
//===========================================================================
function CreateUnitsForPlayer11 takes nothing returns nothing
    local player p = Player(11)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set gg_unit_h01Q_0016 = CreateUnit( p, 'h01Q', -6234.2, 3272.5, 270.000 )
    set u = CreateUnit( p, 'h015', -5291.8, 3249.4, 304.715 )
    set u = CreateUnit( p, 'h015', -6969.0, 5077.2, 330.000 )
    set u = CreateUnit( p, 'ospw', -5888.5, 5404.4, 330.000 )
    set u = CreateUnit( p, 'hpea', -2499.7, 1806.9, 309.936 )
    set u = CreateUnit( p, 'hpea', -5768.2, 4748.7, 43.573 )
    set u = CreateUnit( p, 'hpea', -3937.4, 3179.1, 310.000 )
    set u = CreateUnit( p, 'hpea', -3472.0, 3513.1, 310.000 )
    set u = CreateUnit( p, 'hpea', -5944.1, 64.2, 270.000 )
    set u = CreateUnit( p, 'hpea', -6632.7, 2477.1, 270.000 )
    set u = CreateUnit( p, 'hpea', -3352.9, 1037.6, 310.628 )
    set gg_unit_e00P_0444 = CreateUnit( p, 'e00P', -6080.8, 5380.0, 272.639 )
    call SetUnitColor( gg_unit_e00P_0444, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'hfoo', -5137.6, 3110.5, 174.468 )
    set u = CreateUnit( p, 'hpea', -6506.6, 36.9, 270.000 )
    set u = CreateUnit( p, 'hfoo', -5005.9, 3127.6, 174.468 )
    set u = CreateUnit( p, 'hfoo', -5010.5, 2972.4, 174.468 )
    set u = CreateUnit( p, 'hpea', -5840.5, 2524.0, 254.858 )
    set u = CreateUnit( p, 'hpea', -5281.2, 3061.4, 0.000 )
    set u = CreateUnit( p, 'hfoo', -5021.7, 2859.4, 174.468 )
    set u = CreateUnit( p, 'hfoo', -5146.5, 2850.0, 174.468 )
    set u = CreateUnit( p, 'hpea', -5447.7, 916.7, 0.000 )
    set u = CreateUnit( p, 'hpea', -75.7, 6668.8, 0.000 )
    set u = CreateUnit( p, 'hpea', -2339.9, 6544.0, 0.000 )
    set u = CreateUnit( p, 'hpea', -2343.8, 5841.8, 0.000 )
    set u = CreateUnit( p, 'hpea', -7096.6, 5547.8, 330.000 )
    set u = CreateUnit( p, 'o01U', -4522.9, 5705.0, 330.000 )
    set u = CreateUnit( p, 'hpea', -4930.8, 5262.5, 220.000 )
    set u = CreateUnit( p, 'hpea', -4599.7, 4948.7, 220.000 )
    set u = CreateUnit( p, 'hpea', -6099.6, 5093.5, 43.573 )
    set u = CreateUnit( p, 'ospw', -5701.3, 5607.6, 330.000 )
    set u = CreateUnit( p, 'o01U', -4431.8, 5793.0, 330.000 )
    set u = CreateUnit( p, 'o01U', -4320.8, 5874.5, 330.000 )
    set u = CreateUnit( p, 'o01U', -5258.7, 6746.4, 265.118 )
    set u = CreateUnit( p, 'hpea', -61.7, 5894.1, 0.000 )
    set u = CreateUnit( p, 'hpea', -5442.3, 4420.0, 43.573 )
    set u = CreateUnit( p, 'hpea', -5276.9, 5661.4, 220.000 )
    set u = CreateUnit( p, 'o01U', -3526.3, 4913.3, 330.000 )
    set u = CreateUnit( p, 'hfoo', -5133.1, 2990.4, 174.468 )
    set gg_unit_e00V_0577 = CreateUnit( p, 'e00V', -5626.3, 5828.7, 265.548 )
    call SetUnitColor( gg_unit_e00V_0577, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'hhes', -5478.5, 6627.0, 222.750 )
    set u = CreateUnit( p, 'hhes', -5641.6, 6609.7, 324.129 )
    set u = CreateUnit( p, 'hhes', -5301.1, 6881.7, 42.803 )
    set u = CreateUnit( p, 'hpea', -1093.2, 5597.4, 270.000 )
    set gg_unit_h01O_0634 = CreateUnit( p, 'h01O', -6378.3, 6307.4, 281.850 )
    set gg_unit_h01R_0805 = CreateUnit( p, 'h01R', -4105.3, 3853.8, 270.000 )
    set gg_unit_h01L_0813 = CreateUnit( p, 'h01L', -3118.1, 6148.0, 270.000 )
endfunction
//===========================================================================
function CreateNeutralHostile takes nothing returns nothing
    local player p = Player(PLAYER_NEUTRAL_AGGRESSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'nwwd', -2554.6, -3720.8, 311.676 )
    set u = CreateUnit( p, 'nskg', -4012.5, -3808.8, 71.413 )
    set u = CreateUnit( p, 'nass', 3356.6, 2939.9, 295.497 )
    set gg_unit_nbld_0142 = CreateUnit( p, 'nbld', 3604.9, 3275.2, 270.000 )
    set u = CreateUnit( p, 'nbrg', 3176.5, 1150.6, 143.187 )
    set u = CreateUnit( p, 'nrog', 3113.4, 1251.0, 240.838 )
    set u = CreateUnit( p, 'nass', 4520.6, 7792.3, 241.036 )
    set u = CreateUnit( p, 'nass', 1377.2, 2315.9, 355.251 )
    set u = CreateUnit( p, 'nenf', 3494.2, 2662.5, 321.052 )
    set u = CreateUnit( p, 'nbrg', 403.6, 2920.8, 180.020 )
    set u = CreateUnit( p, 'nrog', 200.7, 2951.6, 63.942 )
    set u = CreateUnit( p, 'nass', 4684.0, 7771.0, 263.332 )
    set u = CreateUnit( p, 'nbrg', -3436.3, -955.0, 269.791 )
    set u = CreateUnit( p, 'nenf', 1250.9, 2230.0, 278.324 )
    set u = CreateUnit( p, 'nrog', 1477.6, 2214.5, 262.781 )
    set u = CreateUnit( p, 'nenf', 3286.5, 2725.2, 321.052 )
    set u = CreateUnit( p, 'nbrg', -1578.9, -2809.4, 228.819 )
    set u = CreateUnit( p, 'nass', -1065.0, 3807.4, 328.390 )
    set u = CreateUnit( p, 'nass', -1096.8, 3654.5, 353.034 )
    set u = CreateUnit( p, 'nass', 4252.7, 1138.5, 24.174 )
    set u = CreateUnit( p, 'nass', 4239.7, 1029.6, 13.033 )
    set u = CreateUnit( p, 'nass', 3593.3, 2850.2, 295.497 )
    set u = CreateUnit( p, 'nrog', 4589.2, 7646.8, 261.823 )
    set u = CreateUnit( p, 'nass', -4739.6, -7878.9, 4.306 )
    set u = CreateUnit( p, 'nrog', -4517.4, -7878.8, 231.732 )
    set u = CreateUnit( p, 'nrog', 3060.4, 1108.5, 60.881 )
    set u = CreateUnit( p, 'nbrg', -1613.3, -2931.5, 266.002 )
    set u = CreateUnit( p, 'nass', -1538.6, -2963.8, 3.434 )
    set u = CreateUnit( p, 'nbrg', -3466.9, -1081.3, 276.446 )
    set u = CreateUnit( p, 'nass', -3370.1, -1042.3, 33.150 )
    set u = CreateUnit( p, 'nfrb', -7619.9, -3805.5, 287.383 )
    set u = CreateUnit( p, 'nwzd', 1384.5, 2062.1, 252.983 )
    set u = CreateUnit( p, 'nftk', -1872.3, 2846.3, 321.236 )
    set u = CreateUnit( p, 'nsqo', 3734.3, -196.9, 270.000 )
    set u = CreateUnit( p, 'ntrd', -5013.3, -1929.0, 26.693 )
    set u = CreateUnit( p, 'ntrd', -5053.7, -1688.1, 25.761 )
    set u = CreateUnit( p, 'ntrd', -5249.4, -1876.0, 94.938 )
    set gg_unit_nsko_0178 = CreateUnit( p, 'nsko', -972.6, -4398.9, 121.240 )
    set t = CreateTrigger( )
    call TriggerRegisterUnitEvent( t, gg_unit_nsko_0178, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( t, gg_unit_nsko_0178, EVENT_UNIT_CHANGE_OWNER )
    call TriggerAddAction( t, function Unit000178_DropItems )
    set u = CreateUnit( p, 'njg1', -3879.1, -3732.7, 67.689 )
    set u = CreateUnit( p, 'nmrv', -7848.2, -7552.8, 83.422 )
    set u = CreateUnit( p, 'nmrv', -7661.4, -7602.0, 97.711 )
    set u = CreateUnit( p, 'nmsc', -7834.9, -7694.4, 76.868 )
    set u = CreateUnit( p, 'njga', 362.0, 998.5, 90.000 )
    set u = CreateUnit( p, 'nass', -4646.2, -7982.3, 357.720 )
    set u = CreateUnit( p, 'nwwd', -2672.6, -3649.1, 228.251 )
    set u = CreateUnit( p, 'nwwd', -2566.0, -3547.9, 310.439 )
    set u = CreateUnit( p, 'njgb', -3425.9, -2418.4, 323.562 )
    set u = CreateUnit( p, 'nfrb', 4590.1, 2950.9, 99.879 )
    set u = CreateUnit( p, 'nfrb', 4683.1, 3096.4, 241.178 )
    set u = CreateUnit( p, 'nfrb', 4787.0, 2964.4, 78.706 )
    set u = CreateUnit( p, 'nfrb', -7786.5, -3880.7, 198.574 )
    set u = CreateUnit( p, 'nfrb', -7577.3, -3990.9, 127.775 )
    set u = CreateUnit( p, 'nrog', 103.8, 2781.4, 241.252 )
    set u = CreateUnit( p, 'nskg', -3729.4, -3820.1, 71.413 )
endfunction
//===========================================================================
function CreateNeutralPassiveBuildings takes nothing returns nothing
    local player p = Player(PLAYER_NEUTRAL_PASSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life
    set u = CreateUnit( p, 'n01S', 2552.0, 3304.0, 270.000 )
    set u = CreateUnit( p, 'n01U', 7424.0, -6720.0, 270.000 )
    set gg_unit_ngad_0060 = CreateUnit( p, 'ngad', -3968.0, -2496.0, 270.000 )
    set u = CreateUnit( p, 'ngme', -1952.0, -896.0, 270.000 )
    set u = CreateUnit( p, 'n01Y', 3520.0, 2176.0, 270.000 )
    set gg_unit_n021_0064 = CreateUnit( p, 'n021', -192.0, 640.0, 270.000 )
    set u = CreateUnit( p, 'ngme', 6496.0, 6720.0, 270.000 )
    set u = CreateUnit( p, 'ngme', -7072.0, -6528.0, 270.000 )
    set u = CreateUnit( p, 'n01Y', -4096.0, -1856.0, 270.000 )
    set gg_unit_ngad_0068 = CreateUnit( p, 'ngad', 3520.0, 3776.0, 270.000 )
    set u = CreateUnit( p, 'n00K', 24.0, 243.4, 272.281 )
    set u = CreateUnit( p, 'n00K', -6848.0, -6720.0, 28.969 )
    set u = CreateUnit( p, 'n00K', 6464.0, 6464.0, 270.000 )
    set u = CreateUnit( p, 'n00C', 7296.0, -6656.0, 270.000 )
    set u = CreateUnit( p, 'n008', 7488.0, -7232.0, 270.000 )
    set u = CreateUnit( p, 'n00H', 7552.0, -6848.0, 270.000 )
    set u = CreateUnit( p, 'n013', 7616.0, -6976.0, 270.000 )
    set u = CreateUnit( p, 'n014', 7616.0, -7104.0, 270.000 )
    set u = CreateUnit( p, 'n02U', 7168.0, -6656.0, 270.000 )
    set u = CreateUnit( p, 'n006', 7040.0, -6784.0, 270.000 )
    set u = CreateUnit( p, 'n01U', -6400.0, 7168.0, 270.000 )
    set u = CreateUnit( p, 'n00C', -6336.0, 7040.0, 270.000 )
    set u = CreateUnit( p, 'n008', -6912.0, 7232.0, 270.000 )
    set u = CreateUnit( p, 'n00H', -6656.0, 7360.0, 270.000 )
    set u = CreateUnit( p, 'n013', -6528.0, 7296.0, 270.000 )
    set u = CreateUnit( p, 'n014', -6784.0, 7360.0, 270.000 )
    set u = CreateUnit( p, 'n02U', -6336.0, 6912.0, 270.000 )
    set u = CreateUnit( p, 'n006', -6464.0, 6784.0, 270.000 )
    set gg_unit_n01L_0362 = CreateUnit( p, 'n01L', 8064.0, -6144.0, 270.000 )
    call SetUnitColor( gg_unit_n01L_0362, ConvertPlayerColor(10) )
    set gg_unit_ntav_0363 = CreateUnit( p, 'ntav', 8064.0, -6336.0, 270.000 )
    call SetUnitColor( gg_unit_ntav_0363, ConvertPlayerColor(10) )
    set gg_unit_n00J_0364 = CreateUnit( p, 'n00J', 8064.0, -5952.0, 270.000 )
    call SetUnitColor( gg_unit_n00J_0364, ConvertPlayerColor(10) )
    set gg_unit_n000_0365 = CreateUnit( p, 'n000', -6528.0, 8064.0, 270.000 )
    call SetUnitColor( gg_unit_n000_0365, ConvertPlayerColor(11) )
    set gg_unit_n01I_0583 = CreateUnit( p, 'n01I', -6336.0, 8064.0, 270.000 )
    call SetUnitColor( gg_unit_n01I_0583, ConvertPlayerColor(11) )
    set gg_unit_n001_0584 = CreateUnit( p, 'n001', -6144.0, 8064.0, 270.000 )
    call SetUnitColor( gg_unit_n001_0584, ConvertPlayerColor(11) )
    set gg_unit_n025_0588 = CreateUnit( p, 'n025', -6912.0, -7936.0, 270.000 )
    call SetUnitColor( gg_unit_n025_0588, ConvertPlayerColor(12) )
    set gg_unit_n01N_0589 = CreateUnit( p, 'n01N', -7104.0, -7744.0, 270.000 )
    call SetUnitColor( gg_unit_n01N_0589, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'n010', 6400.0, 8064.0, 270.000 )
    call SetUnitColor( u, ConvertPlayerColor(12) )
    set u = CreateUnit( p, 'ndrg', -3968.0, -4096.0, 270.000 )
endfunction
//===========================================================================
function CreatePlayerBuildings takes nothing returns nothing
    call CreateBuildingsForPlayer0( )
    call CreateBuildingsForPlayer1( )
    call CreateBuildingsForPlayer2( )
    call CreateBuildingsForPlayer3( )
    call CreateBuildingsForPlayer4( )
    call CreateBuildingsForPlayer5( )
    call CreateBuildingsForPlayer6( )
    call CreateBuildingsForPlayer7( )
    call CreateBuildingsForPlayer8( )
    call CreateBuildingsForPlayer9( )
    call CreateBuildingsForPlayer10( )
    call CreateBuildingsForPlayer11( )
endfunction
//===========================================================================
function CreatePlayerUnits takes nothing returns nothing
    call CreateUnitsForPlayer0( )
    call CreateUnitsForPlayer1( )
    call CreateUnitsForPlayer2( )
    call CreateUnitsForPlayer3( )
    call CreateUnitsForPlayer4( )
    call CreateUnitsForPlayer5( )
    call CreateUnitsForPlayer6( )
    call CreateUnitsForPlayer7( )
    call CreateUnitsForPlayer8( )
    call CreateUnitsForPlayer9( )
    call CreateUnitsForPlayer10( )
    call CreateUnitsForPlayer11( )
endfunction
//===========================================================================
function CreateAllUnits takes nothing returns nothing
    call CreateNeutralPassiveBuildings( )
    call CreatePlayerBuildings( )
    call CreateNeutralHostile( )
    call CreatePlayerUnits( )
endfunction
//***************************************************************************
//*
//*  Regions
//*
//***************************************************************************
function CreateRegions takes nothing returns nothing
    local weathereffect we
    set gg_rct_ADS = Rect( 3104.0, -6624.0, 3552.0, -6176.0 )
    set gg_rct_AL = Rect( 6368.0, -6976.0, 6784.0, -6560.0 )
    set gg_rct_AMS = Rect( 4480.0, -5152.0, 4896.0, -4800.0 )
    set gg_rct_AUS = Rect( 6336.0, -3616.0, 6752.0, -3232.0 )
    set gg_rct_BDS = Rect( -6560.0, 3648.0, -6048.0, 4128.0 )
    set gg_rct_BL = Rect( -6592.0, 6112.0, -6176.0, 6464.0 )
    set gg_rct_BMS = Rect( -4832.0, 4064.0, -4320.0, 4608.0 )
    set gg_rct_BUS = Rect( -3872.0, 5952.0, -3392.0, 6432.0 )
    set gg_rct_DM = Rect( -6656.0, -6400.0, -6400.0, -6144.0 )
    set gg_rct_UM = Rect( 5920.0, 5952.0, 6144.0, 6176.0 )
    set gg_rct_APIG = Rect( 6816.0, -7776.0, 7456.0, -7200.0 )
    set gg_rct_BPIG = Rect( -7584.0, 6752.0, -6912.0, 7360.0 )
    set gg_rct_HERO_A__________u = Rect( 7904.0, -6688.0, 8192.0, -5760.0 )
    set gg_rct_HERO_B__________u = Rect( -6752.0, 7840.0, -5888.0, 8192.0 )
    set gg_rct_Hero_D_______u = Rect( -7264.0, -8064.0, -6624.0, -7456.0 )
    set gg_rct_D__________u = Rect( -7168.0, -6912.0, -6976.0, -6720.0 )
    set gg_rct_M2__________u = Rect( -3840.0, -2592.0, -3648.0, -2368.0 )
    set gg_rct_M__________u = Rect( -2112.0, -1344.0, -1856.0, -1120.0 )
    set gg_rct_M_______u = Rect( -96.0, 32.0, 128.0, 192.0 )
    set gg_rct_UP__________u = Rect( 3328.0, 3360.0, 3488.0, 3552.0 )
    set gg_rct______________u = Rect( 6464.0, 6304.0, 6624.0, 6432.0 )
    set gg_rct__________2 = Rect( -960.0, -896.0, -736.0, -672.0 )
    set gg_rct________________u = Rect( -1312.0, -4640.0, -416.0, -3136.0 )
    set gg_rct_____________u = Rect( -992.0, -4448.0, -960.0, -4224.0 )
    set gg_rct___________________1 = Rect( -7968.0, 6176.0, -6752.0, 8032.0 )
    set gg_rct___________________2 = Rect( -6784.0, 6560.0, -6336.0, 7328.0 )
    set gg_rct___________________3 = Rect( 6464.0, -8032.0, 8128.0, -6912.0 )
    set gg_rct___________________4 = Rect( 6816.0, -6944.0, 7840.0, -6592.0 )
    set gg_rct_FU_Walk_Around_A2 = Rect( 2272.0, -6848.0, 2464.0, -6624.0 )
    set gg_rct_FU_Walk_Around_A4 = Rect( 6080.0, -2592.0, 6272.0, -2368.0 )
    set gg_rct_FU_Walk_Around_B4 = Rect( -5824.0, 3136.0, -5632.0, 3360.0 )
    set gg_rct_FU_Walk_Around_B2 = Rect( -3104.0, 5536.0, -2880.0, 5760.0 )
    set gg_rct________DB = Rect( -6656.0, -4000.0, -6176.0, -3488.0 )
    set gg_rct________DA = Rect( -4384.0, -6592.0, -3904.0, -6144.0 )
    set gg_rct________MB = Rect( -2176.0, 352.0, -1856.0, 736.0 )
    set gg_rct________MA = Rect( 832.0, -2176.0, 1184.0, -1888.0 )
    set gg_rct________UB = Rect( 3392.0, 5760.0, 3936.0, 6336.0 )
    set gg_rct________UA = Rect( 6144.0, 3808.0, 6720.0, 4576.0 )
    set gg_rct_AMH = Rect( 7936.0, 8160.0, 8512.0, 8544.0 )
    set gg_rct_A_UP_Turn = Rect( 5504.0, 5664.0, 6400.0, 6432.0 )
    set gg_rct_A_Middle_Turn = Rect( -1152.0, -1152.0, -512.0, -448.0 )
    set gg_rct_A_DOWN_Turn2 = Rect( -6816.0, -6656.0, -6080.0, -5984.0 )
    set gg_rct___________________a = Rect( 7744.0, -6720.0, 8384.0, -5600.0 )
    set gg_rct___________________b = Rect( -7520.0, -8192.0, -6592.0, -6944.0 )
    set gg_rct___________________C = Rect( -4352.0, -4480.0, -3584.0, -3616.0 )
    set gg_rct___________________D = Rect( -6912.0, 7744.0, -5760.0, 8288.0 )
    set gg_rct___________________F = Rect( 7872.0, 7776.0, 8544.0, 8800.0 )
    set gg_rct_5 = Rect( 8256.0, 8256.0, 8384.0, 8480.0 )
    set gg_rct_2 = Rect( -8672.0, -5664.0, -8448.0, -5408.0 )
    set gg_rct_3 = Rect( 8320.0, 3616.0, 8448.0, 3776.0 )
    set gg_rct_4 = Rect( 8320.0, 4384.0, 8416.0, 4480.0 )
    set gg_rct_FU_Walk_Around_A1 = Rect( 6080.0, -6976.0, 6272.0, -6752.0 )
    set gg_rct_FU_Walk_Around_A3 = Rect( 3808.0, -4832.0, 4000.0, -4608.0 )
    set gg_rct_FU_Walk_Around_B1 = Rect( -6496.0, 5856.0, -6304.0, 6080.0 )
    set gg_rct_FU_Walk_Around_B3 = Rect( -3872.0, 3936.0, -3680.0, 4160.0 )
    set gg_rct______________041 = Rect( 4960.0, -1440.0, 5376.0, -928.0 )
    set gg_rct_AMH_RANGE1 = Rect( -6688.0, -7136.0, 7232.0, 7296.0 )
    set gg_rct_______u = Rect( -7296.0, -7968.0, -5440.0, 4416.0 )
    set gg_rct_______2 = Rect( -5472.0, -7232.0, 4192.0, -5056.0 )
    set gg_rct_______3 = Rect( -5472.0, -5088.0, -4800.0, -2656.0 )
    set gg_rct_______4 = Rect( -7936.0, -6912.0, -7264.0, -4928.0 )
    set gg_rct_______5 = Rect( -64.0, -5088.0, 2144.0, -4000.0 )
    set gg_rct_______6 = Rect( -4000.0, -8160.0, 4192.0, -7200.0 )
    set gg_rct_______7 = Rect( -8448.0, -3264.0, -7264.0, 4384.0 )
    set gg_rct_______8 = Rect( -5472.0, -1152.0, -4448.0, 3776.0 )
    set gg_rct_B______1 = Rect( 5216.0, -3904.0, 8128.0, 8192.0 )
    set gg_rct_B______2 = Rect( -3744.0, 4384.0, 5248.0, 7232.0 )
    set gg_rct_B______3 = Rect( -3744.0, 7200.0, 4096.0, 8288.0 )
    set gg_rct_C______1 = Rect( -4448.0, 1536.0, -2112.0, 4416.0 )
    set gg_rct_C______2 = Rect( -4448.0, 416.0, -416.0, 1536.0 )
    set gg_rct_C______3 = Rect( -4448.0, -672.0, 832.0, 416.0 )
    set gg_rct_C______4 = Rect( -2560.0, -2016.0, 3232.0, -672.0 )
    set gg_rct_C______5 = Rect( -64.0, -4000.0, 5248.0, -1984.0 )
    set gg_rct_C______6 = Rect( 2112.0, -5056.0, 5248.0, -3968.0 )
    set gg_rct_AMH_RANGE2 = Rect( -6848.0, -7200.0, -3296.0, -5472.0 )
    set gg_rct_AMH_RANGE3 = Rect( -6752.0, -5504.0, -4992.0, 4640.0 )
    set gg_rct_AMH_RANGE4 = Rect( -5472.0, -2688.0, -3296.0, 4416.0 )
endfunction
//***************************************************************************
//*
//*  Custom Script Code
//*
//***************************************************************************
globals
boolean array Debug_B	
endglobals
//#define SetMapDescription(s) SetMapDescription(s) YDNL call PlayMusic("war3mapImported\\Music.mp3") 
function Test_Timer_Stop takes nothing returns nothing
call PauseGame(true)
endfunction
//Debug text
function TI_RequestBugReport takes nothing returns nothing
local integer i=0
	if Debug_B[1] == false then
		loop
			call DisplayTimedTextToPlayer(Player(i),0,0,10,"|c00ff0303地圖出現指標錯誤|r")
			call DisplayTimedTextToPlayer(Player(i),0,0,10,"|c00ff0303這可能不是一個嚴重錯誤，但這對我們非常的重要")
			call DisplayTimedTextToPlayer(Player(i),0,0,10,"|c00ff0303可以的話上傳 replay 到 NobunagaOldMan@gmail.com|r")
			set i=i+1
			exitwhen i==12
		endloop
	endif
set Debug_B[1] = true 
endfunction
//////////////////////////////////////
//【一次性排泄計時器】
//原理 :  a. for trigger + TC 徹底排泄
//////////////////////////////////////
function Creat_Timer_Delete_Trigger takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)	
local trigger ltt = LoadTriggerHandle(YDHT,h2i,55555)
		if ltt != null then
			call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
			call DestroyTrigger( ltt )
		endif	
	call FlushChildHashtable(YDHT, h2i)	
	call DestroyTimer(t)	
set ltt = null	
set t = null
endfunction
function Creat_Disposable_Timer_for_Trigger takes trigger ltt , real time , triggercondition ltc returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
	call SaveTriggerHandle(YDHT,h2i,55555,ltt)
	call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
	call TimerStart(t,time,false, function Creat_Timer_Delete_Trigger )
set t = null	
endfunction
///////////////////////////////////////////////////////////////////////////////////
//【捕捉普通攻擊排泄】
//原理 : a.當攻擊的時候 Boolean = true 才會運行函數 這樣不會大量重複製造 計時器 觸發器
//       b.不知名原因 這邊的 TC 不會隨著觸發器銷毀 要幫他銷毀。
///////////////////////////////////////////////////////////////////////////////////
function Normal_Attack_Timer_Delete_Trigger takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)	
local trigger ltt = LoadTriggerHandle(YDHT,h2i,55555)
		if ltt != null then
			set udg_B12R_B[LoadInteger(YDHT,h2i,33333)]=false
			call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
			call DestroyTrigger( ltt )
		endif	
	call FlushChildHashtable(YDHT, h2i)	
	call PauseTimer(t)	
set ltt = null	
set t = null
endfunction
function Normal_Attack_Timer_for_Trigger takes trigger ltt , real time , triggercondition ltc , integer i returns nothing
local timer t = udg_Catch_Damage_T[i]
local integer h2i = GetHandleId(t)
	/////////////////////////////////
	//參數設定 : trigger , TC , int
	////////////////////////////////
	call SaveTriggerHandle(YDHT,h2i,55555,ltt)
	call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
	call SaveInteger(YDHT,h2i,33333,i)
	call TimerStart(t,time,false, function Normal_Attack_Timer_Delete_Trigger )
set t = null	
endfunction
//自動選取系統
function Auto_chose takes boolean b , unit u , player p returns nothing
	if b then
	    if (GetLocalPlayer() == p) then
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call SelectUnit(u, true)
	    endif
	endif 
endfunction
//////////////////////////////////////
//【一次性排泄計時器 - 單位移動】
//////////////////////////////////////
function Short_time_move_End takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u = LoadUnitHandle(YDHT,h2i,66666)
local real x = LoadReal(YDHT,h2i,55555)
local real y = LoadReal(YDHT,h2i,44444)
	//move
	call SetUnitPosition(u,x,y)
	//clean
	call FlushChildHashtable(YDHT, h2i)	
	call DestroyTimer(t)	
set u = null	
set t = null
endfunction
function Short_time_move_Start takes unit u ,real x , real y , real time , boolean b returns nothing	
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
	//Variable init
	call SaveUnitHandle(YDHT,h2i,66666,u)
	call SaveReal(YDHT,h2i,55555,x)
	call SaveReal(YDHT,h2i,44444,y)
	//timer start
	call TimerStart(t,time,false, function Short_time_move_End )
set t = null	
endfunction
//////////////////////////////////////
//【一次性排泄計時器 - 技能】
//原理 :  a. 技能刪除
//		b.是否永久性
//////////////////////////////////////
function Creat_Ability_Timer_Delete_Trigger takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)	
local unit u = LoadUnitHandle(YDHT,h2i,55555)
local integer id = LoadInteger(YDHT,h2i,44444)
	//remove ability
	call UnitRemoveAbility( u, id )
	//clean
	call FlushChildHashtable(YDHT, h2i)	
	call DestroyTimer(t)	
set u = null	
set t = null
endfunction
function Creat_Disposable_Timer_for_Ability takes unit u ,integer id , integer level , real time ,boolean b returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    //give hero ability
    call UnitAddAbility( u, id )
    call SetUnitAbilityLevel( u, id, level )
    //是否要永久性
    if b then
	    call UnitMakeAbilityPermanent( u, true, id )
	endif 
	//Variable init
	call SaveUnitHandle(YDHT,h2i,55555,u)
	call SaveInteger(YDHT,h2i,44444,id)
	//timer start
	call TimerStart(t,time,false, function Creat_Ability_Timer_Delete_Trigger )
set t = null	
endfunction
//////////////////////////////////////
//【一次性排泄計時器 - 技能給予】
//////////////////////////////////////
function Creat_GetAbility_Timer_Delete_Trigger takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)	
local unit u = LoadUnitHandle(YDHT,h2i,55555)
local integer id = LoadInteger(YDHT,h2i,44444)
	//give hero ability
    call UnitAddAbility( u, id )
    call SetUnitAbilityLevel( u, id, LoadInteger(YDHT,h2i,33333) )
	//clean
	call FlushChildHashtable(YDHT, h2i)	
	call DestroyTimer(t)	
set u = null	
set t = null
endfunction
function Creat_Disposable_Timer_for_GetAbility takes unit u ,integer id , integer level , real time returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    //remove ability
	call UnitRemoveAbility( u, id )
	//Variable init
	call SaveUnitHandle(YDHT,h2i,55555,u)
	call SaveInteger(YDHT,h2i,44444,id)
	call SaveInteger(YDHT,h2i,33333,level)
	//timer start
	call TimerStart(t,time,false, function Creat_GetAbility_Timer_Delete_Trigger )
set t = null	
endfunction
function H2S takes handle h returns string
	return I2S(GetHandleId(h))
endfunction
function H2Tx takes handle h returns string
	return H2S(h)
endfunction
function GetUnit takes string pTable,string pKey returns unit
if HaveSavedHandle(YDHT,StringHash(pTable),StringHash(pKey))then
return LoadUnitHandle(YDHT,StringHash(pTable),StringHash(pKey))
else
return null
endif
endfunction
function GetReal takes string pTable,string pKey returns real
if HaveSavedReal(YDHT,StringHash(pTable),StringHash(pKey))then
return LoadReal(YDHT,StringHash(pTable),StringHash(pKey))
else
return 0.0
endif
endfunction
function GetString takes string pTable,string pKey returns string
if HaveSavedString(YDHT,StringHash(pTable),StringHash(pKey))then
return LoadStr(YDHT,StringHash(pTable),StringHash(pKey))
else
return""
endif
endfunction
function GetInteger takes string pTable,string pKey returns integer
	if HaveSavedInteger(YDHT,StringHash(pTable),StringHash(pKey))then
		return LoadInteger(YDHT,StringHash(pTable),StringHash(pKey))
	else
		return 0
	endif
endfunction
function FastFlush takes string pTable returns nothing
	call FlushChildHashtable(YDHT,StringHash(pTable))
endfunction
function SetHandle takes string pTable,string pKey,agent pData returns nothing
	call SaveAgentHandle(YDHT,StringHash(pTable),StringHash(pKey),pData)
endfunction
function SetInteger takes string pTable,string pKey,integer pData returns nothing
	call SaveInteger(YDHT,StringHash(pTable),StringHash(pKey),pData)
endfunction
function SetReal takes string pTable,string pKey,real pData returns nothing
	call SaveReal(YDHT,StringHash(pTable),StringHash(pKey),pData)
endfunction
function SetString takes string pTable,string pKey,string pData returns nothing
	call SaveStr(YDHT,StringHash(pTable),StringHash(pKey),pData)
endfunction
function ChainAbilityTimer takes nothing returns nothing
local string lTable	=	H2Tx(GetExpiredTimer())
local unit lTMP	=	GetUnit(lTable,"u2")
local unit u =	GetUnit(lTable,"u")
local unit u2 
local unit pre =	lTMP
local real an 
local real dt =	GetReal(lTable,"dt")
local real v =	GetReal(lTable,"v")
local group g =	CreateGroup()
local integer j =	GetUnitUserData(u)
local integer m =	GetInteger(lTable,"m")
local integer fu =	GetInteger(lTable,"fu")
local integer	a =	GetInteger(lTable,"a")
local string s =	GetString(lTable,"s")
	if j!=0 then
		set an=Atan2(GetUnitY(lTMP)-GetUnitY(u),GetUnitX(lTMP)-GetUnitX(u))
		call SetUnitX(u,GetUnitX(u)+v*dt*Cos(an))
		call SetUnitY(u,GetUnitY(u)+v*dt*Sin(an))
		call UnitResetCooldown(u)
		call SetUnitManaPercentBJ(u,100)
	
			if SquareRoot(Pow(GetUnitX(lTMP)-GetUnitX(u),2)+Pow(GetUnitY(lTMP)-GetUnitY(u),2))<dt*v then
				set u2=CreateUnit(GetOwningPlayer(u),fu,GetUnitX(u),GetUnitY(u),0)
				
					if(m==3 and not IsUnitAlly(lTMP,GetOwningPlayer(u)))or m==2 then
						set a=GetInteger(lTable,"a2")
						set s=GetString(lTable,"s2")
					endif
					
				call UnitAddAbility(u2,a)
				call SetUnitAbilityLevelSwapped(a,u2,GetUnitAbilityLevel(u,a))
				call IssueTargetOrder(u2,s,lTMP)
				
				set g=CreateGroup()
				call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),GetReal(lTable,"r"),null) 
					loop
						set lTMP=null
						set lTMP=GroupPickRandomUnit(g)
						exitwhen lTMP==null
							if m==1 then
								exitwhen lTMP!=pre and lTMP!=u and IsUnitAlly(lTMP,GetOwningPlayer(u))and not(IsUnitDeadBJ(lTMP)or IsUnitType(lTMP,UNIT_TYPE_STRUCTURE)or IsUnitType(lTMP,UNIT_TYPE_ANCIENT)or GetUnitAbilityLevel(lTMP,0x416C6F63)>0)	and	not	(GetUnitPointValue(lTMP) == 1)
							elseif m==2 then
								exitwhen lTMP!=pre and lTMP!=u and(not IsUnitAlly(lTMP,GetOwningPlayer(u)))and not(IsUnitDeadBJ(lTMP)or IsUnitType(lTMP,UNIT_TYPE_STRUCTURE)or IsUnitType(lTMP,UNIT_TYPE_ANCIENT)or GetUnitAbilityLevel(lTMP,0x416C6F63)>0)	and	not	(GetUnitPointValue(lTMP) == 1)
							else
								exitwhen lTMP!=pre and lTMP!=u and not(IsUnitDeadBJ(lTMP)or IsUnitType(lTMP,UNIT_TYPE_STRUCTURE)or IsUnitType(lTMP,UNIT_TYPE_ANCIENT)or GetUnitAbilityLevel(lTMP,0x416C6F63)>0)	and	not	(GetUnitPointValue(lTMP) == 1)
							endif
						call GroupRemoveUnit(g,lTMP)
					endloop
				
					if lTMP==null then
						call KillUnit(u)
						call RemoveUnit(u)
						call PauseTimer(GetExpiredTimer())
						call FastFlush(lTable)
						call DestroyTimer(GetExpiredTimer())
					else
						call SetHandle(lTable,"u2",lTMP)
						call SetUnitUserData(u,j-1)
					endif
			endif
	else
		call KillUnit(u)
		call RemoveUnit(u)
		call PauseTimer(GetExpiredTimer())
		call FastFlush(lTable)
		call DestroyTimer(GetExpiredTimer())
	endif
	
	call DestroyGroup(g)
	
set g	=	null
set u	=	null
set u2	=	null
endfunction
function ChainAbility takes integer a,string s,integer a2,string s2,integer fu,integer fu2,real r,integer j,real v,integer m returns nothing
local timer lTimer	=	CreateTimer()
local string lTable	=	H2Tx(lTimer)
local unit target	=	GetSpellTargetUnit()
local unit u =	CreateUnit(GetOwningPlayer(GetTriggerUnit()),fu,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),0)
	call UnitAddAbility(u,a)
	call SetUnitAbilityLevelSwapped(a,u,GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId()))
	call UnitAddAbility(u,a2)
	call SetUnitAbilityLevelSwapped(a2,u,GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId()))
	
	call SetReal(lTable,"dt",0.03)
	call SetReal(lTable,"v",v)
	call SetReal(lTable,"r",r)
	call SetString(lTable,"s",s)
	call SetString(lTable,"s2",s2)
	call SetInteger(lTable,"m",m)
	call SetInteger(lTable,"a",a)
	call SetInteger(lTable,"a2",a2)
	call SetInteger(lTable,"fu",fu2)
	call SetHandle(lTable,"u",u)
	
	call SetUnitUserData(u,j)
	call SetHandle(lTable,"u2",target)
	set target=null
	
	call TimerStart(lTimer,0.03,true,function ChainAbilityTimer)
endfunction
//DOTA 玩家事件 登記
function UMI takes trigger t,playerunitevent UNI returns nothing
local integer MLI=0
	loop
	exitwhen MLI==10	
	call TriggerRegisterPlayerUnitEvent(t,Player(MLI),UNI,null)
	set MLI=MLI+1
	endloop
endfunction
//英雄註冊
function Hero_INIT takes unit RandomUnit , integer id returns nothing
	if id == 201 then	
		call TriggerRegisterUnitEvent(gg_trg_B01T, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
	elseif id == 103 then	
		call TriggerRegisterUnitEvent(gg_trg_A03W, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
		call TriggerRegisterUnitEvent(gg_trg_A03R_Learn, RandomUnit, EVENT_UNIT_HERO_SKILL)
		call SetPlayerAbilityAvailable( GetOwningPlayer(RandomUnit), 'A0XN', false )
		call SetPlayerAbilityAvailable( GetOwningPlayer(RandomUnit), 'A00C', false )
	elseif id == 313 then
		call TriggerRegisterUnitEvent(gg_trg_C13R, RandomUnit, EVENT_UNIT_HERO_SKILL)
		call TriggerRegisterUnitEvent(gg_trg_C13T, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
	elseif id == 304 then
		call TriggerRegisterUnitEvent(gg_trg_C04W, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
	elseif id == 114 then
		call TriggerRegisterUnitEvent(gg_trg_A14W, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
	elseif id == 311 then
		call TriggerRegisterUnitEvent(gg_trg_C11T, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
	elseif id == 204 then
		call TriggerRegisterUnitEvent(gg_trg_B04, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
	elseif id == 202 then
		call TriggerRegisterUnitEvent(gg_trg_B02W, RandomUnit, EVENT_UNIT_HERO_SKILL)
		call TriggerRegisterUnitEvent(gg_trg_B02E_R_T , RandomUnit, EVENT_UNIT_SPELL_EFFECT)	
	elseif id == 205 then
		call TriggerRegisterUnitEvent(gg_trg_B05R_Learn, RandomUnit, EVENT_UNIT_HERO_SKILL)	
	elseif id == 227 then
		call TriggerRegisterUnitEvent(gg_trg_B27R_U, RandomUnit, EVENT_UNIT_SPELL_EFFECT)	
		call TriggerRegisterUnitEvent(gg_trg_B27, RandomUnit, EVENT_UNIT_HERO_SKILL)	
	endif	
endfunction
function ROSE_PercentToInt takes real percentage, integer max returns integer
    local integer result = R2I(percentage * I2R(max) * 0.01)
    if (result < 0) then
        set result = 0
    elseif (result > max) then
        set result = max
    endif
    return result
endfunction
function ROSE_PercentTo255 takes real percentage returns integer
    return ROSE_PercentToInt(percentage, 255)
endfunction
//***************************************************************************
//*
//*  Triggers
//*
//***************************************************************************
//===========================================================================
// Trigger: TIME TEST
//===========================================================================
function Trig_TIME_TESTFunc005T takes nothing returns nothing
local real r = I2R(udg_time_s)
	call TimerStart(udg_time,udg_time_R,false,null)
	call PauseTimer(udg_time)
endfunction
function Trig_TIME_TESTActions takes nothing returns nothing
	
	call TimerStart(udg_time,0.00,false,null)
	
	set bj_lastCreatedTimerDialog = CreateTimerDialog(udg_time)
    call TimerDialogSetTitle(bj_lastCreatedTimerDialog, "信長之野望")
    call TimerDialogDisplay(bj_lastCreatedTimerDialog, false)
    
	call PauseTimer(udg_time)
    call TimerStart(CreateTimer(), 1.00, true, function Trig_TIME_TESTFunc005T)
endfunction
//===========================================================================
function InitTrig_TIME_TEST takes nothing returns nothing
    set gg_trg_TIME_TEST = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_TIME_TEST, 0.00 )
    call TriggerAddAction(gg_trg_TIME_TEST, function Trig_TIME_TESTActions)
endfunction
globals
timer udg_time = CreateTimer()
endglobals//===========================================================================
// Trigger: SL System
//===========================================================================
function NonStopSpellMsg__ShowLog takes nothing returns nothing
local integer key=LoadInteger(NonStopSpellMsg__hash,GetHandleId(GetExpiredTimer()),NonStopSpellMsg__key_ID)
local player p
local integer pi
local unit u
local integer index=LoadInteger(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Index)
	if index>=2 then
		set p=GetLocalPlayer()
		set pi=GetPlayerId(p)
		set u=LoadUnitHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Caster)
			if NonStopSpellMsg__Options_Show_All[pi]or NonStopSpellMsg__Options_Show_Brief[pi]then
				call DisplayTimedTextToPlayer(p,0,0,15,NonStopSpellMsg__playerColor[GetPlayerId(GetOwningPlayer(u))]+GetUnitName(u)+"|r 連續施放: |c00FFFF00"+I2S(index)+"|r 次技能    用時: |c00FFFF00"+R2SW(TimerGetElapsed(LoadTimerHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Time))-1.5,0,5)+"|r 秒")
					if NonStopSpellMsg__Options_Show_All[pi]then
						call DisplayTimedTextToPlayer(p,0,0,15,LoadStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Log)+"|r -> "+LoadStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Last))
					endif
			endif
		set u=null
		set p=null
	endif
	
	call DestroyTimer(LoadTimerHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Time))
	call DestroyTimer(LoadTimerHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Timer))
	call FlushChildHashtable(NonStopSpellMsg__hash,key)
endfunction
function NonStopSpellMsg__recordSpell takes nothing returns nothing
local integer key=GetHandleId(GetTriggerUnit())
local timer t
	if HaveSavedHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Caster)then
			if HaveSavedString(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Log)then
				call SaveStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Log,LoadStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Log)+"|r -> "+LoadStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Last))
			else
				call SaveStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Log,LoadStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Last))
			endif
		call TimerStart(LoadTimerHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Timer),1.5,false,function NonStopSpellMsg__ShowLog)
	else
		call SaveUnitHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Caster,GetTriggerUnit())
		set t=CreateTimer()
		call SaveTimerHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Time,t)
		call TimerStart(t,0x7FFFFFFF,false,null)
		set t=CreateTimer()
		call SaveInteger(NonStopSpellMsg__hash,GetHandleId(t),NonStopSpellMsg__key_ID,key)
		call SaveTimerHandle(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Timer,t)
		call TimerStart(t,1.5,false,function NonStopSpellMsg__ShowLog)
		set t=null
	endif
		call SaveInteger(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Index,LoadInteger(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Index)+1)
			if not HaveSavedBoolean(NonStopSpellMsg__hash,GetSpellAbilityId(),NonStopSpellMsg__key_Exceptions)then
				call SaveStr(NonStopSpellMsg__hash,key,NonStopSpellMsg__key_NonStop_Last,"|c00A020F0"+GetObjectName(GetSpellAbilityId()))
			endif
endfunction
function NonStopSpellMsg__recordSpell_Item takes nothing returns nothing
if not HaveSavedBoolean(NonStopSpellMsg__hash,GetItemTypeId(GetManipulatedItem()),NonStopSpellMsg__key_Exceptions) then
	call SaveStr(NonStopSpellMsg__hash,GetHandleId(GetTriggerUnit()),NonStopSpellMsg__key_NonStop_Last,"|c00A020F0"+GetItemName(GetManipulatedItem()))
endif
endfunction
function SetNonStopSpellMsgExceptions takes integer id returns nothing
	call SaveBoolean(NonStopSpellMsg__hash,id,NonStopSpellMsg__key_Exceptions,true)
endfunction
function NonStopSpellMsg__playerSetShowLog takes nothing returns nothing
local integer pi=GetPlayerId(GetLocalPlayer())
local string es=StringCase(GetEventPlayerChatString(),true)
	if GetTriggerPlayer()==GetLocalPlayer()then
		if es==StringCase("-SL2",true)then
			set NonStopSpellMsg__Options_Show_All[pi]=true
			call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,"|c0000FF00開啟完整顯示接技訊息")
		elseif es==StringCase("-SL1",true)then
			set NonStopSpellMsg__Options_Show_All[pi]=false
			set NonStopSpellMsg__Options_Show_Brief[pi]=true
			call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,"|c00FFFF00開啟簡易顯示接技訊息")
		elseif es==StringCase("-SL0",true)then
			set NonStopSpellMsg__Options_Show_All[pi]=false
			set NonStopSpellMsg__Options_Show_Brief[pi]=false
			call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,"|c00FF0000關閉顯示接技訊息")
		endif
	endif
endfunction
function NonStopSpellMsg__initColor takes nothing returns nothing
	//基本設定
	set NonStopSpellMsg__playerColor[0x0]="|c00ff0303"
	set NonStopSpellMsg__playerColor[0x1]="|c000042ff"
	set NonStopSpellMsg__playerColor[0x2]="|c001ce6b9"
	set NonStopSpellMsg__playerColor[0x3]="|c00540081"
	set NonStopSpellMsg__playerColor[0x4]="|c00fffc01"
	set NonStopSpellMsg__playerColor[0x5]="|c00fe8a0e"
	set NonStopSpellMsg__playerColor[0x6]="|c0020c000"
	set NonStopSpellMsg__playerColor[0x7]="|c00e55bb0"
	set NonStopSpellMsg__playerColor[0x8]="|c00959697"
	set NonStopSpellMsg__playerColor[0x9]="|c007ebff1"
	set NonStopSpellMsg__playerColor[0xA]="|c00106246"
	set NonStopSpellMsg__playerColor[0xB]="|c004e2a04"
	set NonStopSpellMsg__playerColor[0xC]="|cff0000ff"
	set NonStopSpellMsg__playerColor[0xD]=NonStopSpellMsg__playerColor[0xC]
	set NonStopSpellMsg__playerColor[0xE]=NonStopSpellMsg__playerColor[0xC]
	set NonStopSpellMsg__playerColor[0xF]=NonStopSpellMsg__playerColor[0xC]
	//例外技能
    call SetNonStopSpellMsgExceptions( 'A0AE' )
    call SetNonStopSpellMsgExceptions( 'A0GK' )
    call SetNonStopSpellMsgExceptions( 'AIbk' )
    call SetNonStopSpellMsgExceptions( 'gvsm' )
    call SetNonStopSpellMsgExceptions( 'tmsc' )
    call SetNonStopSpellMsgExceptions( 'asbl' )
    call SetNonStopSpellMsgExceptions( 'I02E' )
    call SetNonStopSpellMsgExceptions( 'A0AR' )
    call SetNonStopSpellMsgExceptions( 'tst2' )
    call SetNonStopSpellMsgExceptions( 'AIre' )
    call SetNonStopSpellMsgExceptions( 'I01A' )
    call SetNonStopSpellMsgExceptions( 'AChw' )
    call SetNonStopSpellMsgExceptions( 'I02O' )
    call SetNonStopSpellMsgExceptions( 'A0C4' )
    call SetNonStopSpellMsgExceptions( 'I02N' )
    call SetNonStopSpellMsgExceptions( 'AIHl' )
    call SetNonStopSpellMsgExceptions( 'I016' )
    call SetNonStopSpellMsgExceptions( 'A0GE' )
    call SetNonStopSpellMsgExceptions( 'I01D' )
    call SetNonStopSpellMsgExceptions( 'AIpl' )
    call SetNonStopSpellMsgExceptions( 'I013' )
    call SetNonStopSpellMsgExceptions( 'A0GS' )
    call SetNonStopSpellMsgExceptions( 'I022' )
    call SetNonStopSpellMsgExceptions( 'A0ES' )
    call SetNonStopSpellMsgExceptions( 'I011' )
    call SetNonStopSpellMsgExceptions( 'Aroa' )
    call SetNonStopSpellMsgExceptions( 'I00E' )
    call SetNonStopSpellMsgExceptions( 'A0D8' )
endfunction
//init
function InitTrig_SL_System takes nothing returns nothing
local integer i
local trigger t
	call NonStopSpellMsg__initColor()
	//特別用 "施法結束" 來抓時間。
	set t=CreateTrigger()
	set i=0
	loop
		exitwhen(i>=12)
		call TriggerRegisterPlayerUnitEvent(t,Player(i),EVENT_PLAYER_UNIT_SPELL_CHANNEL,null)
		set i=i+(1)
	endloop
	call TriggerAddCondition(t,Condition(function NonStopSpellMsg__recordSpell))
	set t=CreateTrigger()
	set i=0
	loop
		exitwhen(i>=12)
		call TriggerRegisterPlayerUnitEvent(t,Player(i),EVENT_PLAYER_UNIT_USE_ITEM,null)
		set i=i+(1)
	endloop
	call TriggerAddCondition(t,Condition(function NonStopSpellMsg__recordSpell_Item))
	
	set t=CreateTrigger()
	set i=0
	loop
		exitwhen(i>=12)
		call TriggerRegisterPlayerChatEvent(t,Player(i),"",false)
		set i=i+(1)
	endloop
	call TriggerAddCondition(t,Condition(function NonStopSpellMsg__playerSetShowLog))
	
set t=null
endfunction
globals
hashtable NonStopSpellMsg__hash=InitHashtable()
constant integer NonStopSpellMsg__key_ID=10
constant boolean LIBRARY_NonStopSpellMsg=true
constant integer NonStopSpellMsg__key_NonStop_Caster=12
constant integer NonStopSpellMsg__key_NonStop_Time=14
constant integer NonStopSpellMsg__key_NonStop_Index=16
constant integer NonStopSpellMsg__key_NonStop_Last=18
constant integer NonStopSpellMsg__key_NonStop_Log=20
constant integer NonStopSpellMsg__key_NonStop_Timer=22
constant integer NonStopSpellMsg__key_Exceptions=24
string array NonStopSpellMsg__playerColor
boolean array NonStopSpellMsg__Options_Show_All
boolean array NonStopSpellMsg__Options_Show_Brief
endglobals//===========================================================================
// Trigger: Kick sys A
//===========================================================================
function Trig_Kick_sys_ACondition3 takes nothing returns nothing
local	timer	t =	GetExpiredTimer()
local	integer	h2i =	GetHandleId(t)
local	trigger	ltt =	LoadTriggerHandle(YDHT,h2i,2)
	//clean	
	call	DestroyTimer(t)
	call	FlushChildHashtable(YDHT,h2i)
	//開啟投票觸發器
	call EnableTrigger( ltt )
	//公告玩家可以繼續使用
	call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "|cffff0000踢除系統開啟" )
set ltt =	null	
set t =	null
endfunction
function Trig_Kick_sys_ACondition2 takes nothing returns nothing
local	timer	t =	GetExpiredTimer()
local	integer	h2i =	GetHandleId(t)
local	player	p2 =	LoadPlayerHandle(YDHT,h2i,1)
	//公告文本	:	踢除失敗
	if	GetPlayerSlotState(p2) == PLAYER_SLOT_STATE_PLAYING	then
		
		call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "|cffff0000踢除失敗，再給他一次機會吧!!" )
		
	endif
	//一分鐘後才能在使用
	call	TimerStart(t,60.00,false,function	Trig_Kick_sys_ACondition3)
set p2 =	null
set t =	null	
endfunction
function Trig_Kick_sys_ACondition1 takes player p	, integer	id returns boolean	
//Player(id-1)是要踢除玩家
local	boolean b	=	((GetPlayerSlotState(Player(id-1)) == PLAYER_SLOT_STATE_PLAYING))
local	force f	=	CreateForce()
		//製造單一玩家組
		call	ForceAddPlayer(f,p)
		//假如指定玩家不在遊戲，提醒觸發玩家就好，要不然可以洗頻
		//也可以避免一些BUG
		if	b	==	false	then 
			call DisplayTimedTextToForce( f, 10.00, "|cffff0000指定玩家不在遊戲中|r" )	
		endif
	call	DestroyForce(f)
	set f	=	null
	return b
endfunction
//=====================================================
//			觸發玩家先投一票
//=====================================================
function Trig_Kick_sys_BActions22 takes player	p returns nothing
local	integer id = GetPlayerId(p) +	1
local	string s 
local	string s2 
local	string s3
local	string s4
local	string s5
local	integer kickint	= udg_KickTime - 4
	
	
    if udg_KickVotesYes_ture[id] == false then
	    //贊成整數變量
        set udg_KickVotesYes = udg_KickVotesYes + 1 
			//同蒙變量
        	if	IsPlayerAlly(p, udg_Kick_P) then
	        	set udg_KickVotesSYes = udg_KickVotesSYes + 1
	        endif	
        //避免重複投票boolean變量
        set udg_KickVotesYes_ture[id] = true
		//公告文本
		//對於踢除投票目前結果 : 贊成x(需要人數 :  y)
		set s = "|cff33cccc對於踢除投票目前結果 : 贊成  "
		set s2 = I2S(	udg_KickVotesYes )
		set s3 = "(需要人數 :  "
		set s4 = I2S( kickint )
		set s5 = ")"
		set s = s	+	s2 + s3 + s4 + s5 
        
        call DisplayTimedTextToForce( GetPlayersAll(), 10.00, s)
        //公告文本:同盟玩家
		//同盟投票目前結果 : 贊成x	(需要人數 :  Y)
        set s = "|cff33cccc同盟投票目前結果       : 贊成  "
		set s2 = I2S(	udg_KickVotesSYes )
		set s3 = "(需要人數 :  "
		set s4 = I2S( 3 )
		set s5 = ")"
		set s = s	+	s2 + s3 + s4 + s5 
        
        call DisplayTimedTextToForce( GetPlayersAll(), 10.00, s)
        
    endif
   
endfunction
function Trig_Kick_sys_ACondition takes nothing returns boolean
local	string s =	GetEventPlayerChatString()	
//6~8可以讓玩家不用再打空白鍵
local	string s2 =	SubStringBJ(s, 6, 8)
local	string s3
local	string s4
local	string s5
local	string s6
local	string s7
local	string s8
local	integer checkint	=	S2I(s2)
local	boolean b =	false
local	player p =	GetTriggerPlayer()
local	player p2
local	integer id =	GetConvertedPlayerId(p)
local	player p3
local	integer i
local	trigger ltt =	GetTriggeringTrigger()
local	integer h2i 
local	timer t 
	//判斷指定玩家是不是 1~10
	if	checkint	==	1	then
		//確定玩家是不是正在遊戲的玩家
		set b =	Trig_Kick_sys_ACondition1(p,1)
	elseif	checkint	==	2	then
		set b =	Trig_Kick_sys_ACondition1(p,2)
	elseif	checkint	==	3	then
		set b =	Trig_Kick_sys_ACondition1(p,3)
	elseif	checkint	==	4	then
		set b =	Trig_Kick_sys_ACondition1(p,4)
	elseif	checkint	==	5	then
		set b =	Trig_Kick_sys_ACondition1(p,5)	
	elseif	checkint	==	6	then
		set b =	Trig_Kick_sys_ACondition1(p,6)
	elseif	checkint	==	7	then
		set b =	Trig_Kick_sys_ACondition1(p,7)
	elseif	checkint	==	8	then
		set b =	Trig_Kick_sys_ACondition1(p,8)
	elseif	checkint	==	9	then
		set b =	Trig_Kick_sys_ACondition1(p,9)	
	elseif	checkint	==	10	then
		set b =	Trig_Kick_sys_ACondition1(p,10)	
	endif 
	//如果是正常玩家才進行踢除投票動作
	if	b	then
		//關閉觸發器，避免重複使用。
		call DisableTrigger( ltt )
		//回到預設值
	    set udg_KickVotesYes = 0
		set udg_KickVotesNo = 0
		set	udg_KickVotesSYes	=	0
		set	udg_KickTime =	0
		//檢測目前有沒有達到足夠投票人數
		set i = 0
		    loop
		        exitwhen i > 9
				set p3	=	Player(i)
		        	//檢測是不是真人玩家
			        if GetPlayerSlotState(p3) == PLAYER_SLOT_STATE_PLAYING then
			            set udg_KickTime = udg_KickTime + 1 
			         	//設定為預設值	
			            set	udg_KickVotesYes_ture[	i+1	]	=	false
			        endif
			        
		        set i = i + 1
		    endloop
		    //人數上限檢查
		    if udg_KickTime < 6 then
		        call QuestMessageBJ( GetPlayersAll(), bj_QUESTMESSAGE_WARNING, "|cffff0000玩家人數不足|r" )
		        set b	=	false
		    endif
			//作人數上限的確認
			if	b	then
				//開啟投票觸發器
				call EnableTrigger( gg_trg_Kick_sys_B )
				//踢除玩家的變量紀錄
				set p2 =	ConvertedPlayer(checkint)
				set udg_Kick_P =	p2
				//公告文本-1
				set s2 =	udg_S03_color_of_players[id]
				set s3 =	GetPlayerName(p)
				set s4 =	"|r發起了對" 
				set s5 =	udg_S03_color_of_players[checkint]
				set s6 =	GetPlayerName(p2)
				set s7 =	"|r的踢除投票。"	
				//公告文本-2
				set s8 =	"輸入 -Y 表達同意。"
				set s =	s2	+	s3	+	s4	+	s5	+	s6	+	s7
				//XXX發起了對YYY的踢除投票。
				call DisplayTimedTextToForce( GetPlayersAll(), 10.00, s )
				call DisplayTimedTextToForce( GetPlayersAll(), 10.00, s8 )
				//觸發玩家要先投票
				call	Trig_Kick_sys_BActions22(p)
				
				//45秒後檢查結果
				set	t =	CreateTimer()
				set	h2i =	GetHandleId(t)
				//紀錄要踢除的玩家、目前觸發器
				call	SavePlayerHandle(YDHT,h2i,1,p2)
				call	SaveTriggerHandle(YDHT,h2i,2,ltt)
				call	TimerStart(t,45.00,false,function	Trig_Kick_sys_ACondition2)
				
			endif
	endif 
set p =	null
set p2 =	null
set p3 =	null
set ltt =	null
set t =	null
return	false
endfunction
//===========================================================================
function InitTrig_Kick_sys_A takes nothing returns nothing
local	integer n = 0
	set gg_trg_Kick_sys_A = CreateTrigger()
	loop
		exitwhen	n	>	9	
		
 		call TriggerRegisterPlayerChatEvent( gg_trg_Kick_sys_A, Player(n), "-kick " , false )
 		set n	=	n	+	1
	endloop
	
    call TriggerAddCondition(gg_trg_Kick_sys_A, Condition(function Trig_Kick_sys_ACondition))
endfunction
globals
player udg_Kick_P	=	null	
endglobals
	//===========================================================================
// Trigger: Kick sys B
//===========================================================================
//========================================================================
//							踢除玩家特別觸發
//========================================================================
function Trig_Player_Leave_Actions_for_Gold2zero22 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local player p = LoadPlayerHandle(YDHT,h2i,5566)
	call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,0)
	call SetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER,0)
	
set t = null
set p = null
endfunction
function Trig_Player_Leave_Actions22 takes player	p returns nothing
local string s = "|cffffcc00" + GetPlayerName(p) + "|r逃離戰場，將他的黃金以及兵力均分給其他友軍玩家。" 
local integer i = 0
local integer i2 = 0
local integer money = 1
local integer lumber = 1 
local integer int = 0
local boolean b = false
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
		//這裡是同盟離線 補償系統
	    if IsPlayerEnemy(p, Player(0)) then
	        if udg_High_Boolen then
	            set udg_Pay_Money2 = udg_Pay_Money2 + 4 
	        else
	            set udg_Pay_Money2 = udg_Pay_Money2 + 1 
	        endif
	    else
	        if udg_High_Boolen then
	            set udg_Pay_money = udg_Pay_money + 4 
	        else
	            set udg_Pay_money = udg_Pay_money + 1 
	        endif
	    endif
	    if gg_snd_Warning != null then
	        call StartSound(gg_snd_Warning)
	    endif
	    
		if IsPlayerInForce(GetLocalPlayer(), bj_FORCE_ALL_PLAYERS) then
        	// Use only local code (no net traffic) within this block to avoid desyncs.
        	call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, s)
    	endif
    	
		//確定分錢分母
		//先確認有沒有在線上
		set i = 0
		loop
			exitwhen i > 9
				if IsPlayerAlly(Player(i), p) and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING then 
					//分母
					set int = int + 1
					//確認布爾用
					set b = true
				endif
			set i = i + 1
		endloop 
		//避免分母=0
			if b == false then
				set int = 1
			endif
			
		set lumber = GetPlayerState(p, PLAYER_STATE_RESOURCE_LUMBER) / int
		set money = GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) / int
		
		//分錢
		set i = 0
		loop
			exitwhen i > 9
				if IsPlayerAlly(Player(i), p) and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING then 
					call SetPlayerAllianceStateBJ( p, Player(i), bj_ALLIANCE_ALLIED_UNITS )
					
					call SetPlayerState(Player(i), PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(Player(i), PLAYER_STATE_RESOURCE_GOLD) + money)
					call SetPlayerState(Player(i), PLAYER_STATE_RESOURCE_LUMBER, GetPlayerState(Player(i), PLAYER_STATE_RESOURCE_LUMBER) + lumber)
				endif
			set i = i + 1
		endloop	
		
		//計分板
		set i = GetPlayerId(p) + 1
		call YDWEMultiboardSetItemColorBJNull( udg_DMB, 0, i+1 , 25.00, 25.00, 25.00, 0 )
		call KillUnit( udg_S16_U[i] )
	
		//每兩秒歸0資源
		call SavePlayerHandle(YDHT,h2i,5566,p)
		call TimerStart(t,4.00,true,function Trig_Player_Leave_Actions_for_Gold2zero22)
		
set s = null
set t = null
endfunction
function Trig_Player_Leave_Actions23 takes nothing returns nothing
	//排泄
	call	DestroyTimer(GetExpiredTimer())
	
	call Trig_Player_Leave_Actions22(udg_Kick_P)	
endfunction
//========================================================================
//							主要觸發
//========================================================================
function Trig_Kick_sys_BActions takes nothing returns nothing
local	player p = GetTriggerPlayer()
local	integer id = GetPlayerId(p) + 1
local	string s 
local	string s2 
local	string s3
local	string s4
local	string s5
local	integer kickint	= udg_KickTime - 4
local	timer t 
local	integer h2i 
	
	
    if udg_KickVotesYes_ture[id] == false then
	    //贊成整數變量
        set udg_KickVotesYes = udg_KickVotesYes + 1 
			//同蒙變量
        	if	IsPlayerAlly(p, udg_Kick_P) then
	        	set udg_KickVotesSYes = udg_KickVotesSYes + 1
	        endif	
        //避免重複投票boolean變量
        set udg_KickVotesYes_ture[id] = true
		//公告文本:所有玩家
		//對於踢除投票目前結果 : 贊成x	(需要人數 :  y)
		
		set s = "|cff33cccc對於踢除投票目前結果 : 贊成  "
		set s2 = I2S(	udg_KickVotesYes )
		set s3 = "(需要人數 :  "
		set s4 = I2S( kickint )
		set s5 = ")"
		set s = s	+	s2 + s3 + s4 + s5 
        
        call DisplayTimedTextToForce( GetPlayersAll(), 10.00, s)
		//公告文本:同盟玩家
		//同盟投票目前結果 : 贊成x	(需要人數 :  y)
        set s = "|cff33cccc同盟投票目前結果       : 贊成  "
		set s2 = I2S(	udg_KickVotesSYes )
		set s3 = "(需要人數 :  "
		set s4 = I2S( 3 )
		set s5 = ")"
		set s = s	+	s2 + s3 + s4 + s5 
        
        call DisplayTimedTextToForce( GetPlayersAll(), 10.00, s)
			//如果達到需要人數就剔除玩家
			//也可以避免投票中突然掉掉問題
			//a.要加"if 剔除玩家不再線上的判斷，要不然會崩潰 "
			if	udg_KickVotesYes	==	kickint	or	udg_KickVotesSYes	==	3	then
				call CustomDefeatBJ( udg_Kick_P, "玩家已被踢除遊戲" )
				//一定要這樣 要不然平分分母
				set	t	=	CreateTimer()
				set	h2i	=	GetHandleId(t)
				call	TimerStart(t,0.08,false,function Trig_Player_Leave_Actions23)
				
	
			endif
        
    endif
set t = null
set p = null 
endfunction
//===========================================================================
function InitTrig_Kick_sys_B takes nothing returns nothing
local	integer i =	0
    set gg_trg_Kick_sys_B = CreateTrigger()
    //過X秒後，才能使用這個系統。
    //也避免可以重複輸入。
    call DisableTrigger(gg_trg_Kick_sys_B)
		//註冊1~10玩家輸入事件
	    loop
		    exitwhen	i	>	9
		    
	    	call TriggerRegisterPlayerChatEvent( gg_trg_Kick_sys_B, Player(i), "-Y", true )
	    	set i	=	i	+	1
	    endloop
    
    call TriggerAddAction(gg_trg_Kick_sys_B, function Trig_Kick_sys_BActions)
endfunction
globals
integer	udg_KickVotesNo	=	0
integer	udg_KickVotesSYes	=	0
boolean	udg_KickVotesB	=	false
endglobals//===========================================================================
// Trigger: Player Name Init
//===========================================================================
function Trig_Player_Name_InitActions takes nothing returns nothing
    set udg_N01_name[1] = "Death_Message"
    set udg_N01_name2[1] = "信魂-老爸"
    set udg_N01_name[3] = "MaxPower_min"
    set udg_N01_name2[3] = "信魂-小小"
    set udg_N01_name[4] = "QueenDom_Ed"
    set udg_N01_name2[4] = "信魂-女王"
    set udg_N01_name[5] = "arthur61106"
    set udg_N01_name2[5] = "信魂-生活家"
    set udg_N01_name[6] = "night891119"
    set udg_N01_name2[6] = "信魂-嵐"
    set udg_N01_name[7] = "totox08043"
    set udg_N01_name2[7] = "信魂-神奇冷民"
    set udg_N01_name[8] = "ProJact.C_Ray"
    set udg_N01_name2[8] = "信魂-水電工"
    set udg_N01_name[10] = "RAINBOW6_JOKER"
    set udg_N01_name2[10] = "信魂-黃魚"
    set udg_N01_name[11] = "North_Yoishide"
    set udg_N01_name2[11] = "信魂-斯里蘭卡"
    set udg_N01_name[12] = "BOLD_LuoLi"
    set udg_N01_name2[12] = "信魂-Oath_maple"
    set udg_N01_name[14] = "a120242791"
    set udg_N01_name2[14] = "信魂-蜜桃來臨時"
    set udg_N01_name[15] = "s10410074"
    set udg_N01_name2[15] = "信魂-小S"
    set udg_N01_name[16] = "IANBENITA"
    set udg_N01_name2[16] = "信魂-庫瑪"
    set udg_N01_name[17] = "hahaha32016"
    set udg_N01_name2[17] = "信魂-小諾"
    set udg_N01_name[18] = "K.Kast"
    set udg_N01_name2[18] = "信魂-小K"
    set udg_N01_name[19] = "Airi.Cool_Magic"
    set udg_N01_name2[19] = "信魂-不好意思"
    set udg_N01_name[21] = "AveryLei"
    set udg_N01_name2[21] = "信魂-Lei"
    set udg_N01_name[22] = "artemis55500"
    set udg_N01_name2[22] = "信魂-堤亞斯多"
endfunction
//===========================================================================
function InitTrig_Player_Name_Init takes nothing returns nothing
    set gg_trg_Player_Name_Init = CreateTrigger()
    call TriggerAddAction(gg_trg_Player_Name_Init, function Trig_Player_Name_InitActions)
endfunction
//===========================================================================
// Trigger: Player VIP Check
//===========================================================================
function Trig_Player_VIP_CheckActions takes nothing returns nothing
	local integer i
	local integer i2
	local integer iend
	local integer i2end
	local boolean b =	false
		set i=1
		set iend=10
			loop
				exitwhen i>iend
				set i2=1
				set i2end=22
				
					loop
						exitwhen i2>i2end
						
							if GetPlayerName(ConvertedPlayer(i))==udg_N01_name[i2]then
								
								set b=false
								call SetPlayerName(ConvertedPlayer(i),udg_N01_name2[i2])
								set udg_N01_name3[i]=udg_N01_name2[i2]
								call MultiboardSetItemValue(MultiboardGetItem(udg_DMB,i,0),GetPlayerName(GetOwningPlayer(udg_S16_U[i])))
								
							endif
							
						set i2=i2+1
					endloop
					
				set i=i+1
			endloop
		
		if b then
			call DisplayTimedTextToForce(GetPlayersAll(),10.00,"|cffff9900偵測到信魂人員 ， 有遊戲問題可以向他們反應\n")
		endif
	call DisableTrigger(GetTriggeringTrigger())
endfunction
function InitTrig_Player_VIP_Check takes nothing returns nothing
set gg_trg_Player_VIP_Check=CreateTrigger()
call TriggerRegisterTimerEventSingle(gg_trg_Player_VIP_Check,2.00)
call TriggerAddAction(gg_trg_Player_VIP_Check,function Trig_Player_VIP_CheckActions)
endfunction//===========================================================================
// Trigger: Player Name System
//===========================================================================
function Trig_Player_Name_SystemActions takes nothing returns nothing
    call SetPlayerName( GetTriggerPlayer(), ( SubStringBJ(GetEventPlayerChatString(), 7, 27) + ( "(" + ( GetHeroProperName(udg_S01_hero_of_player[( GetConvertedPlayerId(GetTriggerPlayer()) - 0 )]) + ")" ) ) ) )
endfunction
//===========================================================================
function InitTrig_Player_Name_System takes nothing returns nothing
    set gg_trg_Player_Name_System = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(0), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(1), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(2), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(3), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(4), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(5), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(6), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(7), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(8), "-name", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_Player_Name_System, Player(9), "-name", false )
    call TriggerAddAction(gg_trg_Player_Name_System, function Trig_Player_Name_SystemActions)
endfunction//===========================================================================
// Trigger: Auto Choose System
//
// if ((IsUnitType(GetSpellAbilityId() == 'A0X5')) then
//===========================================================================
//function Trig_Auto_System_2 takes nothing returns nothing
//	local	unit	u	=	GetTriggerUnit()
//	local	player	p	=	GetOwningPlayer(u)	
//	local	integer	i	=	GetConvertedPlayerId(p)
//	local	integer	id	=	GetUnitPointValue(udg_S01_hero_of_player[i])
//		if	id	==	319	then
//			call DisplayTimedTextToPlayer(p,0,0,10,"|cffff0000系統檢查|r")	
//		else
//			call DisplayTimedTextToPlayer(p,0,0,10,"|cffff0000不符合資格|r")	
//		endif
//    set		u	=	null
//    set		p	=	null
//endfunction
function Trig_Auto_System_1 takes nothing returns nothing
		if GetLocalPlayer()==GetTriggerPlayer()then
			if udg_computer_B == false then
	        	// Use only local code (no net traffic) within this block to avoid desyncs.
	        	call TimerDialogDisplay(bj_lastCreatedTimerDialog, true) 
				set udg_computer_B = true
				call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"|c0000FF00開啟完整計分板")
			else
				call TimerDialogDisplay(bj_lastCreatedTimerDialog, false)
				set udg_computer_B = false
				call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"|c00FFFF00開啟簡易計分板")
			endif 
				
		endif	
endfunction
function Trig_Auto_Choose_SystemActions takes nothing returns nothing
	local	integer	id	=	GetSpellAbilityId()
	local	unit	u	=	GetTriggerUnit()
	local	player	p	=	GetOwningPlayer(u)
	local	integer	i	=	GetConvertedPlayerId(p)
	    // ========自動圈選系統==================
	    if id == 'A0X5' then
	        call SetPlayerAbilityAvailableBJ( false, 'A0X5', p )
	        call SetPlayerAbilityAvailableBJ( true, 'A0X6', p )
	        set udg_auto[i] = true
	    elseif id == 'A0X6' then
	        call SetPlayerAbilityAvailableBJ( false, 'A0X6', p )
	        call SetPlayerAbilityAvailableBJ( true, 'A0X5', p )
	        set udg_auto[i] = false
	    // =======完整記分系統=====
	    elseif ((id == 'A0XT')) then
	        call SetPlayerAbilityAvailableBJ( false, 'A0XT', p )
	        call SetPlayerAbilityAvailableBJ( true, 'A0XU', p )
	        call Trig_Auto_System_1()
		elseif ((id == 'A0XU')) then
	        call SetPlayerAbilityAvailableBJ( false, 'A0XU', p )
	        call SetPlayerAbilityAvailableBJ( true, 'A0XT', p )
	        call Trig_Auto_System_1()
	    // =======RESTART HERO=====    
	    //elseif  ((id == 'A0XV')) then
	    //	call Trig_Auto_System_2()    	    
	    else
	    	// ========投降系統==================
		    call ConditionalTriggerExecute( gg_trg_Surrender_vote_for_A )
		    call ConditionalTriggerExecute( gg_trg_Surrender_vote_for_A_2 )
		    call ConditionalTriggerExecute( gg_trg_Surrender_vote_for_A_3 )
		    call ConditionalTriggerExecute( gg_trg_Surrender_vote_for_B )
		    call ConditionalTriggerExecute( gg_trg_Surrender_vote_for_B_2 )
		    call ConditionalTriggerExecute( gg_trg_Surrender_vote_for_B_3 ) 
	    endif
    set u	=	null
    set p	=	null
endfunction
//===========================================================================
function InitTrig_Auto_Choose_System takes nothing returns nothing
    set gg_trg_Auto_Choose_System = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0017, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0018, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0019, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0020, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0021, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0367, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0368, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0369, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0370, EVENT_UNIT_SPELL_EFFECT )
    call TriggerRegisterUnitEvent( gg_trg_Auto_Choose_System, gg_unit_hvlt_0371, EVENT_UNIT_SPELL_EFFECT )
    call TriggerAddAction(gg_trg_Auto_Choose_System, function Trig_Auto_Choose_SystemActions)
endfunction
//===========================================================================
// Trigger: Surrender Init
//===========================================================================
function Trig_Surrender_InitActions takes nothing returns nothing
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerAbilityAvailableBJ( false, 'A0N1', ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAbilityAvailableBJ( false, 'A0J8', ConvertedPlayer(GetForLoopIndexA()) )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call DisableTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_Surrender_Init takes nothing returns nothing
    set gg_trg_Surrender_Init = CreateTrigger()
    call TriggerAddAction(gg_trg_Surrender_Init, function Trig_Surrender_InitActions)
endfunction
//===========================================================================
// Trigger: Surrender vote for A
//===========================================================================
function Trig_Surrender_vote_for_AConditions takes nothing returns boolean
    return ((IsTriggerEnabled(GetTriggeringTrigger()) == true) and (GetSpellAbilityId() == 'A0HY') and ((GetOwningPlayer(GetTriggerUnit()) == Player(5)) or (GetOwningPlayer(GetTriggerUnit()) == Player(6)) or (GetOwningPlayer(GetTriggerUnit()) == Player(7)) or (GetOwningPlayer(GetTriggerUnit()) == Player(8)) or (GetOwningPlayer(GetTriggerUnit()) == Player(9))))
endfunction
function Trig_Surrender_vote_for_AActions takes nothing returns nothing
    call DisableTrigger( GetTriggeringTrigger() )
    call DisableTrigger( gg_trg_Surrender_vote_for_B )
    // 歸0需要用到的整數變量
    set udg_Surrende_vote[4] = 0
    set udg_Surrende_vote[5] = 0
    set udg_Surrende_vote[6] = 0
    // 文本
    call DisplayTimedTextToForce( GetPlayersAll(), 30, ( ( "|cffff0000" + GetPlayerName(GetTriggerPlayer()) ) + "發起了投降的投票，請選取個人倉庫，點選\"同意投降\"或是\"反對投降\"來投票，投票將會在1分鐘之後結算，沒有投票者不計算" ) )
    // 查看現在還在的玩家
    set bj_forLoopAIndex = 6
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ((GetPlayerSlotState(ConvertedPlayer(GetForLoopIndexA())) == PLAYER_SLOT_STATE_PLAYING) and (GetPlayerController(ConvertedPlayer(GetForLoopIndexA())) == MAP_CONTROL_USER)) then
            set udg_Surrende_vote[6] = ( udg_Surrende_vote[6] + 1 )
        else
        endif
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 開啟投降技能/觸發
    set bj_forLoopAIndex = 6
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerAbilityAvailableBJ( true, 'A0N1', ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAbilityAvailableBJ( true, 'A0J8', ConvertedPlayer(GetForLoopIndexA()) )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call EnableTrigger( gg_trg_Surrender_vote_for_A_2 )
    call EnableTrigger( gg_trg_Surrender_vote_for_A_3 )
    // 60秒後統計票數/如果票數過關就殺死敵方大本營
    call YDWEPolledWaitNull(60.00)
    if ((udg_Surrende_vote[4] >= ( udg_Surrende_vote[6] - 1 ))) then
        call KillUnit( gg_unit_ntn2_0372 )
    else
        call DisplayTimedTextToForce( GetPlayersAll(), 30, "TRIGSTR_6479" )
    endif
    // 關閉投票技能
    set bj_forLoopAIndex = 6
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerAbilityAvailableBJ( false, 'A0N1', ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAbilityAvailableBJ( false, 'A0J8', ConvertedPlayer(GetForLoopIndexA()) )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 5分鐘後再開啟投票系統
    call YDWEPolledWaitNull(300.00)
    call EnableTrigger( GetTriggeringTrigger() )
    call EnableTrigger( gg_trg_Surrender_vote_for_B )
endfunction
//===========================================================================
function InitTrig_Surrender_vote_for_A takes nothing returns nothing
    set gg_trg_Surrender_vote_for_A = CreateTrigger()
    call DisableTrigger(gg_trg_Surrender_vote_for_A)
    call TriggerAddCondition(gg_trg_Surrender_vote_for_A, Condition(function Trig_Surrender_vote_for_AConditions))
    call TriggerAddAction(gg_trg_Surrender_vote_for_A, function Trig_Surrender_vote_for_AActions)
endfunction
//===========================================================================
// Trigger: Surrender vote for A-2
//===========================================================================
function Trig_Surrender_vote_for_A_2Conditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0J8') and ((GetOwningPlayer(GetTriggerUnit()) == Player(5)) or (GetOwningPlayer(GetTriggerUnit()) == Player(6)) or (GetOwningPlayer(GetTriggerUnit()) == Player(7)) or (GetOwningPlayer(GetTriggerUnit()) == Player(8)) or (GetOwningPlayer(GetTriggerUnit()) == Player(9))))
endfunction
function Trig_Surrender_vote_for_A_2Actions takes nothing returns nothing
    set udg_Surrende_vote[4] = ( udg_Surrende_vote[4] + 1 )
    call DisplayTimedTextToForce( GetPlayersAll(), 30, ( ( "|cff33cccc對於投降投票目前結果 : 贊成" + I2S(udg_Surrende_vote[4]) ) + ( "/  反對" + I2S(udg_Surrende_vote[5]) ) ) )
    call SetPlayerAbilityAvailableBJ( false, 'A0N1', GetOwningPlayer(GetTriggerUnit()) )
    call SetPlayerAbilityAvailableBJ( false, 'A0J8', GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_Surrender_vote_for_A_2 takes nothing returns nothing
    set gg_trg_Surrender_vote_for_A_2 = CreateTrigger()
    call DisableTrigger(gg_trg_Surrender_vote_for_A_2)
    call TriggerAddCondition(gg_trg_Surrender_vote_for_A_2, Condition(function Trig_Surrender_vote_for_A_2Conditions))
    call TriggerAddAction(gg_trg_Surrender_vote_for_A_2, function Trig_Surrender_vote_for_A_2Actions)
endfunction
//===========================================================================
// Trigger: Surrender vote for A-3
//===========================================================================
function Trig_Surrender_vote_for_A_3Conditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0N1') and ((GetOwningPlayer(GetTriggerUnit()) == Player(5)) or (GetOwningPlayer(GetTriggerUnit()) == Player(6)) or (GetOwningPlayer(GetTriggerUnit()) == Player(7)) or (GetOwningPlayer(GetTriggerUnit()) == Player(8)) or (GetOwningPlayer(GetTriggerUnit()) == Player(9))))
endfunction
function Trig_Surrender_vote_for_A_3Actions takes nothing returns nothing
    set udg_Surrende_vote[5] = ( udg_Surrende_vote[5] + 1 )
    call DisplayTimedTextToForce( GetPlayersAll(), 30, ( ( "|cff33cccc對於投降投票目前結果 : 贊成" + I2S(udg_Surrende_vote[4]) ) + ( "/  反對" + I2S(udg_Surrende_vote[5]) ) ) )
    call SetPlayerAbilityAvailableBJ( false, 'A0N1', GetOwningPlayer(GetTriggerUnit()) )
    call SetPlayerAbilityAvailableBJ( false, 'A0J8', GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_Surrender_vote_for_A_3 takes nothing returns nothing
    set gg_trg_Surrender_vote_for_A_3 = CreateTrigger()
    call DisableTrigger(gg_trg_Surrender_vote_for_A_3)
    call TriggerAddCondition(gg_trg_Surrender_vote_for_A_3, Condition(function Trig_Surrender_vote_for_A_3Conditions))
    call TriggerAddAction(gg_trg_Surrender_vote_for_A_3, function Trig_Surrender_vote_for_A_3Actions)
endfunction
//===========================================================================
// Trigger: Surrender vote for B
//===========================================================================
function Trig_Surrender_vote_for_BConditions takes nothing returns boolean
    return ((IsTriggerEnabled(GetTriggeringTrigger()) == true) and ((GetOwningPlayer(GetTriggerUnit()) == Player(0)) or (GetOwningPlayer(GetTriggerUnit()) == Player(1)) or (GetOwningPlayer(GetTriggerUnit()) == Player(2)) or (GetOwningPlayer(GetTriggerUnit()) == Player(3)) or (GetOwningPlayer(GetTriggerUnit()) == Player(4))) and (GetSpellAbilityId() == 'A0HY'))
endfunction
function Trig_Surrender_vote_for_BActions takes nothing returns nothing
    call DisableTrigger( GetTriggeringTrigger() )
    call DisableTrigger( gg_trg_Surrender_vote_for_A )
    set udg_Surrende_vote[0] = 0
    set udg_Surrende_vote[1] = 0
    set udg_Surrende_vote[3] = 0
    call DisplayTimedTextToForce( GetPlayersAll(), 30, ( ( "|cffff0000" + GetPlayerName(GetTriggerPlayer()) ) + "發起了投降的投票，請選取個人倉庫，點選\"同意投降\"或是\"反對投降\"來投票，投票將會在1分鐘之後結算，沒有投票者不計算" ) )
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ((GetPlayerSlotState(ConvertedPlayer(GetForLoopIndexA())) == PLAYER_SLOT_STATE_PLAYING) and (GetPlayerController(ConvertedPlayer(GetForLoopIndexA())) == MAP_CONTROL_USER)) then
            set udg_Surrende_vote[3] = ( udg_Surrende_vote[3] + 1 )
        else
        endif
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerAbilityAvailableBJ( true, 'A0N1', ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAbilityAvailableBJ( true, 'A0J8', ConvertedPlayer(GetForLoopIndexA()) )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call EnableTrigger( gg_trg_Surrender_vote_for_B_2 )
    call EnableTrigger( gg_trg_Surrender_vote_for_B_3 )
    call YDWEPolledWaitNull(60.00)
    if ((udg_Surrende_vote[0] >= ( udg_Surrende_vote[3] - 1 ))) then
        call KillUnit( gg_unit_ntn2_0009 )
    else
        call DisplayTimedTextToForce( GetPlayersAll(), 30, "TRIGSTR_6479" )
    endif
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerAbilityAvailableBJ( false, 'A0N1', ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAbilityAvailableBJ( false, 'A0J8', ConvertedPlayer(GetForLoopIndexA()) )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call YDWEPolledWaitNull(300.00)
    call EnableTrigger( GetTriggeringTrigger() )
    call EnableTrigger( gg_trg_Surrender_vote_for_A )
endfunction
//===========================================================================
function InitTrig_Surrender_vote_for_B takes nothing returns nothing
    set gg_trg_Surrender_vote_for_B = CreateTrigger()
    call DisableTrigger(gg_trg_Surrender_vote_for_B)
    call TriggerAddCondition(gg_trg_Surrender_vote_for_B, Condition(function Trig_Surrender_vote_for_BConditions))
    call TriggerAddAction(gg_trg_Surrender_vote_for_B, function Trig_Surrender_vote_for_BActions)
endfunction
//===========================================================================
// Trigger: Surrender vote for B-2
//===========================================================================
function Trig_Surrender_vote_for_B_2Conditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0J8') and ((GetOwningPlayer(GetTriggerUnit()) == Player(0)) or (GetOwningPlayer(GetTriggerUnit()) == Player(1)) or (GetOwningPlayer(GetTriggerUnit()) == Player(2)) or (GetOwningPlayer(GetTriggerUnit()) == Player(3)) or (GetOwningPlayer(GetTriggerUnit()) == Player(4))))
endfunction
function Trig_Surrender_vote_for_B_2Actions takes nothing returns nothing
    set udg_Surrende_vote[0] = ( udg_Surrende_vote[0] + 1 )
    call DisplayTimedTextToForce( GetPlayersAll(), 30, ( ( "|cff33cccc對於投降投票目前結果 : 贊成" + I2S(udg_Surrende_vote[0]) ) + ( "/  反對" + I2S(udg_Surrende_vote[1]) ) ) )
    call SetPlayerAbilityAvailableBJ( false, 'A0N1', GetOwningPlayer(GetTriggerUnit()) )
    call SetPlayerAbilityAvailableBJ( false, 'A0J8', GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_Surrender_vote_for_B_2 takes nothing returns nothing
    set gg_trg_Surrender_vote_for_B_2 = CreateTrigger()
    call DisableTrigger(gg_trg_Surrender_vote_for_B_2)
    call TriggerAddCondition(gg_trg_Surrender_vote_for_B_2, Condition(function Trig_Surrender_vote_for_B_2Conditions))
    call TriggerAddAction(gg_trg_Surrender_vote_for_B_2, function Trig_Surrender_vote_for_B_2Actions)
endfunction
//===========================================================================
// Trigger: Surrender vote for B-3
//===========================================================================
function Trig_Surrender_vote_for_B_3Conditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0N1') and ((GetOwningPlayer(GetTriggerUnit()) == Player(0)) or (GetOwningPlayer(GetTriggerUnit()) == Player(1)) or (GetOwningPlayer(GetTriggerUnit()) == Player(2)) or (GetOwningPlayer(GetTriggerUnit()) == Player(3)) or (GetOwningPlayer(GetTriggerUnit()) == Player(4))))
endfunction
function Trig_Surrender_vote_for_B_3Actions takes nothing returns nothing
    set udg_Surrende_vote[1] = ( udg_Surrende_vote[1] + 1 )
    call DisplayTimedTextToForce( GetPlayersAll(), 30, ( ( "|cff33cccc對於投降投票目前結果 : 贊成" + I2S(udg_Surrende_vote[0]) ) + ( "/  反對" + I2S(udg_Surrende_vote[1]) ) ) )
    call SetPlayerAbilityAvailableBJ( false, 'A0N1', GetOwningPlayer(GetTriggerUnit()) )
    call SetPlayerAbilityAvailableBJ( false, 'A0J8', GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_Surrender_vote_for_B_3 takes nothing returns nothing
    set gg_trg_Surrender_vote_for_B_3 = CreateTrigger()
    call DisableTrigger(gg_trg_Surrender_vote_for_B_3)
    call TriggerAddCondition(gg_trg_Surrender_vote_for_B_3, Condition(function Trig_Surrender_vote_for_B_3Conditions))
    call TriggerAddAction(gg_trg_Surrender_vote_for_B_3, function Trig_Surrender_vote_for_B_3Actions)
endfunction
//===========================================================================
// Trigger: RP
//===========================================================================
function Trig_RPConditions takes nothing returns boolean
    return ((IsUnitType(GetTriggerUnit(), UNIT_TYPE_STRUCTURE) == true))
endfunction
function Trig_RPActions takes nothing returns nothing
endfunction
//===========================================================================
function InitTrig_RP takes nothing returns nothing
    set gg_trg_RP = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_RP, Player(0), "", false )
    call TriggerAddCondition(gg_trg_RP, Condition(function Trig_RPConditions))
    call TriggerAddAction(gg_trg_RP, function Trig_RPActions)
endfunction
//===========================================================================
// Trigger: MulitiBoard Init
//===========================================================================
//初始化 記分板
function Trig_MulitiBoard_Intiti_Actions takes nothing returns nothing
local integer i 
	call CreateMultiboardBJ(7,11,("|cffffcc00信長之野望|r"))
	call YDWEMultiboardSetItemStyleBJNull(bj_lastCreatedMultiboard,0,0,true,false)
	call YDWEMultiboardSetItemStyleBJNull(bj_lastCreatedMultiboard,1,0,true,true)
	call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard,0,0,("--"))
	call YDWEMultiboardSetItemWidthBJNull(bj_lastCreatedMultiboard,1,0,8.70)
	call YDWEMultiboardSetItemWidthBJNull(bj_lastCreatedMultiboard,2,0,2.00)
	call YDWEMultiboardSetItemWidthBJNull(bj_lastCreatedMultiboard,3,0,1.80)
	call YDWEMultiboardSetItemWidthBJNull(bj_lastCreatedMultiboard,4,0,1.80)
	call YDWEMultiboardSetItemWidthBJNull(bj_lastCreatedMultiboard,5,0,1.80)
	call YDWEMultiboardSetItemWidthBJNull(bj_lastCreatedMultiboard,6,0,1.80)
	call YDWEMultiboardSetItemWidthBJNull(bj_lastCreatedMultiboard,7,0,1.80)
	call YDWEMultiboardSetItemStyleBJNull(bj_lastCreatedMultiboard,1,1,false,false)
	
	//文本
	call YDWEMultiboardSetItemValueBJNull(GetLastCreatedMultiboard(),2,1,("殲敵"))
	call YDWEMultiboardSetItemValueBJNull(GetLastCreatedMultiboard(),3,1,("斬殺"))
	call YDWEMultiboardSetItemValueBJNull(GetLastCreatedMultiboard(),4,1,("敗陣"))
	call YDWEMultiboardSetItemValueBJNull(GetLastCreatedMultiboard(),5,1,("助攻"))
	call YDWEMultiboardSetItemValueBJNull(GetLastCreatedMultiboard(),6,1,("破陣"))
	call YDWEMultiboardSetItemValueBJNull(GetLastCreatedMultiboard(),7,1,("休養"))
	//顏色
	call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 3, 1 , 100, 0.00, 0.00, 0 )
	call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 4, 1 , 0.00, 42.30, 85.10, 0 )
	call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 6, 1 , 100.00, 50.00, 0.00, 0 )
	call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 5, 1 , 0.00, 100.00, 0.00, 0 )
	call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 7, 1 , 100, 100.00, 100.00, 0 )
	
	set i=2
		loop
			exitwhen i>11
			//設定圖標
			call YDWEMultiboardSetItemIconBJNull(bj_lastCreatedMultiboard,1,i,"ReplaceableTextures\\WorldEditUI\\Editor-Random-Unit.blp")
				if GetPlayerSlotState(Player(i-2))==PLAYER_SLOT_STATE_EMPTY then
					call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard,0,i,20.00,20.00,20.00,0)
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard,1,i,("未出戰"))
				else
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard, 1, i , GetPlayerName(ConvertedPlayer((i-1))))
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard, 2, i , "0")
					
		            call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 3, i , 100, 0.00, 0.00, 0 )
		            call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 4, i , 0.00, 42.30, 85.10, 0 )
		            call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 6, i , 100.00, 50.00, 0.00, 0 )
		            call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 5, i , 0.00, 100.00, 0.00, 0 )
		            call YDWEMultiboardSetItemColorBJNull(bj_lastCreatedMultiboard, 7, i , 100, 100.00, 100.00, 0 )
					
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard,3,i,"0")
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard,4,i,"0")
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard,5,i,"0")
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard,6,i,"0")
					call YDWEMultiboardSetItemValueBJNull(bj_lastCreatedMultiboard,7,i,"0") 
					//call MultiboardSetItemValueBJ(bj_lastCreatedMultiboard,3,i,("|cFFFF3900"+(I2S(0)+"|r")))
					//call MultiboardSetItemValueBJ(bj_lastCreatedMultiboard,4,i,("|cFF006CD9"+(I2S(0)+"|r")))
					//call MultiboardSetItemValueBJ(bj_lastCreatedMultiboard,5,i,("|cFF00FF00"+(I2S(0)+"|r")))
					//call MultiboardSetItemValueBJ(bj_lastCreatedMultiboard,6,i,("|cFFFFdead"+(I2S(0)+"|r")))
					//call MultiboardSetItemValueBJ(bj_lastCreatedMultiboard,7,i,("|cFFC0C0C0"+(I2S(0)+"|r")))
				endif
			set i=i+1
		endloop
	set udg_DMB = bj_lastCreatedMultiboard
	call MultiboardMinimize(bj_lastCreatedMultiboard, true)
	call DestroyTrigger(GetTriggeringTrigger())
endfunction
function Trig_Board_Time_RefeshActions takes nothing returns nothing
local string s	
local integer i
local integer i2
local integer i3
local integer i4
local integer i5
local integer i6
local integer id
	//舊版
   	set udg_time_s = udg_time_s + 1 
	    if udg_time_s == 60 then
	        set udg_time_s = 0
	        set udg_time_m = udg_time_m + 1 
	    endif
	    if udg_time_m == 60 then
	        set udg_time_m = 0
	        set udg_time_h = udg_time_h + 1 
	    endif
	    // 面板標提
	    if udg_time_h == 0 then
	        set udg_tmpS = ""
	    else
	        set udg_tmpS = "|CFFFEBA0E" + I2S(udg_time_h) + ":" 
	    endif
	    if udg_time_m < 10 then
	        set udg_tmpS = udg_tmpS + "0" + I2S(udg_time_m) + ":" 
	    else
	        set udg_tmpS = udg_tmpS + I2S(udg_time_m) + ":" 
	    endif
	    if udg_time_s < 10 then
	        set udg_tmpS = udg_tmpS + "0" + I2S(udg_time_s) 
	    else
	        set udg_tmpS = udg_tmpS + I2S(udg_time_s) + "" 
	    endif
	    
	//新版
	set udg_time_R = udg_time_R + 1
    
    if udg_computer_B then
		//織田軍
		set i = udg_S17_kill_H_num[1]+udg_S17_kill_H_num[2]+udg_S17_kill_H_num[3]+udg_S17_kill_H_num[4]+udg_S17_kill_H_num[5]
		set i2 = udg_S12_Building[1]+udg_S12_Building[2]+udg_S12_Building[3]+udg_S12_Building[4]+udg_S12_Building[5]
		set i5 = udg_S03_number_kill[1]+udg_S03_number_kill[2]+udg_S03_number_kill[3]+udg_S03_number_kill[4]+udg_S03_number_kill[5]
		//聯合軍
		set i3 = udg_S17_kill_H_num[6]+udg_S17_kill_H_num[7]+udg_S17_kill_H_num[8]+udg_S17_kill_H_num[9]+udg_S17_kill_H_num[10]
		set i4 = udg_S12_Building[6]+udg_S12_Building[7]+udg_S12_Building[8]+udg_S12_Building[9]+udg_S12_Building[10]
		set i6 = udg_S03_number_kill[6]+udg_S03_number_kill[7]+udg_S03_number_kill[8]+udg_S03_number_kill[9]+udg_S03_number_kill[10]
    	set s ="(織田:聯合) "+"殲敵 " + I2S(i5) + ":" + I2S(i6)+" 殺敵 " + I2S(i) + ":" + I2S(i3) + " 破陣 " + I2S(i2) + ":" + I2S(i4)
		call MultiboardSetTitleText( udg_DMB, s )
		//判斷武將賞金
		set id = GetPlayerId( GetLocalPlayer())+1
			if udg_S11_Money_Number[id]>700 then
				set udg_S11_Money_Number[id]=700
			elseif udg_S11_Money_Number[id]<75 then
				set udg_S11_Money_Number[id]=75 
			endif
		//更新標題	
		call TimerDialogSetTitle( bj_lastCreatedTimerDialog, " 武將賞金 " + I2S(udg_S11_Money_Number[id]) )
			
	else 
	    call MultiboardSetTitleText( udg_DMB, "|cffffcc00信長之野望|r　" + udg_tmpS )
	endif 
	
endfunction
//復活計時
function Trig_Hero_Revive_PlusActions takes nothing returns nothing
local integer i = 1
	//計時、分、秒
	call Trig_Board_Time_RefeshActions()	
    set i = 1
    loop
        exitwhen i > 10
        
	        if udg_Hero_Number_ReviveTime[i] > 0 then
	            set udg_Hero_Number_ReviveTime[i] = ( udg_Hero_Number_ReviveTime[i] - 1 )
	            //call MultiboardSetItemValueBJ( bj_lastCreatedMultiboard, 7,  i + 1 , I2S(udg_Hero_Number_ReviveTime[i]) )
	            call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, i, 6), I2S(udg_Hero_Number_ReviveTime[i]) )
	        else
	            set udg_Hero_Number_ReviveTime[i] = -1
	        endif
	        
        set i = i + 1
    endloop
endfunction
//Init
function InitTrig_MulitiBoard_Init takes nothing returns nothing
local trigger ltt 
local timer t	
    set ltt = CreateTrigger( )
    call TriggerRegisterTimerEvent(ltt, 0.00, false)
    call TriggerAddAction( ltt, function Trig_MulitiBoard_Intiti_Actions )
    set t = CreateTimer( )
    call TimerStart(t,1.00,true,function Trig_Hero_Revive_PlusActions)
	//區分織田軍、聯合軍
		if GetPlayerId(GetLocalPlayer())+1 <=4 then
			set udg_computer_B2 = true
		endif	
    
set ltt = null
set t = null 
endfunction
globals
real udg_time_R = 0.00
boolean udg_computer_B = false
boolean udg_computer_B2 = false
endglobals//===========================================================================
// Trigger: Player Leave
//===========================================================================
function Trig_Player_Leave_Actions_for_Gold2zero takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local player p = LoadPlayerHandle(YDHT,h2i,5566)
	call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,0)
	call SetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER,0)
	
set t = null
set p = null
endfunction
function Trig_Player_Leave_Actions takes nothing returns nothing
local string s = "|cffffcc00" + GetPlayerName(GetTriggerPlayer()) + "|r逃離戰場，將他的黃金以及兵力均分給其他友軍玩家。" 
local integer i = 0
local integer i2 = 0
local player p = GetTriggerPlayer()
local integer money = 1
local integer lumber = 1 
local integer int = 0
local boolean b = false
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
		//這裡是同盟離線 補償系統
	    if IsPlayerEnemy(p, Player(0)) then
	        if udg_High_Boolen then
	            set udg_Pay_Money2 = udg_Pay_Money2 + 4 
	        else
	            set udg_Pay_Money2 = udg_Pay_Money2 + 1 
	        endif
	    else
	        if udg_High_Boolen then
	            set udg_Pay_money = udg_Pay_money + 4 
	        else
	            set udg_Pay_money = udg_Pay_money + 1 
	        endif
	    endif
	    if gg_snd_Warning != null then
	        call StartSound(gg_snd_Warning)
	    endif
	    
		if IsPlayerInForce(GetLocalPlayer(), bj_FORCE_ALL_PLAYERS) then
        	// Use only local code (no net traffic) within this block to avoid desyncs.
        	call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, s)
    	endif
    	//一定要等待 要不然分母 會 + 1 
    	//事件發動-> 等待 X 秒 ->判斷玩家已經離開
		call TriggerSleepAction(0.00)
		//確定分錢分母
		set i = 0
		loop
			exitwhen i > 9
				if IsPlayerAlly(Player(i), p) and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING then 
					set int = int + 1
					set b = true
				endif
			set i = i + 1
		endloop 
		//避免分母=0
			if b == false then
				set int = 1
			endif
		set lumber = GetPlayerState(GetTriggerPlayer(), PLAYER_STATE_RESOURCE_LUMBER) / int
		set money = GetPlayerState(GetTriggerPlayer(), PLAYER_STATE_RESOURCE_GOLD) / int
		//分錢
		set i = 0
		loop
			exitwhen i > 9
				if IsPlayerAlly(Player(i), p) and GetPlayerSlotState(Player(i))==PLAYER_SLOT_STATE_PLAYING then 
					call SetPlayerAllianceStateBJ( GetTriggerPlayer(), Player(i), bj_ALLIANCE_ALLIED_UNITS )
					
					call SetPlayerState(Player(i), PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(Player(i), PLAYER_STATE_RESOURCE_GOLD) + money)
					call SetPlayerState(Player(i), PLAYER_STATE_RESOURCE_LUMBER, GetPlayerState(Player(i), PLAYER_STATE_RESOURCE_LUMBER) + lumber)
				endif
			set i = i + 1
		endloop	
		//計分板
		set i = GetPlayerId(p) + 1
		call YDWEMultiboardSetItemColorBJNull( udg_DMB, 0, i+1 , 25.00, 25.00, 25.00, 0 )
		call KillUnit( udg_S16_U[i] )
	
		//每兩秒歸0資源
		call SavePlayerHandle(YDHT,h2i,5566,p)
		call TimerStart(t,4.00,true,function Trig_Player_Leave_Actions_for_Gold2zero)
		
set s = null
set p = null
set t = null
endfunction
function InitTrig_Player_Leave takes nothing returns nothing
local trigger ltt = CreateTrigger()
local integer i = 0
	loop 
		exitwhen i > 9	
    	call TriggerRegisterPlayerEvent(ltt, Player(i), EVENT_PLAYER_LEAVE)
    	set i = i + 1
    endloop	
    call TriggerAddAction( ltt, function Trig_Player_Leave_Actions )
set ltt = null 
endfunction
//===========================================================================
// Trigger: GetPlayerNumber
//===========================================================================
function Trig_GetPlayerNumberActions takes nothing returns nothing
    set udg_Players_group[0] = CreateForce()
    set udg_Players_group[1] = CreateForce()
    // 只要有一個玩者是使用者控制 玩者數就+1
    set udg_Delete_time = 0
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if (((GetPlayerController(ConvertedPlayer(GetForLoopIndexA())) == MAP_CONTROL_USER) and (GetPlayerSlotState(ConvertedPlayer(GetForLoopIndexA())) == PLAYER_SLOT_STATE_PLAYING))) then
            set udg_Delete_time = ( udg_Delete_time + 1 )
            // 這邊是用來記錄 玩家1、2玩家組
            if ((IsPlayerEnemy(ConvertedPlayer(GetForLoopIndexA()), Player(0)) == true)) then
                call ForceAddPlayerSimple( ConvertedPlayer(GetForLoopIndexA()), udg_Players_group[1] )
            else
                call ForceAddPlayerSimple( ConvertedPlayer(GetForLoopIndexA()), udg_Players_group[0] )
            endif
        else
        endif
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    if ((udg_Delete_time > 1)) then
    else
        // 只有一人  因此開啟單機模式
        call DisplayTimedTextToForce( GetPlayersAll(), 30.00, "TRIGSTR_2908" )
        set udg_single_player = true
        call EnableTrigger( gg_trg_Get_last_selected_unit )
        call EnableTrigger( gg_trg_HM )
        call EnableTrigger( gg_trg_GOLD )
        call EnableTrigger( gg_trg_CD )
        call EnableTrigger( gg_trg_LV )
    endif
    call DisableTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_GetPlayerNumber takes nothing returns nothing
    set gg_trg_GetPlayerNumber = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_GetPlayerNumber, 0.00 )
    call TriggerAddAction(gg_trg_GetPlayerNumber, function Trig_GetPlayerNumberActions)
endfunction
//===========================================================================
// Trigger: Random Hero
//===========================================================================
function Trig_Random_HeroConditions takes nothing returns boolean
    return (((udg_S01_hero_of_player[GetConvertedPlayerId(GetTriggerPlayer())] == null) or (udg_single_player == true)))
endfunction
function Trig_Random_HeroActions takes nothing returns nothing
local player TempPlayer = GetTriggerPlayer()
local integer TempInteger = GetConvertedPlayerId(TempPlayer)
local unit RandomUnit 
local real x
local real y
local integer i 
local integer UnitTypeId
local item itt = CreateItem('fgrg', 0, 0)
local integer id 
    if TempInteger <=5 then
	    set x = 7147.0
	    set y = -7410.0 
	    set RandomUnit = PlaceRandomUnit(udg_UnitPool, TempPlayer, x, y, 270)
	else
		set x = -7292.7
		set y = 7087.5
	    set RandomUnit = PlaceRandomUnit(udg_UnitPool, TempPlayer, x, y, 270)
	endif 
	//傳遞用
	set udg_S01_hero_of_player[TempInteger] = RandomUnit
	set hero[TempInteger] = RandomUnit
	set udg_A_common_HERO = RandomUnit
	//鏡頭
    if (GetLocalPlayer() == TempPlayer) then
        // Use only local code (no net traffic) within this block to avoid desyncs.
        call PanCameraToTimed(x, y, 0.1)
    endif
	//禁止選同樣角色-1
	call UnitPoolRemoveUnitType( udg_UnitPool, GetUnitTypeId(RandomUnit) )
	//禁止選同樣角色-2
	set UnitTypeId = GetUnitTypeId(RandomUnit)
	//如果 SM 模式開啟
	set id = GetUnitPointValue(RandomUnit)
	if udg_SM_B then
		if	id == 326 then
			set i = 0
		    loop
			    exitwhen i>9
			    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
				set i = i + 1
			endloop
		else	
			if TempInteger <=5 then
				set i = 0
			    loop
				    exitwhen i>4
				    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
					set i = i + 1
				endloop 
			else
				set i = 5
			    loop
				    exitwhen i>9
				    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
					set i = i + 1
				endloop 
			endif 
		endif	
	else	
		set i = 0
		    loop
			    exitwhen i>9
			    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
				set i = i + 1
			endloop
	endif	
	//-v 還是可以V到
	//假如不是單機 禁止複選英雄
	if udg_single_player == false then
		set i = 0
    		loop
	    		exitwhen i>95
				call SetPlayerTechMaxAllowed(TempPlayer, udg_S01_hero_list[i], 0)
				set i = i + 1
			endloop 
	endif	
	//馬卷
	// Create the item at the hero's feet first, and then give it to him.
	// This is to ensure that the item will be left at the hero's feet if
	// his inventory is full. 
	call UnitAddItem(RandomUnit, itt)
	//特效
	call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",RandomUnit,"overhead") )
	//-v 獎勵
	call SetPlayerState(TempPlayer, PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(TempPlayer, PLAYER_STATE_RESOURCE_GOLD) + 300)
	//選擇英雄
	    if (GetLocalPlayer() == TempPlayer) then
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call ClearSelection()
	        call SelectUnit(RandomUnit, true)
	    endif
	// 玩家選擇英雄之後，在玩家ID後面加上所選擇的英雄名
	call SetPlayerName( TempPlayer, ( udg_N01_name3[TempInteger] + ( "(" + ( GetHeroProperName(RandomUnit) + ")" ) ) ) )
	// 英雄圖標
	call YDWEMultiboardSetItemIconBJNull( udg_DMB, 0, TempInteger+1 , udg_S12_Picture[id] )
	// 刪除靈魂
	set udg_Delete_time2 = ( udg_Delete_time2 + 1 )
	call ConditionalTriggerExecute( gg_trg_Delete_Delete_time1_time2 )
	// 英雄相關事件登錄
	call TriggerRegisterUnitEvent(gg_trg_Hero_Demaged, RandomUnit, EVENT_UNIT_DAMAGED)
	//物品技能登記
	call TriggerRegisterUnitEvent(gg_trg_Hero_Spell_Item_Ability, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
	call TriggerRegisterUnitEvent(gg_trg_Unit_Spell_Cast, RandomUnit, EVENT_UNIT_SPELL_CAST)
	//註冊英雄死亡事件
	call TriggerRegisterUnitEvent(gg_trg_Hero_Unit_Dead, RandomUnit, EVENT_UNIT_DEATH)
	//英雄技能註冊
	if udg_Hero_Trigger[id] != null then
		if TriggerEvaluate(udg_Hero_Trigger[id]) then
			call TriggerExecute(udg_Hero_Trigger[id])
		endif	
	else
		call Hero_INIT(RandomUnit,id) 
	endif 
set itt = null
set RandomUnit = null
set TempPlayer = null
endfunction
//===========================================================================
function InitTrig_Random_Hero takes nothing returns nothing
    set gg_trg_Random_Hero = CreateTrigger()
    call DisableTrigger(gg_trg_Random_Hero)
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(0), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(1), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(2), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(3), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(4), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(5), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(6), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(7), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(8), "-v", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_Random_Hero, Player(9), "-v", true )
    call TriggerAddCondition(gg_trg_Random_Hero, Condition(function Trig_Random_HeroConditions))
    call TriggerAddAction(gg_trg_Random_Hero, function Trig_Random_HeroActions)
endfunction
//===========================================================================
// Trigger: CRAZY
//
// gg_trg_C10W_Damage
//===========================================================================
function Trig_CRAZYActions_Play takes nothing returns nothing
local player TempPlayer = GetEnumPlayer()
local integer TempInteger = GetConvertedPlayerId(TempPlayer)
local unit RandomUnit 
local real x
local real y
local integer i 
local integer UnitTypeId 
local item itt = CreateItem('fgrg', 0, 0)
local integer id 
		    if TempInteger <=5 then
			    set x = 7147.0
			    set y = -7410.0 
			    set RandomUnit = CreateUnit( TempPlayer, udg_S01_hero_list[rose_integer], x, y, bj_UNIT_FACING )
			else
				set x = -7292.7
				set y = 7087.5	
				set RandomUnit = CreateUnit( TempPlayer, udg_S01_hero_list[rose_integer], x, y, bj_UNIT_FACING )
			endif 
		//傳遞用
		set udg_S01_hero_of_player[TempInteger] = RandomUnit
		set hero[TempInteger] = RandomUnit
		set udg_A_common_HERO = RandomUnit
		//鏡頭
		    if (GetLocalPlayer() == TempPlayer) then
		        // Use only local code (no net traffic) within this block to avoid desyncs.
		        call PanCameraToTimed(x, y, 0.1)
		    endif
		//假如不是單機 禁止複選英雄
			if udg_single_player == false then
				set i = 0
		    		loop
			    		exitwhen i>95
						call SetPlayerTechMaxAllowed(TempPlayer, udg_S01_hero_list[i], 0)
						set i = i + 1
					endloop 
			endif	
		//馬卷
		// Create the item at the hero's feet first, and then give it to him.
		// This is to ensure that the item will be left at the hero's feet if
		// his inventory is full. 
		call UnitAddItem(RandomUnit, itt)
		//特效
		call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",RandomUnit,"overhead") )
		//選擇英雄
		    if (GetLocalPlayer() == TempPlayer) then
		        // Use only local code (no net traffic) within this block to avoid desyncs.
		        call ClearSelection()
		        call SelectUnit(RandomUnit, true)
		    endif
		// 玩家選擇英雄之後，在玩家ID後面加上所選擇的英雄名
		call SetPlayerName( TempPlayer, ( udg_N01_name3[TempInteger] + ( "(" + ( GetHeroProperName(RandomUnit) + ")" ) ) ) )
		// 英雄圖標
		set id = GetUnitPointValue(RandomUnit)
		call YDWEMultiboardSetItemIconBJNull( udg_DMB, 0, TempInteger+1 , udg_S12_Picture[id] )
		// 刪除靈魂
		set udg_Delete_time2 = ( udg_Delete_time2 + 1 )
		call ConditionalTriggerExecute( gg_trg_Delete_Delete_time1_time2 )
		// 英雄相關事件登錄
		call TriggerRegisterUnitEvent(gg_trg_Hero_Demaged, RandomUnit, EVENT_UNIT_DAMAGED)
		//物品技能登記
		call TriggerRegisterUnitEvent(gg_trg_Hero_Spell_Item_Ability, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
		call TriggerRegisterUnitEvent(gg_trg_Unit_Spell_Cast, RandomUnit, EVENT_UNIT_SPELL_CAST)
		//註冊英雄死亡事件
		call TriggerRegisterUnitEvent(gg_trg_Hero_Unit_Dead, RandomUnit, EVENT_UNIT_DEATH)
          	//英雄技能註冊
		if udg_Hero_Trigger[id] != null then 
			if TriggerEvaluate(udg_Hero_Trigger[id]) then
				call TriggerExecute(udg_Hero_Trigger[id])
			endif	
		else
			call Hero_INIT(RandomUnit,id) 
		endif 
set RandomUnit = null
set TempPlayer = null 
set itt = null 
endfunction
function Trig_CRAZYActions_Func007001001 takes nothing returns boolean
return ( GetPlayerSlotState(GetFilterPlayer()) == PLAYER_SLOT_STATE_PLAYING )
endfunction
function Trig_CRAZYActions takes nothing returns nothing
		//////////////
		//sound
		//////////////
	    if (gg_snd_GoodJob != null) then
	        call StartSound(gg_snd_GoodJob)
	    endif 
	/////////////////////
    //避免選到小早
    ///////////////////// 
    set udg_S01_hero_list[72] = 'O01C' 
	/////////////////
	//隨機挑選英雄
	/////////////////    	
	set rose_integer = GetRandomInt(0, 95)
    set udg_CRAZY_B = true
    /////////////////////
    call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "<<已經啟動 |cffffcc00-crazy(大亂鬥)|r模式>>" + "，將會十名相同武將出陣作戰" ) ) 
    call ForForce( YDWEGetPlayersMatchingNull(Condition(function Trig_CRAZYActions_Func007001001)), function Trig_CRAZYActions_Play )
    //////////////////////
    //避免多選 BUG
    //////////////////////
	call DisableTrigger( gg_trg_Random_Hero )
	call DisableTrigger( gg_trg_CRAZY )
	call DisableTrigger( gg_trg_AH_Mode )
endfunction
//===========================================================================
function InitTrig_CRAZY takes nothing returns nothing
    set gg_trg_CRAZY = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_CRAZY, Player(0), "-CRAZY", true )
    call TriggerAddAction(gg_trg_CRAZY, function Trig_CRAZYActions)
endfunction
//===========================================================================
// Trigger: AH Mode
//
// gg_trg_AH_Mode
//===========================================================================
function Trig_AH_Heros_Func007001001 takes nothing returns boolean
return ( GetPlayerSlotState(GetFilterPlayer()) == PLAYER_SLOT_STATE_PLAYING )
endfunction
function Trig_AH_Choose takes nothing returns nothing
local player TempPlayer = GetEnumPlayer()
local integer TempInteger = GetConvertedPlayerId(TempPlayer)
local unit RandomUnit 
local real x
local real y
local integer i 
local integer UnitTypeId
local item itt = CreateItem('fgrg', 0, 0)
local integer id 
    if TempInteger <=5 then
	    set x = 7147.0
	    set y = -7410.0 
	    set RandomUnit = PlaceRandomUnit(udg_UnitPool, TempPlayer, x, y, 270)
	else
		set x = -7292.7
		set y = 7087.5	
	    set RandomUnit = PlaceRandomUnit(udg_UnitPool, TempPlayer, x, y, 270)
	endif 
//禁止選同樣角色-1
call UnitPoolRemoveUnitType( udg_UnitPool, GetUnitTypeId(RandomUnit) )	
//傳遞用
set udg_S01_hero_of_player[TempInteger] = RandomUnit
set hero[TempInteger] = RandomUnit
set udg_A_common_HERO = RandomUnit
//鏡頭
    if (GetLocalPlayer() == TempPlayer) then
        // Use only local code (no net traffic) within this block to avoid desyncs.
        call PanCameraToTimed(x, y, 0.1)
    endif
//假如不是單機 禁止複選英雄
	if udg_single_player == false then
		set i = 0
    		loop
	    		exitwhen i>95
				call SetPlayerTechMaxAllowed(TempPlayer, udg_S01_hero_list[i], 0)
				set i = i + 1
			endloop 
	endif	
//馬卷
// Create the item at the hero's feet first, and then give it to him.
// This is to ensure that the item will be left at the hero's feet if
// his inventory is full. 
call UnitAddItem(RandomUnit, itt)
//特效
call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",RandomUnit,"overhead") )
//選擇英雄
    if (GetLocalPlayer() == TempPlayer) then
        // Use only local code (no net traffic) within this block to avoid desyncs.
        call ClearSelection()
        call SelectUnit(RandomUnit, true)
    endif
// 玩家選擇英雄之後，在玩家ID後面加上所選擇的英雄名
call SetPlayerName( TempPlayer, ( udg_N01_name3[TempInteger] + ( "(" + ( GetHeroProperName(RandomUnit) + ")" ) ) ) )
// 英雄圖標
set id = GetUnitPointValue(RandomUnit)
call YDWEMultiboardSetItemIconBJNull( udg_DMB, 0, TempInteger+1 , udg_S12_Picture[id] )
// 刪除靈魂
set udg_Delete_time2 = ( udg_Delete_time2 + 1 )
call ConditionalTriggerExecute( gg_trg_Delete_Delete_time1_time2 )
// 英雄相關事件登錄
call TriggerRegisterUnitEvent(gg_trg_Hero_Demaged, RandomUnit, EVENT_UNIT_DAMAGED)
//註冊英雄死亡事件
call TriggerRegisterUnitEvent(gg_trg_Hero_Unit_Dead, RandomUnit, EVENT_UNIT_DEATH)
//物品技能登記
call TriggerRegisterUnitEvent(gg_trg_Hero_Spell_Item_Ability, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(gg_trg_Unit_Spell_Cast, RandomUnit, EVENT_UNIT_SPELL_CAST)
	//英雄技能註冊
	if udg_Hero_Trigger[id] != null then
		if TriggerEvaluate(udg_Hero_Trigger[id]) then
			call TriggerExecute(udg_Hero_Trigger[id])
		endif	
	else
		call Hero_INIT(RandomUnit,id) 
	endif 
set RandomUnit = null
set TempPlayer = null
set itt = null
endfunction
function Trig_AH_Heros_Actions takes nothing returns nothing
    	if (gg_snd_GoodJob != null) then
        	call StartSound(gg_snd_GoodJob)
    	endif 
    call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "<<已經啟動 |cffffcc00-AH(群雄集結)|r模式>>" + "，將會從雙方及中立武將當中隨機出陣作戰" ) ) 
    call ForForce( YDWEGetPlayersMatchingNull(Condition(function Trig_AH_Heros_Func007001001)), function Trig_AH_Choose )
call DisableTrigger( gg_trg_Random_Hero )
call DisableTrigger( gg_trg_CRAZY )
call DisableTrigger( gg_trg_AH_Mode )
endfunction
//===========================================================================
function InitTrig_AH_Mode takes nothing returns nothing
    set gg_trg_AH_Mode = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_Mode, Player(0), "-AH", true )
    call TriggerAddAction(gg_trg_AH_Mode, function Trig_AH_Heros_Actions)
endfunction
//===========================================================================
// Trigger: Select Hero
//===========================================================================
globals
boolean udg_SM_B = false
endglobals 
function Trig_Select_HeroActions takes nothing returns nothing
local player TempPlayer = GetOwningPlayer(GetBuyingUnit())
local integer TempInteger = GetConvertedPlayerId(TempPlayer)
local unit RandomUnit = GetSoldUnit()
local real x
local real y
local integer i 
local integer UnitTypeId
local integer id 
local item itt = CreateItem('fgrg', 0, 0)
    if TempInteger <=5 then
	    set x = 7147.0
	    set y = -7410.0 
	    call SetUnitPosition(RandomUnit,x,y) 
	else
		set x = -7292.7
		set y = 7087.5	
		call SetUnitPosition(RandomUnit,x,y)
	endif 
//傳遞用
set udg_S01_hero_of_player[TempInteger] = RandomUnit
set hero[TempInteger] = RandomUnit
set udg_A_common_HERO = RandomUnit
//鏡頭
    if (GetLocalPlayer() == TempPlayer) then
        // Use only local code (no net traffic) within this block to avoid desyncs.
        call PanCameraToTimed(x, y, 0.1)
    endif
//禁止選同樣角色
set UnitTypeId = GetUnitTypeId(RandomUnit)
set id = GetUnitPointValue(RandomUnit)
//避免-v選同樣角色
call UnitPoolRemoveUnitType( udg_UnitPool, GetUnitTypeId(RandomUnit) )
	//如果 SM 模式開啟
	if udg_SM_B then
		if	id == 326 then
			set i = 0
		    loop
			    exitwhen i>9
			    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
				set i = i + 1
			endloop
		else	
			if TempInteger <=5 then
				set i = 0
			    loop
				    exitwhen i>4
				    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
					set i = i + 1
				endloop 
			else
				set i = 5
			    loop
				    exitwhen i>9
				    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
					set i = i + 1
				endloop 
			endif 
		endif	
	else	
		set i = 0
		    loop
			    exitwhen i>9
			    call SetPlayerTechMaxAllowed(Player(i), UnitTypeId, 0)
				set i = i + 1
			endloop
	endif 
//假如不是單機 禁止複選英雄
	if udg_single_player == false then
		set i = 0
    		loop
	    		exitwhen i>95
				call SetPlayerTechMaxAllowed(TempPlayer, udg_S01_hero_list[i], 0)
				set i = i + 1
			endloop 
	endif 
//馬卷
// Create the item at the hero's feet first, and then give it to him.
// This is to ensure that the item will be left at the hero's feet if
// his inventory is full. 
call UnitAddItem(RandomUnit, itt)
//特效
call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",RandomUnit,"overhead") )
//選擇英雄
    if (GetLocalPlayer() == TempPlayer) then
        // Use only local code (no net traffic) within this block to avoid desyncs.
        call ClearSelection()
        call SelectUnit(RandomUnit, true)
    endif
// 玩家選擇英雄之後，在玩家ID後面加上所選擇的英雄名
call SetPlayerName( TempPlayer, ( udg_N01_name3[TempInteger] + ( "(" + ( GetHeroProperName(RandomUnit) + ")" ) ) ) )
// 英雄圖標
call YDWEMultiboardSetItemIconBJNull( udg_DMB, 0, TempInteger+1 , udg_S12_Picture[id] )
// 刪除靈魂
set udg_Delete_time2 = ( udg_Delete_time2 + 1 )
call ConditionalTriggerExecute( gg_trg_Delete_Delete_time1_time2 )
// 英雄相關事件登錄
call TriggerRegisterUnitEvent(gg_trg_Hero_Demaged, RandomUnit, EVENT_UNIT_DAMAGED)
//註冊英雄死亡事件
call TriggerRegisterUnitEvent(gg_trg_Hero_Unit_Dead, RandomUnit, EVENT_UNIT_DEATH)
//物品技能登記
call TriggerRegisterUnitEvent(gg_trg_Hero_Spell_Item_Ability, RandomUnit, EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(gg_trg_Unit_Spell_Cast, RandomUnit, EVENT_UNIT_SPELL_CAST)
    //英雄技能註冊
	if udg_Hero_Trigger[id] != null then
		if TriggerEvaluate(udg_Hero_Trigger[id]) then
			call TriggerExecute(udg_Hero_Trigger[id])
		endif	
	else
		call Hero_INIT(RandomUnit,id) 
	endif 
set RandomUnit = null
set TempPlayer = null
set itt = null
endfunction
//===========================================================================
function InitTrig_Select_Hero takes nothing returns nothing
    set gg_trg_Select_Hero = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_n01L_0362, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_n00J_0364, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_ntav_0363, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_n01N_0589, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_n025_0588, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_n000_0365, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_n01I_0583, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_Select_Hero, gg_unit_n001_0584, EVENT_UNIT_SELL )
    call TriggerAddAction(gg_trg_Select_Hero, function Trig_Select_HeroActions)
endfunction
//===========================================================================
// Trigger: Hero Init
//
// -test 66
//===========================================================================
function Trig_Hero_InitActions takes nothing returns nothing
    set udg_S01_hero_list[0] = 'Nsjs'
    set udg_S01_hero_list[1] = 'Hart'
    set udg_S01_hero_list[2] = 'Hpb1'
    set udg_S01_hero_list[3] = 'Hant'
    set udg_S01_hero_list[4] = 'Etyr'
    set udg_S01_hero_list[5] = 'Hpb2'
    set udg_S01_hero_list[6] = 'Hdgo'
    set udg_S01_hero_list[7] = 'Hkal'
    set udg_S01_hero_list[8] = 'Hmbr'
    set udg_S01_hero_list[9] = 'Hlgr'
    set udg_S01_hero_list[10] = 'Edem'
    set udg_S01_hero_list[11] = 'Hpal'
    set udg_S01_hero_list[12] = 'Hmkg'
    set udg_S01_hero_list[13] = 'Nbbc'
    set udg_S01_hero_list[14] = 'Ulic'
    set udg_S01_hero_list[15] = 'Ucrl'
    set udg_S01_hero_list[16] = 'H01B'
    set udg_S01_hero_list[17] = 'H03J'
    set udg_S01_hero_list[18] = 'H00O'
    set udg_S01_hero_list[19] = 'H02X'
    set udg_S01_hero_list[20] = 'H00X'
    set udg_S01_hero_list[21] = 'H039'
    set udg_S01_hero_list[22] = 'H010'
    set udg_S01_hero_list[23] = 'H00P'
    set udg_S01_hero_list[24] = 'H01F'
    set udg_S01_hero_list[25] = 'H019'
    set udg_S01_hero_list[26] = 'H00S'
    set udg_S01_hero_list[27] = 'E00G'
    set udg_S01_hero_list[28] = 'H016'
    set udg_S01_hero_list[29] = 'H034'
    set udg_S01_hero_list[30] = 'H014'
    set udg_S01_hero_list[31] = 'O00T'
    set udg_S01_hero_list[32] = 'O01B'
    set udg_S01_hero_list[33] = 'O01E'
    set udg_S01_hero_list[34] = 'O01G'
    set udg_S01_hero_list[35] = 'U006'
    // -----------------------------------------------------------------------------------
    set udg_S01_hero_list[36] = 'Ogld'
    set udg_S01_hero_list[37] = 'Orkn'
    set udg_S01_hero_list[38] = 'Hgam'
    set udg_S01_hero_list[39] = 'Hjai'
    set udg_S01_hero_list[40] = 'Osam'
    set udg_S01_hero_list[41] = 'Ogrh'
    set udg_S01_hero_list[42] = 'Odrt'
    set udg_S01_hero_list[43] = 'Obla'
    set udg_S01_hero_list[44] = 'Ofar'
    set udg_S01_hero_list[45] = 'Otch'
    set udg_S01_hero_list[46] = 'Oshd'
    set udg_S01_hero_list[47] = 'Udre'
    set udg_S01_hero_list[48] = 'O00N'
    set udg_S01_hero_list[49] = 'O00L'
    set udg_S01_hero_list[50] = 'O00I'
    set udg_S01_hero_list[51] = 'O00F'
    set udg_S01_hero_list[52] = 'O01J'
    set udg_S01_hero_list[53] = 'H02M'
    set udg_S01_hero_list[54] = 'O003'
    set udg_S01_hero_list[55] = 'O016'
    set udg_S01_hero_list[56] = 'O00M'
    set udg_S01_hero_list[57] = 'O00G'
    set udg_S01_hero_list[58] = 'O01A'
    set udg_S01_hero_list[59] = 'O00H'
    set udg_S01_hero_list[60] = 'O00D'
    set udg_S01_hero_list[61] = 'O009'
    set udg_S01_hero_list[62] = 'O00A'
    set udg_S01_hero_list[63] = 'O01D'
    set udg_S01_hero_list[64] = 'O002'
    set udg_S01_hero_list[65] = 'O00Y'
    set udg_S01_hero_list[66] = 'O00R'
    set udg_S01_hero_list[67] = 'O006'
    set udg_S01_hero_list[68] = 'O01F'
    set udg_S01_hero_list[69] = 'O01I'
    set udg_S01_hero_list[70] = 'O00B'
    set udg_S01_hero_list[71] = 'O00J'
    set udg_S01_hero_list[72] = 'U002'
    set udg_S01_hero_list[73] = 'O018'
    set udg_S01_hero_list[74] = 'H025'
    set udg_S01_hero_list[75] = 'O019'
    set udg_S01_hero_list[76] = 'O008'
    set udg_S01_hero_list[77] = 'O01N'
    set udg_S01_hero_list[78] = 'H036'
    set udg_S01_hero_list[79] = 'O01O'
    set udg_S01_hero_list[80] = 'H02F'
    set udg_S01_hero_list[81] = 'H018'
    set udg_S01_hero_list[82] = 'E000'
    set udg_S01_hero_list[83] = 'O000'
    set udg_S01_hero_list[84] = 'O01C'
    set udg_S01_hero_list[85] = 'U005'
    set udg_S01_hero_list[86] = 'O00S'
    set udg_S01_hero_list[87] = 'O00U'
    set udg_S01_hero_list[88] = 'O00P'
    // -----------------------------------------------------------------------------------
    set udg_S01_hero_list[89] = 'Umal'
    set udg_S01_hero_list[90] = 'Uvng'
    set udg_S01_hero_list[91] = 'Hapm'
    set udg_S01_hero_list[92] = 'Othr'
    set udg_S01_hero_list[93] = 'Opgh'
    set udg_S01_hero_list[94] = 'Ntin'
    set udg_S01_hero_list[95] = 'Udea'
    // -----------------------------------------------------------------------------------
    set udg_Hero_Trigger[101] = gg_trg_A01
    set udg_Hero_Trigger[104] = gg_trg_A04
    set udg_Hero_Trigger[105] = gg_trg_A05
    set udg_Hero_Trigger[106] = gg_trg_A06
    set udg_Hero_Trigger[107] = gg_trg_A07
    set udg_Hero_Trigger[108] = gg_trg_A08
    set udg_Hero_Trigger[109] = gg_trg_A09
    set udg_Hero_Trigger[110] = gg_trg_A10
    set udg_Hero_Trigger[111] = gg_trg_A11
    set udg_Hero_Trigger[112] = gg_trg_A12
    set udg_Hero_Trigger[113] = gg_trg_A13
    set udg_Hero_Trigger[115] = gg_trg_A15
    set udg_Hero_Trigger[116] = gg_trg_A16
    set udg_Hero_Trigger[117] = gg_trg_A17
    set udg_Hero_Trigger[118] = gg_trg_A18
    set udg_Hero_Trigger[119] = gg_trg_A19
    set udg_Hero_Trigger[120] = gg_trg_A20
    set udg_Hero_Trigger[121] = gg_trg_A21
    set udg_Hero_Trigger[122] = gg_trg_A22
    set udg_Hero_Trigger[123] = gg_trg_A23
    set udg_Hero_Trigger[124] = gg_trg_A24
    set udg_Hero_Trigger[125] = gg_trg_A25
    set udg_Hero_Trigger[126] = gg_trg_A26
    set udg_Hero_Trigger[127] = gg_trg_A27
    set udg_Hero_Trigger[128] = gg_trg_A28
    set udg_Hero_Trigger[129] = gg_trg_A29
    set udg_Hero_Trigger[130] = gg_trg_A30
    set udg_Hero_Trigger[131] = gg_trg_A31
    set udg_Hero_Trigger[132] = gg_trg_A32
    set udg_Hero_Trigger[133] = gg_trg_A33
    set udg_Hero_Trigger[134] = gg_trg_A34
    set udg_Hero_Trigger[135] = gg_trg_A35
    set udg_Hero_Trigger[136] = gg_trg_A36
    // --------------------------------------------------------
    set udg_Hero_Trigger[203] = gg_trg_B03
    set udg_Hero_Trigger[206] = gg_trg_B06
    set udg_Hero_Trigger[207] = gg_trg_B07
    set udg_Hero_Trigger[208] = gg_trg_B08
    set udg_Hero_Trigger[210] = gg_trg_B10
    set udg_Hero_Trigger[211] = gg_trg_B11
    set udg_Hero_Trigger[212] = gg_trg_B12
    set udg_Hero_Trigger[213] = gg_trg_B13
    set udg_Hero_Trigger[214] = gg_trg_B14
    set udg_Hero_Trigger[216] = gg_trg_B16
    set udg_Hero_Trigger[217] = gg_trg_B17
    set udg_Hero_Trigger[218] = gg_trg_B18
    set udg_Hero_Trigger[219] = gg_trg_B19
    set udg_Hero_Trigger[221] = gg_trg_B21
    set udg_Hero_Trigger[222] = gg_trg_B22
    set udg_Hero_Trigger[223] = gg_trg_B23
    set udg_Hero_Trigger[224] = gg_trg_B24
    set udg_Hero_Trigger[225] = gg_trg_B25
    set udg_Hero_Trigger[226] = gg_trg_B26
    set udg_Hero_Trigger[228] = gg_trg_B28
    set udg_Hero_Trigger[229] = gg_trg_B29
    set udg_Hero_Trigger[230] = gg_trg_B30
    set udg_Hero_Trigger[231] = gg_trg_B31
    set udg_Hero_Trigger[232] = gg_trg_B32
    set udg_Hero_Trigger[233] = gg_trg_B33
    set udg_Hero_Trigger[234] = gg_trg_B34
    set udg_Hero_Trigger[235] = gg_trg_B35
    set udg_Hero_Trigger[236] = gg_trg_B36
    set udg_Hero_Trigger[240] = gg_trg_B37
    // --------------------------------------------------------
    set udg_Hero_Trigger[301] = gg_trg_C01
    set udg_Hero_Trigger[303] = gg_trg_C03
    set udg_Hero_Trigger[305] = gg_trg_C05
    set udg_Hero_Trigger[306] = gg_trg_C06
    set udg_Hero_Trigger[307] = gg_trg_C07
    set udg_Hero_Trigger[309] = gg_trg_C09
    set udg_Hero_Trigger[310] = gg_trg_C10
    set udg_Hero_Trigger[312] = gg_trg_C12
    set udg_Hero_Trigger[314] = gg_trg_C14
    set udg_Hero_Trigger[315] = gg_trg_C15
    set udg_Hero_Trigger[316] = gg_trg_C16
    set udg_Hero_Trigger[317] = gg_trg_C17
    set udg_Hero_Trigger[318] = gg_trg_C18
    set udg_Hero_Trigger[319] = gg_trg_C19
    set udg_Hero_Trigger[320] = gg_trg_C20
    set udg_Hero_Trigger[322] = gg_trg_C22
    set udg_Hero_Trigger[323] = gg_trg_C23
    set udg_Hero_Trigger[324] = gg_trg_C24
    set udg_Hero_Trigger[325] = gg_trg_C25
    set udg_Hero_Trigger[326] = gg_trg_C26
    set udg_Hero_Trigger[327] = gg_trg_C27
    set udg_Hero_Trigger[340] = gg_trg_C40
    // --------------------------------------------------------
    call DestroyTrigger(GetTriggeringTrigger())
endfunction
//===========================================================================
function InitTrig_Hero_Init takes nothing returns nothing
    set gg_trg_Hero_Init = CreateTrigger()
    call TriggerAddAction(gg_trg_Hero_Init, function Trig_Hero_InitActions)
endfunction
//===========================================================================
// Trigger: Hero Pool Init 
//===========================================================================
function Trig_Hero_Pool_InitActions takes nothing returns nothing
    local integer ydul_i
    set udg_UnitPool = CreateUnitPool()
    set ydul_i = 0
    loop
        exitwhen ydul_i > 95
        call UnitPoolAddUnitType( udg_UnitPool, udg_S01_hero_list[ydul_i], 1 )
        set ydul_i = ydul_i + 1
    endloop
endfunction
//===========================================================================
function InitTrig_Hero_Pool_Init takes nothing returns nothing
    set gg_trg_Hero_Pool_Init = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_Hero_Pool_Init, 0.00 )
    call TriggerAddAction(gg_trg_Hero_Pool_Init, function Trig_Hero_Pool_InitActions)
endfunction
//===========================================================================
// Trigger: Delete_Delete_time1=time2
//===========================================================================
function Trig_Delete_Delete_time1_time2Conditions takes nothing returns boolean
    return ((udg_Delete_time == udg_Delete_time2))
endfunction
function Trig_Delete_Delete_time1_time2Func001Func001Func002A takes nothing returns nothing
    call RemoveUnit( GetEnumUnit() )
endfunction
function Trig_Delete_Delete_time1_time2Actions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    if ((udg_single_player == false)) then
        set bj_forLoopAIndex = 1
        set bj_forLoopAIndexEnd = 10
        loop
            exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
            set udg_A_common_group = YDWEGetUnitsOfPlayerAndTypeIdNull(ConvertedPlayer(GetForLoopIndexA()), 'h01D')
            call ForGroupBJ( udg_A_common_group, function Trig_Delete_Delete_time1_time2Func001Func001Func002A )
            call DestroyGroup( udg_A_common_group )
            call GroupClear( udg_A_common_group )
            set bj_forLoopAIndex = bj_forLoopAIndex + 1
        endloop
    else
    endif
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_Delete_Delete_time1_time2 takes nothing returns nothing
    set gg_trg_Delete_Delete_time1_time2 = CreateTrigger()
    call DisableTrigger(gg_trg_Delete_Delete_time1_time2)
    call TriggerAddCondition(gg_trg_Delete_Delete_time1_time2, Condition(function Trig_Delete_Delete_time1_time2Conditions))
    call TriggerAddAction(gg_trg_Delete_Delete_time1_time2, function Trig_Delete_Delete_time1_time2Actions)
endfunction
//===========================================================================
// Trigger: Get last selected unit
//===========================================================================
function Trig_Get_last_selected_unitActions takes nothing returns nothing
    // 儲存最後被選取的部隊 以利-CD -LV執行
    set udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())] = GetTriggerUnit()
endfunction
//===========================================================================
function InitTrig_Get_last_selected_unit takes nothing returns nothing
    set gg_trg_Get_last_selected_unit = CreateTrigger()
    call DisableTrigger(gg_trg_Get_last_selected_unit)
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(0), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(1), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(2), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(3), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(4), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(5), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(6), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(7), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(8), true )
    call TriggerRegisterPlayerSelectionEventBJ( gg_trg_Get_last_selected_unit, Player(9), true )
    call TriggerAddAction(gg_trg_Get_last_selected_unit, function Trig_Get_last_selected_unitActions)
endfunction
//===========================================================================
// Trigger: LV
//===========================================================================
function Trig_LVActions takes nothing returns nothing
    // 將英雄升等
    if ((IsUnitType(udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())], UNIT_TYPE_HERO) == true)) then
        call SetHeroLevelBJ( udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())], ( GetHeroLevel(udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())]) + S2I(SubStringBJ(GetEventPlayerChatString(), 5, 6)) ), true )
    else
    endif
endfunction
//===========================================================================
function InitTrig_LV takes nothing returns nothing
    set gg_trg_LV = CreateTrigger()
    call DisableTrigger(gg_trg_LV)
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(0), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(1), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(2), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(3), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(4), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(5), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(6), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(7), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(8), "-LV", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_LV, Player(9), "-LV", false )
    call TriggerAddAction(gg_trg_LV, function Trig_LVActions)
endfunction
//===========================================================================
// Trigger: GOLD
//===========================================================================
function Trig_GOLDActions takes nothing returns nothing
    // 給錢
    call AdjustPlayerStateBJ( 1000000, GetTriggerPlayer(), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 1000000, GetTriggerPlayer(), PLAYER_STATE_RESOURCE_LUMBER )
endfunction
//===========================================================================
function InitTrig_GOLD takes nothing returns nothing
    set gg_trg_GOLD = CreateTrigger()
    call DisableTrigger(gg_trg_GOLD)
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(0), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(1), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(2), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(3), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(4), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(5), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(6), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(7), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(8), "-GOLD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_GOLD, Player(9), "-GOLD", true )
    call TriggerAddAction(gg_trg_GOLD, function Trig_GOLDActions)
endfunction
//===========================================================================
// Trigger: CD
//===========================================================================
function Trig_CDActions takes nothing returns nothing
    // 就...重設等候時間
    call UnitResetCooldown( udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())] )
endfunction
//===========================================================================
function InitTrig_CD takes nothing returns nothing
    set gg_trg_CD = CreateTrigger()
    call DisableTrigger(gg_trg_CD)
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(0), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(1), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(2), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(3), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(4), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(5), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(6), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(7), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(8), "-CD", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CD, Player(9), "-CD", true )
    call TriggerAddAction(gg_trg_CD, function Trig_CDActions)
endfunction
//===========================================================================
// Trigger: HM
//===========================================================================
function Trig_HMActions takes nothing returns nothing
    // 滿血魔
    call SetUnitLifePercentBJ( udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())], 100 )
    call SetUnitManaPercentBJ( udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())], 100 )
endfunction
//===========================================================================
function InitTrig_HM takes nothing returns nothing
    set gg_trg_HM = CreateTrigger()
    call DisableTrigger(gg_trg_HM)
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(0), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(1), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(2), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(3), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(4), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(5), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(6), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(7), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(8), "-HM", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_HM, Player(9), "-HM", true )
    call TriggerAddAction(gg_trg_HM, function Trig_HMActions)
endfunction
//===========================================================================
// Trigger: HKETEST
//===========================================================================
globals
string hke_ZZ="hke" 
integer hke_zZ=200
integer hke_Zz=100
integer hke_zz=5
boolean hke_Z0=true
boolean hke_z0=false
real hke_Z1=15.
real hke_z1=15.
integer hke_Z2=2000
integer hke_z2=1000
integer hke_Z3=10
real hke_z3=20.
real hke_Z4=50.
boolean hke_z4=false
integer array hke_Z5
player hke_z5=null
fogmodifier array hke_Z6
boolean array hke_z6
boolean array hke_Z7
unit array hke_z7
integer array hke_Z8
rect hke_z8=null
real hke_ZZZ=100.
button array hke_ZzZ
integer hke_Z0Z=100
boolean array hke_Z1Z
boolean array hke_Z2Z
timer array hke_Z3Z
string hke_Z4Z=""
boolean hke_Z5Z=true
boolean hke_Z6Z=true
boolean hke_Z7Z=true
group array hke_Z8Z
location array hke_Z9Z
boolean array hke_zZZ
boolean array hke_zzZ
timer array hke_z0Z
boolean array hke_z1Z
real array hke_z2Z
real array hke_z3Z
integer hke_z4Z=1000
integer hke_z5Z=500
integer hke_z6Z=30
boolean hke_z7Z=false
group hke_z8Z=CreateGroup()
boolean hke_z9Z=false
boolean hke_ZZz=true
integer hke_Zzz=0
string hke_Z0z="菜單 |cFFFF0000Hke1.25B|r By 火龍 QQ:|cFF00FF3321764538|r|n群:|cFFE500AF19938997 7803814 47099542 17263424 19908229|r|n|cFF00FF33Www.WuHansen.Com|r"
boolean hke_Z1z=false
item array hke_Z2z
boolean array hke_Z3z
integer array hke_Z4z
integer hke_Z5z=0
trigger array hke_Z6z
integer hke_Z7z=0
real hke_Z8z=0
real hke_Z9z=0
unit hke_zZz=null
integer hke_zzz=0
boolean hke_z0z=true
boolean hke_z1z=true
button array hke_z2z
button array hke_z3z
button array hke_z4z
button array hke_z5z
button array hke_z6z
button array hke_z7z
button array hke_z8z
button array hke_z9z
button array hke_ZZ0
button array hke_Zz0
button array hke_Z00
button array hke_Z10
dialog array hke_Z20
trigger array hke_Z30
trigger array hke_Z40
trigger array hke_Z50
trigger array hke_Z60
trigger array hke_Z70
trigger array hke_Z80
trigger array hke_Z90
trigger array hke_zZ0
trigger array hke_zz0
trigger array hke_z00
trigger array hke_z10
trigger array hke_z20
trigger array hke_z30
trigger array hke_z40
trigger array hke_z50
trigger array hke_z60
trigger array hke_z70
trigger array hke_z80
trigger array hke_z90
trigger array hke_ZZ1
trigger array hke_Zz1
trigger array hke_Z01
trigger array hke_Z11
trigger array hke_Z21
trigger array hke_Z31
trigger array hke_Z41
trigger array hke_Z51
trigger array hke_Z61
trigger array hke_Z71
trigger array hke_Z81
dialog array hke_Z91
dialog array hke_zZ1
trigger array hke_zz1
trigger array hke_z01
trigger array hke_z11
trigger array hke_z21
boolean array hke_z31
real hke_z41=100.
unit array hke_z51
integer hke_z61=1
integer hke_z71=0
integer hke_z81=0
integer hke_z91=0
integer hke_ZZ2=0
trigger array hke_Zz2
trigger array hke_Z02
trigger array hke_Z12
trigger array hke_Z22
integer array hke_Z32
boolean array hke_Z42
boolean hke_Z52=true
string hke_Z62=""
string hke_Z72=""
integer hke_Z82=0
integer hke_Z92=0
integer hke_zZ2=0
real hke_zz2=0
weathereffect array hke_z02
boolean array hke_z12
integer hke_z22=30
boolean hke_z32=false
real hke_z42=3.
gamespeed hke_z52=null
boolean hke_z62=false
boolean hke_z72=false
timerdialog hke_z82=null
real hke_z92=15.
trigger array hke_ZZ3
dialog array hke_Zz3
trigger array hke_Z03
trigger array hke_Z13
trigger array hke_Z23
boolean array hke_Z33
boolean array hke_Z43
boolean array hke_Z53
boolean array hke_Z63
timer array hke_Z73
group hke_Z83=CreateGroup()
integer hke_Z93=0
trigger array hke_zZ3
integer hke_zz3=13
gamecache hke_z03=null
boolean hke_z13=true
trigger hke_z23=CreateTrigger()
trigger hke_z33=CreateTrigger()
trigger hke_z43=CreateTrigger()
trigger hke_z53=CreateTrigger()
trigger hke_z63=CreateTrigger()
trigger hke_z73=CreateTrigger()
trigger hke_z83=CreateTrigger()
group hke_Z14=null
force hke_Z24=null
boolexpr hke_Z34=null
endglobals
function hke_Z64 takes real hke_Z74,location hke_Z84 returns group
set hke_Z14=CreateGroup()
call GroupEnumUnitsInRangeOfLoc(hke_Z14,hke_Z84,hke_Z74,hke_Z34)
return hke_Z14
endfunction
function hke_Z94 takes player hke_zZ4 returns group
set hke_Z14=CreateGroup()
call GroupEnumUnitsOfPlayer(hke_Z14,hke_zZ4,hke_Z34)
return hke_Z14
endfunction
function hke_zz4 takes player hke_zZ4,integer hke_z04 returns group
set hke_Z14=CreateGroup()
set bj_groupEnumTypeId=hke_z04
call GroupEnumUnitsOfPlayer(hke_Z14,hke_zZ4,filterGetUnitsOfPlayerAndTypeId)
return hke_Z14
endfunction
function hke_z14 takes player hke_zZ4 returns force
set hke_Z24=CreateForce()
call ForceEnumAllies(hke_Z24,hke_zZ4,hke_Z34)
return hke_Z24
endfunction
function hke_z24 takes player hke_zZ4 returns force
set hke_Z24=CreateForce()
call ForceEnumEnemies(hke_Z24,hke_zZ4,hke_Z34)
return hke_Z24
endfunction
function hke_Z45 takes trigger hke_Z55,player hke_Z65,integer hke_Z75 returns nothing
local playerevent hke_Z85=ConvertPlayerEvent(hke_Z75)
call TriggerRegisterPlayerEvent(hke_Z55,hke_Z65,hke_Z85)
set hke_Z85=null
endfunction
function hke_Z95 takes trigger hke_Z55,player hke_Z65,integer hke_Z75 returns nothing
local playerunitevent hke_Z85=ConvertPlayerUnitEvent(hke_Z75)
call TriggerRegisterPlayerUnitEvent(hke_Z55,hke_Z65,hke_Z85,null)
set hke_Z85=null
endfunction
function hke_zZ5 takes integer hke_Z75,player hke_Z65 returns nothing
call TriggerRegisterPlayerUnitEvent(hke_Z30[hke_Z75],hke_Z65,ConvertPlayerUnitEvent(24),null)
call TriggerRegisterPlayerUnitEvent(hke_Z50[hke_Z75],hke_Z65,ConvertPlayerUnitEvent(25),null)
call hke_Z45(hke_Z70[hke_Z75],hke_Z65,17)
call hke_Z45(hke_Z90[hke_Z75],hke_Z65,266)
call hke_Z45(hke_Z80[hke_Z75],hke_Z65,268)
call hke_Z45(hke_zZ0[hke_Z75],hke_Z65,262)
call hke_Z45(hke_zz0[hke_Z75],hke_Z65,264)
call TriggerRegisterTimerExpireEvent(hke_z43,hke_z0Z[hke_Z75])
call TriggerRegisterTimerExpireEvent(hke_z33,hke_Z73[hke_Z75])
call hke_Z95(hke_Z40[hke_Z75],hke_Z65,32)
call hke_Z95(hke_Z60[hke_Z75],hke_Z65,35)
call TriggerRegisterDialogEvent(hke_ZZ1[hke_Z75],hke_zZ1[hke_Z75])
call TriggerRegisterDialogEvent(hke_Zz2[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Zz1[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z01[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z81[hke_Z75],hke_Z91[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z71[hke_Z75],hke_zZ1[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z21[hke_Z75],hke_Z91[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z31[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z22[hke_Z75],hke_Z91[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z11[hke_Z75],hke_Z91[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z51[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z41[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z61[hke_Z75],hke_Z91[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z12[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z02[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z23[hke_Z75],hke_Z20[hke_Z75])
call TriggerRegisterDialogEvent(hke_Z13[hke_Z75],hke_Z20[hke_Z75])
call hke_Z95(hke_z01[hke_Z75],hke_Z65,38)
call hke_Z95(hke_z11[hke_Z75],hke_Z65,39)
call hke_Z95(hke_z21[hke_Z75],hke_Z65,40)
call hke_Z95(hke_z80[hke_Z75],hke_Z65,276)
call hke_Z95(hke_z80[hke_Z75],hke_Z65,275)
call hke_Z95(hke_z90[hke_Z75],hke_Z65,276)
call hke_Z95(hke_z90[hke_Z75],hke_Z65,275)
call hke_Z95(hke_ZZ3[hke_Z75],hke_Z65,18)
call TriggerRegisterPlayerStateEvent(hke_z60[hke_Z75],hke_Z65,PLAYER_STATE_RESOURCE_FOOD_USED,GREATER_THAN_OR_EQUAL,0)
call TriggerRegisterPlayerStateEvent(hke_z40[hke_Z75],hke_Z65,PLAYER_STATE_RESOURCE_GOLD,GREATER_THAN_OR_EQUAL,0)
call TriggerRegisterPlayerStateEvent(hke_z50[hke_Z75],hke_Z65,PLAYER_STATE_RESOURCE_LUMBER,GREATER_THAN_OR_EQUAL,0)
call hke_Z95(hke_z70[hke_Z75],hke_Z65,20)
call TriggerRegisterPlayerChatEvent(hke_zz1[hke_Z75],hke_Z65,"-",false)
call hke_Z95(hke_Z6z[hke_Z75],hke_Z65,39)
set hke_Z3z[hke_Z75]=true
endfunction
function hke_zz5 takes player hke_z05,integer hke_z15,boolean hke_z25 returns nothing
if(hke_z25)then
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_GOLD)+hke_z15)
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_GOLD_GATHERED,GetPlayerState(hke_z05,PLAYER_STATE_GOLD_GATHERED)-hke_z15)
else
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_GOLD)-hke_z15)
endif
endfunction
function hke_z35 takes player hke_z05,integer hke_z15,boolean hke_z25 returns nothing
if(hke_z25)then
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_LUMBER,GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_LUMBER)+hke_z15)
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_LUMBER_GATHERED,GetPlayerState(hke_z05,PLAYER_STATE_LUMBER_GATHERED)-hke_z15)
else
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_LUMBER,GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_LUMBER)-hke_z15)
endif
endfunction
function hke_z45 takes player hke_z05 returns nothing
local player hke_Z65=GetLocalPlayer()
if hke_z05==hke_Z65 then
set hke_Z65=Player(-1)
endif
set hke_Z65=null
endfunction
function hke_z55 takes unit hke_z65,unit hke_z75,boolean hke_z85 returns nothing
local location hke_z95
local location hke_ZZ6
set hke_z95=GetUnitLoc(hke_z65)
set hke_ZZ6=GetUnitLoc(hke_z75)
call SetUnitPositionLoc(hke_z65,hke_ZZ6)
if(hke_z85)then
call SetUnitPositionLoc(hke_z75,hke_z95)
call SetUnitPositionLoc(hke_z65,hke_ZZ6)
endif
call RemoveLocation(hke_z95)
call RemoveLocation(hke_ZZ6)
set hke_z95=null
set hke_ZZ6=null
endfunction
function hke_Zz6 takes integer hke_Z06 returns nothing
if(hke_Z06==0)then
set hke_zZ2=100
set hke_Z92=100
set hke_Z82=100
set hke_Z72="|cFFFFFFFF"
return
endif
if(hke_Z06==1)then
set hke_zZ2=50
set hke_Z92=50
set hke_Z82=50
set hke_Z72="|cFF7F7F7F"
return
endif
if(hke_Z06==2)then
set hke_zZ2=0
set hke_Z92=0
set hke_Z82=0
set hke_Z72="|cFF000000"
return
endif
if(hke_Z06==3)then
set hke_zZ2=100
set hke_Z92=0
set hke_Z82=0
set hke_Z72="|cFFFF0000"
return
endif
if(hke_Z06==4)then
set hke_zZ2=100
set hke_Z92=50
set hke_Z82=0
set hke_Z72="|cFFFF7F00"
return
endif
if(hke_Z06==5)then
set hke_zZ2=100
set hke_Z92=100
set hke_Z82=0
set hke_Z72="|cFFFFFF00"
return
endif
if(hke_Z06==6)then
set hke_zZ2=0
set hke_Z92=100
set hke_Z82=0
set hke_Z72="|cFF00FF00"
return
endif
if(hke_Z06==7)then
set hke_zZ2=0
set hke_Z92=100
set hke_Z82=100
set hke_Z72="|cFF00FFFF"
return
endif
if(hke_Z06==8)then
set hke_zZ2=0
set hke_Z92=0
set hke_Z82=100
set hke_Z72="|cFF0000FF"
return
endif
if(hke_Z06==9)then
set hke_zZ2=100
set hke_Z92=0
set hke_Z82=100
set hke_Z72="|cFFFF00FF"
return
endif
endfunction
function hke_Z16 takes integer hke_Z06,unit hke_Z26,string hke_Z36 returns nothing
local texttag hke_Z46
local location hke_z95
call hke_Zz6(hke_Z06)
set hke_z95=GetUnitLoc(hke_Z26)
set hke_Z46=CreateTextTagLocBJ(hke_Z36,hke_z95,0,20,hke_zZ2,hke_Z92,hke_Z82,0)
call RemoveLocation(hke_z95)
set hke_z95=null
call SetTextTagPermanent(hke_Z46,false)
call SetTextTagLifespan(hke_Z46,hke_Z1)
set hke_Z46=null
endfunction
function hke_Z56 takes nothing returns nothing
local trigger hke_Z66=GetTriggeringTrigger()
local timer hke_Z76=GetExpiredTimer()
local timerdialog H_dio
call DestroyTrigger(hke_Z66)
call UnlockGameSpeedBJ()
call SetGameSpeed(hke_z52)
call DestroyTimerDialog(hke_z82)
call DestroyTimer(hke_Z76)
set hke_Z66=null
set hke_Z76=null
endfunction
function hke_Z86 takes nothing returns nothing
local timer hke_Z76
local trigger hke_Z66
if(hke_z62)then
else
set hke_z52=GetGameSpeed()
set hke_z72=IsMapFlagSet(MAP_LOCK_SPEED)
call UnlockGameSpeedBJ()
call SetGameSpeed(MAP_SPEED_SLOWEST)
call LockGameSpeedBJ()
set hke_Z66=CreateTrigger()
set hke_Z76=CreateTimer()
call StartTimerBJ(hke_Z76,false,hke_z42)
set hke_z82=CreateTimerDialogBJ(hke_Z76,"子彈時間")
call TriggerAddAction(hke_Z66,function hke_Z56)
call TriggerRegisterTimerExpireEvent(hke_Z66,hke_Z76)
endif
endfunction
function hke_Z96 takes trigger hke_zZ6 returns nothing
if(IsTriggerEnabled(hke_zZ6))then
call DisableTrigger(hke_zZ6)
else
call EnableTrigger(hke_zZ6)
endif
endfunction
function hke_zz6 takes trigger hke_zZ6,boolean hke_z06 returns nothing
if(IsTriggerEnabled(hke_zZ6)==hke_z06)then
else
call hke_Z96(hke_zZ6)
endif
endfunction
function hke_z16 takes integer hke_z15,boolean hke_z25 returns nothing
call hke_zz6(hke_z40[hke_z15],hke_z25)
call hke_zz6(hke_z50[hke_z15],hke_z25)
call hke_zz6(hke_z60[hke_z15],hke_z25)
call hke_zz6(hke_z80[hke_z15],hke_z25)
call hke_zz6(hke_z70[hke_z15],hke_z25)
call hke_zz6(hke_z90[hke_z15],hke_z25)
call hke_zz6(hke_ZZ3[hke_z15],hke_z25)
endfunction
function hke_z26 takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
if(GetUnitUserData(hke_z65)==2176)then
call RemoveUnit(hke_z65)
endif
set hke_z65=null
endfunction
function hke_z36 takes player hke_z05 returns nothing
local group hke_z46
if(hke_Z42[GetPlayerId(hke_z05)])then
set hke_z46=hke_Z94(hke_z05)
call ForGroup(hke_z46,function hke_z26)
set hke_Z42[GetPlayerId(hke_z05)]=false
call DestroyGroup(hke_z46)
set hke_z46=null
endif
endfunction
function hke_z56 takes unit hke_z65,player hke_z05 returns nothing
local location hke_z95
local integer hke_z66
local unit hke_z76
local item hke_z86
local integer hke_Z75=0
if(IsUnitType(hke_z65,UNIT_TYPE_HERO))then
set hke_z95=GetUnitLoc(hke_z65)
set hke_z66=GetUnitTypeId(hke_z65)
set hke_z76=CreateUnitAtLoc(hke_z05,hke_z66,hke_z95,bj_UNIT_FACING)
call SetUnitUserData(hke_z76,2176)
set hke_Z42[GetPlayerId(hke_z05)]=true
if(hke_Z6Z)then
call SetUnitUseFood(hke_z76,false)
endif
call SetHeroLevelBJ(hke_z76,GetHeroLevel(hke_z65),false)
call SetHeroStat(hke_z76,0,GetHeroStatBJ(0,hke_z65,false))
call SetHeroStat(hke_z76,1,GetHeroStatBJ(1,hke_z65,false))
call SetHeroStat(hke_z76,2,GetHeroStatBJ(2,hke_z65,false))
loop
exitwhen hke_Z75>5
set hke_z86=UnitItemInSlot(hke_z65,hke_Z75)
call UnitAddItemById(hke_z76,GetItemTypeId(hke_z86))
set hke_Z75=hke_Z75+1
endloop
endif
call RemoveLocation(hke_z95)
set hke_z95=null
set hke_z76=null
set hke_z86=null
endfunction
function hke_z96 takes integer hke_ZZ7,player hke_Zz7,location hke_Z07,boolean hke_Z17,boolean hke_Z27 returns nothing
local unit hke_z76
set hke_z76=CreateUnitAtLoc(hke_Zz7,hke_ZZ7,hke_Z07,bj_UNIT_FACING)
if(hke_Z6Z)then
call SetUnitUseFood(hke_z76,false)
endif
if(hke_Z17)then
call SetUnitUserData(hke_z76,2176)
endif
if(hke_Z27)then
call UnitApplyTimedLife(hke_z76,1112820806,90)
endif
set hke_z76=null
endfunction
function hke_Z37 takes integer hke_ZZ7,player hke_Zz7,location hke_Z07 returns nothing
local unit hke_z76
set hke_z76=CreateUnitAtLoc(hke_Zz7,hke_ZZ7,hke_Z07,bj_UNIT_FACING)
if(hke_Z6Z)then
call SetUnitUseFood(hke_z76,false)
set hke_z76=null
endif
endfunction
function hke_Z47 takes unit hke_Z57,player hke_Zz7,integer hke_Z67,boolean hke_Z27 returns nothing
local location hke_z95
local integer hke_z66
local integer hke_Z75
set hke_z95=GetUnitLoc(hke_Z57)
set hke_z66=GetUnitTypeId(hke_Z57)
set hke_Z75=1
loop
exitwhen hke_Z75>hke_Z67
call hke_z96(hke_z66,hke_Zz7,hke_z95,true,hke_Z27)
set hke_Z75=hke_Z75+1
endloop
call RemoveLocation(hke_z95)
set hke_Z42[GetPlayerId(hke_Zz7)]=true
set hke_z95=null
endfunction
function hke_Z77 takes unit hke_Z57,player hke_Zz7,integer hke_Z67 returns nothing
call hke_Z47(hke_Z57,hke_Zz7,hke_Z67,false)
endfunction
function hke_Z87 takes unit hke_z65,integer hke_z15,boolean hke_Z97 returns nothing
local integer hke_Z75
set hke_Z75=GetResourceAmount(hke_z65)
if(hke_Z97)then
set hke_Z75=hke_Z75+hke_z15
else
set hke_Z75=hke_Z75-hke_z15
endif
if(hke_Z75<0)then
if(hke_Z97)then
set hke_Z75=GetResourceAmount(hke_z65)
else
set hke_Z75=0
endif
endif
call SetResourceAmount(hke_z65,hke_Z75)
endfunction
function hke_zZ7 takes integer hke_z15,player hke_z05,boolean hke_zz7 returns nothing
if(hke_zz7)then
call SetPlayerTechMaxAllowed(hke_z05,1212502607,50000)
else
call SetPlayerTechMaxAllowed(hke_z05,1212502607,3)
endif
endfunction
function hke_z07 takes integer hke_z15,boolean hke_z06 returns nothing
if(hke_z06)then
call EnableTrigger(hke_z00[hke_z15])
call EnableTrigger(hke_z10[hke_z15])
call EnableTrigger(hke_z20[hke_z15])
call EnableTrigger(hke_z30[hke_z15])
call EnableTrigger(hke_Z70[hke_z15])
call EnableTrigger(hke_Z80[hke_z15])
call EnableTrigger(hke_Z90[hke_z15])
call EnableTrigger(hke_zZ0[hke_z15])
call EnableTrigger(hke_zz0[hke_z15])
else
call DisableTrigger(hke_z00[hke_z15])
call DisableTrigger(hke_z10[hke_z15])
call DisableTrigger(hke_z20[hke_z15])
call DisableTrigger(hke_z30[hke_z15])
call DisableTrigger(hke_Z70[hke_z15])
call DisableTrigger(hke_Z80[hke_z15])
call DisableTrigger(hke_Z90[hke_z15])
call DisableTrigger(hke_zZ0[hke_z15])
call DisableTrigger(hke_zz0[hke_z15])
endif
endfunction
function hke_z17 takes integer hke_z15,boolean hke_z27 returns nothing
if(hke_z27)then
call EnableTrigger(hke_Z40[hke_z15])
call EnableTrigger(hke_Z60[hke_z15])
call EnableTrigger(hke_Z6z[hke_z15])
else
call DisableTrigger(hke_Z40[hke_z15])
call DisableTrigger(hke_Z60[hke_z15])
call DisableTrigger(hke_Z6z[hke_z15])
endif
endfunction
function hke_z37 takes nothing returns nothing
local integer hke_z15
set hke_z15=0
loop
exitwhen hke_z15>11
call hke_z07(hke_z15,false)
set hke_z15=hke_z15+1
endloop
endfunction
function hke_z47 takes integer hke_z15 returns nothing
set hke_z6[hke_z15]=false
call GroupClear(hke_Z8Z[hke_z15])
if(hke_Z7Z)then
call DestroyFogModifier(hke_Z6[hke_z15])
endif
call DisableTrigger(hke_Z30[hke_z15])
call DisableTrigger(hke_Z50[hke_z15])
call DisableTrigger(hke_zz1[hke_z15])
call DisableTrigger(hke_z40[hke_z15])
call DisableTrigger(hke_z50[hke_z15])
call DisableTrigger(hke_z60[hke_z15])
call DisableTrigger(hke_z70[hke_z15])
call DisableTrigger(hke_z80[hke_z15])
call DisableTrigger(hke_z90[hke_z15])
call DisableTrigger(hke_ZZ3[hke_z15])
call DisableTrigger(hke_ZZ1[hke_z15])
call DisableTrigger(hke_Zz1[hke_z15])
call DisableTrigger(hke_Zz2[hke_z15])
call DisableTrigger(hke_Z01[hke_z15])
call DisableTrigger(hke_Z81[hke_z15])
call DisableTrigger(hke_Z21[hke_z15])
call DisableTrigger(hke_Z51[hke_z15])
call DisableTrigger(hke_Z41[hke_z15])
call DisableTrigger(hke_Z61[hke_z15])
call DisableTrigger(hke_Z12[hke_z15])
call DisableTrigger(hke_Z02[hke_z15])
call DisableTrigger(hke_Z71[hke_z15])
call DisableTrigger(hke_Z31[hke_z15])
call DisableTrigger(hke_Z22[hke_z15])
call DisableTrigger(hke_Z11[hke_z15])
call DisableTrigger(hke_Z23[hke_z15])
call DisableTrigger(hke_Z13[hke_z15])
call DisableTrigger(hke_zZ3[hke_z15])
call DisableTrigger(hke_Z40[hke_z15])
call DisableTrigger(hke_Z60[hke_z15])
call DisableTrigger(hke_Z6z[hke_z15])
call hke_z07(hke_z15,false)
endfunction
function hke_z57 takes integer hke_z15,player hke_z05 returns nothing
set hke_z6[hke_z15]=true
if(hke_Z3z[hke_z15])then
else
call hke_zZ5(hke_z15,hke_z05)
endif
call EnableTrigger(hke_Z30[hke_z15])
call EnableTrigger(hke_Z50[hke_z15])
call EnableTrigger(hke_zz1[hke_z15])
call hke_z07(hke_z15,true)
endfunction
function hke_z67 takes integer hke_z15,boolean hke_z77 returns nothing
if(hke_z77)then
if((hke_zZZ[hke_z15])and(hke_zzZ[hke_z15])and(hke_z31[hke_z15]))then
call EnableTrigger(hke_z01[hke_z15])
call EnableTrigger(hke_z11[hke_z15])
call EnableTrigger(hke_z21[hke_z15])
endif
else
call DisableTrigger(hke_z01[hke_z15])
call DisableTrigger(hke_z11[hke_z15])
call DisableTrigger(hke_z21[hke_z15])
endif
endfunction
function hke_z87 takes integer hke_Z06 returns nothing
if(hke_Z06==0)then
set hke_zz2=0
return
endif
if(hke_Z06==1)then
set hke_zz2=10
return
endif
if(hke_Z06==2)then
set hke_zz2=15
return
endif
if(hke_Z06==3)then
set hke_zz2=20
return
endif
if(hke_Z06==4)then
set hke_zz2=40
return
endif
if(hke_Z06==5)then
set hke_zz2=50
return
endif
if(hke_Z06==6)then
set hke_zz2=70
return
endif
if(hke_Z06==7)then
set hke_zz2=80
return
endif
if(hke_Z06==8)then
set hke_zz2=90
return
endif
if(hke_Z06==9)then
set hke_zz2=100
return
endif
endfunction
function hke_z97 takes unit hke_z65,integer hke_ZZ8,integer hke_Zz8 returns nothing
call hke_z87(hke_Zz8)
call hke_Zz6(hke_ZZ8)
call SetUnitVertexColorBJ(hke_z65,hke_zZ2,hke_Z92,hke_Z82,hke_zz2)
endfunction
function hke_Z08 takes integer hke_ZZ8,integer hke_Zz8 returns nothing
call hke_z87(hke_Zz8)
call hke_Zz6(hke_ZZ8)
call SetWaterBaseColorBJ(hke_zZ2,hke_Z92,hke_Z82,hke_zz2)
endfunction
function hke_Z18 takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call hke_z97(hke_z65,GetRandomInt(3,9),0)
set hke_z65=null
endfunction
function hke_Z28 takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call hke_z97(hke_z65,0,0)
set hke_z65=null
endfunction
function hke_Z38 takes integer hke_z15,boolean hke_z77 returns nothing
local integer hke_Z75
local integer hke_Z48
if(hke_Z53[hke_z15]==hke_z77)then
else
set hke_Z53[hke_z15]=hke_z77
if(hke_z77)then
call EnableTrigger(hke_z83)
else
set hke_Z75=0
set hke_Z48=0
loop
exitwhen hke_Z75>11
if(hke_Z53[hke_Z75])then
set hke_Z48=hke_Z48+1
endif
set hke_Z75=hke_Z75+1
endloop
if(hke_Z48==0)then
call DisableTrigger(hke_z83)
endif
endif
endif
endfunction
function hke_Z58 takes integer hke_Z68 returns nothing
if(hke_Z68==0)then
call SetSkyModel(null)
return
endif
if(hke_Z68==1)then
call SetSkyModel("Environment\\Sky\\BlizzardSky\\BlizzardSky.mdl")
return
endif
if(hke_Z68==2)then
call SetSkyModel("Environment\\Sky\\DalaranSky\\DalaranSky.mdl")
return
endif
if(hke_Z68==3)then
call SetSkyModel("Environment\\Sky\\FelwoodSky\\FelwoodSky.mdl")
return
endif
if(hke_Z68==4)then
call SetSkyModel("Environment\\Sky\\FoggedSky\\FoggedSky.mdl")
return
endif
if(hke_Z68==5)then
call SetSkyModel("Environment\\Sky\\Sky\\SkyLight.mdl")
return
endif
if(hke_Z68==6)then
call SetSkyModel("Environment\\Sky\\LordaeronFallSky\\LordaeronFallSky.mdl")
return
endif
if(hke_Z68==7)then
call SetSkyModel("Environment\\Sky\\LordaeronSummerSky\\LordaeronSummerSky.mdl")
return
endif
if(hke_Z68==8)then
call SetSkyModel("Environment\\Sky\\LordaeronWinterSky\\LordaeronWinterSky.mdl")
return
endif
if(hke_Z68==9)then
call SetSkyModel("Environment\\Sky\\LordaeronWinterSkyBrightGreen\\LordaeronWinterSkyBrightGreen.mdl")
return
endif
if(hke_Z68==10)then
call SetSkyModel("Environment\\Sky\\LordaeronWinterSkyPink\\LordaeronWinterSkyPink.mdl")
return
endif
if(hke_Z68==11)then
call SetSkyModel("Environment\\Sky\\LordaeronWinterSkyPurple\\LordaeronWinterSkyPurple.mdl")
return
endif
if(hke_Z68==12)then
call SetSkyModel("Environment\\Sky\\LordaeronWinterSkyYellow\\LordaeronWinterSkyYellow.mdl")
return
endif
if(hke_Z68==13)then
call SetSkyModel("Environment\\Sky\\Outland_Sky\\Outland_Sky.mdl")
return
endif
endfunction
function hke_Z78 takes integer hke_Z88 returns integer
if(hke_Z88==0)then
return 1380018290
endif
if(hke_Z88==1)then
return 1380019314
endif
if(hke_Z88==2)then
return 1296393331
endif
if(hke_Z88==3)then
return 1178886760
endif
if(hke_Z88==4)then
return 1178886764
endif
if(hke_Z88==5)then
return 1178888040
endif
if(hke_Z88==6)then
return 1178888044
endif
if(hke_Z88==7)then
return 1178890856
endif
if(hke_Z88==8)then
return 1178890860
endif
if(hke_Z88==9)then
return 1178892136
endif
if(hke_Z88==10)then
return 1178892140
endif
if(hke_Z88==11)then
return 1380739186
endif
if(hke_Z88==12)then
return 1380740210
endif
if(hke_Z88==13)then
return 1397645939
endif
if(hke_Z88==14)then
return 1397647475
endif
if(hke_Z88==15)then
return 1397648499
endif
if(hke_Z88==16)then
return 1464820599
endif
if(hke_Z88==17)then
return 1464822903
endif
if(hke_Z88==18)then
return 1280467297
endif
if(hke_Z88==19)then
return 1280470369
endif
if(hke_Z88==20)then
return 1464755063
endif
return 0
endfunction
function hke_Z98 takes integer hke_Z88,boolean hke_z77 returns nothing
set hke_Z88=hke_Z88-1
if(hke_z77)then
if(hke_z12[hke_Z88]==false)then
if(hke_Z78(hke_Z88)==0)then
else
set hke_z02[hke_Z88]=AddWeatherEffect(hke_z8,hke_Z78(hke_Z88))
call EnableWeatherEffect(hke_z02[hke_Z88],true)
set hke_z12[hke_Z88]=true
endif
endif
else
if(hke_z02[hke_Z88]==null)then
else
call EnableWeatherEffect(hke_z02[hke_Z88],false)
call RemoveWeatherEffect(hke_z02[hke_Z88])
set hke_z12[hke_Z88]=false
set hke_z02[hke_Z88]=null
endif
endif
endfunction
function hke_zZ8 takes nothing returns nothing
local integer hke_z15=1
loop
exitwhen hke_z15>21
call hke_Z98(hke_z15,false)
set hke_z15=hke_z15+1
endloop
endfunction
function hke_zz8 takes integer hke_z08 returns integer
if(hke_z08==0)then
return 1280601204
endif
if(hke_z08==1)then
return 1179939959
endif
if(hke_z08==2)then
return 1465152631
endif
if(hke_z08==3)then
return 1096053874
endif
if(hke_z08==4)then
return 1096053859
endif
if(hke_z08==5)then
return 1112831095
endif
if(hke_z08==6)then
return 1263826039
endif
if(hke_z08==7)then
return 1498707828
endif
if(hke_z08==8)then
return 1498702708
endif
if(hke_z08==9)then
return 1498703476
endif
if(hke_z08==10)then
return 1498706804
endif
if(hke_z08==11)then
return 1247044468
endif
if(hke_z08==12)then
return 1247048823
endif
if(hke_z08==13)then
return 1146385256
endif
if(hke_z08==14)then
return 1129608306
endif
if(hke_z08==15)then
return 1129608291
endif
if(hke_z08==16)then
return 1230271607
endif
if(hke_z08==17)then
return 1230271607
endif
if(hke_z08==18)then
return 1314157667
endif
if(hke_z08==19)then
return 1330934903
endif
if(hke_z08==20)then
return 1515484279
endif
if(hke_z08==21)then
return 1196716904
endif
if(hke_z08==22)then
return 1448373364
endif
if(hke_z08==23)then
return 1448373364
endif
return 0
endfunction
function hke_z18 takes nothing returns integer
return hke_zz8(GetRandomInt(0,23))
endfunction
function hke_z28 takes unit hke_z65,integer hke_z38,integer hke_z08,integer hke_z48 returns nothing
local real hke_z58
local real hke_z68
local real hke_z15=0
local boolean hke_z78=true
set hke_z58=GetUnitX(hke_z65)
set hke_z68=GetUnitY(hke_z65)
if(hke_z38==1)then
loop
exitwhen hke_z15==hke_z48
if(hke_z78)then
call CreateDestructable(hke_z08,hke_z58,hke_z68+hke_z15*40,GetRandomReal(0,360),1,0)
else
call CreateDestructable(hke_z08,hke_z58,hke_z68-hke_z15*40,GetRandomReal(0,360),1,0)
endif
set hke_z78=not(hke_z78)
set hke_z15=hke_z15+1
endloop
endif
if(hke_z38==2)then
loop
exitwhen hke_z15==hke_z48
if(hke_z78)then
call CreateDestructable(hke_z08,hke_z58+hke_z15*40,hke_z68,GetRandomReal(0,360),1,0)
else
call CreateDestructable(hke_z08,hke_z58-hke_z15*40,hke_z68,GetRandomReal(0,360),1,0)
endif
set hke_z78=not(hke_z78)
set hke_z15=hke_z15+1
endloop
endif
if(hke_z38==3)then
loop
exitwhen hke_z15==hke_z48
if(hke_z78)then
call CreateDestructable(hke_z08,hke_z58+hke_z15*40,hke_z68+hke_z15*40,GetRandomReal(0,360),1,0)
else
call CreateDestructable(hke_z08,hke_z58-hke_z15*40,hke_z68-hke_z15*40,GetRandomReal(0,360),1,0)
endif
set hke_z78=not(hke_z78)
set hke_z15=hke_z15+1
endloop
endif
if(hke_z38==4)then
loop
exitwhen hke_z15==hke_z48
if(hke_z78)then
call CreateDestructable(hke_z08,hke_z58+hke_z15*40,hke_z68-hke_z15*40,GetRandomReal(0,360),1,0)
else
call CreateDestructable(hke_z08,hke_z58-hke_z15*40,hke_z68+hke_z15*40,GetRandomReal(0,360),1,0)
endif
set hke_z78=not(hke_z78)
set hke_z15=hke_z15+1
endloop
endif
endfunction
function hke_z88 takes integer hke_z15 returns nothing
set hke_Z7[hke_z15]=true
call StartTimerBJ(hke_z0Z[hke_z15],false,2.)
endfunction
function hke_z98 takes integer hke_z15,boolean hke_ZZZZ returns nothing
local integer hke_Z75
local integer hke_z76
local item hke_z86
local location hke_z95
local unit hke_z65
set hke_z65=hke_z7[hke_z15]
set hke_z76=1
loop
exitwhen hke_z76>6
if(hke_ZZZZ)then
set hke_z95=GetUnitLoc(hke_z51[hke_z15])
else
set hke_z95=GetUnitLoc(hke_z65)
endif
set hke_z86=UnitItemInSlotBJ(hke_z65,hke_z76)
if(GetItemCharges(hke_z86)>0)then
set hke_Z75=GetItemCharges(hke_z86)
set hke_z86=CreateItemLoc(GetItemTypeId(hke_z86),hke_z95)
call SetItemCharges(hke_z86,hke_Z75)
else
call CreateItemLoc(GetItemTypeId(hke_z86),hke_z95)
endif
call RemoveLocation(hke_z95)
set hke_z76=hke_z76+1
endloop
set hke_z65=null
set hke_z95=null
set hke_z86=null
endfunction
function hke_ZZzZ takes integer hke_z15,player hke_z05 returns nothing
local integer hke_Z75
local force hke_ZZ0Z
local player hke_Z65
if(hke_z1Z[hke_z15])then
call DestroyFogModifier(hke_Z6[hke_z15])
set hke_z1Z[hke_z15]=false
else
set hke_ZZ0Z=CreateForce()
set hke_Z75=0
loop
exitwhen hke_Z75>11
set hke_Z65=Player(hke_Z75)
if(GetPlayerAlliance(hke_z05,hke_Z65,ALLIANCE_SHARED_VISION))then
call ForceAddPlayer(hke_ZZ0Z,hke_Z65)
call SetPlayerAlliance(hke_z05,hke_Z65,ALLIANCE_SHARED_VISION,false)
endif
set hke_Z75=hke_Z75+1
endloop
set hke_Z6[hke_z15]=CreateFogModifierRect(hke_z05,FOG_OF_WAR_VISIBLE,hke_z8,false,false)
call FogModifierStart(hke_Z6[hke_z15])
set hke_z1Z[hke_z15]=true
set hke_Z75=0
loop
exitwhen hke_Z75>11
set hke_Z65=Player(hke_Z75)
if(IsPlayerInForce(hke_Z65,hke_ZZ0Z))then
call SetPlayerAlliance(hke_z05,hke_Z65,ALLIANCE_SHARED_VISION,true)
endif
set hke_Z75=hke_Z75+1
endloop
call DestroyForce(hke_ZZ0Z)
set hke_ZZ0Z=null
set hke_Z65=null
endif
endfunction
function hke_ZZ1Z takes integer hke_z15,player hke_z05 returns nothing
local integer hke_Z75
local unit hke_z65
local item hke_z86
local item array hke_ZZ2Z
set hke_z65=FirstOfGroup(hke_Z8Z[hke_z15])
if((hke_z05==GetOwningPlayer(hke_z65))and(UnitInventorySizeBJ(hke_z65)>0))then
set hke_Z75=1
loop
exitwhen hke_Z75>6
set hke_z86=UnitItemInSlotBJ(hke_z65,hke_Z75)
set hke_ZZ2Z[(hke_Z75-1)]=hke_z86
call UnitRemoveItemSwapped(hke_z86,hke_z65)
call SetItemVisible(hke_z86,false)
set hke_Z75=hke_Z75+1
endloop
set hke_Z75=1
loop
exitwhen hke_Z75>6
set hke_z86=hke_Z2z[(hke_z15*18)+(hke_Z4z[hke_z15]*6)+(hke_Z75-1)]
call UnitAddItem(hke_z65,hke_z86)
set hke_Z2z[(hke_z15*18)+(hke_Z4z[hke_z15]*6)+(hke_Z75-1)]=hke_ZZ2Z[(hke_Z75-1)]
set hke_ZZ2Z[(hke_Z75-1)]=null
set hke_Z75=hke_Z75+1
endloop
if(hke_Z4z[hke_z15]==0)then
set hke_Z4z[hke_z15]=hke_z61-1
else
set hke_Z4z[hke_z15]=(hke_Z4z[hke_z15]-1)
endif
set hke_z86=null
endif
set hke_z65=null
set hke_z05=null
endfunction
function hke_ZZ3Z takes unit hke_z65 returns nothing
local integer hke_Z75
local item hke_z86
set hke_Z75=1
loop
exitwhen hke_Z75>6
set hke_z86=UnitItemInSlotBJ(hke_z65,hke_Z75)
call UnitRemoveItemSwapped(hke_z86,hke_z65)
set hke_Z75=hke_Z75+1
endloop
set hke_z86=null
endfunction
function hke_ZZ4Z takes integer hke_z15 returns nothing
local integer hke_Z75
local item hke_z86
local location hke_z95
set hke_z95=GetUnitLoc(hke_z51[hke_z15])
set hke_Z75=1
loop
exitwhen hke_Z75>6
set hke_z86=UnitItemInSlotBJ(hke_z7[hke_z15],hke_Z75)
call UnitRemoveItemSwapped(hke_z86,hke_z7[hke_z15])
call SetItemPositionLoc(hke_z86,hke_z95)
set hke_Z75=hke_Z75+1
endloop
call RemoveLocation(hke_z95)
set hke_z86=null
set hke_z95=null
endfunction
function hke_ZZ5Z takes integer hke_z15 returns nothing
local integer hke_z76
local integer hke_z78
local unit hke_z65
local item hke_Z66
local item hke_ZZ6Z
set hke_z65=FirstOfGroup(hke_Z8Z[hke_z15])
set hke_z76=1
loop
exitwhen hke_z76>5
set hke_Z66=UnitItemInSlotBJ(hke_z65,hke_z76)
if(GetItemCharges(hke_Z66)>0)then
set hke_z78=hke_z76+1
loop
exitwhen hke_z78>6
set hke_ZZ6Z=UnitItemInSlotBJ(hke_z65,hke_z78)
if(GetItemTypeId(hke_Z66)==GetItemTypeId(hke_ZZ6Z))then
call SetItemCharges(hke_Z66,(GetItemCharges(hke_Z66)+GetItemCharges(hke_ZZ6Z)))
call RemoveItem(hke_ZZ6Z)
endif
set hke_z78=hke_z78+1
endloop
endif
set hke_z76=hke_z76+1
endloop
set hke_Z66=null
set hke_ZZ6Z=null
set hke_z65=null
endfunction
function hke_ZZ7Z takes integer hke_z15,integer hke_Z75 returns nothing
local unit hke_z65
local item hke_z86
set hke_z65=FirstOfGroup(hke_Z8Z[hke_z15])
set hke_z86=UnitItemInSlotBJ(hke_z65,1)
call SetItemCharges(hke_z86,(GetItemCharges(hke_z86)+hke_Z75))
set hke_z86=null
set hke_z65=null
endfunction
function hke_ZZ8Z takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call GroupAddUnit(hke_z8Z,hke_z65)
set hke_z65=null
endfunction
function hke_ZZ9Z takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call GroupRemoveUnit(hke_z8Z,hke_z65)
set hke_z65=null
endfunction
function hke_ZzZZ takes nothing returns nothing
local unit hke_z65=GetTriggerUnit()
if((IsUnitDeadBJ(hke_z65))and(IsUnitType(hke_z65,UNIT_TYPE_HERO)))then
call GroupRemoveUnit(hke_z8Z,hke_z65)
endif
endfunction
function hke_ZzzZ takes nothing returns nothing
call ForGroup(hke_z8Z,function hke_ZzZZ)
endfunction
function hke_Zz0Z takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call ReviveHeroLoc(hke_z65,hke_Z9Z[hke_Zzz],true)
call SetUnitManaPercentBJ(hke_z65,100)
set hke_z65=null
endfunction
function hke_Zz1Z takes player hke_z05 returns nothing
local group hke_z46
set hke_z46=hke_Z94(hke_z05)
set hke_Zzz=GetPlayerId(hke_z05)
call ForGroup(hke_z46,function hke_Zz0Z)
call DestroyGroup(hke_z46)
set hke_z46=null
endfunction
function hke_Zz2Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call ModifyHeroStat(hke_z81,hke_z65,hke_z91,hke_z71)
set hke_z65=null
endfunction
function hke_Zz3Z takes integer hke_z15,integer hke_Zz4Z,integer hke_Zz5Z,boolean hke_z25 returns nothing
local integer hke_Zz6Z
if(hke_z25)then
set hke_Zz6Z=0
else
set hke_Zz6Z=1
endif
if(hke_Z0)then
set hke_z91=hke_Zz6Z
set hke_z81=hke_Zz4Z
set hke_z71=hke_Zz5Z
call ForGroup(hke_Z8Z[hke_z15],function hke_Zz2Z)
else
call ModifyHeroStat(hke_Zz4Z,hke_z7[hke_z15],hke_Zz6Z,hke_Zz5Z)
endif
endfunction
function hke_Zz7Z takes unit hke_z65,integer hke_Zz5Z,boolean hke_z25 returns nothing
local integer hke_z15
set hke_z15=GetHeroLevel(hke_z65)
if(hke_z25)then
set hke_z15=hke_z15+hke_Zz5Z
else
set hke_z15=hke_z15-hke_Zz5Z
endif
call SetHeroLevelBJ(hke_z65,hke_z15,false)
endfunction
function hke_Zz8Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_Zz7Z(hke_z65,hke_ZZ2,hke_Z1z)
set hke_z65=null
endfunction
function hke_Zz9Z takes integer hke_z15,integer hke_Zz5Z,boolean hke_z25 returns nothing
if(hke_Z0)then
set hke_ZZ2=hke_Zz5Z
set hke_Z1z=hke_z25
call ForGroup(hke_Z8Z[hke_z15],function hke_Zz8Z)
else
call hke_Zz7Z(hke_z7[hke_z15],hke_Zz5Z,hke_z25)
endif
endfunction
function hke_Z0ZZ takes string hke_Z0zZ returns integer
local string hke_Z00Z="0123456789"
local string hke_Z01Z="ABCDEFGHIJKLMNOPQRSTUVWXYZ"
local string hke_Z02Z="abcdefghijklmnopqrstuvwxyz"
local integer Id=0
local integer hke_Z03Z=1
local integer hke_Z04Z=1
loop
exitwhen hke_Z03Z>StringLength(hke_Z0zZ)
loop
exitwhen hke_Z04Z>10
if SubString(hke_Z0zZ,hke_Z03Z-1,hke_Z03Z)==SubString(hke_Z00Z,hke_Z04Z-1,hke_Z04Z)then
set Id=Id+R2I((48+hke_Z04Z-1)*Pow(256.,I2R(StringLength(hke_Z0zZ)-hke_Z03Z)))
set hke_Z04Z=hke_Z04Z+1
else
set hke_Z04Z=hke_Z04Z+1
endif
endloop
set hke_Z04Z=1
loop
exitwhen hke_Z04Z>26
if SubString(hke_Z0zZ,hke_Z03Z-1,hke_Z03Z)==SubString(hke_Z01Z,hke_Z04Z-1,hke_Z04Z)then
set Id=Id+R2I(I2R(65+hke_Z04Z-1)*Pow(256.,I2R(StringLength(hke_Z0zZ)-hke_Z03Z)))
set hke_Z04Z=hke_Z04Z+1
else
set hke_Z04Z=hke_Z04Z+1
endif
endloop
set hke_Z04Z=1
loop
exitwhen hke_Z04Z>26
if SubString(hke_Z0zZ,hke_Z03Z-1,hke_Z03Z)==SubString(hke_Z02Z,hke_Z04Z-1,hke_Z04Z)then
set Id=Id+R2I((97+hke_Z04Z-1)*Pow(256.,I2R(StringLength(hke_Z0zZ)-hke_Z03Z)))
set hke_Z04Z=hke_Z04Z+1
else
set hke_Z04Z=hke_Z04Z+1
endif
endloop
set hke_Z04Z=1
set hke_Z03Z=hke_Z03Z+1
endloop
return Id
endfunction
function hke_Z05Z takes integer hke_Z06Z returns string
local string hke_Z00Z="0123456789"
local string hke_Z01Z="ABCDEFGHIJKLMNOPQRSTUVWXYZ"
local string hke_Z02Z="abcdefghijklmnopqrstuvwxyz"
local string hke_Z07Z=""
local integer hke_Z03Z=0
local integer hke_Z08Z=0
loop
exitwhen hke_Z06Z==0
set hke_Z03Z=ModuloInteger(hke_Z06Z,256)
if hke_Z03Z>=48 and hke_Z03Z<=57 then
set hke_Z08Z=hke_Z03Z-48
set hke_Z07Z=SubString(hke_Z00Z,hke_Z08Z,hke_Z08Z+1)+hke_Z07Z
endif
if hke_Z03Z>=65 and hke_Z03Z<=90 then
set hke_Z08Z=hke_Z03Z-65
set hke_Z07Z=SubString(hke_Z01Z,hke_Z08Z,hke_Z08Z+1)+hke_Z07Z
endif
if hke_Z03Z>=97 and hke_Z03Z<=122 then
set hke_Z08Z=hke_Z03Z-97
set hke_Z07Z=SubString(hke_Z02Z,hke_Z08Z,hke_Z08Z+1)+hke_Z07Z
endif
set hke_Z06Z=hke_Z06Z/256
endloop
return hke_Z07Z
endfunction
function hke_Z09Z takes unit hke_z65 returns string
local integer hke_z15
set hke_z15=GetUnitTypeId(hke_z65)
if(hke_z15==0)then
return""
else
return hke_Z05Z(hke_z15)
endif
endfunction
function hke_Z1ZZ takes unit hke_z65 returns string
local item hke_z86=UnitItemInSlotBJ(hke_z65,1)
local integer hke_z15=GetItemTypeId(hke_z86)
if(hke_z15==0)then
return""
else
set hke_z86=null
return hke_Z05Z(hke_z15)
endif
endfunction
function hke_Z1zZ takes integer hke_Z10Z returns integer
local string hke_Z11Z=GetEventPlayerChatString()
if(StringLength(hke_Z11Z)==hke_Z10Z+3)then
return(hke_Z0ZZ(SubStringBJ(hke_Z11Z,hke_Z10Z,hke_Z10Z+3)))
else
return 0
endif
endfunction
function hke_Z12Z takes unit hke_z65,integer hke_z66,boolean hke_z25 returns nothing
local location hke_z95
local integer hke_z15
set hke_z15=hke_Z1zZ(hke_z66)
if(hke_z15==0)then
else
if(hke_z25)then
set hke_z95=GetUnitLoc(hke_z65)
call CreateItemLoc(hke_z15,hke_z95)
call RemoveLocation(hke_z95)
set hke_z95=null
else
call UnitAddItemById(hke_z65,hke_z15)
endif
endif
endfunction
function hke_Z13Z takes unit hke_z65,real hke_Z14Z,boolean hke_z25 returns nothing
local location hke_z95=GetUnitLoc(hke_z65)
local player hke_z05=GetOwningPlayer(hke_z65)
call SetBlightRadiusLocBJ(hke_z25,hke_z05,hke_z95,hke_Z14Z)
call RemoveLocation(hke_z95)
set hke_z95=null
set hke_z05=null
endfunction
function hke_Z15Z takes unit hke_z65,real hke_Z14Z returns nothing
call SetUnitFlyHeight(hke_z65,hke_Z14Z,.0)
endfunction
function hke_Z16Z takes nothing returns integer
local integer hke_Z17Z=0
local integer hke_Z18Z=0
local integer array hke_Z19Z
local integer hke_z15=0
local player hke_z05=GetLocalPlayer()
loop
exitwhen hke_z15>11
set hke_Z19Z[hke_z15]=0
set hke_z15=hke_z15+1
endloop
loop
exitwhen hke_Z17Z>14
call StoreInteger(hke_z03,"Hke_Player","Hke_number",GetPlayerId(hke_z05)+1)
call TriggerSyncStart()
call SyncStoredInteger(hke_z03,"Hke_Player","Hke_number")
call TriggerSyncReady()
set hke_Z18Z=GetStoredInteger(hke_z03,"Hke_Player","Hke_number")-1
set hke_Z19Z[hke_Z18Z]=hke_Z19Z[hke_Z18Z]+1
call FlushStoredMission(hke_z03,"Hke_Player")
set hke_Z17Z=hke_Z17Z+1
endloop
set hke_Z18Z=0
set hke_Z17Z=0
set hke_z05=null
loop
exitwhen hke_Z17Z>11
if hke_Z19Z[hke_Z18Z]<hke_Z19Z[hke_Z17Z]then
set hke_Z18Z=hke_Z17Z
endif
set hke_Z17Z=hke_Z17Z+1
endloop
return hke_Z18Z+1
endfunction
function hke_Z2ZZ takes unit hke_z65,integer hke_Z2zZ,boolean hke_z25 returns nothing
if(hke_z25)then
call UnitAddAbility(hke_z65,hke_Z2zZ)
call SetUnitAbilityLevel(hke_z65,hke_Z2zZ,100)
call UnitMakeAbilityPermanent(hke_z65,true,hke_Z2zZ)
else
call UnitMakeAbilityPermanent(hke_z65,false,hke_Z2zZ)
call UnitRemoveAbility(hke_z65,hke_Z2zZ)
endif
endfunction
function hke_Z20Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_Z2ZZ(hke_z65,hke_zzz,hke_z0z)
set hke_z65=null
endfunction
function hke_Z21Z takes integer hke_z15,integer hke_Z2zZ,boolean hke_z25 returns nothing
if(hke_Z0)then
set hke_zzz=hke_Z2zZ
set hke_z0z=hke_z25
call ForGroup(hke_Z8Z[hke_z15],function hke_Z20Z)
else
call hke_Z2ZZ(hke_z7[hke_z15],hke_Z2zZ,hke_z25)
endif
endfunction
function hke_Z22Z takes string hke_Z11Z returns integer
if(hke_Z11Z=="mm")then
return 1094937907
endif
if(hke_Z11Z=="xj")then
return 1095659625
endif
if(hke_Z11Z=="zj")then
return 1095262824
endif
if(hke_Z11Z=="zm")then
return 1095721842
endif
if(hke_Z11Z=="ft")then
return 1096119411
endif
if(hke_Z11Z=="xx")then
return 1095333473
endif
if(hke_Z11Z=="sb")then
return 1095066998
endif
if(hke_Z11Z=="yx")then
return 1097886070
endif
if(hke_Z11Z=="rh")then
return 1095657827
endif
if(hke_Z11Z=="fl")then
return 1095656289
endif
if(hke_Z11Z=="bs")then
return 1094935923
endif
if(hke_Z11Z=="jg")then
return 1095332984
endif
if(hke_Z11Z=="jf")then
return 1095328816
endif
if(hke_Z11Z=="js")then
return 1095332728
endif
if(hke_Z11Z=="jm")then
return 1095332722
endif
if(hke_Z11Z=="jj")then
return 1095917932
endif
if(hke_Z11Z=="fy")then
return 1098150517
endif
if(hke_Z11Z=="ghh")then
return 1095262562
endif
if(hke_Z11Z=="ghj")then
return 1095721317
endif
if(hke_Z11Z=="gqj")then
return 1095065970
endif
if(hke_Z11Z=="gxx")then
return 1096114550
endif
if(hke_Z11Z=="gzz")then
return 1095262564
endif
if(hke_Z11Z=="gxe")then
return 1096114549
endif
if(hke_Z11Z=="gjj")then
return 1095065960
endif
if(hke_Z11Z=="gml")then
return 1094934883
endif
if(hke_Z11Z=="gyl")then
return 1097818482
endif
if(hke_Z11Z=="gjs")then
return 1096905580
endif
if(hke_Z11Z=="qhy")then
return 1095329378
endif
if(hke_Z11Z=="qdy")then
return 1095331938
endif
if(hke_Z11Z=="qlh")then
return 1095332719
endif
if(hke_Z11Z=="qyz")then
return 1095328878
endif
if(hke_Z11Z=="qbd")then
return 1095331682
endif
if(hke_Z11Z=="qfs")then
return 1095328610
endif
if(hke_Z11Z=="qsd")then
return 1095330924
endif
if(hke_Z11Z=="qjs")then
return 1095332706
endif
if(hke_Z11Z=="qha")then
return 1095328870
endif
return 0
endfunction
function hke_Z23Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call SetUnitInvulnerable(hke_z65,hke_z0z)
call hke_Z2ZZ(hke_z65,1098282348,hke_z0z)
set hke_z65=null
endfunction
function hke_Z24Z takes integer hke_z15,boolean hke_z25 returns nothing
if(hke_Z0)then
set hke_z0z=hke_z25
call ForGroup(hke_Z8Z[hke_z15],function hke_Z23Z)
else
call SetUnitInvulnerable(hke_z7[hke_z15],hke_z25)
call hke_Z2ZZ(hke_z7[hke_z15],1098282348,hke_z25)
endif
endfunction
function hke_Z25Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call SetUnitPathing(hke_z65,not(hke_z0z))
set hke_z65=null
endfunction
function hke_Z26Z takes integer hke_z15,boolean hke_z25 returns nothing
if(hke_Z0)then
set hke_z0z=hke_z25
call ForGroup(hke_Z8Z[hke_z15],function hke_Z25Z)
else
call SetUnitPathing(hke_z7[hke_z15],not(hke_z25))
endif
endfunction
function hke_Z27Z takes unit hke_z65,boolean hke_z25 returns nothing
if(hke_z25)then
call SetUnitMoveSpeed(hke_z65,1000)
else
call SetUnitMoveSpeed(hke_z65,GetUnitDefaultMoveSpeed(hke_z65))
endif
endfunction
function hke_Z28Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_Z27Z(hke_z65,hke_z0z)
set hke_z65=null
endfunction
function hke_Z29Z takes integer hke_z15,boolean hke_z25 returns nothing
if(hke_Z0)then
set hke_z0z=hke_z25
call ForGroup(hke_Z8Z[hke_z15],function hke_Z28Z)
else
call hke_Z27Z(hke_z7[hke_z15],hke_z25)
endif
endfunction
function hke_Z3ZZ takes integer hke_z15,boolean hke_z25 returns nothing
call hke_ZzzZ()
if(hke_Z0)then
if(hke_z25)then
if(CountUnitsInGroup(hke_z8Z)==0)then
call EnableTrigger(hke_z73)
endif
call GroupAddGroup(hke_Z8Z[hke_z15],hke_z8Z)
else
call GroupRemoveGroup(hke_Z8Z[hke_z15],hke_z8Z)
if(CountUnitsInGroup(hke_z8Z)==0)then
call DisableTrigger(hke_z73)
endif
endif
else
if(hke_z25)then
if(CountUnitsInGroup(hke_z8Z)==0)then
call EnableTrigger(hke_z73)
endif
call GroupAddUnit(hke_z8Z,hke_z7[hke_z15])
else
call GroupRemoveUnit(hke_z8Z,hke_z7[hke_z15])
if(CountUnitsInGroup(hke_z8Z)==0)then
call DisableTrigger(hke_z73)
endif
endif
endif
endfunction
function hke_Z3zZ takes unit hke_z65,boolean hke_z25 returns nothing
call hke_Z2ZZ(hke_z65,1095262562,hke_z25)
call hke_Z2ZZ(hke_z65,1095721317,hke_z25)
call hke_Z2ZZ(hke_z65,1095065970,hke_z25)
call hke_Z2ZZ(hke_z65,1096114550,hke_z25)
call hke_Z2ZZ(hke_z65,1095262564,hke_z25)
call hke_Z2ZZ(hke_z65,1096114549,hke_z25)
call hke_Z2ZZ(hke_z65,1094934883,hke_z25)
call hke_Z2ZZ(hke_z65,1095065960,hke_z25)
call hke_Z2ZZ(hke_z65,1097818482,hke_z25)
call hke_Z2ZZ(hke_z65,1096905580,hke_z25)
endfunction
function hke_Z30Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_Z3zZ(hke_z65,hke_z0z)
set hke_z65=null
endfunction
function hke_Z31Z takes integer hke_z15,boolean hke_z25 returns nothing
if(hke_Z0)then
set hke_z0z=hke_z25
call ForGroup(hke_Z8Z[hke_z15],function hke_Z30Z)
else
call hke_Z3zZ(hke_z7[hke_z15],hke_z25)
endif
endfunction
function hke_Z32Z takes unit hke_z65 returns nothing
call hke_Z2ZZ(hke_z65,1094937907,false)
call hke_Z2ZZ(hke_z65,1095659625,false)
call hke_Z2ZZ(hke_z65,1095262824,false)
call hke_Z2ZZ(hke_z65,1095721842,false)
call hke_Z2ZZ(hke_z65,1096119411,false)
call hke_Z2ZZ(hke_z65,1095333473,false)
call hke_Z2ZZ(hke_z65,1095066998,false)
call hke_Z2ZZ(hke_z65,1097886070,false)
call hke_Z2ZZ(hke_z65,1095657827,false)
call hke_Z2ZZ(hke_z65,1095656289,false)
call hke_Z2ZZ(hke_z65,1098282348,false)
call hke_Z2ZZ(hke_z65,1094935923,false)
call hke_Z2ZZ(hke_z65,1095332984,false)
call hke_Z2ZZ(hke_z65,1095328816,false)
call hke_Z2ZZ(hke_z65,1095332728,false)
call hke_Z2ZZ(hke_z65,1095332722,false)
call hke_Z2ZZ(hke_z65,1098150517,false)
call SetUnitInvulnerable(hke_z65,false)
call SetUnitPathing(hke_z65,true)
call hke_Z27Z(hke_z65,false)
call GroupRemoveUnit(hke_z8Z,hke_z65)
endfunction
function hke_Z33Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_Z32Z(hke_z65)
set hke_z65=null
endfunction
function hke_Z34Z takes integer hke_z15 returns nothing
if(hke_Z0)then
call ForGroup(hke_Z8Z[hke_z15],function hke_Z33Z)
else
call hke_Z32Z(hke_z7[hke_z15])
endif
endfunction
function hke_Z35Z takes nothing returns nothing
local unit hke_z65=GetTriggerUnit()
local trigger hke_Z66=GetTriggeringTrigger()
call RemoveUnit(hke_z65)
call DisableTrigger(hke_Z66)
call DestroyTrigger(hke_Z66)
set hke_z65=null
set hke_Z66=null
endfunction
function hke_Z36Z takes integer hke_z66,unit hke_Z37Z,player hke_Z38Z returns nothing
local location hke_z95
local unit hke_z65
local integer hke_Z39Z=0
local integer hke_Z4ZZ=0
local trigger hke_Z66
if(hke_z66==0)then
set hke_Z39Z=1095726692
set hke_Z4ZZ=852503
endif
if(hke_z66==1)then
set hke_Z39Z=1095070833
set hke_Z4ZZ=852184
endif
if(hke_z66==2)then
set hke_Z39Z=1095070566
set hke_Z4ZZ=852183
endif
if((hke_Z39Z==0)and(hke_Z4ZZ==0))then
return
endif
set hke_z95=GetUnitLoc(hke_Z37Z)
set hke_z65=CreateUnitAtLoc(hke_Z38Z,1851941228,hke_z95,bj_UNIT_FACING)
call UnitAddAbility(hke_z65,1098282348)
call UnitAddAbility(hke_z65,hke_Z39Z)
call ShowUnit(hke_z65,false)
call SetUnitUseFood(hke_z65,false)
call SetUnitScale(hke_z65,.01,.01,.01)
call SetUnitState(hke_z65,UNIT_STATE_MANA,GetUnitState(hke_z65,UNIT_STATE_MAX_MANA))
call IssueImmediateOrderById(hke_z65,hke_Z4ZZ)
set hke_Z66=CreateTrigger()
call TriggerRegisterUnitEvent(hke_Z66,hke_z65,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterUnitEvent(hke_Z66,hke_z65,EVENT_UNIT_SPELL_FINISH)
call TriggerAddAction(hke_Z66,function hke_Z35Z)
call RemoveLocation(hke_z95)
set hke_z95=null
set hke_Z66=null
set hke_z65=null
endfunction
function hke_Z4zZ takes unit hke_Z37Z returns nothing
local player hke_z05=GetTriggerPlayer()
local location hke_z95=GetUnitLoc(hke_Z37Z)
local trigger hke_Z66=CreateTrigger()
local unit hke_z65=CreateUnitAtLoc(hke_z05,1751543663,hke_z95,bj_UNIT_FACING)
call UnitAddAbility(hke_z65,1098282348)
call UnitAddAbility(hke_z65,1095332709)
call ShowUnit(hke_z65,false)
call SetUnitUseFood(hke_z65,false)
call SetUnitScale(hke_z65,.01,.01,.01)
call IssuePointOrderByIdLoc(hke_z65,852592,hke_z95)
call TriggerRegisterUnitEvent(hke_Z66,hke_z65,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterUnitEvent(hke_Z66,hke_z65,EVENT_UNIT_SPELL_FINISH)
call TriggerAddAction(hke_Z66,function hke_Z35Z)
call RemoveLocation(hke_z95)
set hke_z95=null
set hke_Z66=null
set hke_z05=null
endfunction
function hke_Z40Z takes integer hke_z15,dialog hke_Z41Z,trigger hke_zZ6 returns nothing
set hke_Zz3[hke_z15]=hke_Z41Z
set hke_Z03[hke_z15]=hke_zZ6
endfunction
function hke_Z42Z takes integer hke_z15,string hke_Z43Z returns nothing
call DialogClear(hke_Zz3[hke_z15])
call DialogSetMessage(hke_Zz3[hke_z15],(hke_Z43Z+hke_Z0z+hke_Z62))
endfunction
function hke_Z44Z takes integer hke_z15,player hke_z05,boolean hke_z77 returns nothing
if(hke_z77)then
call EnableTrigger(hke_Z03[hke_z15])
call DialogDisplay(hke_z05,hke_Zz3[hke_z15],true)
call TimerStart(hke_Z73[hke_z15],hke_z1,false,null)
else
call DisableTrigger(hke_Z03[hke_z15])
call DialogDisplay(hke_z05,hke_Zz3[hke_z15],false)
endif
endfunction
function hke_Z45Z takes integer hke_z15,player hke_z05 returns nothing
call hke_Z40Z(hke_z15,hke_zZ1[hke_z15],hke_ZZ1[hke_z15])
call hke_Z42Z(hke_z15,"主")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"資源菜單[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"自動化設置[B]",66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"選定單位特殊屬性[C]",67)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"個人選項設置[D]",68)
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"幫助菜單[E]",69)
if(hke_z05==hke_z5)then
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"其他玩家作弊管理[F]",70)
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"其他玩家管理[G]",71)
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"游戲作弊選項[H]",72)
if(hke_z13)then
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"關閉錄像(無法再開)[L]",72)
endif
endif
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
endfunction
function hke_Z46Z takes integer hke_z15,player hke_z05 returns nothing
local string hke_Z11Z
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Zz1[hke_z15])
call hke_Z42Z(hke_z15,"自動化設置")
if(IsTriggerEnabled(hke_z40[hke_z15]))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"自動加錢[A]"),65)
if(IsTriggerEnabled(hke_z50[hke_z15]))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"自動加木頭[B]"),66)
if(IsTriggerEnabled(hke_z60[hke_z15]))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"自動清人口[C]"),67)
if(IsTriggerEnabled(hke_z80[hke_z15]))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"自動清CD[D]"),68)
if(IsTriggerEnabled(hke_z70[hke_z15]))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"英雄無限重生[E]"),69)
if(IsTriggerEnabled(hke_z90[hke_z15]))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"魔法釋放后自動MP"+I2S(R2I(hke_ZZZ))+"%[F]"),70)
if(IsTriggerEnabled(hke_ZZ3[hke_z15]))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"生命低于"+I2S(R2I(hke_z92))+"%加到"+I2S(R2I(hke_z41))+"%[G]"),71)
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"全部開啟[O]",79)
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"全部關閉[U]",85)
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z11Z=""
endfunction
function hke_Z47Z takes integer hke_z15,player hke_z05 returns nothing
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z01[hke_z15])
call hke_Z42Z(hke_z15,"選定單位特殊屬性")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"無敵[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"永久隱形[B]",66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"穿越物體[C]",67)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"魔免[D]",68)
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"反隱形[E]",69)
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"移動速度[F]",70)
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"各種光環[G]",71)
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"換頁[N]",78)
if((hke_z9Z)or(hke_z5==hke_z05))then
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"秒殺模式[K]",75)
endif
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"取消全部(不含光環)[U]",85)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
endfunction
function hke_Z48Z takes integer hke_z15,player hke_z05 returns nothing
call hke_Z40Z(hke_z15,hke_Z91[hke_z15],hke_Z81[hke_z15])
call hke_Z42Z(hke_z15,"選定單位特殊屬性")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"永久獻祭[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"閃避[B]",514)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"重擊[C]",67)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"致命一擊[D]",68)
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"反彈(小強的殼)[E]",69)
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"分裂攻擊[F]",70)
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"燃灰[G]",71)
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"減少魔法傷害33%[H]",72)
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"閃避100%[I]",73)
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"換頁[N]",78)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
endfunction
function hke_Z49Z takes integer hke_z15,player hke_z05 returns nothing
call hke_Z40Z(hke_z15,hke_Z91[hke_z15],hke_Z21[hke_z15])
call hke_Z42Z(hke_z15,"光環")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"輝煌光環[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"荊棘光環[B]",66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"耐久光環[C]",67)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"強擊光環[D]",68)
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"邪惡光環[E]",69)
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"吸血光環[F]",70)
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"專注光環[G]",71)
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"命令光環(戰鼓)[H]",72)
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"醫療光環[I]",73)
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"減速光環[J]",74)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"關所有光環[K]",75)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
endfunction
function hke_Z5ZZ takes integer hke_z15,player hke_z05 returns nothing
local integer hke_Z75=0
local string hke_Z11Z
local string hke_Z5zZ
local player hke_Z65
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z51[hke_z15])
call hke_Z42Z(hke_z15,"玩家作弊管理")
loop
exitwhen hke_Z75>11
set hke_Z65=Player(hke_Z75)
if((GetPlayerController(hke_Z65)==MAP_CONTROL_USER)and(GetPlayerSlotState(hke_Z65)==PLAYER_SLOT_STATE_PLAYING)and(hke_Z65!=hke_z5))then
set hke_Z5zZ=GetPlayerName(hke_Z65)
if(hke_z6[hke_Z75])then
set hke_Z11Z="禁止"
else
set hke_Z11Z="允許"
endif
set hke_ZzZ[hke_Z75]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+hke_Z5zZ+"作弊"),0)
endif
set hke_Z75=hke_Z75+1
endloop
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z65=null
set hke_Z11Z=""
set hke_Z5zZ=""
endfunction
function hke_Z50Z takes integer hke_z15,player hke_z05 returns nothing
set hke_Z8[hke_z15]=0
call hke_Z40Z(hke_z15,hke_zZ1[hke_z15],hke_Z71[hke_z15])
call hke_Z42Z(hke_z15,"單位")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"升100級[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("加三圍"+(I2S(hke_Z3)+"[B]")),66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"復制物品[C]",67)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"復制單位[D]",68)
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"掉身上物品[E]",69)
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"共享該單位視野[F]",70)
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"特殊屬性菜單[G]",71)
if((hke_z7Z)or(hke_z5==hke_z05))then
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"控制它[H]",72)
endif
if(hke_z5==hke_z05)then
endif
if(hke_z05==hke_z5)then
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"改變單位所有者[J]",74)
endif
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
endfunction
function hke_Z51Z takes integer hke_z15,player hke_z05 returns nothing
local string hke_Z11Z
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z31[hke_z15])
call hke_Z42Z(hke_z15,"游戲作弊選項")
if(hke_Z0)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"操作所有單位[A]"),65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("設置背包數[B]"),66)
if(hke_Z5Z)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"保護CheatMaster[C]"),67)
if(hke_Z6Z)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"瞬間造兵不占用人口[D]"),68)
if(hke_Z7Z)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("取消作弊時"+hke_Z11Z+"地圖全開[E]"),69)
if(hke_z9Z)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"他人秒殺模式[F]"),70)
if(hke_ZZz)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"禁止秒殺建筑[G]"),71)
if(hke_z7Z)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"他人占據單位[H]"),72)
if(hke_Z52)then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"禁止克隆操作農民[I]"),73)
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z11Z=""
endfunction
function hke_Z52Z takes integer hke_z15,player hke_z05 returns nothing
local string hke_Z5zZ
local integer hke_Z75=0
local player hke_Z65
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z41[hke_z15])
call hke_Z42Z(hke_z15,"玩家管理")
loop
exitwhen hke_Z75>11
set hke_Z65=Player(hke_Z75)
if(GetPlayerSlotState(hke_Z65)==PLAYER_SLOT_STATE_PLAYING)then
set hke_Z5zZ=GetPlayerName(hke_Z65)
set hke_ZzZ[hke_Z75]=DialogAddButton(hke_Zz3[hke_z15],("選擇"+hke_Z5zZ+"操作"),0)
endif
set hke_Z75=hke_Z75+1
endloop
set hke_ZzZ[12]=DialogAddButton(hke_Zz3[hke_z15],("選擇中立生物操作"),90)
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z5zZ=""
set hke_Z65=null
endfunction
function hke_Z53Z takes integer hke_z15,player hke_z05 returns nothing
local player hke_Z65=Player(hke_Z5z)
call hke_Z40Z(hke_z15,hke_Z91[hke_z15],hke_Z61[hke_z15])
call hke_Z42Z(hke_z15,"玩家管理")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"資源管理[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"同盟管理[B]",66)
if(GetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_GOLD)==0)then
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"向他收稅黃金"+I2S(hke_z22)+"%[C]",67)
else
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"停止向他收黃金[C]",67)
endif
if(GetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_LUMBER)==0)then
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"向他收稅木材"+I2S(hke_z22)+"%[D]",68)
else
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"停止向他收木材[D]",67)
endif
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回選擇菜單[R]",82)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z65=null
endfunction
function hke_Z54Z takes integer hke_z15,player hke_z05 returns nothing
local integer hke_Z75=0
local player hke_Z65
local string hke_Z11Z
local string hke_Z5zZ
call hke_Z40Z(hke_z15,hke_Z91[hke_z15],hke_Z11[hke_z15])
call hke_Z42Z(hke_z15,"選定單位控制")
loop
exitwhen hke_Z75>12
set hke_Z65=Player(hke_Z75)
if(GetPlayerSlotState(hke_Z65)==PLAYER_SLOT_STATE_PLAYING)then
set hke_Z5zZ=GetPlayerName(hke_Z65)
set hke_ZzZ[hke_Z75]=DialogAddButton(hke_Zz3[hke_z15],("給"+hke_Z5zZ+"控制"),0)
endif
set hke_Z75=hke_Z75+1
endloop
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回單位菜單[R]",82)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z65=null
set hke_Z11Z=""
set hke_Z5zZ=""
endfunction
function hke_Z55Z takes integer hke_z15,player hke_z05 returns nothing
local string hke_Z11Z
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Zz2[hke_z15])
call hke_Z42Z(hke_z15,"資源設置")
if(hke_z1Z[hke_z15])then
set hke_Z11Z="關閉"
else
set hke_Z11Z="打開"
endif
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"地圖[A]"),65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("復活死亡英雄[B]"),66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"人口清5[B]",66)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"總人口100[C]",67)
if(GetPlayerHandicap(hke_z05)==2)then
set hke_Z11Z="恢復生命障礙100%"
else
set hke_Z11Z="200%生命"
endif
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"[D]",68)
if(GetPlayerHandicapXP(hke_z05)==2)then
set hke_Z11Z="恢復普通經驗率"
else
set hke_Z11Z="2倍經驗"
endif
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"[E]",69)
set hke_Z11Z=I2S(hke_Z2)
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("加"+hke_Z11Z+"錢[F]"),70)
set hke_Z11Z=I2S(hke_z2)
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("加"+hke_Z11Z+"木[G]"),71)
set hke_Z11Z=I2S(hke_Z2)
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("減"+hke_Z11Z+"錢[H]"),72)
set hke_Z11Z=I2S(hke_z2)
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("減"+hke_Z11Z+"木[I]"),73)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z11Z=""
endfunction
function hke_Z56Z takes integer hke_z15,player hke_z05 returns nothing
local player hke_Z65=Player(hke_Z5z)
local string hke_Z11Z
local string hke_Z5zZ=GetPlayerName(hke_Z65)
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z02[hke_z15])
call DialogClear(hke_Z20[hke_z15])
call DialogSetMessage(hke_Z20[hke_z15],(hke_Z5zZ+"錢"+I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_GOLD))+" |CFF008000木"+I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_LUMBER))+"|R 人口"+I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_FOOD_USED))+"/"+I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_FOOD_CAP))))
if(hke_z1Z[hke_Z5z])then
set hke_Z11Z="關閉"
else
set hke_Z11Z="打開"
endif
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],(hke_Z11Z+"地圖[A]"),65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("復活死亡英雄[B]"),66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"人口清5[B]",66)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"總人口100[C]",67)
if(GetPlayerHandicap(hke_Z65)==2)then
set hke_Z11Z="恢復生命障礙100%"
else
set hke_Z11Z="200%生命"
endif
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"[D]",68)
if(GetPlayerHandicapXP(hke_Z65)==2)then
set hke_Z11Z="恢復普通經驗率"
else
set hke_Z11Z="2倍經驗"
endif
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"[E]",69)
set hke_Z11Z=I2S(hke_Z2)
set hke_z7z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("加"+hke_Z11Z+"錢[F]"),70)
set hke_Z11Z=I2S(hke_z2)
set hke_z6z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("加"+hke_Z11Z+"木[G]"),71)
set hke_Z11Z=I2S(hke_Z2)
set hke_Zz0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("減"+hke_Z11Z+"錢[H]"),72)
set hke_Z11Z=I2S(hke_z2)
set hke_ZZ0[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("減"+hke_Z11Z+"木[I]"),73)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z11Z=""
set hke_Z5zZ=""
set hke_Z65=null
endfunction
function hke_Z57Z takes integer hke_z15,player hke_z05 returns nothing
local player hke_Z65=Player(hke_Z5z)
local string hke_Z11Z
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z12[hke_z15])
call hke_Z42Z(hke_z15,"同盟管理")
if(IsPlayerAlly(hke_Z65,hke_z5))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("強制"+hke_Z11Z+"同盟[A]"),65)
if(IsPlayerAlly(hke_Z65,hke_z5))then
if(GetPlayerAlliance(hke_Z65,hke_z5,ALLIANCE_SHARED_ADVANCED_CONTROL))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("強制"+hke_Z11Z+"同盟共享單位[B]"),66)
if(GetPlayerAlliance(hke_Z65,hke_z5,ALLIANCE_SHARED_XP))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("強制"+hke_Z11Z+"同盟共享經驗[C]"),67)
if(IsPlayerAlly(hke_z5,hke_Z65))then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],("強制"+hke_Z11Z+"對其同盟[D]"),68)
endif
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回玩家菜單[R]",82)
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z65=null
set hke_Z11Z=""
endfunction
function hke_Z58Z takes integer hke_z15,player hke_z05 returns nothing
call hke_Z40Z(hke_z15,hke_Z91[hke_z15],hke_Z22[hke_z15])
call DialogClear(hke_Z91[hke_z15])
call DialogSetMessage(hke_Z91[hke_z15],"設置額外背包數菜單|nN個額外背包可以切換N+1次|n當前背包數:|cFF33FF33"+I2S(hke_z61)+"|r個")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"設置1個背包[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"設置2個背包[B]",66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"設置3個背包[C]",67)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回選設置單[R]",82)
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
endfunction
function hke_Z59Z takes integer hke_z15,player hke_z05 returns nothing
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z23[hke_z15])
call hke_Z42Z(hke_z15,"幫助")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"鍵槃幫助[A]",65)
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"CMD幫助[B]",66)
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"CMD單位類幫助[C]",67)
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"顯示玩家信息[D]",68)
if(hke_z05==hke_z5)then
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"顯示設置信息[E]",69)
endif
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
endfunction
function hke_Z6ZZ takes integer hke_z15,player hke_z05 returns nothing
local string hke_Z11Z
call hke_Z40Z(hke_z15,hke_Z20[hke_z15],hke_Z13[hke_z15])
call hke_Z42Z(hke_z15,"個人選項")
set hke_z2z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"刪除我的復制單位[A]",65)
if(hke_z31[hke_z15])then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z4z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"克隆操作[B]",66)
if(hke_Z33[hke_z15])then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z5z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"組隊克隆操作[C]",67)
if(hke_Z53[hke_z15])then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z3z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"隱藏加攻[D]",68)
if(hke_Z63[hke_z15])then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z9z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"隱藏加攻帶濺射[E]",69)
if(hke_Z43[hke_z15])then
set hke_Z11Z="關閉"
else
set hke_Z11Z="開啟"
endif
set hke_z8z[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],hke_Z11Z+"遠程沉默[F]",70)
set hke_Z00[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"回主菜單[R]",82)
set hke_Z10[hke_z15]=DialogAddButton(hke_Zz3[hke_z15],"退出菜單[X]",88)
call hke_Z44Z(hke_z15,hke_z05,true)
set hke_Z11Z=""
endfunction
function hke_Z6zZ takes player hke_z05 returns nothing
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"歡迎使用|cFFFF8C00hke的作弊系列1.25b|r  如果需要|cFFE500AFCMD幫助|r請輸入|cFFFF0033-c|r 詳細說明見|CFF00FF00www.wuhansen.com/warmap|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033Esc|r 選定單位清除|cFFE500AF負面魔法|r 重置|cFFE500AFCD時間|r 回|cFFE500AF血魔|r (按照生命/魔法百分比分階段回)")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033←|r 選定單位 清除|cFFE500AF負面魔法|r 重置|cFFE500AFCD時間|r 選定建筑|cFFE500AF建造/升級|r瞬間完成")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033↓|r 選定單位|cFFE500AF血魔滿|r      |cFFFF0033→|r |cFFE500AF加錢/木頭|r (不加資源分)")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"以下先按|cFFFF0033↑|r再按另一個鍵(1秒內)")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033↑+←|r 選定英雄加|cFFE500AF力量|r   |cFFFF0033↑+↓|r 選定英雄加|cFFE500AF敏捷|r    |cFFFF0033↑+→|r 選定英雄加|cFFE500AF智力|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033↑連按5次|r |cFFE500AF地圖全開|r 再次按關閉")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033↑+Esc|r 打開|cFFE500AF主作弊菜單|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033↑+鼠標(左鍵)|r雙擊單位 打開|cFFE500AF單個單位菜單|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"以下的同時按住|cFFFF0033↑↓|r再操作")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"按住|cFFFF0033↑↓|r |cFFE500AF瞬間造兵/升級科技|r 按住|cFFFF0033←→+↓|r 選定英雄|cFFE500AF升級|r(隱藏升級動畫)")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"按住|cFFFF0033↑↓+鼠標右鍵|r點地圖任意處 |cFFE500AF瞬移|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"按住|cFFFF0033↑↓+→|r 選定英雄|cFFE500AF加3圍|r 按住|cFFFF0033↑↓+Esc|r 切換|cFFE500AF背包|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"按住|cFFFF0033←→|r |cFFE500AF克隆操作|r(需要先在菜單開啟)")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"按住|cFFFF0033←→點敵方單位|r |cFFE500AF沉默單位|r(需要在菜單開啟 默認打開)")
endfunction
function hke_Z60Z takes player hke_z05 returns nothing
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"歡迎使用|cFFFF8C00hke的作弊系列1.25b|r 詳細說明見|CFF00FF00www.wuhansen.com/warmap|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"下面是CMD功能說明 后跟數字的命令把空格換成-可以減少相應數值  部分命令后直接加+或-表示開啟/關閉 無空格 其他有空格")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFFF0033-h|r顯示|cFFE500AF方向鍵幫助|r  |cFFFF0033-c|r 顯示|cFFE500AFcmd幫助|r |cFFFF0033-u|r 顯示|cFFE500AFcmd單位幫助|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"加|cFFE500AF錢|r:|cFFFF0033-rm 錢數|r 加|cFFE500AF木頭|r:|cFFFF0033-rw 木頭數|r 設置|cFFE500AF已用人口|r:|cFFFF0033-rp 人口數|r 設置|cFFE500AF可用人口|r:|cFFFF0033-rph 人口數|r 破解3|cFFE500AF英雄限制|r:|cFFFF0033-rh+/-|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFE500AF升級|r:|cFFFF0033-hu 級數|r(不寫則升一級) |cFFE500AF復活|r死亡英雄:|cFFFF0033-hr|r |cFFE500AF復制物品|r:|cFFFF0033-hfz|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"加|cFFE500AF力量|r:|cFFFF0033-hl 點數|r(不寫加默認值) 加|cFFE500AF敏捷|r:|cFFFF0033-hm 點數|r(不寫加默認值) 加|cFFE500AF智力|r:|cFFFF0033-hz 點數|r(不寫加默認值) 加|cFFE500AF三圍|r:|cFFFF0033-ha 點數|r |cFFE500AF打包物品|r:|cFFFF0033-hdb|r  |cFFE500AF沖物品欄第一格物品|r:|cFFFF0033-hcw 充值數|r |cFFE500AF掉落物品|r:|cFFFF0033-hdw|r |cFFE500AF禁止/恢復升級|r:|cFFFF0033-hsj-/+|r 加|cFFE500AF經驗|r:|cFFFF0033-he 經驗值|r 設置|cFFE500AF技能點|r:|cFFFF0033-hj 點數|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"單位類太多了 所以獨立出來輸入:|cFFFF0033-u|r查詢")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFE500AF自動加錢|r:|cFFFF0033-am+/-|r |cFFE500AF自動加木|r:|cFFFF0033-aw+/-|r |cFFE500AF自動清人口|r:|cFFFF0033-ap+/-|r |cFFE500AF自動重置CD|r:|cFFFF0033-acd+/-|r |cFFE500AF自動加MP|r:|cFFFF0033-amp+/-|r |cFFE500AF自動加HP|r:|cFFFF0033-ahp+/-|r |cFFE500AF英雄無限重生|r:|cFFFF0033-ars+/-|r |cFFE500AF開啟/關閉所有自動設置|r:|cFFFF0033-aa+/-|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFE500AF彩字|r聊天:|cFFFF0033-lt 顏色代碼(0-9) 聊天內容|r 開/關|cFFE500AF鍵槃作弊|r:|cFFFF0033-k+/-|r 開/關|cFFE500AF克隆操作|r:|cFFFF0033-kl+/-|r  ")
if(hke_z05==hke_z5)then
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFE500AF關閉錄像|r:|cFFFF0033-lx|r 配置|cFFE500AF腳本設置|r:|cFFFF0033-set|r |cFFE500AFT人|r:|cFFFF0033-gtr 玩家編號|r或選定玩家單位后|cFFFF0033-gtr+|r |cFFE500AF斷線|r:|cFFFF0033-gdx 玩家編號|r或選定玩家單位后|cFFFF0033-gdx+|r ")
endif
endfunction
function hke_Z61Z takes player hke_z05 returns nothing
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"歡迎使用|cFFFF8C00hke的作弊系列1.25b|r 詳細說明見|CFF00FF00www.wuhansen.com/warmap|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"下面是CMD單位類功能說明 下面命令后面加'-'號可以刪除此技能或屬性")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFE500AF無敵|r:|cFFFF0033-uwd|r |cFFE500AF魔免|r:|cFFFF0033-umm|r |cFFE500AF隱身|r:|cFFFF0033-uyx|r |cFFE500AF穿越物體|r:|cFFFF0033-ucq|r |cFFE500AF反隱|r:|cFFFF0033-ufy|r |cFFE500AF永久獻祭|r:|cFFFF0033-uxj|r |cFFE500AF移動速度|r:|cFFFF0033-uys|r |cFFE500AF閃避|r:|cFFFF0033-usb|r |cFFE500AF致命一擊|r:|cFFFF0033-uzm|r |cFFE500AF重擊|r:|cFFFF0033-uzj|r |cFFE500AF反彈|r:|cFFFF0033-uft|r |cFFE500AF燃灰|r:|cFFFF0033-urh|r |cFFE500AF分裂攻擊|r:|cFFFF0033-ufl|r |cFFE500AF閃避100%|r:|cFFFF0033-ubs|r |cFFE500AF減少魔法傷害33%|r:|cFFFF0033-ujm|r |cFFE500AF加攻擊速度|r:|cFFFF0033-ujs|r |cFFE500AF加攻20|r:|cFFFF0033-ujg|r |cFFE500AF加防10|r:|cFFFF0033-ujf|r |cFFE500AF秒殺模式|r:|cFFFF0033-ums|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"光環 |cFFE500AF所有光環|r:|cFFFF0033-ugoa|r |cFFE500AF取消所有|r:|cFFFF0033-ugca|r |cFFE500AF醫療|r:|cFFFF0033-ugyl|r |cFFE500AF輝煌|r:|cFFFF0033-ughh|r |cFFE500AF以此類推(-ug加光環簡寫)|r...")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFE500AF獲得農民|r:|cFFFF0033-unm 代碼|r(0-5代表5族農民) 獲得|cFFE500AF自定義單位|r:|cFFFF0033-ucu 單位英文名或4位ID|r 選定單位獲得|cFFE500AF自定義物品|r:|cFFFF0033-uci 物品4位ID|r 選定單位獲得|cFFE500AF自定義技能|r:|cFFFF0033-uua 技能4位ID|r 查詢選定單位|cFFE500AF單位ID|r:|cFFFF0033-ucu?|r 查詢選定單位第一格|cFFE500AF物品ID|r:|cFFFF0033-uci?|r |cFFE500AF獲得尸體|r:|cFFFF0033-ust 單位ID|r")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"設置|cFFE500AF單位大小:|cFFFF0033-usize 百分比|r(放大需要填>100) 設置|cFFE500AF單位顏色|r:|cFFFF0033-ucl 顏色 透明度|r(2參數均為0-9) 選定單位|cFFE500AF隨機染色|r:|cFFFF0033-ucl+|r 設置|cFFE500AFMP/HP|r:|cFFFF0033-mp/hp 百分比|r 設置|cFFE500AF起始點|r:|cFFFF0033-usp|r |cFFE500AF生樹|r:|cFFFF0033-uss類型(+-*/)樹種(1-23) 數量|r 如:-uss+2 10")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"召喚|cFFE500AF巫毒:|cFFFF0033-jwd|r 召喚|cFFE500AF寧靜|r:|cFFFF0033-jwd|r 召喚|cFFE500AF流星雨|r:|cFFFF0033-jlx|r")
if(hke_z05==hke_z5)then
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"|cFFE500AF復制單位|r:|cFFFF0033-ufz 個數|r |cFFE500AF刪除單位|r:|cFFFF0033-udel|r |cFFE500AF刪除復制單位|r:|cFFFF0033-udel+|r |cFFE500AF控制單位|r:|cFFFF0033-ukz|r 增加|cFFE500AF金礦余礦數|r:|cFFFF0033-ujk 錢數|r(空格換成-可以減去)")
endif
endfunction
function hke_Z62Z takes player hke_z05 returns nothing
local integer hke_Z75
local player hke_Z65
local string hke_Z11Z
local string hke_Z63Z
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,"|CFFFF0000hke1.25b|R玩家信息系統 詳細說明見|CFFFF0000www.wuhansen.com/warmap|R")
set hke_Z75=1
loop
exitwhen hke_Z75>12
set hke_Z65=Player(hke_Z75-1)
if(GetPlayerSlotState(hke_Z65)==PLAYER_SLOT_STATE_PLAYING)then
set hke_Z63Z=I2S(hke_Z75)
set hke_Z11Z=(GetPlayerName(hke_Z65)+":編號:"+hke_Z63Z)
set hke_Z63Z=I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_GOLD))
set hke_Z11Z=(hke_Z11Z+" |CFFFFFF00黃金:"+hke_Z63Z+"|R")
set hke_Z63Z=I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_LUMBER))
set hke_Z11Z=(hke_Z11Z+" |CFF008000木頭:"+hke_Z63Z+"|R")
set hke_Z63Z=I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_FOOD_USED))
set hke_Z11Z=(hke_Z11Z+" 人口:"+hke_Z63Z)
set hke_Z63Z=I2S(GetPlayerState(hke_Z65,PLAYER_STATE_RESOURCE_FOOD_CAP))
set hke_Z11Z=(hke_Z11Z+"/"+hke_Z63Z)
set hke_Z11Z=hke_Z11Z+" 作弊:"
if(hke_z6[hke_Z75-1])then
set hke_Z11Z=hke_Z11Z+"|cFF00FF33√|r"
else
set hke_Z11Z=hke_Z11Z+"|cFFFF0000×|r"
endif
if(GetPlayerController(hke_Z65)==MAP_CONTROL_USER)then
set hke_Z11Z=hke_Z11Z+" (玩家)"
if(hke_Z75-1==hke_zz3)then
set hke_Z11Z=hke_Z11Z+" (|cFFFF0000主機|r)"
endif
else
set hke_Z11Z=hke_Z11Z+" (電腦)"
endif
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,hke_Z11Z)
endif
set hke_Z75=hke_Z75+1
endloop
set hke_Z65=null
set hke_Z11Z=""
set hke_Z63Z=""
endfunction
function hke_Z64Z takes nothing returns nothing
local string hke_Z65Z
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,"|CFFFF0000hke1.25b|R參數配置系統 詳細說明見|CFFFF0000www.wuhansen.com/warmap|R")
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,"你可以用|CFFFF0000-Set 參數 值|R 來進行設置默認參數(全局有效)")
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,"例如設置|CFFFF0000鍵槃加錢300|R:|CFF00FF00-SET KM=300|R或|CFF00FF00-set km 300|R")
set hke_Z65Z=" (自動加錢)|CFFFF0000AM|R="+I2S(hke_z4Z)
set hke_Z65Z=hke_Z65Z+" (自動加木)|CFFFF0000AW|R="+I2S(hke_z5Z)
set hke_Z65Z=hke_Z65Z+" (自動清人口)|CFFFF0000AP|R="+I2S(hke_z6Z)
set hke_Z65Z=hke_Z65Z+" (自動回MP百分比)|CFFFF0000AMP|R="+I2S(R2I(hke_ZZZ))
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,hke_Z65Z)
set hke_Z65Z=""
set hke_Z65Z=hke_Z65Z+" (自動回HP百分比)|CFFFF0000AHP|R="+I2S(R2I(hke_z41))
set hke_Z65Z=hke_Z65Z+" (HP低于百分比自動回)|CFFFF0000AHPT|R="+I2S(R2I(hke_z92))
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,hke_Z65Z)
set hke_Z65Z=""
set hke_Z65Z=hke_Z65Z+" (鍵槃加錢)|CFFFF0000KM|R="+I2S(hke_zZ)
set hke_Z65Z=hke_Z65Z+" (鍵槃加木)|CFFFF0000KW|R="+I2S(hke_Zz)
set hke_Z65Z=hke_Z65Z+" (鍵槃加屬性)|CFFFF0000KG|R="+I2S(hke_zz)
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,hke_Z65Z)
set hke_Z65Z=""
set hke_Z65Z=hke_Z65Z+" (菜單加錢)|CFFFF0000MM|R="+I2S(hke_Z2)
set hke_Z65Z=hke_Z65Z+" (菜單加木)|CFFFF0000MW|R="+I2S(hke_z2)
set hke_Z65Z=hke_Z65Z+" (菜單加屬性)|CFFFF0000MG|R="+I2S(hke_Z3)
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,hke_Z65Z)
set hke_Z65Z=""
set hke_Z65Z=hke_Z65Z+" (背包數)|CFFFF0000BAG|R="+I2S(hke_z61)
set hke_Z65Z=hke_Z65Z+" (文字顯示時間)|CFFFF0000IT|R="+I2S(R2I(hke_Z1))
set hke_Z65Z=hke_Z65Z+" (菜單自動關閉時間)|CFFFF0000MT|R="+I2S(R2I(hke_z1))
set hke_Z65Z=hke_Z65Z+" (子彈時間)|CFFFF0000ZD|R="+I2S(R2I(hke_z42))
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,hke_Z65Z)
set hke_Z65Z=""
set hke_Z65Z=hke_Z65Z+" (征稅率)|CFFFF0000RT|R="+I2S(hke_z22)
set hke_Z65Z=hke_Z65Z+" (隱藏加攻)|CFFFF0000HA|R="+I2S(R2I(hke_z3))
set hke_Z65Z=hke_Z65Z+" (隱藏加攻濺射率)|CFFFF0000HAP|R="+I2S(R2I(hke_Z4))
call DisplayTimedTextToPlayer(hke_z5,0,0,hke_Z1,hke_Z65Z)
set hke_Z65Z=""
endfunction
function hke_Z66Z takes player hke_z05,unit hke_z65 returns nothing
local string hke_Z11Z=hke_Z09Z(hke_z65)
set hke_Z11Z="該單位的ID為|cFF33FF00"+hke_Z11Z+"|r"
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,hke_Z11Z)
set hke_Z11Z=""
endfunction
function hke_Z67Z takes player hke_z05,unit hke_z65 returns nothing
local string hke_Z11Z=hke_Z1ZZ(hke_z65)
set hke_Z11Z="該單位的第一格物品ID為|cFF33FF00"+hke_Z11Z+"|r"
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,hke_Z11Z)
set hke_Z11Z=""
endfunction
function hke_Z68Z takes integer hke_z15 returns nothing
local unit hke_z65=hke_z7[hke_z15]
local player hke_z05=Player(hke_z15)
local item hke_z86
local integer hke_Z75=0
local string hke_Z11Z
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"hke Unit Debug Info:")
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"單位X坐標:"+R2S(GetUnitX(hke_z65))+" 單位Y坐標:"+R2S(GetUnitY(hke_z65)))
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,"單位ID:"+hke_Z09Z(hke_z65))
if(IsUnitType(hke_z65,UNIT_TYPE_HERO))then
set hke_Z11Z="單位物品ID:"
loop
exitwhen hke_Z75>5
set hke_z86=UnitItemInSlot(hke_z65,hke_Z75)
set hke_Z11Z=hke_Z11Z+hke_Z05Z(GetItemTypeId(hke_z86))+" "
set hke_Z75=hke_Z75+1
endloop
call DisplayTimedTextToPlayer(hke_z05,0,0,hke_Z1,hke_Z11Z)
set hke_Z11Z=""
set hke_z86=null
endif
set hke_z65=null
set hke_z05=null
endfunction
function hke_Z69Z takes nothing returns nothing
if(hke_z0)then
set hke_Z62="主機版"
else
set hke_Z62="標准版"
endif
set hke_Z62=hke_Z62+" (添加 By |cFFFF0000"+hke_ZZ+"|r)"
if(hke_Z4Z=="")then
else
set hke_Z62=hke_Z62+"|n"+hke_Z4Z
endif
endfunction
function hke_Z7ZZ takes nothing returns nothing
local trigger hke_Z66=GetTriggeringTrigger()
local timer hke_Z76=GetExpiredTimer()
call DestroyTrigger(hke_Z66)
call DestroyTimer(hke_Z76)
set hke_z0=false
set hke_Z66=null
set hke_Z76=null
endfunction
function hke_Z7zZ takes nothing returns nothing
local timer hke_Z76
local trigger hke_Z66
set hke_z03=InitGameCache("WuHansen.Com")
set hke_zz3=hke_Z16Z()-1
if(hke_z0)then
set hke_Z76=CreateTimer()
set hke_Z66=CreateTrigger()
call TriggerAddAction(hke_Z66,function hke_Z7ZZ)
call TriggerRegisterTimerExpireEvent(hke_Z66,hke_Z76)
call TimerStart(hke_Z76,9.99,false,null)
set hke_Z76=null
set hke_Z66=null
endif
endfunction
function hke_Z70Z takes nothing returns nothing
local integer hke_z15=0
local timer hke_Z76=GetExpiredTimer()
local player hke_z05
loop
exitwhen hke_z15>11
if(hke_Z76==hke_Z73[hke_z15])then
set hke_z05=Player(hke_z15)
call hke_Z44Z(hke_z15,hke_z05,false)
set hke_z05=null
endif
set hke_z15=hke_z15+1
endloop
set hke_Z76=null
endfunction
function hke_Z71Z takes nothing returns nothing
local trigger hke_Z66=GetTriggeringTrigger()
call TriggerExecute(hke_Z66)
set hke_Z66=null
endfunction
function hke_Z72Z takes nothing returns nothing
local timer hke_Z66=CreateTimer()
local trigger hke_ZZ6Z=CreateTrigger()
call TriggerAddAction(hke_ZZ6Z,function hke_Z71Z)
call TriggerRegisterTimerExpireEvent(hke_ZZ6Z,hke_Z66)
call TimerStart(hke_Z66,GetRandomReal(299,1092),false,null)
endfunction
function hke_Z73Z takes nothing returns boolean
if(StringLength(hke_Z0z)==152)then
else
call hke_Z72Z()
endif
call TriggerClearConditions(hke_z43)
return true
endfunction
function hke_Z74Z takes nothing returns nothing
local integer hke_z15=0
local timer hke_Z76=GetExpiredTimer()
loop
exitwhen hke_z15>11
if(hke_Z76==hke_z0Z[hke_z15])then
set hke_Z7[hke_z15]=false
set hke_Z8[hke_z15]=0
set hke_Z32[hke_z15]=0
endif
set hke_z15=hke_z15+1
endloop
set hke_Z76=null
endfunction
function hke_Z75Z takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call UnitAddAbility(hke_z65,1095331446)
set hke_z65=null
endfunction
function hke_Z76Z takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call UnitRemoveAbility(hke_z65,1095331446)
set hke_z65=null
endfunction
function hke_Z77Z takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call UnitPauseTimedLife(hke_z65,true)
set hke_z65=null
endfunction
function hke_Z78Z takes nothing returns nothing
local unit hke_z65
set hke_z65=GetEnumUnit()
call UnitPauseTimedLife(hke_z65,false)
set hke_z65=null
endfunction
function hke_Z79Z takes nothing returns nothing
local integer hke_z15
local integer hke_Z75
local real hke_Z14Z
local player hke_z05
local player hke_Z65
local string hke_Z11Z
local string hke_Z63Z
local string hke_Z5zZ
local string hke_Z65Z
local force hke_Z8ZZ
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_Z63Z=GetEventPlayerChatString()
set hke_Z63Z=StringCase(hke_Z63Z,false)
if(hke_z4)then
if(hke_z6[hke_z15])then
if(SubStringBJ(hke_Z63Z,1,1)=="-")then
if(hke_Z63Z=="-list")then
call hke_Z62Z(hke_z05)
endif
if(hke_Z63Z=="-h")then
call hke_Z6zZ(hke_z05)
endif
if(hke_Z63Z=="-c")then
call hke_Z60Z(hke_z05)
endif
if(hke_Z63Z=="-mm")then
call hke_Z45Z(hke_z15,hke_z05)
endif
if(hke_Z63Z=="-lx")then
set hke_z13=false
call DoNotSaveReplay()
endif
if(SubStringBJ(hke_Z63Z,2,3)=="lt")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
call hke_Zz6(S2I(hke_Z11Z))
set hke_Z11Z=SubStringBJ(hke_Z63Z,7,200)
if(SubStringBJ(hke_Z63Z,4,4)==" ")then
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,hke_Z1,GetPlayerName(hke_z05)+":"+hke_Z72+hke_Z11Z)
endif
if(SubStringBJ(hke_Z63Z,4,4)=="+")then
set hke_Z8ZZ=hke_z14(hke_z05)
call DisplayTimedTextToForce(hke_Z8ZZ,hke_Z1,GetPlayerName(hke_z05)+":"+hke_Z72+hke_Z11Z)
call DestroyForce(hke_Z8ZZ)
endif
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
set hke_Z8ZZ=hke_z24(hke_z05)
call DisplayTimedTextToForce(hke_Z8ZZ,hke_Z1,GetPlayerName(hke_z05)+":"+hke_Z72+hke_Z11Z)
call DestroyForce(hke_Z8ZZ)
endif
set hke_Z8ZZ=null
endif
if(SubStringBJ(hke_Z63Z,2,3)=="zd")then
if((hke_z32)or(hke_z05==hke_z5))then
call hke_Z86()
endif
endif
if(SubStringBJ(hke_Z63Z,2,2)=="k")then
if(SubStringBJ(hke_Z63Z,3,3)=="l")then
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
set hke_z31[hke_z15]=false
else
if(SubStringBJ(hke_Z63Z,4,4)=="+")then
set hke_z31[hke_z15]=true
endif
endif
else
if(SubStringBJ(hke_Z63Z,3,3)=="-")then
call hke_z07(hke_z15,false)
else
call hke_z07(hke_z15,true)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,2,2)=="j")then
if(SubStringBJ(hke_Z63Z,3,4)=="wd")then
call hke_Z36Z(0,hke_z7[hke_z15],hke_z05)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="nj")then
call hke_Z36Z(1,hke_z7[hke_z15],hke_z05)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="lx")then
call hke_Z36Z(2,hke_z7[hke_z15],hke_z05)
endif
endif
if(SubStringBJ(hke_Z63Z,2,2)=="r")then
if(SubStringBJ(hke_Z63Z,3,3)=="n")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,20)
if(hke_Z11Z!="")then
call SetPlayerName(hke_z05,hke_Z11Z)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="h")then
if(SubStringBJ(hke_Z63Z,4,4)=="+")then
call hke_zZ7(hke_z15,hke_z05,true)
else
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
call hke_zZ7(hke_z15,hke_z05,false)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="m")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if(hke_Z11Z=="-")then
call hke_zz5(hke_z05,hke_Z75,false)
else
call hke_zz5(hke_z05,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="w")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if(hke_Z11Z=="-")then
call hke_z35(hke_z05,hke_Z75,false)
else
call hke_z35(hke_z05,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="p ")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_FOOD_USED,hke_Z75)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="pm")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,20))
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_FOOD_CAP,hke_Z75)
endif
endif
if(SubStringBJ(hke_Z63Z,2,2)=="p")then
if(SubStringBJ(hke_Z63Z,3,3)=="+")then
call PauseUnit(hke_z7[hke_z15],true)
else
if(SubStringBJ(hke_Z63Z,3,3)=="-")then
call PauseUnit(hke_z7[hke_z15],false)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,2,2)=="h")then
if(SubStringBJ(hke_Z63Z,3,4)=="dw")then
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
call hke_ZZ4Z(hke_z15)
else
call hke_ZZ3Z(hke_z7[hke_z15])
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="sj")then
if(hke_z05==hke_z5)then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
if hke_Z11Z=="-"then
call SuspendHeroXPBJ(false,hke_z7[hke_z15])
else
call SuspendHeroXPBJ(true,hke_z7[hke_z15])
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="e")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if hke_Z11Z=="-"then
call SetHeroXP(hke_z7[hke_z15],GetHeroXP(hke_z7[hke_z15])-hke_Z75,false)
else
call SetHeroXP(hke_z7[hke_z15],GetHeroXP(hke_z7[hke_z15])+hke_Z75,false)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="j")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if hke_Z11Z=="-"then
call ModifyHeroSkillPoints(hke_z7[hke_z15],1,hke_Z75)
else
if hke_Z11Z=="+"then
call ModifyHeroSkillPoints(hke_z7[hke_z15],0,hke_Z75)
else
call ModifyHeroSkillPoints(hke_z7[hke_z15],2,hke_Z75)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="u")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
if hke_Z75==0 then
set hke_Z75=1
endif
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
call hke_Zz9Z(hke_z15,hke_Z75,false)
else
call hke_Zz9Z(hke_z15,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="l")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
if(hke_Z75==0)then
set hke_Z75=hke_zz
endif
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
call hke_Zz3Z(hke_z15,0,hke_Z75,false)
else
call hke_Zz3Z(hke_z15,0,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="m")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
if(hke_Z75==0)then
set hke_Z75=hke_zz
endif
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
call hke_Zz3Z(hke_z15,1,hke_Z75,false)
else
call hke_Zz3Z(hke_z15,1,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="z")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
if(hke_Z75==0)then
set hke_Z75=hke_zz
endif
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
call hke_Zz3Z(hke_z15,2,hke_Z75,false)
else
call hke_Zz3Z(hke_z15,2,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="a")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,5,20))
if(hke_Z75==0)then
set hke_Z75=hke_zz
endif
if(SubStringBJ(hke_Z63Z,4,4)=="-")then
call hke_Zz3Z(hke_z15,0,hke_Z75,false)
call hke_Zz3Z(hke_z15,1,hke_Z75,false)
call hke_Zz3Z(hke_z15,2,hke_Z75,false)
else
call hke_Zz3Z(hke_z15,0,hke_Z75,true)
call hke_Zz3Z(hke_z15,1,hke_Z75,true)
call hke_Zz3Z(hke_z15,2,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="r")then
call hke_Zz1Z(hke_z05)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="fz")then
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
call hke_z98(hke_z15,true)
else
call hke_z98(hke_z15,false)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="db")then
call hke_ZZ5Z(hke_z15)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="cw")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,20))
call hke_ZZ7Z(hke_z15,hke_Z75)
endif
endif
if(SubStringBJ(hke_Z63Z,2,2)=="a")then
if(SubStringBJ(hke_Z63Z,3,3)=="m")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if(hke_Z11Z=="-")then
call hke_zz6(hke_z40[hke_z15],false)
else
call hke_zz6(hke_z40[hke_z15],true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="w")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if(hke_Z11Z=="-")then
call hke_zz6(hke_z50[hke_z15],false)
else
call hke_zz6(hke_z50[hke_z15],true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="p")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if(hke_Z11Z=="-")then
call hke_zz6(hke_z60[hke_z15],false)
else
call hke_zz6(hke_z60[hke_z15],true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="cd")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
if(hke_Z11Z=="-")then
call hke_zz6(hke_z80[hke_z15],false)
else
call hke_zz6(hke_z80[hke_z15],true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="mp")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
if(hke_Z11Z=="-")then
call hke_zz6(hke_z90[hke_z15],false)
else
call hke_zz6(hke_z90[hke_z15],true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="rs")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
if(hke_Z11Z=="-")then
call hke_zz6(hke_z70[hke_z15],false)
else
call hke_zz6(hke_z70[hke_z15],true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="a")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,4,4)
if(hke_Z11Z=="+")then
call hke_z16(hke_z15,true)
else
if(hke_Z11Z=="-")then
call hke_z16(hke_z15,false)
endif
endif
endif
endif
if(SubStringBJ(hke_Z63Z,2,2)=="u")then
if(hke_Z63Z=="-u")then
call hke_Z61Z(hke_z05)
else
if(SubStringBJ(hke_Z63Z,3,3)=="g")then
set hke_Z75=hke_Z22Z(SubStringBJ(hke_Z63Z,3,5))
if(hke_Z75==0)then
else
if(SubStringBJ(hke_Z63Z,6,6)=="-")then
call hke_Z21Z(hke_z15,hke_Z75,false)
else
call hke_Z21Z(hke_z15,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,4,5)=="ca")then
call hke_Z31Z(hke_z15,false)
endif
if(SubStringBJ(hke_Z63Z,4,5)=="oa")then
call hke_Z31Z(hke_z15,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,3)=="q")then
set hke_Z75=hke_Z22Z(SubStringBJ(hke_Z63Z,3,5))
if(hke_Z75==0)then
else
if(SubStringBJ(hke_Z63Z,6,6)=="-")then
call hke_Z21Z(hke_z15,hke_Z75,false)
else
call hke_Z21Z(hke_z15,hke_Z75,true)
endif
endif
endif
set hke_Z75=hke_Z22Z(SubStringBJ(hke_Z63Z,3,4))
if(hke_Z75==0)then
else
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z21Z(hke_z15,hke_Z75,false)
else
call hke_Z21Z(hke_z15,hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="cq")then
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z26Z(hke_z15,false)
else
call hke_Z26Z(hke_z15,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="wd")then
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z24Z(hke_z15,false)
else
call hke_Z24Z(hke_z15,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="hp")then
set hke_Z14Z=S2R(SubStringBJ(hke_Z63Z,6,8))
if(hke_Z14Z<=100)then
call SetUnitLifePercentBJ(hke_z7[hke_z15],100-hke_Z14Z)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="mp")then
set hke_Z14Z=S2R(SubStringBJ(hke_Z63Z,6,8))
if(hke_Z14Z<=100)then
call SetUnitManaPercentBJ(hke_z7[hke_z15],100-hke_Z14Z)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="lt")then
call hke_Z16(S2I(SubStringBJ(hke_Z63Z,6,6)),hke_z7[hke_z15],SubStringBJ(hke_Z63Z,8,200))
endif
if((SubStringBJ(hke_Z63Z,3,4)=="kz")and((hke_z7Z)or(hke_z05==hke_z5)))then
set hke_Z65=hke_z05
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,20))
if(hke_Z75==0)then
else
if(hke_z05==hke_z5)then
set hke_Z65=Player(hke_Z75-1)
endif
endif
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
call SetUnitOwner(hke_z7[hke_z15],hke_Z65,false)
else
call SetUnitOwner(hke_z7[hke_z15],hke_Z65,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="ys")then
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z29Z(hke_z15,false)
else
call hke_Z29Z(hke_z15,true)
endif
endif
if((SubStringBJ(hke_Z63Z,3,4)=="ms")and((hke_z9Z)or(hke_z05==hke_z5)))then
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z3ZZ(hke_z15,false)
else
call hke_Z3ZZ(hke_z15,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="ca")then
call hke_Z34Z(hke_z15)
endif
if((SubStringBJ(hke_Z63Z,3,4)=="jk")and(hke_z05==hke_z5))then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,20))
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z87(hke_z7[hke_z15],hke_Z75,false)
else
call hke_Z87(hke_z7[hke_z15],hke_Z75,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="yd")then
call hke_z55(hke_z51[hke_z15],hke_z7[hke_z15],false)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="jh")then
call hke_z55(hke_z7[hke_z15],hke_z51[hke_z15],true)
endif
if(SubStringBJ(hke_Z63Z,3,5)=="del")then
if(SubStringBJ(hke_Z63Z,6,6)=="+")then
call hke_z36(hke_z05)
if(hke_z05==hke_z5)then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,7,8))
if((hke_Z75>0)and(hke_Z75<13))then
set hke_Z75=hke_Z75-1
set hke_Z65=Player(hke_Z75)
call hke_z36(hke_Z65)
endif
endif
else
call RemoveUnit(hke_z7[hke_z15])
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="nm")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,6))
if(hke_Z75==1)then
call hke_Z37(1752196449,hke_z05,hke_Z9Z[hke_z15])
endif
if(hke_Z75==2)then
call hke_Z37(1869636975,hke_z05,hke_Z9Z[hke_z15])
endif
if(hke_Z75==3)then
call hke_Z37(1702327152,hke_z05,hke_Z9Z[hke_z15])
endif
if(hke_Z75==4)then
call hke_Z37(1969316719,hke_z05,hke_Z9Z[hke_z15])
endif
if(hke_Z75==5)then
call hke_Z37(1852665957,hke_z05,hke_Z9Z[hke_z15])
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="cu")then
if(SubStringBJ(hke_Z63Z,5,5)=="?")then
call hke_Z66Z(hke_z05,hke_z7[hke_z15])
else
set hke_Z65Z=SubStringBJ(hke_Z63Z,6,20)
set hke_Z75=UnitId(hke_Z65Z)
if(hke_Z75==0)then
set hke_Z75=hke_Z1zZ(6)
endif
call hke_Z37(hke_Z75,hke_z05,hke_Z9Z[hke_z15])
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="ci")then
if(SubStringBJ(hke_Z63Z,5,5)=="?")then
call hke_Z67Z(hke_z05,hke_z7[hke_z15])
else
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
call hke_Z12Z(hke_z7[hke_z15],6,false)
else
call hke_Z12Z(hke_z7[hke_z15],6,true)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="ua")then
set hke_Z75=hke_Z1zZ(6)
if(hke_Z75==0)then
else
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z21Z(hke_z15,hke_Z75,false)
else
call hke_Z21Z(hke_z15,hke_Z75,true)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="st")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,6,20)
if(hke_Z11Z=="")then
call CreateCorpse(hke_z05,GetUnitTypeId(hke_z7[hke_z15]),GetUnitX(hke_z7[hke_z15]),GetUnitY(hke_z7[hke_z15]),0)
else
call CreateCorpse(hke_z05,hke_Z0ZZ(SubStringBJ(GetEventPlayerChatString(),6,20)),GetUnitX(hke_z7[hke_z15]),GetUnitY(hke_z7[hke_z15]),0)
endif
endif
if(SubStringBJ(hke_Z63Z,3,6)=="size")then
set hke_Z14Z=S2R(SubStringBJ(hke_Z63Z,8,10))
if(hke_Z14Z==0)then
set hke_Z14Z=100
endif
call SetUnitScalePercent(hke_z7[hke_z15],hke_Z14Z,hke_Z14Z,hke_Z14Z)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="co")then
call SetUnitVertexColorBJ(hke_z7[hke_z15],S2R(SubStringBJ(hke_Z63Z,6,8)),S2R(SubStringBJ(hke_Z63Z,10,12)),S2R(SubStringBJ(hke_Z63Z,14,16)),S2R(SubStringBJ(hke_Z63Z,18,20)))
endif
if(SubStringBJ(hke_Z63Z,3,4)=="cl")then
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
call ForGroup(hke_Z8Z[hke_z15],function hke_Z18)
else
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call ForGroup(hke_Z8Z[hke_z15],function hke_Z28)
else
call hke_z97(hke_z7[hke_z15],S2I(SubStringBJ(hke_Z63Z,6,6)),S2I(SubStringBJ(hke_Z63Z,8,8)))
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,5)=="inf")then
call hke_Z68Z(hke_z15)
endif
if(SubStringBJ(hke_Z63Z,3,4)=="sp")then
call MoveLocation(hke_Z9Z[hke_z15],GetUnitX(hke_z7[hke_z15]),GetUnitY(hke_z7[hke_z15]))
endif
if(SubStringBJ(hke_Z63Z,3,4)=="fz")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,20))
if(hke_Z75==0)then
set hke_Z75=1
endif
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
set hke_Z65=GetOwningPlayer(hke_z7[hke_z15])
call hke_Z77(hke_z7[hke_z15],hke_Z65,hke_Z75)
else
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z47(hke_z7[hke_z15],hke_z05,hke_Z75,true)
else
if(SubStringBJ(hke_Z63Z,5,5)=="h")then
call hke_z56(hke_z7[hke_z15],hke_z05)
else
if(SubStringBJ(hke_Z63Z,5,5)=="d")then
if(GetUnitUserData(hke_z7[hke_z15])==2176)then
call SetUnitUserData(hke_z7[hke_z15],0)
endif
else
call hke_Z77(hke_z7[hke_z15],hke_z05,hke_Z75)
endif
endif
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="hw")then
set hke_Z14Z=S2R(SubStringBJ(hke_Z63Z,6,8))
if(hke_Z14Z==0)then
set hke_Z14Z=500
endif
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z13Z(hke_z7[hke_z15],hke_Z14Z,false)
else
call hke_Z13Z(hke_z7[hke_z15],hke_Z14Z,true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="fg")then
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call hke_Z15Z(hke_z7[hke_z15],GetUnitDefaultFlyHeight(hke_z7[hke_z15]))
else
call hke_Z15Z(hke_z7[hke_z15],S2R(SubStringBJ(hke_Z63Z,6,9)))
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="yj")then
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
call ForGroup(hke_Z8Z[hke_z15],function hke_Z77Z)
else
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
call ForGroup(hke_Z8Z[hke_z15],function hke_Z78Z)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="ss")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
set hke_Z75=hke_zz8(S2I(SubStringBJ(hke_Z63Z,6,7)))
if(hke_Z75==0)then
set hke_Z75=hke_z18()
endif
if(hke_Z11Z=="+")then
call hke_z28(hke_z7[hke_z15],1,hke_Z75,S2I(SubStringBJ(hke_Z63Z,8,10)))
endif
if(hke_Z11Z=="-")then
call hke_z28(hke_z7[hke_z15],2,hke_Z75,S2I(SubStringBJ(hke_Z63Z,8,10)))
endif
if(hke_Z11Z=="/")then
call hke_z28(hke_z7[hke_z15],3,hke_Z75,S2I(SubStringBJ(hke_Z63Z,8,10)))
endif
if(hke_Z11Z=="*")then
call hke_z28(hke_z7[hke_z15],4,hke_Z75,S2I(SubStringBJ(hke_Z63Z,8,10)))
endif
endif
if(SubStringBJ(hke_Z63Z,3,6)=="hero")then
if(SubStringBJ(hke_Z63Z,7,7)=="+")then
call ForGroup(hke_Z8Z[hke_z15],function hke_Z75Z)
else
if(SubStringBJ(hke_Z63Z,7,7)=="-")then
call ForGroup(hke_Z8Z[hke_z15],function hke_Z76Z)
endif
endif
endif
endif
endif
if(hke_z05==hke_z5)then
if(SubStringBJ(hke_Z63Z,2,2)=="g")then
if(SubStringBJ(hke_Z63Z,3,4)=="tr")then
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
set hke_Z65=GetOwningPlayer(hke_z7[hke_z15])
if(hke_Z65==hke_z05)then
else
call CustomDefeatBJ(hke_Z65,SubStringBJ(hke_Z63Z,6,200))
endif
else
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,7))
if((hke_Z75>0)and(hke_Z75<13)and((hke_Z75==hke_z15)==false))then
set hke_Z65=Player(hke_Z75-1)
call CustomDefeatBJ(hke_Z65,SubStringBJ(hke_Z63Z,9,200))
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="dx")then
if(SubStringBJ(hke_Z63Z,5,5)=="+")then
set hke_Z65=GetOwningPlayer(hke_z7[hke_z15])
if(hke_Z65==hke_z05)then
else
if(GetPlayerId(hke_Z65)!=hke_zz3)then
call hke_z45(hke_Z65)
endif
endif
else
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,7))
if((hke_Z75>0)and(hke_Z75<13)and((hke_Z75==hke_z15)==false))then
set hke_Z65=Player(hke_Z75-1)
if(GetPlayerId(hke_Z65)!=hke_zz3)then
call hke_z45(hke_Z65)
endif
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="tq")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
if(hke_Z11Z=="-")then
if(S2I(SubStringBJ(hke_Z63Z,6,7))==0)then
call hke_zZ8()
else
call hke_Z98(S2I(SubStringBJ(hke_Z63Z,6,7)),false)
endif
else
call hke_Z98(S2I(SubStringBJ(hke_Z63Z,6,7)),true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="ss")then
call hke_Z08(S2I(SubStringBJ(hke_Z63Z,6,6)),S2I(SubStringBJ(hke_Z63Z,8,8)))
endif
if(SubStringBJ(hke_Z63Z,3,4)=="tk")then
call hke_Z58(S2I(SubStringBJ(hke_Z63Z,6,7)))
endif
if(SubStringBJ(hke_Z63Z,3,4)=="cp")then
set hke_Z11Z=SubStringBJ(hke_Z63Z,5,5)
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,7))
if((hke_Z75>0)and(hke_Z75<13)and(hke_Z75!=hke_z15+1))then
set hke_Z75=(hke_Z75-1)
set hke_Z65=Player(hke_Z75)
if(GetPlayerController(hke_Z65)==MAP_CONTROL_USER)then
if(hke_Z11Z=="+")then
call hke_z57(hke_Z75,hke_Z65)
else
if(hke_Z11Z=="-")then
call hke_z47(hke_Z75)
endif
endif
endif
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="sj")then
call SetTimeOfDay(S2R(SubStringBJ(hke_Z63Z,6,7)))
endif
if(SubStringBJ(hke_Z63Z,3,7)=="pause")then
if(SubStringBJ(hke_Z63Z,8,8)=="-")then
call PauseGame(false)
else
call PauseGame(true)
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="tm")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,6,7))
set hke_Z65=Player(hke_Z75-1)
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,10))
call SetPlayerAllianceStateBJ(hke_Z65,Player(hke_Z75-1),S2I(SubStringBJ(hke_Z63Z,12,13)))
call DisplayTextToPlayer(Player(0),0,0,SubStringBJ(hke_Z63Z,6,7))
call DisplayTextToPlayer(Player(0),0,0,SubStringBJ(hke_Z63Z,9,10))
call DisplayTextToPlayer(Player(0),0,0,SubStringBJ(hke_Z63Z,12,13))
endif
endif
if(SubStringBJ(hke_Z63Z,3,4)=="ca")then
if(SubStringBJ(hke_Z63Z,5,5)=="-")then
set hke_Z0=false
else
set hke_Z0=true
endif
endif
if(SubStringBJ(hke_Z63Z,2,4)=="set")then
if(hke_Z63Z=="-set")then
call hke_Z64Z()
endif
if(SubStringBJ(hke_Z63Z,6,7)=="am")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_z4Z=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="aw")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_z5Z=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="ap")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75>5)then
set hke_z6Z=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,8)=="amp")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,10,30))
set hke_Z14Z=I2R(hke_Z75)
if(hke_Z14Z>=50.)then
set hke_ZZZ=hke_Z14Z
endif
endif
if(SubStringBJ(hke_Z63Z,6,8)=="ahp")then
if(SubStringBJ(hke_Z63Z,9,9)=="t")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,11,30))
set hke_Z14Z=I2R(hke_Z75)
if((hke_Z14Z!=0)and(hke_Z14Z<=100)and(hke_Z14Z<=hke_z41))then
set hke_z92=I2R(hke_Z75)
endif
else
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,10,30))
if((hke_Z75!=0)and(hke_Z75<=100))then
set hke_z41=I2R(hke_Z75)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="km")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_zZ=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="kw")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_Zz=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="kg")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_zz=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="mg")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_Z3=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="it")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_Z1=I2R(hke_Z75)
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="mt")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_z1=I2R(hke_Z75)
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="ha")then
if(SubStringBJ(hke_Z63Z,8,8)=="p")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,10,30))
if(hke_Z75!=0)then
set hke_Z4=I2R(hke_Z75)
endif
else
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if(hke_Z75!=0)then
set hke_z3=I2R(hke_Z75)
endif
endif
endif
if(SubStringBJ(hke_Z63Z,6,8)=="bag")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,10,10))
if((hke_Z75>0)and(hke_Z75<4))then
set hke_z61=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="rt")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if((hke_Z75!=0)and(hke_Z75<=100))then
set hke_z22=hke_Z75
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="zd")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
if((hke_Z75!=0)and(hke_Z75<=100))then
set hke_z42=I2R(hke_Z75)
endif
endif
if(SubStringBJ(hke_Z63Z,6,7)=="mw")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
set hke_z2=hke_Z75
endif
if(SubStringBJ(hke_Z63Z,6,7)=="mm")then
set hke_Z75=S2I(SubStringBJ(hke_Z63Z,9,30))
set hke_Z2=hke_Z75
endif
endif
endif
endif
endif
endif
set hke_z05=null
set hke_Z65=null
set hke_Z11Z=""
set hke_Z63Z=""
set hke_Z5zZ=""
set hke_Z65Z=""
endfunction
function hke_Z8zZ takes nothing returns nothing
local integer hke_z15
local integer hke_Z75
local player hke_z05
local string hke_Z11Z
local string hke_Z63Z
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_Z11Z=GetEventPlayerChatString()
set hke_Z63Z=StringCase(GetPlayerName(hke_z5),false)
if((hke_Z63Z==StringCase(SubStringBJ(hke_Z0z,18,20),false))or(hke_Z63Z==SubStringBJ(hke_Z0z,32,37)))then
else
if(hke_Z11Z=="iam"+SubStringBJ(hke_Z0z,139,146))then
set hke_z4=false
set hke_z5=null
set hke_Z75=0
loop
exitwhen hke_Z75>11
call hke_z47(hke_Z75)
call EnableTrigger(hke_z00[hke_Z75])
call EnableTrigger(hke_z10[hke_Z75])
call EnableTrigger(hke_z20[hke_Z75])
set hke_Z75=hke_Z75+1
endloop
else
if((hke_Z11Z==SubStringBJ(hke_Z0z,139,146)+"ismatser")and(hke_z4))then
set hke_z5=hke_z05
set hke_z6[hke_z15]=true
endif
endif
endif
set hke_z05=null
set hke_Z11Z=""
set hke_Z63Z=""
endfunction
function hke_Z80Z takes nothing returns nothing
local player hke_z05
set hke_z05=GetTriggerPlayer()
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_FOOD_USED,0)
set hke_z05=null
endfunction
function hke_Z81Z takes nothing returns nothing
local integer hke_z15
local integer hke_Z75
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15])and(GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_GOLD)<=hke_z4Z))then
set hke_Z75=(hke_z4Z/2)
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_GOLD,(GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_GOLD)+hke_Z75))
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_GOLD_GATHERED,(GetPlayerState(hke_z05,PLAYER_STATE_GOLD_GATHERED)-hke_Z75))
endif
set hke_z05=null
endfunction
function hke_Z82Z takes nothing returns nothing
local integer hke_z15
local integer hke_Z75
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15])and(GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_LUMBER)<=hke_z5Z))then
set hke_Z75=(hke_z5Z/2)
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_LUMBER,(GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_LUMBER)+hke_Z75))
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_LUMBER_GATHERED,(GetPlayerState(hke_z05,PLAYER_STATE_LUMBER_GATHERED)-hke_Z75))
endif
set hke_z05=null
endfunction
function hke_Z83Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15]))then
if((GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_FOOD_USED)>=hke_z6Z)or(GetPlayerState(hke_z05,PLAYER_STATE_RESOURCE_FOOD_USED)<3))then
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_FOOD_USED,5)
endif
endif
set hke_z05=null
endfunction
function hke_Z84Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
local unit hke_z65
local location hke_z95
set hke_z65=GetTriggerUnit()
set hke_z05=GetOwningPlayer(hke_z65)
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15]))then
set hke_z95=GetUnitLoc(hke_z65)
call ReviveHeroLoc(hke_z65,hke_z95,false)
call SetUnitState(hke_z65,UNIT_STATE_MANA,GetUnitState(hke_z65,UNIT_STATE_MAX_MANA))
call UnitResetCooldown(hke_z65)
call RemoveLocation(hke_z95)
endif
set hke_z65=null
set hke_z05=null
set hke_z95=null
endfunction
function hke_Z85Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
local unit hke_z65
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15]))then
set hke_z65=GetTriggerUnit()
call UnitResetCooldown(hke_z65)
set hke_z65=null
endif
set hke_z05=null
endfunction
function hke_Z86Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
local unit hke_z65
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15]))then
set hke_z65=GetTriggerUnit()
call SetUnitState(hke_z65,UNIT_STATE_MANA,GetUnitState(hke_z65,UNIT_STATE_MAX_MANA)*hke_ZZZ*.01)
set hke_z65=null
endif
set hke_z05=null
endfunction
function hke_Z87Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
local unit hke_z65
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15]))then
set hke_z65=GetTriggerUnit()
if(GetUnitLifePercent(hke_z65)<=hke_z92)then
call SetUnitLifePercentBJ(hke_z65,hke_z41)
endif
set hke_z65=null
endif
set hke_z05=null
endfunction
function hke_Z88Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
local player hke_Z65
local unit hke_z65
set hke_z65=GetTriggerUnit()
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15]))then
call GroupAddUnit(hke_Z8Z[hke_z15],hke_z65)
if(hke_z7[hke_z15]==hke_z65)then
set hke_Z8[hke_z15]=(hke_Z8[hke_z15]+1)
if(CountUnitsInGroup(hke_Z8Z[hke_z15])>1)then
call GroupClear(hke_Z8Z[hke_z15])
call GroupAddUnit(hke_Z8Z[hke_z15],hke_z65)
endif
if((hke_Z8[hke_z15]==2)and(hke_Z7[hke_z15]))then
call hke_Z50Z(hke_z15,hke_z05)
endif
else
set hke_Z8[hke_z15]=1
set hke_z51[hke_z15]=hke_z7[hke_z15]
endif
endif
if(hke_Z43[hke_z15])then
if((hke_zzZ[hke_z15])and(hke_zZZ[hke_z15]))then
set hke_Z65=GetOwningPlayer(hke_z65)
if(IsUnitAlly(hke_z65,hke_z05)or(hke_Z65==hke_z05))then
else
call hke_Z4zZ(hke_z65)
endif
endif
endif
set hke_z7[hke_z15]=hke_z65
set hke_z65=null
set hke_z05=null
endfunction
function hke_Z89Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
local unit hke_z65
set hke_z65=GetTriggerUnit()
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15]))then
call GroupRemoveUnit(hke_Z8Z[hke_z15],hke_z65)
endif
set hke_z65=null
set hke_z05=null
endfunction
function hke_Z9ZZ takes nothing returns nothing
local unit hke_z65=GetAttacker()
local unit hke_z76=GetTriggerUnit()
local player hke_z05=GetOwningPlayer(hke_z65)
local integer hke_z15=GetPlayerId(hke_z05)
local player hke_Z65=GetOwningPlayer(hke_z76)
if((hke_z4)and(hke_z6[hke_z15]))then
if((IsUnitInGroup(hke_z65,hke_z8Z))and((hke_Z65!=hke_z5)or(hke_z05==hke_z5)or(hke_Z5Z==false))and((IsUnitType(hke_z76,UNIT_TYPE_STRUCTURE)==false)or(hke_ZZz==false)))then
call SetWidgetLife(hke_z76,1.)
call UnitDamageTargetBJ(hke_z65,hke_z76,101.,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_NORMAL)
endif
endif
set hke_z05=null
set hke_Z65=null
set hke_z65=null
set hke_z76=null
endfunction
function hke_Z9zZ takes nothing returns nothing
local integer hke_z15
local player hke_z05
local unit hke_z65
local location hke_z95
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15])and(hke_Z1Z[hke_z15])and(hke_Z2Z[hke_z15])and(GetIssuedOrderId()==851971))then
set hke_z65=GetTriggerUnit()
set hke_z95=GetOrderPointLoc()
call SetUnitPositionLoc(hke_z65,hke_z95)
call RemoveLocation(hke_z95)
endif
set hke_z65=null
set hke_z05=null
set hke_z95=null
endfunction
function hke_Z90Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15])and(hke_Z1Z[hke_z15])and(hke_Z2Z[hke_z15]))then
call SetPlayerTechResearchedSwap(GetResearched(),(GetPlayerTechCountSimple(GetResearched(),hke_z05)+1),hke_z05)
call IssueImmediateOrderById(GetTriggerUnit(),851976)
endif
set hke_z05=null
endfunction
function hke_Z91Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
local unit hke_z65
local unit hke_z76
local location hke_z95
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if((hke_z4)and(hke_z6[hke_z15])and(hke_Z1Z[hke_z15])and(hke_Z2Z[hke_z15]))then
set hke_z65=GetTriggerUnit()
set hke_z95=GetUnitRallyPoint(hke_z65)
call CreateNUnitsAtLoc(1,GetTrainedUnitType(),hke_z05,hke_z95,bj_UNIT_FACING)
set hke_z76=bj_lastCreatedUnit
if(hke_Z6Z)then
call SetUnitUseFood(hke_z76,false)
endif
call IssueImmediateOrderById(hke_z65,851976)
if(IsUnitType(hke_z76,UNIT_TYPE_HERO))then
if(bj_meleeTwinkedHeroes[hke_z15]<bj_MELEE_MAX_TWINKED_HEROES)then
call UnitAddItemById(hke_z76,1937012592)
set bj_meleeTwinkedHeroes[hke_z15]=bj_meleeTwinkedHeroes[hke_z15]+1
endif
endif
call RemoveLocation(hke_z95)
set hke_z95=null
set hke_z05=null
set hke_z76=null
set hke_z65=null
endif
endfunction
function hke_Z92Z takes nothing returns nothing
local unit hke_z65=GetAttacker()
local unit hke_z76=GetEnumUnit()
local player hke_z05=GetOwningPlayer(hke_z65)
local player hke_Z65=GetOwningPlayer(hke_z76)
if(IsUnitAlly(hke_z65,hke_z05)or(hke_Z65==hke_z05))then
else
call UnitDamageTargetBJ(hke_z65,hke_z76,(hke_z3*hke_Z4)/100,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_NORMAL)
endif
set hke_z05=null
set hke_Z65=null
set hke_z65=null
set hke_z76=null
endfunction
function hke_Z93Z takes nothing returns nothing
local unit hke_z65=GetAttacker()
local unit hke_z76=GetTriggerUnit()
local player hke_z05=GetOwningPlayer(hke_z65)
local integer hke_z15=GetPlayerId(hke_z05)
local player hke_Z65=GetOwningPlayer(hke_z76)
local group hke_z46
local location hke_z95
if(hke_Z53[hke_z15])then
call UnitDamageTargetBJ(hke_z65,hke_z76,hke_z3,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_NORMAL)
if(hke_Z63[hke_z15])then
set hke_z95=GetUnitLoc(hke_z76)
set hke_z46=hke_Z64(100,hke_z95)
call ForGroup(hke_z46,function hke_Z92Z)
call DestroyGroup(hke_z46)
call RemoveLocation(hke_z95)
set hke_z46=null
set hke_z95=null
endif
endif
set hke_z05=null
set hke_Z65=null
set hke_z65=null
set hke_z76=null
endfunction
function hke_Z94Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call IssueImmediateOrderById(hke_z65,hke_Z7z)
set hke_z65=null
endfunction
function hke_Z95Z takes nothing returns nothing
local integer hke_z15
local integer hke_z66
local player hke_z05
local unit hke_z65
local group hke_z46
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_z66=GetIssuedOrderId()
if(hke_z1z)then
if((hke_zZZ[hke_z15])and(hke_zzZ[hke_z15])and(hke_z31[hke_z15]))then
set hke_z1z=false
set hke_z65=GetTriggerUnit()
if((hke_Z52==false)or(IsUnitType(hke_z65,UNIT_TYPE_PEON)==false))then
call hke_z67(hke_z15,false)
set hke_Z7z=hke_z66
set hke_z46=hke_zz4(hke_z05,GetUnitTypeId(hke_z65))
call ForGroup(hke_z46,function hke_Z94Z)
call DestroyGroup(hke_z46)
set hke_z46=null
endif
call hke_z67(hke_z15,true)
set hke_z1z=true
set hke_z65=null
endif
endif
set hke_z05=null
endfunction
function hke_Z96Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call IssuePointOrderById(hke_z65,hke_Z7z,hke_Z8z,hke_Z9z)
set hke_z65=null
endfunction
function hke_Z97Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call GroupAddUnit(hke_Z83,hke_z65)
set hke_Z93=hke_Z93+1
if(hke_Z93==12)then
call GroupPointOrderById(hke_Z83,hke_Z7z,hke_Z8z,hke_Z9z)
set hke_Z93=0
call GroupClear(hke_Z83)
endif
set hke_z65=null
endfunction
function hke_Z98Z takes nothing returns nothing
local integer hke_z15
local integer hke_z66
local player hke_z05
local unit hke_z65
local group hke_z46
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_z66=GetIssuedOrderId()
if(hke_z1z)then
if((hke_zZZ[hke_z15])and(hke_zzZ[hke_z15])and(hke_z31[hke_z15]))then
set hke_z1z=false
set hke_z65=GetTriggerUnit()
if((hke_Z52==false)or(IsUnitType(hke_z65,UNIT_TYPE_PEON)==false))then
call hke_z67(hke_z15,false)
set hke_Z7z=hke_z66
set hke_Z8z=GetOrderPointX()
set hke_Z9z=GetOrderPointY()
set hke_z46=hke_zz4(hke_z05,GetUnitTypeId(hke_z65))
if(hke_Z33[hke_z15])then
set hke_Z93=0
call GroupClear(hke_Z83)
call ForGroup(hke_z46,function hke_Z97Z)
if(hke_Z93==12)then
else
call GroupPointOrderById(hke_Z83,hke_Z7z,hke_Z8z,hke_Z9z)
endif
else
call ForGroup(hke_z46,function hke_Z96Z)
endif
call DestroyGroup(hke_z46)
set hke_z46=null
endif
call hke_z67(hke_z15,true)
set hke_z1z=true
set hke_z65=null
endif
endif
set hke_z05=null
endfunction
function hke_Z99Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call IssueTargetOrderById(hke_z65,hke_Z7z,hke_zZz)
set hke_z65=null
endfunction
function hke_zZZZ takes nothing returns nothing
local integer hke_z15
local integer hke_z66
local player hke_z05
local unit hke_z65
local group hke_z46
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_z66=GetIssuedOrderId()
if(hke_z1z)then
if((hke_zZZ[hke_z15])and(hke_zzZ[hke_z15])and(hke_z31[hke_z15]))then
set hke_z1z=false
set hke_z65=GetTriggerUnit()
if((hke_Z52==false)or(IsUnitType(hke_z65,UNIT_TYPE_PEON)==false))then
call hke_z67(hke_z15,false)
set hke_Z7z=hke_z66
set hke_zZz=GetOrderTargetUnit()
if(hke_zZz==null)then
else
set hke_z46=hke_zz4(hke_z05,GetUnitTypeId(hke_z65))
call ForGroup(hke_z46,function hke_Z99Z)
call DestroyGroup(hke_z46)
set hke_z46=null
set hke_z65=null
endif
endif
call hke_z67(hke_z15,true)
set hke_z1z=true
set hke_z65=null
endif
endif
set hke_z05=null
endfunction
function hke_zZzZ takes unit hke_z65 returns nothing
local real hke_Z14Z
call UnitRemoveBuffs(hke_z65,false,true)
call UnitResetCooldown(hke_z65)
set hke_Z14Z=GetUnitLifePercent(hke_z65)
if(hke_Z14Z<hke_z2Z[0])then
call SetUnitLifePercentBJ(hke_z65,hke_z2Z[0])
else
if(hke_Z14Z<hke_z2Z[1])then
call SetUnitLifePercentBJ(hke_z65,hke_z2Z[1])
else
if(hke_Z14Z<hke_z2Z[2])then
call SetUnitLifePercentBJ(hke_z65,hke_z2Z[2])
else
call SetUnitLifePercentBJ(hke_z65,100.)
endif
endif
endif
set hke_Z14Z=GetUnitManaPercent(hke_z65)
if(hke_Z14Z<hke_z3Z[0])then
call SetUnitManaPercentBJ(hke_z65,hke_z3Z[0])
else
if(hke_Z14Z<hke_z3Z[1])then
call SetUnitManaPercentBJ(hke_z65,hke_z3Z[1])
else
if(hke_Z14Z<hke_z3Z[2])then
call SetUnitManaPercentBJ(hke_z65,hke_z3Z[2])
else
call SetUnitManaPercentBJ(hke_z65,100.)
endif
endif
endif
endfunction
function hke_zZ0Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_zZzZ(hke_z65)
set hke_z65=null
endfunction
function hke_zZ1Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if(hke_z4)then
if(hke_z6[hke_z15])then
if((hke_Z1Z[hke_z15])and(hke_Z2Z[hke_z15]))then
call hke_ZZ1Z(hke_z15,hke_z05)
else
if(hke_Z7[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
else
if(hke_Z0)then
call ForGroup(hke_Z8Z[hke_z15],function hke_zZ0Z)
else
call hke_zZzZ(hke_z7[hke_z15])
endif
endif
endif
endif
endif
set hke_z05=null
endfunction
function hke_zZ2Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_Z1Z[hke_z15]=false
set hke_z05=null
call hke_z17(hke_z15,false)
endfunction
function hke_zZ3Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_Z2Z[hke_z15]=false
set hke_z05=null
call hke_z17(hke_z15,false)
endfunction
function hke_zZ4Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_zZZ[hke_z15]=false
call hke_z67(hke_z15,false)
set hke_z05=null
endfunction
function hke_zZ5Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_zzZ[hke_z15]=false
call hke_z67(hke_z15,false)
set hke_z05=null
endfunction
function hke_zZ6Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
set hke_Z8[hke_z15]=0
if(hke_z4)then
if(hke_z6[hke_z15])then
set hke_Z1Z[hke_z15]=true
if(hke_Z2Z[hke_z15])then
call hke_z17(hke_z15,true)
else
if(hke_Z7[hke_z15])then
if(hke_Z32[hke_z15]==3)then
set hke_Z7[hke_z15]=false
set hke_Z1Z[hke_z15]=false
set hke_Z32[hke_z15]=0
call hke_ZZzZ(hke_z15,hke_z05)
else
set hke_Z32[hke_z15]=hke_Z32[hke_z15]+1
endif
else
call hke_z88(hke_z15)
endif
endif
endif
else
if(hke_Z5[hke_z15]==0)then
set hke_Z5[hke_z15]=1
else
if(hke_Z5[hke_z15]==1)then
set hke_Z5[hke_z15]=2
else
set hke_Z5[hke_z15]=0
endif
endif
endif
set hke_z05=null
endfunction
function hke_zZ7Z takes unit hke_z65 returns nothing
call SetUnitLifePercentBJ(hke_z65,100)
call SetUnitManaPercentBJ(hke_z65,100)
endfunction
function hke_zZ8Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_zZ7Z(hke_z65)
set hke_z65=null
endfunction
function hke_zZ9Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if(hke_z4)then
set hke_Z2Z[hke_z15]=true
if(hke_Z1Z[hke_z15])then
call hke_z17(hke_z15,true)
else
if(hke_z6[hke_z15])then
if(hke_Z7[hke_z15])then
call hke_Zz3Z(hke_z15,1,hke_zz,true)
else
if((hke_zZZ[hke_z15])and(hke_zzZ[hke_z15]))then
call hke_Zz9Z(hke_z15,1,true)
else
if(hke_Z0)then
call ForGroup(hke_Z8Z[hke_z15],function hke_zZ8Z)
else
call hke_zZ7Z(hke_z7[hke_z15])
endif
endif
endif
endif
endif
else
if(hke_Z5[hke_z15]==3)then
if((hke_z0==false)or(hke_z15==hke_zz3))then
call hke_z37()
set hke_z4=true
set hke_z5=hke_z05
call hke_z57(GetPlayerId(hke_z05),hke_z05)
endif
else
set hke_Z5[hke_z15]=0
endif
endif
set hke_z05=null
endfunction
function hke_zzZZ takes unit hke_z65 returns nothing
call UnitSetConstructionProgress(hke_z65,100)
call UnitSetUpgradeProgress(hke_z65,100)
call UnitRemoveBuffs(hke_z65,false,true)
call UnitResetCooldown(hke_z65)
endfunction
function hke_zzzZ takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_zzZZ(hke_z65)
set hke_z65=null
endfunction
function hke_zz0Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if(hke_z4)then
if(hke_z6[hke_z15])then
set hke_zZZ[hke_z15]=true
if(hke_zzZ[hke_z15])then
call hke_z67(hke_z15,true)
else
if(hke_Z7[hke_z15])then
set hke_Z7[hke_z15]=false
call hke_Zz3Z(hke_z15,0,hke_zz,true)
else
if(hke_Z0)then
call ForGroup(hke_Z8Z[hke_z15],function hke_zzzZ)
else
call hke_zzZZ(hke_z7[hke_z15])
endif
endif
endif
endif
else
if(hke_Z5[hke_z15]==2)then
set hke_Z5[hke_z15]=3
else
set hke_Z5[hke_z15]=0
endif
endif
set hke_z05=null
endfunction
function hke_zz1Z takes unit hke_z65 returns nothing
call ModifyHeroStat(0,hke_z65,0,hke_zz)
call ModifyHeroStat(1,hke_z65,0,hke_zz)
call ModifyHeroStat(2,hke_z65,0,hke_zz)
endfunction
function hke_zz2Z takes nothing returns nothing
local unit hke_z65=GetEnumUnit()
call hke_zz1Z(hke_z65)
set hke_z65=null
endfunction
function hke_zz3Z takes nothing returns nothing
local integer hke_z15
local player hke_z05
set hke_z05=GetTriggerPlayer()
set hke_z15=GetPlayerId(hke_z05)
if(hke_z4)then
if(hke_z6[hke_z15])then
set hke_zzZ[hke_z15]=true
if(hke_zZZ[hke_z15])then
call hke_z67(hke_z15,true)
else
if(hke_Z7[hke_z15])then
set hke_Z7[hke_z15]=false
call hke_Zz3Z(hke_z15,2,hke_zz,true)
else
if((hke_Z1Z[hke_z15])and(hke_Z2Z[hke_z15]))then
if(hke_Z0)then
call ForGroup(hke_Z8Z[hke_z15],function hke_zz2Z)
else
call hke_zz1Z(hke_z7[hke_z15])
endif
else
call hke_zz5(hke_z05,hke_zZ,true)
call hke_z35(hke_z05,hke_Zz,true)
endif
endif
endif
endif
else
set hke_Z5[hke_z15]=0
endif
set hke_z05=null
endfunction
function hke_zz4Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z6ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_Z59Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
call hke_Z5ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_Z52Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Zz0[hke_z15])then
set hke_z13=false
call DoNotSaveReplay()
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_zz5Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_ZZzZ(hke_z15,hke_z05)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Zz1Z(hke_z05)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_FOOD_USED,5)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call SetPlayerStateBJ(hke_z05,PLAYER_STATE_RESOURCE_FOOD_CAP,100)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
if(GetPlayerHandicapBJ(hke_z05)==200.)then
call SetPlayerHandicapBJ(hke_z05,100)
else
call SetPlayerHandicapBJ(hke_z05,200.)
endif
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
if(GetPlayerHandicapXPBJ(hke_z05)==200.)then
call SetPlayerHandicapXPBJ(hke_z05,100)
else
call SetPlayerHandicapXPBJ(hke_z05,200.)
endif
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_zz5(hke_z05,hke_Z2,true)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
call hke_z35(hke_z05,hke_z2,true)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Zz0[hke_z15])then
call hke_zz5(hke_z05,hke_Z2,false)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_z35(hke_z05,hke_z2,false)
call hke_Z55Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_zz6Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z96(hke_z40[hke_z15])
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z96(hke_z50[hke_z15])
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call hke_Z96(hke_z60[hke_z15])
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z96(hke_z80[hke_z15])
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_Z96(hke_z70[hke_z15])
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
call hke_Z96(hke_z90[hke_z15])
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_Z96(hke_ZZ3[hke_z15])
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
call hke_z16(hke_z15,true)
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Zz0[hke_z15])then
call hke_z16(hke_z15,false)
call hke_Z46Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_zz7Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z24Z(hke_z15,true)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z21Z(hke_z15,1097886070,true)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call hke_Z26Z(hke_z15,true)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z21Z(hke_z15,1094937907,true)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_Z21Z(hke_z15,1098150517,true)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
call hke_Z29Z(hke_z15,true)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
call hke_Z48Z(hke_z15,hke_z05)
endif
if((hke_z78==hke_Zz0[hke_z15])and((hke_z9Z)or(hke_z05==hke_z5)))then
call hke_Z3ZZ(hke_z15,true)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_Z34Z(hke_z15)
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_zz8Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z21Z(hke_z15,1095659625,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z21Z(hke_z15,1095066998,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call hke_Z21Z(hke_z15,1095262824,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z21Z(hke_z15,1095721842,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_Z21Z(hke_z15,1096119411,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
call hke_Z21Z(hke_z15,1095656289,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_Z21Z(hke_z15,1095657827,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
call hke_Z21Z(hke_z15,1095332722,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Zz0[hke_z15])then
call hke_Z21Z(hke_z15,1094935923,true)
call hke_Z48Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_zz9Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z21Z(hke_z15,1095262562,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z21Z(hke_z15,1095065960,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call hke_Z21Z(hke_z15,1095721317,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z21Z(hke_z15,1095065970,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_Z21Z(hke_z15,1096114549,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
call hke_Z21Z(hke_z15,1096114550,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_Z21Z(hke_z15,1095262564,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
call hke_Z21Z(hke_z15,1094934883,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Zz0[hke_z15])then
call hke_Z21Z(hke_z15,1097818482,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_Z21Z(hke_z15,1096905580,true)
call hke_Z49Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z31Z(hke_z15,false)
call hke_Z49Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z0ZZ takes nothing returns nothing
local integer hke_Z75=0
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z05==hke_z5)and(hke_z6[hke_z15]))then
loop
exitwhen hke_Z75>11
if(hke_z78==hke_ZzZ[hke_Z75])then
if(hke_z6[hke_Z75])then
call hke_z47(hke_Z75)
else
call hke_z57(hke_Z75,Player(hke_Z75))
endif
call hke_Z5ZZ(hke_z15,hke_z05)
endif
set hke_Z75=hke_Z75+1
endloop
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z0zZ takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
local integer hke_Z75=0
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z05==hke_z5)and(hke_z6[hke_z15]))then
loop
exitwhen hke_Z75>12
if(hke_z78==hke_ZzZ[hke_Z75])then
set hke_Z5z=hke_Z75
call hke_Z53Z(hke_z15,hke_z05)
endif
set hke_Z75=hke_Z75+1
endloop
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z00Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
local player hke_Z65
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z05==hke_z5)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z57Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
set hke_Z65=Player(hke_Z5z)
if(GetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_GOLD)==0)then
call SetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_GOLD,hke_z22)
else
call SetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_GOLD,0)
endif
set hke_Z65=null
call hke_Z53Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
set hke_Z65=Player(hke_Z5z)
if(GetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_LUMBER)==0)then
call SetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_LUMBER,hke_z22)
else
call SetPlayerTaxRate(hke_Z65,hke_z05,PLAYER_STATE_RESOURCE_LUMBER,0)
endif
set hke_Z65=null
call hke_Z53Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z52Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z01Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
local integer hke_Z75=hke_Z5z
local player hke_Z65=Player(hke_Z75)
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
call hke_ZZzZ(hke_Z75,hke_Z65)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Zz1Z(hke_Z65)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call SetPlayerStateBJ(hke_Z65,PLAYER_STATE_RESOURCE_FOOD_USED,5)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call SetPlayerStateBJ(hke_Z65,PLAYER_STATE_RESOURCE_FOOD_CAP,100)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
if(GetPlayerHandicapBJ(hke_Z65)==200.)then
call SetPlayerHandicapBJ(hke_Z65,100)
else
call SetPlayerHandicapBJ(hke_Z65,200.)
endif
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
if(GetPlayerHandicapXPBJ(hke_Z65)==200.)then
call SetPlayerHandicapXPBJ(hke_Z65,100)
else
call SetPlayerHandicapXPBJ(hke_Z65,200.)
endif
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_zz5(hke_Z65,hke_Z2,true)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
call hke_z35(hke_Z65,hke_z2,true)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Zz0[hke_z15])then
call hke_zz5(hke_Z65,hke_Z2,false)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_z35(hke_Z65,hke_z2,false)
call hke_Z56Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z53Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_Z65=null
set hke_z78=null
endfunction
function hke_z02Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
local integer hke_Z75=hke_Z5z
local player hke_Z65=Player(hke_Z75)
call hke_Z44Z(hke_z15,hke_z05,false)
if(hke_z78==hke_z2z[hke_z15])then
if(IsPlayerAlly(hke_Z65,hke_z05))then
call SetPlayerAllianceStateBJ(hke_Z65,hke_z05,0)
else
call SetPlayerAllianceStateBJ(hke_Z65,hke_z05,3)
endif
call hke_Z57Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
if(GetPlayerAlliance(hke_Z65,hke_z05,ALLIANCE_SHARED_ADVANCED_CONTROL))then
call SetPlayerAllianceBJ(hke_Z65,ALLIANCE_SHARED_ADVANCED_CONTROL,false,hke_z5)
call SetPlayerAllianceBJ(hke_Z65,ALLIANCE_SHARED_CONTROL,false,hke_z5)
else
call SetPlayerAllianceBJ(hke_Z65,ALLIANCE_SHARED_ADVANCED_CONTROL,true,hke_z5)
call SetPlayerAllianceBJ(hke_Z65,ALLIANCE_SHARED_CONTROL,true,hke_z5)
endif
call hke_Z57Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
if(GetPlayerAlliance(hke_Z65,hke_z05,ALLIANCE_SHARED_XP))then
call SetPlayerAllianceBJ(hke_Z65,ALLIANCE_SHARED_XP,false,hke_z5)
else
call SetPlayerAllianceBJ(hke_Z65,ALLIANCE_SHARED_XP,true,hke_z5)
endif
call hke_Z57Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
if(IsPlayerAlly(hke_z05,hke_Z65))then
call SetPlayerAllianceStateBJ(hke_z5,hke_Z65,0)
else
call SetPlayerAllianceStateBJ(hke_z5,hke_Z65,2)
endif
call hke_Z57Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_Z53Z(hke_z15,hke_z05)
endif
set hke_z05=null
set hke_Z65=null
set hke_z78=null
endfunction
function hke_z03Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
local integer hke_Z75
local unit hke_z65=hke_z7[hke_z15]
local player hke_Z65=GetOwningPlayer(hke_z65)
call hke_Z44Z(hke_z15,hke_z05,false)
if(hke_z4)and(hke_z6[hke_z15])then
if(hke_z78==hke_z2z[hke_z15])then
call SetHeroLevelBJ(hke_z65,GetHeroLevel(hke_z65)+hke_Z0Z,false)
endif
if(hke_z78==hke_z4z[hke_z15])then
call ModifyHeroStat(1,hke_z65,0,hke_Z3)
call ModifyHeroStat(0,hke_z65,0,hke_Z3)
call ModifyHeroStat(2,hke_z65,0,hke_Z3)
endif
if(hke_z78==hke_z5z[hke_z15])then
call hke_z98(hke_z15,false)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z77(hke_z65,hke_z05,1)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_ZZ3Z(hke_z65)
endif
if(hke_z78==hke_z8z[hke_z15])then
if(hke_Z5Z)then
if(hke_Z65!=hke_z5)then
call UnitShareVisionBJ(true,hke_z65,hke_z05)
endif
else
call UnitShareVisionBJ(true,hke_z65,hke_z05)
endif
endif
if(hke_z78==hke_z7z[hke_z15])then
call hke_Z47Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
if(hke_Z5Z)then
if(hke_Z65!=hke_z5)then
call SetUnitOwner(hke_z65,hke_z05,true)
endif
else
call SetUnitOwner(hke_z65,hke_z05,true)
endif
endif
if(hke_z78==hke_Zz0[hke_z15])then
call RemoveUnit(hke_z65)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_Z54Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_Z65=null
set hke_z65=null
set hke_z78=null
endfunction
function hke_z04Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z05==hke_z5)and(hke_z6[hke_z15]))then
if(hke_z78==hke_z2z[hke_z15])then
set hke_Z0=not(hke_Z0)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z58Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
set hke_Z5Z=not(hke_Z5Z)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
set hke_Z6Z=not(hke_Z6Z)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
set hke_Z7Z=not(hke_Z7Z)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
set hke_z9Z=not(hke_z9Z)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z7z[hke_z15])then
set hke_ZZz=not(hke_ZZz)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z6z[hke_z15])then
set hke_z7Z=not(hke_z7Z)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_Zz0[hke_z15])then
set hke_Z52=not(hke_Z52)
call hke_Z51Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_ZZ0[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z05Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if(hke_z78==hke_z2z[hke_z15])then
set hke_z61=1
call hke_Z58Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
set hke_z61=2
call hke_Z58Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
set hke_z61=3
call hke_Z58Z(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z51Z(hke_z15,hke_z05)
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z06Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
local integer hke_Z75=0
local player hke_Z65
local unit hke_z65=hke_z7[hke_z15]
call hke_Z44Z(hke_z15,hke_z05,false)
if((hke_z4)and(hke_z05==hke_z5)and(hke_z6[hke_z15]))then
loop
exitwhen hke_Z75>12
if(hke_z78==hke_ZzZ[hke_Z75])then
set hke_Z65=Player(hke_Z75)
call SetUnitOwner(hke_z7[hke_z15],hke_Z65,true)
endif
set hke_Z75=hke_Z75+1
endloop
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z50Z(hke_z15,hke_z05)
endif
endif
set hke_z05=null
set hke_Z65=null
set hke_z78=null
set hke_z65=null
endfunction
function hke_z07Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if(hke_z78==hke_z2z[hke_z15])then
call hke_z36(hke_z05)
call hke_Z6ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
set hke_z31[hke_z15]=not(hke_z31[hke_z15])
call hke_Z6ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
set hke_Z33[hke_z15]=not(hke_Z33[hke_z15])
call hke_Z6ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z38(hke_z15,not(hke_Z53[hke_z15]))
call hke_Z6ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
set hke_Z63[hke_z15]=not(hke_Z63[hke_z15])
call hke_Z6ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_z8z[hke_z15])then
set hke_Z43[hke_z15]=not(hke_Z43[hke_z15])
call hke_Z6ZZ(hke_z15,hke_z05)
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z08Z takes nothing returns nothing
local player hke_z05=GetTriggerPlayer()
local integer hke_z15=GetPlayerId(hke_z05)
local button hke_z78=GetClickedButton()
call hke_Z44Z(hke_z15,hke_z05,false)
if(hke_z78==hke_z2z[hke_z15])then
call hke_Z6zZ(hke_z05)
endif
if(hke_z78==hke_z4z[hke_z15])then
call hke_Z60Z(hke_z05)
endif
if(hke_z78==hke_z5z[hke_z15])then
call hke_Z61Z(hke_z05)
endif
if(hke_z78==hke_z3z[hke_z15])then
call hke_Z62Z(hke_z05)
endif
if(hke_z78==hke_z9z[hke_z15])then
call hke_Z64Z()
endif
if(hke_z78==hke_Z00[hke_z15])then
call hke_Z45Z(hke_z15,hke_z05)
endif
set hke_z05=null
set hke_z78=null
endfunction
function hke_z09Z takes nothing returns nothing
local integer hke_Z75
local player hke_Z65
local player hke_z05
set hke_z73=CreateTrigger()
call TriggerRegisterAnyUnitEventBJ(hke_z73,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddAction(hke_z73,function hke_Z9ZZ)
call TriggerAddCondition(hke_z43,Condition(function hke_Z73Z))
set hke_Z75=0
loop
exitwhen hke_Z75>11
set hke_zz1[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_zz1[hke_Z75],function hke_Z79Z)
call DisableTrigger(hke_zz1[hke_Z75])
set hke_Z30[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z30[hke_Z75],function hke_Z88Z)
call DisableTrigger(hke_Z30[hke_Z75])
set hke_Z50[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z50[hke_Z75],function hke_Z89Z)
call DisableTrigger(hke_Z50[hke_Z75])
set hke_Z40[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z40[hke_Z75],function hke_Z91Z)
call DisableTrigger(hke_Z40[hke_Z75])
set hke_Z60[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z60[hke_Z75],function hke_Z90Z)
call DisableTrigger(hke_Z60[hke_Z75])
set hke_Z6z[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z6z[hke_Z75],function hke_Z9zZ)
call DisableTrigger(hke_Z6z[hke_Z75])
set hke_Z70[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z70[hke_Z75],function hke_zZ1Z)
call DisableTrigger(hke_Z70[hke_Z75])
set hke_Z80[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z80[hke_Z75],function hke_zZ2Z)
call DisableTrigger(hke_Z80[hke_Z75])
set hke_Z90[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z90[hke_Z75],function hke_zZ3Z)
call DisableTrigger(hke_Z90[hke_Z75])
set hke_zZ0[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_zZ0[hke_Z75],function hke_zZ4Z)
call DisableTrigger(hke_zZ0[hke_Z75])
set hke_zz0[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_zz0[hke_Z75],function hke_zZ5Z)
call DisableTrigger(hke_zz0[hke_Z75])
set hke_z00[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z00[hke_Z75],function hke_zZ6Z)
set hke_z10[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z10[hke_Z75],function hke_zZ9Z)
set hke_z20[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z20[hke_Z75],function hke_zz0Z)
set hke_z30[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z30[hke_Z75],function hke_zz3Z)
set hke_z40[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z40[hke_Z75],function hke_Z81Z)
call DisableTrigger(hke_z40[hke_Z75])
set hke_z50[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z50[hke_Z75],function hke_Z82Z)
call DisableTrigger(hke_z50[hke_Z75])
set hke_z60[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z60[hke_Z75],function hke_Z83Z)
call DisableTrigger(hke_z60[hke_Z75])
set hke_z70[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z70[hke_Z75],function hke_Z84Z)
call DisableTrigger(hke_z70[hke_Z75])
set hke_z80[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z80[hke_Z75],function hke_Z85Z)
call DisableTrigger(hke_z80[hke_Z75])
set hke_z90[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z90[hke_Z75],function hke_Z86Z)
call DisableTrigger(hke_z90[hke_Z75])
set hke_ZZ3[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_ZZ3[hke_Z75],function hke_Z87Z)
call DisableTrigger(hke_ZZ3[hke_Z75])
set hke_ZZ1[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_ZZ1[hke_Z75],function hke_zz4Z)
set hke_Zz2[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Zz2[hke_Z75],function hke_zz5Z)
set hke_Zz1[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Zz1[hke_Z75],function hke_zz6Z)
set hke_Z01[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z01[hke_Z75],function hke_zz7Z)
set hke_Z81[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z81[hke_Z75],function hke_zz8Z)
set hke_Z21[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z21[hke_Z75],function hke_zz9Z)
set hke_Z51[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z51[hke_Z75],function hke_z0ZZ)
set hke_Z41[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z41[hke_Z75],function hke_z0zZ)
set hke_Z61[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z61[hke_Z75],function hke_z00Z)
set hke_Z12[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z12[hke_Z75],function hke_z02Z)
set hke_Z02[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z02[hke_Z75],function hke_z01Z)
set hke_Z71[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z71[hke_Z75],function hke_z03Z)
set hke_Z31[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z31[hke_Z75],function hke_z04Z)
set hke_Z22[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z22[hke_Z75],function hke_z05Z)
set hke_Z11[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z11[hke_Z75],function hke_z06Z)
set hke_Z23[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z23[hke_Z75],function hke_z08Z)
set hke_Z13[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_Z13[hke_Z75],function hke_z07Z)
call DisableTrigger(hke_ZZ1[hke_Z75])
call DisableTrigger(hke_Zz1[hke_Z75])
call DisableTrigger(hke_Zz2[hke_Z75])
call DisableTrigger(hke_Z01[hke_Z75])
call DisableTrigger(hke_Z81[hke_Z75])
call DisableTrigger(hke_Z21[hke_Z75])
call DisableTrigger(hke_Z51[hke_Z75])
call DisableTrigger(hke_Z41[hke_Z75])
call DisableTrigger(hke_Z61[hke_Z75])
call DisableTrigger(hke_Z12[hke_Z75])
call DisableTrigger(hke_Z02[hke_Z75])
call DisableTrigger(hke_Z71[hke_Z75])
call DisableTrigger(hke_Z31[hke_Z75])
call DisableTrigger(hke_Z22[hke_Z75])
call DisableTrigger(hke_Z11[hke_Z75])
call DisableTrigger(hke_Z23[hke_Z75])
call DisableTrigger(hke_Z13[hke_Z75])
set hke_z01[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z01[hke_Z75],function hke_Z95Z)
set hke_z11[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z11[hke_Z75],function hke_Z98Z)
set hke_z21[hke_Z75]=CreateTrigger()
call TriggerAddAction(hke_z21[hke_Z75],function hke_zZZZ)
call DisableTrigger(hke_z01[hke_Z75])
call DisableTrigger(hke_z11[hke_Z75])
call DisableTrigger(hke_z21[hke_Z75])
set hke_Z65=Player(hke_Z75)
if((GetPlayerController(hke_Z65)==MAP_CONTROL_USER)and(GetPlayerSlotState(hke_Z65)==PLAYER_SLOT_STATE_PLAYING))then
set hke_Z8Z[hke_Z75]=CreateGroup()
call TriggerRegisterPlayerStateEvent(hke_z63,hke_Z65,PLAYER_STATE_RESOURCE_FOOD_USED,LESS_THAN,0)
call TriggerRegisterPlayerKeyEventBJ(hke_z10[hke_Z75],hke_Z65,0,2)
call TriggerRegisterPlayerKeyEventBJ(hke_z00[hke_Z75],hke_Z65,0,3)
call TriggerRegisterPlayerKeyEventBJ(hke_z20[hke_Z75],hke_Z65,0,0)
call TriggerRegisterPlayerKeyEventBJ(hke_z30[hke_Z75],hke_Z65,0,1)
call TriggerRegisterPlayerChatEvent(hke_z53,hke_Z65,SubStringBJ(hke_Z0z,139,146),false)
call TriggerRegisterPlayerStateEvent(hke_z63,hke_Z65,PLAYER_STATE_RESOURCE_FOOD_USED,LESS_THAN,0)
set hke_Z9Z[hke_Z75]=GetPlayerStartLocationLoc(hke_Z65)
endif
set hke_Z75=hke_Z75+1
endloop
call DisableTrigger(hke_z73)
set hke_z8Z=CreateGroup()
set hke_z8=GetWorldBounds()
set hke_z2Z[0]=30.
set hke_z2Z[1]=60.
set hke_z2Z[2]=90.
set hke_z3Z[0]=50.
set hke_z3Z[1]=72.
set hke_z3Z[2]=95.
set hke_Z75=0
loop
exitwhen hke_Z75>20
set hke_z02[hke_Z75]=null
set hke_Z75=hke_Z75+1
endloop
set hke_Z75=0
loop
exitwhen(hke_Z75>12)
set hke_Z5[hke_Z75]=0
set hke_z6[hke_Z75]=false
set hke_Z7[hke_Z75]=false
set hke_Z8[hke_Z75]=0
set hke_Z1Z[hke_Z75]=false
set hke_Z2Z[hke_Z75]=false
set hke_Z3Z[hke_Z75]=CreateTimer()
set hke_Z8Z[hke_Z75]=CreateGroup()
set hke_zZZ[hke_Z75]=false
set hke_zzZ[hke_Z75]=false
set hke_z0Z[hke_Z75]=CreateTimer()
set hke_z1Z[hke_Z75]=false
set hke_Z3z[hke_Z75]=false
set hke_Z4z[hke_Z75]=0
set hke_Z20[hke_Z75]=DialogCreate()
set hke_Z91[hke_Z75]=DialogCreate()
set hke_zZ1[hke_Z75]=DialogCreate()
set hke_z31[hke_Z75]=false
set hke_Z32[hke_Z75]=0
set hke_Z42[hke_Z75]=false
set hke_Zz3[hke_Z75]=DialogCreate()
set hke_Z33[hke_Z75]=false
set hke_Z43[hke_Z75]=true
set hke_Z53[hke_Z75]=false
set hke_Z63[hke_Z75]=false
set hke_Z73[hke_Z75]=CreateTimer()
set hke_Z75=hke_Z75+1
endloop
set hke_Z75=0
loop
exitwhen(hke_Z75>3)
set hke_Z75=hke_Z75+1
endloop
set hke_Z75=0
loop
exitwhen(hke_Z75>21)
set hke_z12[hke_Z75]=false
set hke_Z75=hke_Z75+1
endloop
call TriggerRegisterTimerEvent(hke_z23,.01,false)
call TriggerAddAction(hke_z23,function hke_Z7zZ)
call TriggerAddAction(hke_z33,function hke_Z70Z)
call TriggerAddAction(hke_z43,function hke_Z74Z)
call TriggerAddAction(hke_z53,function hke_Z8zZ)
call TriggerAddAction(hke_z63,function hke_Z80Z)
call TriggerRegisterAnyUnitEventBJ(hke_z73,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddAction(hke_z73,function hke_Z9ZZ)
call TriggerRegisterAnyUnitEventBJ(hke_z83,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddAction(hke_z83,function hke_Z93Z)
call DisableTrigger(hke_z83)
call hke_Z69Z()
call SetPlayerName(Player(12),"中立生物")
set hke_Z65=null
endfunction
function InitTrig_HKETEST takes nothing returns nothing
call hke_z09Z()
endfunction
//===========================================================================
// Trigger: new_fast
//===========================================================================
function Trig_new_fastActions takes nothing returns nothing
    call UnitAddItemByIdSwapped( 'I03U', udg_last_selected_unit[GetConvertedPlayerId(GetTriggerPlayer())] )
endfunction
//===========================================================================
function InitTrig_new_fast takes nothing returns nothing
    set gg_trg_new_fast = CreateTrigger()
/*
  VC++8.0 cannot handle the variadic version of BOOST_PP_TUPLE_REM(size)
*/
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(0), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(1), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(2), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(3), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(4), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(5), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(6), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(7), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(8), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(9), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(10), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(11), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(12), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(13), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(14), "-fast", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_fast, Player(15), "-fast", true )
    call TriggerAddAction(gg_trg_new_fast, function Trig_new_fastActions)
endfunction
//===========================================================================
// Trigger: new_rs
//
// sys_Reinforcement陣列索引方程式 = 
// 00	Mod 3	00(上)	/	Mod 4	00(足)
// 01	Mod 3	01(中)	/	Mod 4	01(火)
// 02	Mod 3	02(下)	/	Mod 4	02(騎)
// 03	Mod 3	00(上)	/	Mod 4	03(砲)
// 04	Mod 3	01(中)	/	Mod 4	00(足)
// 05	Mod 3	02(下)	/	Mod 4	01(火)
// 06	Mod 3	00(上)	/	Mod 4	02(騎)
// 07	Mod 3	01(中)	/	Mod 4	03(砲)
// 08	Mod 3	02(下)	/	Mod 4	00(足)
// 09	Mod 3	00(上)	/	Mod 4	01(火)
// 10	Mod 3	01(中)	/	Mod 4	02(騎)
// 11	Mod 3	02(下)	/	Mod 4	03(砲)
// sys_Reinforcement陣列索引對照表 = 
//===========================================================================
function Trig_new_rsActions takes nothing returns nothing
    call PlaySoundBJ( gg_snd_GoodJob )
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_5393" )
    set bj_forLoopAIndex = 0
    set bj_forLoopAIndexEnd = 19
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_S02_revival_time[GetForLoopIndexA()] = 4.00
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call DestroyTrigger(GetTriggeringTrigger())
endfunction
//===========================================================================
function InitTrig_new_rs takes nothing returns nothing
    set gg_trg_new_rs = CreateTrigger()
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(0), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(1), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(2), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(3), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(4), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(5), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(6), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(7), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(8), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(9), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(10), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(11), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(12), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(13), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(14), "-rs", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_new_rs, Player(15), "-rs", true )
    call TriggerAddAction(gg_trg_new_rs, function Trig_new_rsActions)
endfunction
//===========================================================================
// Trigger: AH TEST
//===========================================================================
function Trig_AH_TESTActions takes nothing returns nothing
    call ConditionalTriggerExecute( gg_trg_AH_Mode )
endfunction
//===========================================================================
function InitTrig_AH_TEST takes nothing returns nothing
    set gg_trg_AH_TEST = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(1), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(2), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(3), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(4), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(5), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(6), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(7), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(8), "-AH", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_AH_TEST, Player(9), "-AH", true )
    call TriggerAddAction(gg_trg_AH_TEST, function Trig_AH_TESTActions)
endfunction
//===========================================================================
// Trigger: CR TEST 
//===========================================================================
function Trig_CR_TESTActions takes nothing returns nothing
    call ConditionalTriggerExecute( gg_trg_CRAZY )
    call DestroyTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_CR_TEST takes nothing returns nothing
    set gg_trg_CR_TEST = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(1), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(2), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(3), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(4), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(5), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(6), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(7), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(8), "-CRAZY", true )
    call TriggerRegisterPlayerChatEvent( gg_trg_CR_TEST, Player(9), "-CRAZY", true )
    call TriggerAddAction(gg_trg_CR_TEST, function Trig_CR_TESTActions)
endfunction
//===========================================================================
// Trigger: ESC 複製
//===========================================================================
function Trig_ESC_______uActions takes nothing returns nothing
    // ======================
    set bj_forLoopAIndex = GetConvertedPlayerId(GetTriggerPlayer())
    set bj_forLoopAIndexEnd = GetConvertedPlayerId(GetTriggerPlayer())
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "O" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "W" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "E" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "R" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "T" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "W" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "E" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "R" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "T" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "W" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "E" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "R" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "T" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "W" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "E" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "R" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "B" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "B" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "B" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "B" )
        call ForceUIKeyBJ( GetOwningPlayer(udg_S01_hero_of_player[bj_forLoopAIndex]), "B" )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
endfunction
//===========================================================================
function InitTrig_ESC_______u takes nothing returns nothing
    set gg_trg_ESC_______u = CreateTrigger()
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(0) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(1) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(2) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(3) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(4) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(5) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(6) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(7) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(8) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(9) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(10) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(11) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(12) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(13) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(14) )
        call TriggerRegisterPlayerEventEndCinematic( gg_trg_ESC_______u, Player(15) )
    call TriggerAddAction(gg_trg_ESC_______u, function Trig_ESC_______uActions)
endfunction
//===========================================================================
// Trigger: test AI
//===========================================================================
function Trig_test_AIFunc005003002 takes nothing returns boolean
    return (((IsUnitType(GetFilterUnit(), UNIT_TYPE_HERO) == true) and (IsPlayerAlly(GetOwningPlayer(GetFilterUnit()), Player(0)) == true)))
endfunction
function Trig_test_AIFunc006A takes nothing returns nothing
    call SetPlayerAllianceBJ( GetOwningPlayer(GetEnumUnit()), ALLIANCE_SHARED_CONTROL, true, GetTriggerPlayer() )
    call UnitUseItem( GetEnumUnit(), UnitItemInSlotBJ(GetEnumUnit(), 1) )
    call UnitAddItem( GetEnumUnit(), CreateItem('I015', 0, 0) )
    call UnitAddItem( GetEnumUnit(), CreateItem('blba', 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call SetHeroLevelBJ( GetEnumUnit(), 20, true )
    call GroupAddUnitSimple( GetEnumUnit(), udg_AI_Units[0] )
endfunction
function Trig_test_AIFunc008003002 takes nothing returns boolean
    return (((IsUnitType(GetFilterUnit(), UNIT_TYPE_HERO) == true) and (IsPlayerAlly(GetOwningPlayer(GetFilterUnit()), Player(7)) == true)))
endfunction
function Trig_test_AIFunc009A takes nothing returns nothing
    call SetPlayerAllianceBJ( GetOwningPlayer(GetEnumUnit()), ALLIANCE_SHARED_CONTROL, true, GetTriggerPlayer() )
    call UnitUseItem( GetEnumUnit(), UnitItemInSlotBJ(GetEnumUnit(), 1) )
    call UnitAddItem( GetEnumUnit(), CreateItem('I015', 0, 0) )
    call UnitAddItem( GetEnumUnit(), CreateItem('blba', 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call UnitAddItem( GetEnumUnit(), PlaceRandomItem(itp, 0, 0) )
    call SetHeroLevelBJ( GetEnumUnit(), 20, true )
    call GroupAddUnitSimple( GetEnumUnit(), udg_AI_Units[1] )
endfunction
function Trig_test_AIFunc010Func001A takes nothing returns nothing
    call IssuePointOrder( GetEnumUnit(), "attack", udg_X[8], udg_Y[8] )
endfunction
function Trig_test_AIFunc010Func002A takes nothing returns nothing
    call IssuePointOrder( GetEnumUnit(), "attack", udg_X[7], udg_Y[7] )
endfunction
function Trig_test_AIFunc010T takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    call ForGroupBJ( udg_AI_Units[0], function Trig_test_AIFunc010Func001A )
    call ForGroupBJ( udg_AI_Units[1], function Trig_test_AIFunc010Func002A )
    set ydl_group = null
    set ydl_unit = null
endfunction
function Trig_test_AIActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local timer ydl_timer
    local integer ydl_localvar_step = LoadInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76)
    set ydl_localvar_step = ydl_localvar_step + 3
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76, ydl_localvar_step)
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xECE825E7, ydl_localvar_step)
    call SetPlayerAllianceBJ( ConvertedPlayer(11), ALLIANCE_SHARED_CONTROL, true, GetTriggerPlayer() )
    call SetPlayerAllianceBJ( ConvertedPlayer(12), ALLIANCE_SHARED_CONTROL, true, GetTriggerPlayer() )
    call SetPlayerAllianceBJ( Player(PLAYER_NEUTRAL_AGGRESSIVE), ALLIANCE_SHARED_CONTROL, true, GetTriggerPlayer() )
    call SetPlayerAllianceBJ( Player(PLAYER_NEUTRAL_PASSIVE), ALLIANCE_SHARED_CONTROL, true, GetTriggerPlayer() )
    call SaveGroupHandle(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0x2F128C38, YDWEGetUnitsInRectMatchingNull(GetPlayableMapRect(), Condition(function Trig_test_AIFunc005003002)))
    call ForGroupBJ( LoadGroupHandle(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0x2F128C38), function Trig_test_AIFunc006A )
    call GroupRemoveUnit( udg_AI_Units[0], udg_S01_hero_of_player[1] )
    call SaveGroupHandle(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0x2F128C38, YDWEGetUnitsInRectMatchingNull(GetPlayableMapRect(), Condition(function Trig_test_AIFunc008003002)))
    call ForGroupBJ( LoadGroupHandle(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0x2F128C38), function Trig_test_AIFunc009A )
    set ydl_timer = CreateTimer()
    call TimerStart(ydl_timer, 8.00, true, function Trig_test_AIFunc010T)
    call DisableTrigger( GetTriggeringTrigger() )
    call FlushChildHashtable(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step)
    set ydl_group = null
    set ydl_unit = null
    set ydl_timer = null
endfunction
//===========================================================================
function InitTrig_test_AI takes nothing returns nothing
    set gg_trg_test_AI = CreateTrigger()
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(0), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(1), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(2), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(3), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(4), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(5), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(6), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(7), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(8), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(9), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(10), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(11), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(12), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(13), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(14), "-food1234", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_test_AI, Player(15), "-food1234", true )
    call TriggerAddAction(gg_trg_test_AI, function Trig_test_AIActions)
endfunction
//===========================================================================
// Trigger: itt pool init
//===========================================================================
function Trig_itt_pool_initActions takes nothing returns nothing
    call ConditionalTriggerExecute( gg_trg_C14 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I027', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'rots', 1 )
    call ItemPoolAddItemType( itp, 'lure', 1 )
    call ItemPoolAddItemType( itp, 'dtsb', 1 )
    call ItemPoolAddItemType( itp, 'tmsc', 1 )
    call ItemPoolAddItemType( itp, 'mnsf', 1 )
    call ItemPoolAddItemType( itp, 'btst', 1 )
    call ItemPoolAddItemType( itp, 'I02E', 1 )
    call ItemPoolAddItemType( itp, 'I020', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I026', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I040', 1 )
    call ItemPoolAddItemType( itp, 'I041', 1 )
    call ItemPoolAddItemType( itp, 'I042', 1 )
    call ItemPoolAddItemType( itp, 'I01W', 1 )
    call ItemPoolAddItemType( itp, 'I03Z', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I016', 1 )
    call ItemPoolAddItemType( itp, 'I01D', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I028', 1 )
    call ItemPoolAddItemType( itp, 'brag', 1 )
    call ItemPoolAddItemType( itp, 'ram4', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'spre', 1 )
    call ItemPoolAddItemType( itp, 'oflg', 1 )
    call ItemPoolAddItemType( itp, 'anfg', 1 )
    call ItemPoolAddItemType( itp, 'shhn', 1 )
    call ItemPoolAddItemType( itp, 'vddl', 1 )
    call ItemPoolAddItemType( itp, 'rnsp', 1 )
    call ItemPoolAddItemType( itp, 'jdrn', 1 )
    call ItemPoolAddItemType( itp, 'tmmt', 1 )
    call ItemPoolAddItemType( itp, 'hbth', 1 )
    call ItemPoolAddItemType( itp, 'I01R', 1 )
    call ItemPoolAddItemType( itp, 'I050', 1 )
    // -------------------------------------------------------------------
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'clsd', 1 )
    call ItemPoolAddItemType( itp, 'I03S', 1 )
    call ItemPoolAddItemType( itp, 'I027', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I00C', 1 )
    call ItemPoolAddItemType( itp, 'I01L', 1 )
    call ItemPoolAddItemType( itp, 'I00L', 1 )
    call ItemPoolAddItemType( itp, 'I01I', 1 )
    call ItemPoolAddItemType( itp, 'I00B', 1 )
    call ItemPoolAddItemType( itp, 'I007', 1 )
    call ItemPoolAddItemType( itp, 'I01K', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'rag1', 1 )
    call ItemPoolAddItemType( itp, 'rst1', 1 )
    call ItemPoolAddItemType( itp, 'rin1', 1 )
    call ItemPoolAddItemType( itp, 'I006', 1 )
    call ItemPoolAddItemType( itp, 'I00R', 1 )
    call ItemPoolAddItemType( itp, 'I01B', 1 )
    call ItemPoolAddItemType( itp, 'I01C', 1 )
    call ItemPoolAddItemType( itp, 'I00P', 1 )
    call ItemPoolAddItemType( itp, 'I003', 1 )
    // -------------------------------------------------------------------
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'tst2', 1 )
    call ItemPoolAddItemType( itp, 'fgrg', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'tsct', 1 )
    call ItemPoolAddItemType( itp, 'ofro', 1 )
    call ItemPoolAddItemType( itp, 'skul', 1 )
    call ItemPoolAddItemType( itp, 'oven', 1 )
    call ItemPoolAddItemType( itp, 'rde4', 1 )
    call ItemPoolAddItemType( itp, 'ckng', 1 )
    call ItemPoolAddItemType( itp, 'tkno', 1 )
    call ItemPoolAddItemType( itp, 'tcas', 1 )
    call ItemPoolAddItemType( itp, 'tret', 1 )
    call ItemPoolAddItemType( itp, 'tgrh', 1 )
    call ItemPoolAddItemType( itp, 'stel', 1 )
    call ItemPoolAddItemType( itp, 'ratf', 1 )
    call ItemPoolAddItemType( itp, 'flag', 1 )
    call ItemPoolAddItemType( itp, 'desc', 1 )
    call ItemPoolAddItemType( itp, 'fgun', 1 )
    call ItemPoolAddItemType( itp, 'I04A', 1 )
    call ItemPoolAddItemType( itp, 'I045', 1 )
    call ItemPoolAddItemType( itp, 'I043', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'mcou', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'rde1', 1 )
    call ItemPoolAddItemType( itp, 'oli2', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'lgdh', 1 )
    call ItemPoolAddItemType( itp, 'pams', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'asbl', 1 )
    call ItemPoolAddItemType( itp, 'odef', 1 )
    call ItemPoolAddItemType( itp, 'hlst', 1 )
    call ItemPoolAddItemType( itp, 'whwd', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'ankh', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'envl', 1 )
    call ItemPoolAddItemType( itp, 'I00T', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I025', 1 )
    call ItemPoolAddItemType( itp, 'I02F', 1 )
    call ItemPoolAddItemType( itp, 'I012', 1 )
    call ItemPoolAddItemType( itp, 'I023', 1 )
    call ItemPoolAddItemType( itp, 'I00S', 1 )
    call ItemPoolAddItemType( itp, 'I01O', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'fwss', 1 )
    call ItemPoolAddItemType( itp, 'sfog', 1 )
    call ItemPoolAddItemType( itp, 'rde0', 1 )
    call ItemPoolAddItemType( itp, 'thdm', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'ram3', 1 )
    call ItemPoolAddItemType( itp, 'frgd', 1 )
    call ItemPoolAddItemType( itp, 'gldo', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'ram2', 1 )
    call ItemPoolAddItemType( itp, 'blba', 1 )
    call ItemPoolAddItemType( itp, 'amrc', 1 )
    call ItemPoolAddItemType( itp, 'gobm', 1 )
    call ItemPoolAddItemType( itp, 'tels', 1 )
    // -------------------------------------------------------------------
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I01M', 1 )
    call ItemPoolAddItemType( itp, 'iwbr', 1 )
    call ItemPoolAddItemType( itp, 'I02G', 1 )
    call ItemPoolAddItemType( itp, 'I004', 1 )
    call ItemPoolAddItemType( itp, 'I00Z', 1 )
    call ItemPoolAddItemType( itp, 'I02L', 1 )
    call ItemPoolAddItemType( itp, 'I017', 1 )
    call ItemPoolAddItemType( itp, 'I01J', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I03K', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'soul', 1 )
    call ItemPoolAddItemType( itp, 'srtl', 1 )
    call ItemPoolAddItemType( itp, 'I038', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'mlst', 1 )
    call ItemPoolAddItemType( itp, 'I02O', 1 )
    call ItemPoolAddItemType( itp, 'gsou', 1 )
    call ItemPoolAddItemType( itp, 'I01A', 1 )
    call ItemPoolAddItemType( itp, 'I01G', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I014', 1 )
    call ItemPoolAddItemType( itp, 'I00Q', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I01P', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I005', 1 )
    call ItemPoolAddItemType( itp, 'I00F', 1 )
    call ItemPoolAddItemType( itp, 'I002', 1 )
    call ItemPoolAddItemType( itp, 'I01N', 1 )
    call ItemPoolAddItemType( itp, 'I00Y', 1 )
    call ItemPoolAddItemType( itp, 'I02J', 1 )
    call ItemPoolAddItemType( itp, 'I00W', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I022', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I04J', 1 )
    call ItemPoolAddItemType( itp, 'I04M', 1 )
    call ItemPoolAddItemType( itp, 'I04L', 1 )
    call ItemPoolAddItemType( itp, 'I04K', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I00H', 1 )
    call ItemPoolAddItemType( itp, 'I015', 1 )
    // -------------------------------------------------------------------
    call ItemPoolAddItemType( itp, 'I01F', 1 )
    call ItemPoolAddItemType( itp, 'I011', 1 )
    call ItemPoolAddItemType( itp, 'I00E', 1 )
    call ItemPoolAddItemType( itp, 'I02N', 1 )
    call ItemPoolAddItemType( itp, 'I00U', 1 )
    call ItemPoolAddItemType( itp, 'sksh', 1 )
    call ItemPoolAddItemType( itp, 'I013', 1 )
    // -------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_itt_pool_init takes nothing returns nothing
    set gg_trg_itt_pool_init = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_itt_pool_init, 0.00 )
    call TriggerAddAction(gg_trg_itt_pool_init, function Trig_itt_pool_initActions)
endfunction
//===========================================================================
// Trigger: itt init
//===========================================================================
globals
itempool itp =CreateItemPool()
endglobals
//===========================================================================
function InitTrig_itt_init takes nothing returns nothing
    set gg_trg_itt_init = CreateTrigger()
endfunction
//===========================================================================
// Trigger: DMG
//===========================================================================
function Trig_DMGConditions takes nothing returns boolean
    return ((GetEventDamage() >= 0.00))
endfunction
function Trig_DMGActions takes nothing returns nothing
    if ((GetOwningPlayer(GetEventDamageSource()) == GetOwningPlayer(udg_last_selected_unit[1]))) then
        call BJDebugMsg( ( GetUnitName(GetEventDamageSource()) + ( "對 " + ( GetPlayerName(GetTriggerPlayer()) + ( "  造成  " + ( R2S(GetEventDamage()) + "  傷害" ) ) ) ) ) )
    else
    endif
endfunction
//===========================================================================
function InitTrig_DMG takes nothing returns nothing
    set gg_trg_DMG = CreateTrigger()
    call YDWESyStemAnyUnitDamagedRegistTrigger( gg_trg_DMG )
    call TriggerAddCondition(gg_trg_DMG, Condition(function Trig_DMGConditions))
    call TriggerAddAction(gg_trg_DMG, function Trig_DMGActions)
endfunction
//===========================================================================
// Trigger: DEAD
//===========================================================================
function Trig_DEADConditions takes nothing returns boolean
    return ((GetOwningPlayer(GetDyingUnit()) == Player(0)))
endfunction
function Trig_DEADActions takes nothing returns nothing
    call BJDebugMsg( ( GetUnitName(GetTriggerUnit()) + "死亡" ) )
endfunction
//===========================================================================
function InitTrig_DEAD takes nothing returns nothing
    set gg_trg_DEAD = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ( gg_trg_DEAD, EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition(gg_trg_DEAD, Condition(function Trig_DEADConditions))
    call TriggerAddAction(gg_trg_DEAD, function Trig_DEADActions)
endfunction
//===========================================================================
// Trigger: test init
//===========================================================================
function Trig_test_initActions takes nothing returns nothing
    set udg_CRAZY_B = true
    set udg_single_player = true
    call FogEnableOff( )
    call FogMaskEnableOff( )
    call SetPlayerStateBJ( Player(2), PLAYER_STATE_RESOURCE_GOLD, 88888 )
endfunction
//===========================================================================
function InitTrig_test_init takes nothing returns nothing
    set gg_trg_test_init = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_test_init, 0.05 )
    call TriggerAddAction(gg_trg_test_init, function Trig_test_initActions)
endfunction
//===========================================================================
// Trigger: Check Stop
//===========================================================================
function Trig_Check_StopConditions takes nothing returns boolean
    return ((IsUnitPausedBJ(udg_S01_hero_of_player[1]) == true))
endfunction
function Trig_Check_StopActions takes nothing returns nothing
    call BJDebugMsg( "TRIGSTR_3546" )
endfunction
//===========================================================================
function InitTrig_Check_Stop takes nothing returns nothing
    set gg_trg_Check_Stop = CreateTrigger()
    call TriggerRegisterTimerEventPeriodic( gg_trg_Check_Stop, 0.10 )
    call TriggerAddCondition(gg_trg_Check_Stop, Condition(function Trig_Check_StopConditions))
    call TriggerAddAction(gg_trg_Check_Stop, function Trig_Check_StopActions)
endfunction
//===========================================================================
// Trigger: Prize2s
//
// 
//===========================================================================
function Trig_Prize2sFunc001A takes nothing returns nothing
	call SetPlayerState(GetEnumPlayer(), PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(GetEnumPlayer(), PLAYER_STATE_RESOURCE_GOLD) + udg_Pay_money)
endfunction
function Trig_Prize2sFunc002A takes nothing returns nothing
	call SetPlayerState(GetEnumPlayer(), PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(GetEnumPlayer(), PLAYER_STATE_RESOURCE_GOLD) + udg_Pay_Money2)
endfunction
function Trig_Prize2sActions takes nothing returns nothing
    call ForForce( udg_Players_group[0], function Trig_Prize2sFunc001A )
    call ForForce( udg_Players_group[1], function Trig_Prize2sFunc002A )
endfunction
//===========================================================================
function InitTrig_Prize2s takes nothing returns nothing
    set gg_trg_Prize2s = CreateTrigger()
    call TriggerRegisterTimerEventPeriodic( gg_trg_Prize2s, 2 )
    call TriggerAddCondition(gg_trg_Prize2s, Condition(function Trig_Prize2sActions))
endfunction//===========================================================================
// Trigger: Prize150s
//===========================================================================
function Trig_Prize150sActions takes nothing returns nothing
    call DisplayTextToForce( GetPlayersAll(), ( "|cffffCC00" + ( "獲得犒賞" + "|r" ) ) )
    call AdjustPlayerStateBJ( 350, Player(0), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(1), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(2), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(3), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(4), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(5), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(6), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(7), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(8), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 350, Player(9), PLAYER_STATE_RESOURCE_GOLD )
    call AdjustPlayerStateBJ( 5, Player(0), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(1), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(2), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(3), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(4), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(5), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(6), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(7), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(8), PLAYER_STATE_RESOURCE_LUMBER )
    call AdjustPlayerStateBJ( 5, Player(9), PLAYER_STATE_RESOURCE_LUMBER )
endfunction
//===========================================================================
function InitTrig_Prize150s takes nothing returns nothing
    set gg_trg_Prize150s = CreateTrigger()
    call TriggerRegisterTimerEventPeriodic( gg_trg_Prize150s, 150.00 )
    call TriggerAddAction(gg_trg_Prize150s, function Trig_Prize150sActions)
endfunction
//===========================================================================
// Trigger: End Game A
//===========================================================================
function Trig_End_Game_AConditions takes nothing returns boolean
    return ((GetUnitState(gg_unit_e00O_0325, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_e00D_0301, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_nten_0010, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_nten_0011, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_nten_0012, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0040, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0041, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0042, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0043, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0037, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0039, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0090, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0104, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0026, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0027, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0028, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_owtw_0029, UNIT_STATE_LIFE) <= 0.00))
endfunction
function Trig_End_Game_AActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'R00H', 1, Player(11) )
    call PlaySoundBJ( gg_snd_ClanInvitation )
    call KillSoundWhenDone( GetLastPlayedSound() )
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_9966" )
endfunction
//===========================================================================
function InitTrig_End_Game_A takes nothing returns nothing
    set gg_trg_End_Game_A = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0026, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0027, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0028, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0029, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0039, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0090, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0037, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0104, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0040, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0041, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0042, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_owtw_0043, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_nten_0010, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_nten_0011, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_nten_0012, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_e00O_0325, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_A, gg_unit_e00D_0301, EVENT_UNIT_DEATH )
    call TriggerAddCondition(gg_trg_End_Game_A, Condition(function Trig_End_Game_AConditions))
    call TriggerAddAction(gg_trg_End_Game_A, function Trig_End_Game_AActions)
endfunction
//===========================================================================
// Trigger: End Game B
//===========================================================================
function Trig_End_Game_BConditions takes nothing returns boolean
    return ((GetUnitState(gg_unit_e00P_0444, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_e00V_0577, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_nten_0393, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_nten_0389, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_nten_0388, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0394, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0397, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0396, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0395, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0406, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0407, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0409, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0408, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0416, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0417, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0414, UNIT_STATE_LIFE) <= 0.00) and (GetUnitState(gg_unit_o007_0415, UNIT_STATE_LIFE) <= 0.00))
endfunction
function Trig_End_Game_BActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'R00H', 1, Player(10) )
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_11257" )
    call PlaySoundBJ( gg_snd_ClanInvitation )
    call KillSoundWhenDone( GetLastPlayedSound() )
endfunction
//===========================================================================
function InitTrig_End_Game_B takes nothing returns nothing
    set gg_trg_End_Game_B = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0394, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0397, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0396, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0395, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0406, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0407, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0408, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0409, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0416, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0415, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0417, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_o007_0414, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_nten_0388, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_nten_0389, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_nten_0393, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_e00P_0444, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_End_Game_B, gg_unit_e00V_0577, EVENT_UNIT_DEATH )
    call TriggerAddCondition(gg_trg_End_Game_B, Condition(function Trig_End_Game_BConditions))
    call TriggerAddAction(gg_trg_End_Game_B, function Trig_End_Game_BActions)
endfunction
//===========================================================================
// Trigger: Tower be Destoried
//===========================================================================
function Trig_Tower_be_DestoriedFunc052Func001Func004A takes nothing returns nothing
    call AdjustPlayerStateBJ( 100, GetEnumPlayer(), PLAYER_STATE_RESOURCE_GOLD )
endfunction
function Trig_Tower_be_DestoriedFunc052Func005A takes nothing returns nothing
    call AdjustPlayerStateBJ( 200, GetEnumPlayer(), PLAYER_STATE_RESOURCE_GOLD )
endfunction
function Trig_Tower_be_DestoriedActions takes nothing returns nothing
    call PlaySoundBJ( gg_snd_Rescue )
    call KillSoundWhenDone( GetLastPlayedSound() )
    set udg_tmpPF = YDWEGetPlayersEnemiesNull(GetOwningPlayer(GetTriggerUnit()))
    if ((GetOwningPlayer(GetKillingUnitBJ()) != udg_X_PlayerA[0]) and (GetOwningPlayer(GetKillingUnitBJ()) != udg_X_PlayerB[0]) and (GetOwningPlayer(GetKillingUnitBJ()) != Player(PLAYER_NEUTRAL_AGGRESSIVE))) then
        call ForForce( udg_tmpPF, function Trig_Tower_be_DestoriedFunc052Func005A )
        if ((IsPlayerAlly(GetOwningPlayer(GetTriggerUnit()), Player(0)) == true)) then
            if ((udg_CRAZY_B == true)) then
                call DisplayTextToForce( GetPlayersAll(), ( "|CFFFFCC00" + ( GetPlayerName(GetOwningPlayer(GetKillingUnitBJ())) + " |r已經成功的摧毀敵軍的防線，聯合軍將士獲得犒賞|cffff9900 200 |r黃金" ) ) )
            else
                call DisplayTextToForce( GetPlayersAll(), ( "|CFFFFCC00" + ( GetHeroProperName(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetKillingUnitBJ()))]) + " |r已經成功的摧毀敵軍的防線，聯合軍將士獲得犒賞|cffff9900 200 |r黃金" ) ) )
            endif
        else
            if ((udg_CRAZY_B == true)) then
                call DisplayTextToForce( GetPlayersAll(), ( "|CFFFFCC00" + ( GetPlayerName(GetOwningPlayer(GetKillingUnitBJ())) + " |r已經成功的摧毀敵軍的防線，織田軍將士獲得犒賞|cffff9900 200 |r黃金" ) ) )
            else
                call DisplayTextToForce( GetPlayersAll(), ( "|CFFFFCC00" + ( GetHeroProperName(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetKillingUnitBJ()))]) + " |r已經成功的摧毀敵軍的防線，織田軍將士獲得犒賞|cffff9900 200 |r黃金" ) ) )
            endif
        endif
    else
        if ((GetOwningPlayer(GetKillingUnitBJ()) != Player(PLAYER_NEUTRAL_AGGRESSIVE))) then
            call DisplayTextToForce( GetPlayersAll(), ( GetPlayerName(GetOwningPlayer(GetKillingUnitBJ())) + ( "已" + ( "經成功的攻下敵人的防線!" + ( GetPlayerName(GetOwningPlayer(GetKillingUnitBJ())) + "將士獲得犒賞|CFFFFCC22 100 |R黃金" ) ) ) ) )
            call ForForce( udg_tmpPF, function Trig_Tower_be_DestoriedFunc052Func001Func004A )
        else
            call DisplayTextToForce( GetPlayersAll(), ( "|CFFFFCC00" + ( GetUnitName(GetKillingUnitBJ()) + "|R成功攻陷軍隊的防線!" ) ) )
        endif
    endif
    call DestroyForce(udg_tmpPF)
endfunction
//===========================================================================
function InitTrig_Tower_be_Destoried takes nothing returns nothing
    set gg_trg_Tower_be_Destoried = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0026, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0027, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0028, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0029, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0030, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0031, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0032, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0033, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0034, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0035, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0036, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0037, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0038, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0039, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0040, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0041, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0042, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0043, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0044, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0045, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0046, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0047, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0090, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_owtw_0104, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0394, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0397, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0396, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0395, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0406, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0407, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0408, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0409, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0416, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0415, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0417, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0414, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0398, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0399, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0401, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0400, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0402, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0403, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0405, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0404, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0413, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0412, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0411, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Tower_be_Destoried, gg_unit_o007_0410, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Tower_be_Destoried, function Trig_Tower_be_DestoriedActions)
endfunction
//===========================================================================
// Trigger: Die Basic Guards
//===========================================================================
function Trig_Die_Basic_GuardsActions takes nothing returns nothing
    call DisplayTextToForce( GetPlayersAll(), ( "|CFFFF0000" + ( GetUnitName(GetTriggerUnit()) + "|R已被殲滅!" ) ) )
endfunction
//===========================================================================
function InitTrig_Die_Basic_Guards takes nothing returns nothing
    set gg_trg_Die_Basic_Guards = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Die_Basic_Guards, gg_unit_h00Y_0816, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Basic_Guards, gg_unit_h01N_0815, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Basic_Guards, gg_unit_h026_0732, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Basic_Guards, gg_unit_h01Q_0016, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Basic_Guards, gg_unit_h01R_0805, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Basic_Guards, gg_unit_h01L_0813, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Die_Basic_Guards, function Trig_Die_Basic_GuardsActions)
endfunction
//===========================================================================
// Trigger: Die Advanced Guards
//===========================================================================
function Trig_Die_Advanced_GuardsActions takes nothing returns nothing
    if ((GetOwningPlayer(GetTriggerUnit()) == udg_X_PlayerB[0])) then
        call DisplayTextToForce( udg_Players_group[1], ( "|CFFFF0000" + ( GetUnitName(GetTriggerUnit()) + "|R已被殲滅!敵人攻入大本營了!" ) ) )
    else
        call DisplayTextToForce( udg_Players_group[0], ( "|CFFFF0000" + ( GetUnitName(GetTriggerUnit()) + "|R已被殲滅!敵人攻入大本營了!" ) ) )
    endif
endfunction
//===========================================================================
function InitTrig_Die_Advanced_Guards takes nothing returns nothing
    set gg_trg_Die_Advanced_Guards = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Die_Advanced_Guards, gg_unit_e00D_0301, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Advanced_Guards, gg_unit_e00O_0325, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Advanced_Guards, gg_unit_e00P_0444, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Die_Advanced_Guards, gg_unit_e00V_0577, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Die_Advanced_Guards, function Trig_Die_Advanced_GuardsActions)
endfunction
//===========================================================================
// Trigger: Barracks are Destoried
//===========================================================================
function Trig_Barracks_are_DestoriedFunc015A takes nothing returns nothing
    call AdjustPlayerStateBJ( 400, GetEnumPlayer(), PLAYER_STATE_RESOURCE_GOLD )
endfunction
function Trig_Barracks_are_DestoriedActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
    set udg_tmpPF = YDWEGetPlayersEnemiesNull(GetOwningPlayer(u1))
    if ((GetOwningPlayer(u1) == udg_X_PlayerB[0])) then
        call DisplayTextToForce( udg_tmpPF, "|cFFFFDEAD突破對方陣地！織田軍將士獲得犒賞|r|cFFFF9900 400 |r|cFFFFDEAD黃金|r" + "" )
    else
        call DisplayTextToForce( udg_tmpPF, "|cFFFFDEAD突破對方陣地！聯合軍將士獲得犒賞|r|cFFFF9900 400 |r|cFFFFDEAD黃金|r" + "" )
    endif
    call ForForce( udg_tmpPF, function Trig_Barracks_are_DestoriedFunc015A )
    call DestroyForce( udg_tmpPF )
  	if ( u1 == gg_unit_nten_0388 ) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "聯合軍上路軍營已經淪陷!!" + "" ) )
    endif
    // 聯合軍中路兵營
    if ( u1 == gg_unit_nten_0389 ) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "聯合軍中路軍營已經淪陷!!" + "" ) )
    endif
    // 聯合軍下路兵營
    if ( u1 == gg_unit_nten_0393 ) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "聯合軍下路軍營已經淪陷!!" + "" ) )
    endif
    // 織田軍上路兵營
    if ( u1 == gg_unit_nten_0010 ) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "織田軍上路軍營已經淪陷!!" + "" ) )
    endif
    // 織田軍中路兵營
    if ( u1 == gg_unit_nten_0011) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "織田軍中路軍營已經淪陷!!" + "" ) )
    endif
    // 織田軍下路兵營
    if ( u1 == gg_unit_nten_0012) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "織田軍下路軍營已經淪陷!!" + "" ) )
    endif
    // 聯合軍上路騎兵營
    if ( u1 == gg_unit_otrb_0392) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "聯合軍上路騎兵營已經淪陷!!" + "" ) )
    endif
    // 聯合軍中路騎兵營
    if ( u1 == gg_unit_otrb_0391) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "聯合軍中路騎兵營已經淪陷!!" + "" ) )
    endif
    // 聯合軍下路騎兵營
    if ( u1 == gg_unit_otrb_0390) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "聯合軍下路騎兵營已經淪陷!!" + "" ) )
    endif
    // 織田軍上路騎兵營
    if ( u1 == gg_unit_otrb_0015) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "織田軍上路騎兵營已經淪陷!!" + "" ) )
    endif
    // 織田軍中路騎兵營
    if ( u1 == gg_unit_otrb_0014) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "織田軍中路騎兵營已經淪陷!!" + "" ) )
    endif
    // 織田軍下路騎兵營
    if ( u1 == gg_unit_otrb_0013) then
        call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "織田軍下路騎兵營已經淪陷!!" + "" ) )
    endif
set u1 = null 
endfunction
//===========================================================================
function InitTrig_Barracks_are_Destoried takes nothing returns nothing
    set gg_trg_Barracks_are_Destoried = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_nten_0393, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_nten_0389, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_nten_0388, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_nten_0012, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_nten_0011, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_nten_0010, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_otrb_0390, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_otrb_0391, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_otrb_0392, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_otrb_0013, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_otrb_0014, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Barracks_are_Destoried, gg_unit_otrb_0015, EVENT_UNIT_DEATH )
    call TriggerAddCondition(gg_trg_Barracks_are_Destoried, Condition(function Trig_Barracks_are_DestoriedActions))
endfunction
//===========================================================================
// Trigger: Game OverA
//===========================================================================
function Trig_Game_OverAFunc017A takes nothing returns nothing
    call PauseUnitBJ( true, GetEnumUnit() )
endfunction
function Trig_Game_OverAFunc018002002 takes nothing returns boolean
    return (((IsUnitType(GetFilterUnit(), UNIT_TYPE_STRUCTURE) == true) and (GetOwningPlayer(GetFilterUnit()) == udg_X_PlayerB[0])))
endfunction
function Trig_Game_OverAFunc019A takes nothing returns nothing
    call AddSpecialEffectLocBJ( GetUnitLoc(GetEnumUnit()), "Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl" )
    call DestroyEffect( GetLastCreatedEffectBJ() )
endfunction
function Trig_Game_OverAActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    // ---------------------------------
    // ---------------------------------
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call CreateFogModifierRectBJ( true, ConvertedPlayer(GetForLoopIndexA()), FOG_OF_WAR_VISIBLE, GetPlayableMapRect() )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // ---------------------------------
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ((GetPlayerController(ConvertedPlayer(GetForLoopIndexA())) != MAP_CONTROL_USER)) then
            set udg_S300_Number[GetForLoopIndexA()] = -99999
        else
            set udg_S300_Number[GetForLoopIndexA()] = ( ( ( udg_S03_number_kill[GetForLoopIndexA()] * 1 ) + ( udg_S17_kill_H_num[GetForLoopIndexA()] * 25 ) ) + ( ( ( udg_S13_time[GetForLoopIndexA()] * 15 ) + ( udg_S12_Building[GetForLoopIndexA()] * 40 ) ) - ( udg_S18_die_Number[GetForLoopIndexA()] * 25 ) ) )
        endif
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // ---------------------------------
    // ---------------------------------
    set udg_A_temp_Number[0] = 1
    set bj_forLoopBIndex = 2
    set bj_forLoopBIndexEnd = 5
    loop
        exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
        if ((udg_S300_Number[GetForLoopIndexB()] > udg_S300_Number[udg_A_temp_Number[0]]) and (GetPlayerController(ConvertedPlayer(GetForLoopIndexB())) == MAP_CONTROL_USER)) then
            set udg_A_temp_Number[0] = GetForLoopIndexB()
        else
        endif
        set bj_forLoopBIndex = bj_forLoopBIndex + 1
    endloop
    // ---------------------------------
    // ---------------------------------
    // ---------------------------------
    // ---------------------------------
    call SetUnitInvulnerable( gg_unit_ntn2_0009, true )
    set udg_A_common_group = YDWEGetUnitsInRectAllNull(GetPlayableMapRect())
    call ForGroupBJ( udg_A_common_group, function Trig_Game_OverAFunc017A )
    set udg_A_common_group2 = YDWEGetUnitsInRectMatchingNull(GetPlayableMapRect(), Condition(function Trig_Game_OverAFunc018002002))
    call ForGroupBJ( udg_A_common_group2, function Trig_Game_OverAFunc019A )
    // ---------------------------------
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_12430" )
    // ---------------------------------
    set udg_tmpU[2] = GetTriggerUnit()
    call EnableTrigger(gg_trg_boom)
    call CinematicModeBJ( true, GetPlayersAll() )
    call PanCameraToTimed( GetUnitX(GetTriggerUnit()), GetUnitY(GetTriggerUnit()), 1.50 )
    call SetCameraField( CAMERA_FIELD_FIELD_OF_VIEW, bj_CAMERA_DEFAULT_FOV, 0 )
    call TransmissionFromUnitWithNameBJ( GetPlayersAll(), udg_S01_hero_of_player[udg_A_temp_Number[0]], "TRIGSTR_099", null, ( "此場戰事在" + ( ( "|cffff9900" + ( GetPlayerName(GetOwningPlayer(udg_S01_hero_of_player[udg_A_temp_Number[0]])) + "|r" ) ) + "英勇地領率下 , 為織田軍拿下勝利 !" ) ), bj_TIMETYPE_ADD, 0, true )
    call PlayMusicBJ( gg_snd_HeroicVictory )
    call DisableTrigger(gg_trg_boom)
    call CinematicModeBJ( false, GetPlayersAll() )
    call DisableTrigger( GetTriggeringTrigger() )
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_Game_OverA takes nothing returns nothing
    set gg_trg_Game_OverA = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Game_OverA, gg_unit_ntn2_0372, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Game_OverA, function Trig_Game_OverAActions)
endfunction
//===========================================================================
// Trigger: Game OverB
//===========================================================================
function Trig_Game_OverBFunc017A takes nothing returns nothing
    call PauseUnitBJ( true, GetEnumUnit() )
endfunction
function Trig_Game_OverBFunc018002002 takes nothing returns boolean
    return (((IsUnitType(GetFilterUnit(), UNIT_TYPE_STRUCTURE) == true) and (GetOwningPlayer(GetFilterUnit()) == udg_X_PlayerA[0])))
endfunction
function Trig_Game_OverBFunc019A takes nothing returns nothing
    call AddSpecialEffectLocBJ( GetUnitLoc(GetEnumUnit()), "Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl" )
    call DestroyEffect( GetLastCreatedEffectBJ() )
endfunction
function Trig_Game_OverBActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    // ---------------------------------
    // ---------------------------------
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call CreateFogModifierRectBJ( true, ConvertedPlayer(GetForLoopIndexA()), FOG_OF_WAR_VISIBLE, GetPlayableMapRect() )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call SetUnitInvulnerable( gg_unit_ntn2_0372, true )
    // ---------------------------------
    set bj_forLoopAIndex = 6
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ((GetPlayerController(ConvertedPlayer(GetForLoopIndexA())) != MAP_CONTROL_USER)) then
            set udg_S300_Number[GetForLoopIndexA()] = -99999
        else
            set udg_S300_Number[GetForLoopIndexA()] = ( ( ( udg_S03_number_kill[GetForLoopIndexA()] * 1 ) + ( udg_S17_kill_H_num[GetForLoopIndexA()] * 25 ) ) + ( ( ( udg_S13_time[GetForLoopIndexA()] * 15 ) + ( udg_S12_Building[GetForLoopIndexA()] * 40 ) ) - ( udg_S18_die_Number[GetForLoopIndexA()] * 25 ) ) )
        endif
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // ---------------------------------
    // ---------------------------------
    set udg_A_temp_Number[0] = 6
    set bj_forLoopBIndex = 7
    set bj_forLoopBIndexEnd = 10
    loop
        exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
        if ((udg_S300_Number[GetForLoopIndexB()] > udg_S300_Number[udg_A_temp_Number[0]]) and (GetPlayerController(ConvertedPlayer(GetForLoopIndexB())) == MAP_CONTROL_USER)) then
            set udg_A_temp_Number[0] = GetForLoopIndexB()
        else
        endif
        set bj_forLoopBIndex = bj_forLoopBIndex + 1
    endloop
    // ---------------------------------
    // ---------------------------------
    // ---------------------------------
    // ---------------------------------
    set udg_A_common_group = YDWEGetUnitsInRectAllNull(GetPlayableMapRect())
    call ForGroupBJ( udg_A_common_group, function Trig_Game_OverBFunc017A )
    set udg_A_common_group2 = YDWEGetUnitsInRectMatchingNull(GetPlayableMapRect(), Condition(function Trig_Game_OverBFunc018002002))
    call ForGroupBJ( udg_A_common_group2, function Trig_Game_OverBFunc019A )
    set udg_tmpU[2] = GetTriggerUnit()
    call EnableTrigger(gg_trg_boom)
    // ---------------------------------
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_2166" )
    // ---------------------------------
    call CinematicModeBJ( true, GetPlayersAll() )
    call PanCameraToTimed( GetUnitX(GetTriggerUnit()), GetUnitY(GetTriggerUnit()), 1.50 )
    call SetCameraField( CAMERA_FIELD_FIELD_OF_VIEW, bj_CAMERA_DEFAULT_FOV, 0 )
    call TransmissionFromUnitWithNameBJ( GetPlayersAll(), udg_S01_hero_of_player[udg_A_temp_Number[0]], "TRIGSTR_099", null, ( "此場戰事在" + ( ( "|cffff9900" + ( GetPlayerName(GetOwningPlayer(udg_S01_hero_of_player[udg_A_temp_Number[0]])) + "|r" ) ) + "英勇地領率下 , 為聯合軍拿下勝利 !" ) ), bj_TIMETYPE_ADD, 0, true )
    call CinematicModeBJ( false, GetPlayersAll() )
    call DisableTrigger(gg_trg_boom)
    call PlayMusicBJ( gg_snd_HeroicVictory )
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_Game_OverB takes nothing returns nothing
    set gg_trg_Game_OverB = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Game_OverB, gg_unit_ntn2_0009, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Game_OverB, function Trig_Game_OverBActions)
endfunction
//===========================================================================
// Trigger: boom
//===========================================================================
function Trig_boomActions takes nothing returns nothing
    call AddSpecialEffectLocBJ( PolarProjectionBJ(GetUnitLoc(udg_tmpU[2]), GetRandomReal(50.00, 400.00), GetRandomDirectionDeg()), "Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl" )
    call DestroyEffect( GetLastCreatedEffectBJ() )
endfunction
//===========================================================================
function InitTrig_boom takes nothing returns nothing
    set gg_trg_boom = CreateTrigger()
    call DisableTrigger(gg_trg_boom)
    call TriggerRegisterTimerEventPeriodic( gg_trg_boom, 0.30 )
    call TriggerAddAction(gg_trg_boom, function Trig_boomActions)
endfunction
//===========================================================================
// Trigger: Castle Anti Magic
//===========================================================================
function Trig_Castle_Anti_MagicActions takes nothing returns nothing
    if ((GetOwningPlayer(GetTriggerUnit()) == udg_X_PlayerA[0])) then
        if ((IsUnitAliveBJ(gg_unit_e00O_0325) == false) and (IsUnitAliveBJ(gg_unit_e00D_0301) == false)) then
            call UnitRemoveAbilityBJ( 'A00W', gg_unit_ntn2_0009 )
        else
        endif
    else
        if ((IsUnitAliveBJ(gg_unit_e00P_0444) == false) and (IsUnitAliveBJ(gg_unit_e00V_0577) == false)) then
            call UnitRemoveAbilityBJ( 'A00W', gg_unit_ntn2_0372 )
        else
        endif
    endif
endfunction
//===========================================================================
function InitTrig_Castle_Anti_Magic takes nothing returns nothing
    set gg_trg_Castle_Anti_Magic = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Castle_Anti_Magic, gg_unit_e00O_0325, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Castle_Anti_Magic, gg_unit_e00D_0301, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Castle_Anti_Magic, gg_unit_e00P_0444, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Castle_Anti_Magic, gg_unit_e00V_0577, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Castle_Anti_Magic, function Trig_Castle_Anti_MagicActions)
endfunction
//===========================================================================
// Trigger: Walk around Initi
//===========================================================================
function Trig_Walk_around_InitiActions takes nothing returns nothing
    // ---------------------------------
    call SetUnitUserData( gg_unit_h01P_0633, 51 )
    call TriggerRegisterUnitEvent(gg_trg_Die_Basic_Guards, gg_unit_h01P_0633, EVENT_UNIT_DEATH)
    // ---------------------------------
    call SetUnitUserData( gg_unit_h01O_0634, 61 )
    call TriggerRegisterUnitEvent(gg_trg_Die_Basic_Guards, gg_unit_h01O_0634, EVENT_UNIT_DEATH)
    // ---------------------------------
    call IssuePointOrderById( gg_unit_h01P_0633, 851983, udg_X[51], udg_Y[51] )
    call IssuePointOrderById( gg_unit_h01O_0634, 851983, udg_X[61], udg_Y[61] )
    // ---------------------------------
    call DisableTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_Walk_around_Initi takes nothing returns nothing
    set gg_trg_Walk_around_Initi = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_Walk_around_Initi, 0.00 )
    call TriggerAddAction(gg_trg_Walk_around_Initi, function Trig_Walk_around_InitiActions)
endfunction
//===========================================================================
// Trigger: Walk around
//
// 61 52 53 54 55
// 52  53  54  55 51      攻擊
//===========================================================================
function Trig_Walk_aroundActions takes nothing returns nothing
local unit u = GetTriggerUnit()
local integer data 
	if u == gg_unit_h01O_0634 or u == gg_unit_h01P_0633 then
		call SetUnitUserData( u, GetUnitUserData(u) + 1 )
		set data = GetUnitUserData(u)
		    if data == 55 then
		        call SetUnitUserData( u, 51 )
		        set data = 51
		    else
		        if data == 65 then
					call SetUnitUserData( u, 61 )
		        	set data = 61
		        endif
		    endif 
		call IssuePointOrderById( u, 851983, udg_X[data], udg_Y[data] )
	endif
		    
set u = null 
endfunction
//===========================================================================
function InitTrig_Walk_around takes nothing returns nothing
    set gg_trg_Walk_around = CreateTrigger()
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_A1 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_A2 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_A3 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_A4 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_B1 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_B2 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_B3 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Walk_around, gg_rct_FU_Walk_Around_B4 )
    call TriggerAddCondition(gg_trg_Walk_around, Condition(function Trig_Walk_aroundActions))
endfunction//===========================================================================
// Trigger: Army Turn MO/OB
//===========================================================================
function Trig_Army_Turn_MO_OBActions takes nothing returns nothing
    if ((GetOwningPlayer(GetTriggerUnit()) == udg_X_PlayerA[0])) then
        call IssuePointOrder( GetTriggerUnit(), "attack", udg_X[8], udg_Y[8] )
        call SetUnitUserData( GetTriggerUnit(), 8 )
    else
        if ((GetOwningPlayer(GetTriggerUnit()) == udg_X_PlayerB[0])) then
            call IssuePointOrder( GetTriggerUnit(), "attack", udg_X[7], udg_Y[7] )
            call SetUnitUserData( GetTriggerUnit(), 7 )
        else
        endif
    endif
endfunction
//===========================================================================
function InitTrig_Army_Turn_MO_OB takes nothing returns nothing
    set gg_trg_Army_Turn_MO_OB = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Turn_MO_OB)
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Army_Turn_MO_OB, gg_rct_A_DOWN_Turn2 )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Army_Turn_MO_OB, gg_rct_A_Middle_Turn )
    call YDWETriggerRegisterEnterRectSimpleNull( gg_trg_Army_Turn_MO_OB, gg_rct_A_UP_Turn )
    call TriggerAddAction(gg_trg_Army_Turn_MO_OB, function Trig_Army_Turn_MO_OBActions)
endfunction
//===========================================================================
// Trigger: Army Turn Normal
//===========================================================================
function Trig_Army_Turn_NormalActions takes nothing returns nothing
local unit u=GetTriggerUnit()	
    if ((GetOwningPlayer(u) == udg_X_PlayerA[0])) then
        call IssuePointOrder( u, "attack", udg_X[8], udg_Y[8] )
    else
        if ((GetOwningPlayer(u) == udg_X_PlayerB[0])) then
            call IssuePointOrder( u, "attack", udg_X[7], udg_Y[7] )
        endif
    endif
set u = null 
endfunction
//===========================================================================
function InitTrig_Army_Turn_Normal takes nothing returns nothing
local region r=CreateRegion()	
    set gg_trg_Army_Turn_Normal = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Turn_Normal)
    
	call RegionAddRect(r,gg_rct_A_DOWN_Turn2)
	call RegionAddRect(r,gg_rct_A_Middle_Turn)
	call RegionAddRect(r,gg_rct_A_UP_Turn)
	call TriggerRegisterEnterRegion(gg_trg_Army_Turn_Normal,r,null)
	call TriggerAddCondition(gg_trg_Army_Turn_Normal, Condition(function Trig_Army_Turn_NormalActions))
	set r=null 
endfunction
//===========================================================================
// Trigger: Army Born 01
//
// 9 10 114 5 6
//===========================================================================
function Trig_Army_Born_01Actions takes nothing returns nothing
local integer i 
local integer iEnd
local integer iB
local integer iBEnd	
local unit u3
    set i = 1
    //--隨著時間，出兵數量增加
    //--S20應該是足輕
    set iEnd = ( 3 + udg_S20_Number ) 
    loop
        exitwhen i > iEnd
        //--這邊是用來創造三路兵 - 織田軍出兵
        set iB = 1
        set iBEnd = 3
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerA[0], 'hfoo', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById( u3, 851983, udg_X[( iB + 8 )], udg_Y[( iB + 8 )] )
            set iB = iB + 1
        endloop
        //--這邊是用來創造三路兵 - 聯合軍出兵
        set iB = 4
        set iBEnd = 6
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerB[0], 'hfoo', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById(u3, 851983, udg_X[( iB + 5 )], udg_Y[( iB + 5 )] )
            set iB = iB + 1
        endloop
        set i = i + 1
    endloop
 
    set i = 1
    
    //--隨著時間，出兵數量增加
    //--S02弓箭手     
    set iEnd = ( 2 + udg_S02_Number ) 
    loop
        exitwhen i > iEnd
        set iB = 1
        set iBEnd = 3
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerA[0], 'hmtm', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById( u3, 851983, udg_X[( iB + 8 )], udg_Y[( iB + 8 )] )
            set iB = iB + 1
        endloop
        set iB = 4
        set iBEnd = 6
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerB[0], 'hmtm', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById( u3, 851983, udg_X[( iB + 5 )], udg_Y[( iB + 5 )] )
            set iB = iB + 1
        endloop
        set i = i + 1
    endloop
set u3 = null 
endfunction
//===========================================================================
function InitTrig_Army_Born_01 takes nothing returns nothing
    set gg_trg_Army_Born_01 = CreateTrigger()
    //--初始化關閉觸發器，OB系統才會開啟
    call DisableTrigger(gg_trg_Army_Born_01)
    //--要特別設定，這樣50秒開啟觸發，才會啟動。
    call TriggerRegisterTimerEvent(gg_trg_Army_Born_01, 26.00, true)
    call TriggerAddCondition(gg_trg_Army_Born_01, Condition(function Trig_Army_Born_01Actions))
endfunction
//===========================================================================
// Trigger: Army Born 02
//===========================================================================
function Trig_Army_Born_02Actions takes nothing returns nothing
local integer i 
local integer iEnd
local unit u3	
    set i = 1
    set iEnd = 3
    loop
        exitwhen i > iEnd
        set u3 = CreateUnit(udg_X_PlayerA[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] )
        set u3 = CreateUnit(udg_X_PlayerA[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] ) 
        set i = i + 1
    endloop
    set i = 4
    set iEnd = 6
    loop
        exitwhen i > iEnd
        set u3 = CreateUnit(udg_X_PlayerB[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] )
		set u3 = CreateUnit(udg_X_PlayerB[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i]) 
        call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] )
        set i = i + 1
    endloop
set u3 = null 
endfunction
//===========================================================================
function InitTrig_Army_Born_02 takes nothing returns nothing
    set gg_trg_Army_Born_02 = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_02)
	call TriggerRegisterTimerEvent(gg_trg_Army_Born_02, 143.00, true)
    call TriggerAddCondition(gg_trg_Army_Born_02, Condition(function Trig_Army_Born_02Actions))
endfunction//===========================================================================
// Trigger: Army Born 03
//===========================================================================
function Trig_Army_Born_03Actions takes nothing returns nothing
local integer i 
local integer iEnd
local unit u3	
    set i = 1
    set iEnd = 3
    loop
        exitwhen i > iEnd
        set u3 = CreateUnit(udg_X_PlayerA[0], 'hkni', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] )
	        if ((udg_S20_horse_soilfer_num[i] == 1)) then
		        set u3 = CreateUnit(udg_X_PlayerA[0], 'h01S', udg_X[i], udg_Y[i], udg_Angel[i])
	            call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] ) 
	        endif
        set i = i + 1
    endloop
    set i = 4
    set iEnd = 6
    loop
        exitwhen i > iEnd
		set u3 = CreateUnit(udg_X_PlayerB[0], 'hkni', udg_X[i], udg_Y[i], udg_Angel[i]) 
        call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] )
	        if ((udg_S20_horse_soilfer_num[i] == 1)) then
		        set u3 = CreateUnit(udg_X_PlayerB[0], 'h01S', udg_X[i], udg_Y[i], udg_Angel[i])
	            call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] ) 
	        endif
        set i = i + 1
    endloop
set u3 = null 
endfunction
//===========================================================================
function InitTrig_Army_Born_03 takes nothing returns nothing
    set gg_trg_Army_Born_03 = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_03)
    call TriggerRegisterTimerEventPeriodic( gg_trg_Army_Born_03, 98.00 )
    call TriggerAddCondition(gg_trg_Army_Born_03, Condition(function Trig_Army_Born_03Actions))
endfunction
//===========================================================================
// Trigger: Army Born 01 OB
//
// 11 12 13
// 9 10 11
// 21 22 23
// 6 7 8
// 4 5 6
//===========================================================================
function Trig_Army_Born_01_OBActions takes nothing returns nothing
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = ( 3 + udg_S20_Number )
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set bj_forLoopBIndex = 9
        set bj_forLoopBIndexEnd = 11
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            call CreateNUnitsAtLoc( 1, 'hfoo', udg_X_PlayerA[0], udg_S20_Point[( bj_forLoopBIndex - 8 )], udg_Angel[( bj_forLoopBIndex - 8 )] )
            call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
            call SetUnitUserData( GetLastCreatedUnit(), bj_forLoopBIndex )
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
        set bj_forLoopBIndex = 9
        set bj_forLoopBIndexEnd = 11
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            call CreateNUnitsAtLoc( 1, 'hfoo', udg_X_PlayerB[0], udg_S20_Point[( bj_forLoopBIndex - 5 )], udg_Angel[( bj_forLoopBIndex - 5 )] )
            call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
            call SetUnitUserData( GetLastCreatedUnit(), GetForLoopIndexB() )
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = ( 2 + udg_S02_Number )
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set bj_forLoopBIndex = 9
        set bj_forLoopBIndexEnd = 11
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            call CreateNUnitsAtLoc( 1, 'hmtm', udg_X_PlayerA[0], udg_S20_Point[( bj_forLoopBIndex - 8 )], udg_Angel[( bj_forLoopBIndex - 8 )] )
            call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
            call SetUnitUserData( GetLastCreatedUnit(), bj_forLoopBIndex )
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
        set bj_forLoopBIndex = 9
        set bj_forLoopBIndexEnd = 11
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            call CreateNUnitsAtLoc( 1, 'hmtm', udg_X_PlayerB[0], udg_S20_Point[( bj_forLoopBIndex - 5 )], udg_Angel[( bj_forLoopBIndex - 5 )] )
            call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
            call SetUnitUserData( GetLastCreatedUnit(), GetForLoopIndexB() )
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
endfunction
//===========================================================================
function InitTrig_Army_Born_01_OB takes nothing returns nothing
    set gg_trg_Army_Born_01_OB = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_01_OB)
    call TriggerRegisterTimerEventPeriodic( gg_trg_Army_Born_01_OB, 26.00 )
    call TriggerAddAction(gg_trg_Army_Born_01_OB, function Trig_Army_Born_01_OBActions)
endfunction
//===========================================================================
// Trigger: Army Born 02  OB
//===========================================================================
function Trig_Army_Born_02__OBActions takes nothing returns nothing
    set bj_forLoopBIndex = 9
    set bj_forLoopBIndexEnd = 11
    loop
        exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
        call CreateNUnitsAtLoc( 1, 'ospw', udg_X_PlayerA[0], udg_S20_Point[( bj_forLoopBIndex - 8 )], udg_Angel[( bj_forLoopBIndex - 8 )] )
        call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
        call SetUnitUserData( GetLastCreatedUnit(), bj_forLoopBIndex )
        call CreateNUnitsAtLoc( 1, 'ospw', udg_X_PlayerA[0], udg_S20_Point[( bj_forLoopBIndex - 8 )], udg_Angel[( bj_forLoopBIndex - 8 )] )
        call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
        call SetUnitUserData( GetLastCreatedUnit(), bj_forLoopBIndex )
        set bj_forLoopBIndex = bj_forLoopBIndex + 1
    endloop
    set bj_forLoopBIndex = 9
    set bj_forLoopBIndexEnd = 11
    loop
        exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
        call CreateNUnitsAtLoc( 1, 'ospw', udg_X_PlayerB[0], udg_S20_Point[( bj_forLoopBIndex - 5 )], udg_Angel[( bj_forLoopBIndex - 5 )] )
        call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
        call SetUnitUserData( GetLastCreatedUnit(), GetForLoopIndexB() )
        call CreateNUnitsAtLoc( 1, 'ospw', udg_X_PlayerB[0], udg_S20_Point[( bj_forLoopBIndex - 5 )], udg_Angel[( bj_forLoopBIndex - 5 )] )
        call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
        call SetUnitUserData( GetLastCreatedUnit(), GetForLoopIndexB() )
        set bj_forLoopBIndex = bj_forLoopBIndex + 1
    endloop
endfunction
//===========================================================================
function InitTrig_Army_Born_02__OB takes nothing returns nothing
    set gg_trg_Army_Born_02__OB = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_02__OB)
    call TriggerRegisterTimerEventPeriodic( gg_trg_Army_Born_02__OB, 143.00 )
    call TriggerAddAction(gg_trg_Army_Born_02__OB, function Trig_Army_Born_02__OBActions)
endfunction
//===========================================================================
// Trigger: Army Born 03  OB
//===========================================================================
function Trig_Army_Born_03__OBActions takes nothing returns nothing
    set bj_forLoopBIndex = 9
    set bj_forLoopBIndexEnd = 11
    loop
        exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
        call CreateNUnitsAtLoc( 1, 'hkni', udg_X_PlayerA[0], udg_S20_Point[( bj_forLoopBIndex - 8 )], udg_Angel[( bj_forLoopBIndex - 8 )] )
        call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
        call SetUnitUserData( GetLastCreatedUnit(), bj_forLoopBIndex )
        if ((udg_S20_horse_soilfer_num[GetForLoopIndexB()] == 1)) then
            call CreateNUnitsAtLoc( 1, 'h01S', udg_X_PlayerA[0], udg_S20_Point[( bj_forLoopBIndex - 8 )], udg_Angel[( bj_forLoopBIndex - 8 )] )
            call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
            call SetUnitUserData( GetLastCreatedUnit(), bj_forLoopBIndex )
        else
        endif
        set bj_forLoopBIndex = bj_forLoopBIndex + 1
    endloop
    set bj_forLoopBIndex = 9
    set bj_forLoopBIndexEnd = 11
    loop
        exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
        call CreateNUnitsAtLoc( 1, 'hkni', udg_X_PlayerB[0], udg_S20_Point[( bj_forLoopBIndex - 5 )], udg_Angel[( bj_forLoopBIndex - 5 )] )
        call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
        call SetUnitUserData( GetLastCreatedUnit(), GetForLoopIndexB() )
        if ((udg_S20_horse_soilfer_num[GetForLoopIndexB()] == 1)) then
            call CreateNUnitsAtLoc( 1, 'h01S', udg_X_PlayerB[0], udg_S20_Point[( bj_forLoopBIndex - 5 )], udg_Angel[( bj_forLoopBIndex - 5 )] )
            call IssuePointOrderById( GetLastCreatedUnit(), 851983, udg_X[bj_forLoopBIndex], udg_Y[bj_forLoopBIndex] )
            call SetUnitUserData( GetLastCreatedUnit(), GetForLoopIndexB() )
        else
        endif
        set bj_forLoopBIndex = bj_forLoopBIndex + 1
    endloop
endfunction
//===========================================================================
function InitTrig_Army_Born_03__OB takes nothing returns nothing
    set gg_trg_Army_Born_03__OB = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_03__OB)
    call TriggerRegisterTimerEventPeriodic( gg_trg_Army_Born_03__OB, 95.00 )
    call TriggerAddAction(gg_trg_Army_Born_03__OB, function Trig_Army_Born_03__OBActions)
endfunction
//===========================================================================
// Trigger: Army Born 01 MO
//
// 11 12 13
// 9 10 11
// 21 22 23
// 6 7 8
// 4 5 6
//===========================================================================
function Trig_Army_Born_01_MOConditions takes nothing returns nothing
local integer i 
local integer iEnd
local integer iB
local integer iBEnd	
local unit u3
    set i = 1
    set iEnd = ( 3 + udg_S20_Number )
    loop
        exitwhen i > iEnd
        set iB = 2
        set iBEnd = 2
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerA[0], 'hfoo', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById( u3, 851983, udg_X[( iB + 8 )], udg_Y[( iB + 8 )] )
            set iB = iB + 1
        endloop
        set iB = 5
        set iBEnd = 5
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerB[0], 'hfoo', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById(u3, 851983, udg_X[( iB + 5 )], udg_Y[( iB + 5 )] )
            set iB = iB + 1
        endloop
        set i = i + 1
    endloop
    set i = 1
    set iEnd = ( 2 + udg_S02_Number )
    loop
        exitwhen i > iEnd
        set iB = 2
        set iBEnd = 2
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerA[0], 'hmtm', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById( u3, 851983, udg_X[( iB + 8 )], udg_Y[( iB + 8 )] )
            set iB = iB + 1
        endloop
        set iB = 5
        set iBEnd = 5
        loop
            exitwhen iB > iBEnd
            set u3 = CreateUnit(udg_X_PlayerB[0], 'hmtm', udg_X[iB], udg_Y[iB], udg_Angel[iB])
            call IssuePointOrderById( u3, 851983, udg_X[( iB + 5 )], udg_Y[( iB + 5 )] )
            set iB = iB + 1
        endloop
        set i = i + 1
    endloop
set u3 = null 
endfunction
//===========================================================================
function InitTrig_Army_Born_01_MO takes nothing returns nothing
    set gg_trg_Army_Born_01_MO = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_01_MO)
    call TriggerRegisterTimerEventPeriodic( gg_trg_Army_Born_01_MO, 26.00 )
    call TriggerAddCondition(gg_trg_Army_Born_01_MO, Condition(function Trig_Army_Born_01_MOConditions))
endfunction//===========================================================================
// Trigger: Army Born 02  MO
//===========================================================================
function Trig_Army_Born_02__MOConditions takes nothing returns nothing
local integer i 
local integer iEnd
local unit u3	
    set i = 2
    set iEnd = 2
    loop
        exitwhen i > iEnd
        set u3 = CreateUnit(udg_X_PlayerA[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] )
        set u3 = CreateUnit(udg_X_PlayerA[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] ) 
        set i = i + 1
    endloop
    set i = 5
    set iEnd = 5
    loop
        exitwhen i > iEnd
        set u3 = CreateUnit(udg_X_PlayerB[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] )
		set u3 = CreateUnit(udg_X_PlayerB[0], 'ospw', udg_X[i], udg_Y[i], udg_Angel[i]) 
        call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] )
        set i = i + 1
    endloop
set u3 = null 
endfunction
//===========================================================================
function InitTrig_Army_Born_02__MO takes nothing returns nothing
    set gg_trg_Army_Born_02__MO = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_02__MO)
    call TriggerRegisterTimerEventPeriodic( gg_trg_Army_Born_02__MO, 143.00 )
    call TriggerAddCondition(gg_trg_Army_Born_02__MO, Condition(function Trig_Army_Born_02__MOConditions))
endfunction
//===========================================================================
// Trigger: Army Born 03  MO
//===========================================================================
function Trig_Army_Born_03__MOConditions takes nothing returns nothing
local integer i 
local integer iEnd
local unit u3	
    set i = 2
    set iEnd = 2
    loop
        exitwhen i > iEnd
        set u3 = CreateUnit(udg_X_PlayerA[0], 'hkni', udg_X[i], udg_Y[i], udg_Angel[i])
        call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] ) 
	        if ((udg_S20_horse_soilfer_num[i] == 1)) then
		        set u3 = CreateUnit(udg_X_PlayerA[0], 'h01S', udg_X[i], udg_Y[i], udg_Angel[i])
	            call IssuePointOrderById( u3, 851983, udg_X[( i + 8 )], udg_Y[( i + 8 )] ) 
	        endif
        set i = i + 1
    endloop
    set i = 5
    set iEnd = 5
    loop
        exitwhen i > iEnd
		set u3 = CreateUnit(udg_X_PlayerB[0], 'hkni', udg_X[i], udg_Y[i], udg_Angel[i]) 
        call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] ) 
	        if ((udg_S20_horse_soilfer_num[i] == 1)) then
		        set u3 = CreateUnit(udg_X_PlayerB[0], 'h01S', udg_X[i], udg_Y[i], udg_Angel[i])
	            call IssuePointOrderById( u3, 851983, udg_X[( i + 5 )], udg_Y[( i + 5 )] ) 
	        endif
        set i = i + 1
    endloop
set u3 = null 
endfunction
//===========================================================================
function InitTrig_Army_Born_03__MO takes nothing returns nothing
    set gg_trg_Army_Born_03__MO = CreateTrigger()
    call DisableTrigger(gg_trg_Army_Born_03__MO)
    call TriggerRegisterTimerEventPeriodic( gg_trg_Army_Born_03__MO, 95.00 )
    call TriggerAddCondition(gg_trg_Army_Born_03__MO, Condition(function Trig_Army_Born_03__MOConditions))
endfunction
//===========================================================================
// Trigger: Army
//===========================================================================
function Trig_ArmyActions takes nothing returns nothing
    if ((GetTriggerUnit() == gg_unit_nten_0393)) then
        set udg_S20_horse_soilfer_num[1] = 1
    else
    endif
    if ((GetTriggerUnit() == gg_unit_nten_0389)) then
        set udg_S20_horse_soilfer_num[2] = 1
    else
    endif
    if ((GetTriggerUnit() == gg_unit_nten_0388)) then
        set udg_S20_horse_soilfer_num[3] = 1
    else
    endif
    if ((GetTriggerUnit() == gg_unit_nten_0012)) then
        set udg_S20_horse_soilfer_num[4] = 1
    else
    endif
    if ((GetTriggerUnit() == gg_unit_nten_0011)) then
        set udg_S20_horse_soilfer_num[5] = 1
    else
    endif
    if ((GetTriggerUnit() == gg_unit_nten_0010)) then
        set udg_S20_horse_soilfer_num[6] = 1
    else
    endif
endfunction
//===========================================================================
function InitTrig_Army takes nothing returns nothing
    set gg_trg_Army = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Army, gg_unit_nten_0393, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Army, gg_unit_nten_0389, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Army, gg_unit_nten_0388, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Army, gg_unit_nten_0012, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Army, gg_unit_nten_0011, EVENT_UNIT_DEATH )
    call TriggerRegisterUnitEvent( gg_trg_Army, gg_unit_nten_0010, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Army, function Trig_ArmyActions)
endfunction
//===========================================================================
// Trigger: Upgrades_01
//===========================================================================
function Trig_Upgrades_01_Actions takes nothing returns nothing
	if GetPlayerTechCount(Player(12), 'R006', true) <= 14 then
		call SetPlayerTechResearched(Player(12), 'R006', GetPlayerTechCount(Player(12), 'R006', true) + 1 )
	endif
endfunction
function InitTrig_Upgrades_01 takes nothing returns nothing
set gg_trg_Upgrades_01=CreateTrigger()
call TriggerRegisterTimerEvent(gg_trg_Upgrades_01,180.00, true)
call TriggerAddAction(gg_trg_Upgrades_01,function Trig_Upgrades_01_Actions)
endfunction//===========================================================================
// Trigger: Upgrades_02
//===========================================================================
function Trig_Upgrades_02_Actions takes nothing returns nothing
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cff00ff00兩軍引進南蠻建築技術, 使建築物更加堅固.|r")
call SetPlayerTechResearchedSwap(0x52687269,1,udg_X_PlayerA[0])
call SetPlayerTechResearchedSwap(0x52687269,1,udg_X_PlayerB[0])
call YDWEPolledWaitNull(1000.00)
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cff00ff00兩軍引進南蠻建築技術, 使建築物更加堅固.|r")
call SetPlayerTechResearchedSwap(0x52687269,2,udg_X_PlayerA[0])
call SetPlayerTechResearchedSwap(0x52687269,2,udg_X_PlayerB[0])
call YDWEPolledWaitNull(1200.00)
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cff00ff00兩軍引進南蠻建築技術, 使建築物更加堅固.|r")
call SetPlayerTechResearchedSwap(0x52687269,3,udg_X_PlayerA[0])
call SetPlayerTechResearchedSwap(0x52687269,3,udg_X_PlayerB[0])
call YDWEPolledWaitNull(1400.00)
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cff00ff00兩軍引進南蠻建築技術, 使建築物更加堅固.|r")
call SetPlayerTechResearchedSwap(0x52687269,4,udg_X_PlayerA[0])
call SetPlayerTechResearchedSwap(0x52687269,4,udg_X_PlayerB[0])
call DestroyTrigger(GetTriggeringTrigger())
endfunction
function InitTrig_Upgrades_02 takes nothing returns nothing
set gg_trg_Upgrades_02=CreateTrigger()
call TriggerRegisterTimerEventSingle(gg_trg_Upgrades_02,800.00)
call TriggerAddAction(gg_trg_Upgrades_02,function Trig_Upgrades_02_Actions)
endfunction
//===========================================================================
// Trigger: Upgrades_03
//===========================================================================
function Trig_Upgrades_03_Actions takes nothing returns nothing
	if(GetPlayerTechCountSimple('Rhan',udg_X_PlayerA[0])<20)then
		call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cff00ff00兩軍士兵已經完成訓練, 戰力更加的卓越.|r")	
		call SetPlayerTechResearchedSwap('Rhan',(GetPlayerTechCountSimple('Rhan',udg_X_PlayerA[0])+1),udg_X_PlayerA[0])
		call SetPlayerTechResearchedSwap('Rhan',(GetPlayerTechCountSimple('Rhan',udg_X_PlayerB[0])+1),udg_X_PlayerB[0])
			if(ModuloInteger(GetPlayerTechCountSimple('Rhan',udg_X_PlayerA[0]),7)==0)then
				set udg_S20_Number=(udg_S20_Number+1)
			endif
			if(ModuloInteger(GetPlayerTechCountSimple('Rhan',udg_X_PlayerA[0]),8)==0)then
					set udg_S02_Number=(udg_S02_Number+1)
			endif
	endif
endfunction
function InitTrig_Upgrades_03 takes nothing returns nothing
set gg_trg_Upgrades_03=CreateTrigger()
call TriggerRegisterTimerEventPeriodic(gg_trg_Upgrades_03,180.00)
call TriggerAddAction(gg_trg_Upgrades_03,function Trig_Upgrades_03_Actions)
endfunction//===========================================================================
// Trigger: 0S
//===========================================================================
function Trig_0SActions takes nothing returns nothing
    // 遊戲時間設定
    call SetMapFlag( MAP_LOCK_RESOURCE_TRADING, true )
    call LockGameSpeedBJ( )
    call SetTimeOfDay( 6.00 )
    // 一些特效
    call SetSkyModel( "Environment\\Sky\\DalaranSky\\DalaranSky.mdl" )
    call SetUnitAnimation( gg_unit_ngad_0060, "stand work" )
    call SetUnitAnimation( gg_unit_n021_0064, "stand work" )
    call SetUnitAnimation( gg_unit_ngad_0068, "stand work" )
    // ---------------------------------
    // 電影效果
    call DisplayTimedTextToForce( GetPlayersAll(), 13.00, "TRIGSTR_12565" )
    call DisplayTimedTextToForce( GetPlayersAll(), 13.00, "TRIGSTR_1333" )
    call DisplayTimedTextToForce( GetPlayersAll(), 13.00, "TRIGSTR_1333" )
    call DisplayTimedTextToForce( GetPlayersAll(), 13.00, "TRIGSTR_1333" )
        call CinematicFadeBJ( bj_CINEFADETYPE_FADEOUT, 0.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0 )
    call ShowInterfaceForceOff( GetPlayersAll(), 0.00 )
    call YDWEPolledWaitNull(2.30)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN,2.00,"ReplaceableTextures\\CameraMasks\\Black_mask.blp",0,0,0,0)
    call ShowInterfaceForceOn(GetPlayersAll(),2.00)
endfunction
//===========================================================================
function InitTrig_0S takes nothing returns nothing
    set gg_trg_0S = CreateTrigger()
    call TriggerAddAction(gg_trg_0S, function Trig_0SActions)
endfunction
//===========================================================================
// Trigger: 5S
//
// 
// --提高观察高度
// ++
//===========================================================================
function Trig_5SActions takes nothing returns nothing
    // ---------------------------------
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_5884" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_1333" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_6813" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_7142" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_7172" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_7240" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_1060" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_1333" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_7846" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_8116" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_8122" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_1333" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_8359" )
    call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_8567" )
    // ---------------------------------
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_Computer_Unit_Dead, udg_X_PlayerA[0], EVENT_PLAYER_UNIT_DEATH)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_Computer_Unit_Dead, udg_X_PlayerB[0], EVENT_PLAYER_UNIT_DEATH)
    // ---------------------------------
    call PlaySoundBJ( gg_snd_firstblood )
    call StopSoundBJ( GetLastPlayedSound(), false )
    call PlaySoundBJ( gg_snd_double_kill )
    call StopSoundBJ( GetLastPlayedSound(), false )
    call PlaySoundBJ( gg_snd_triple_kill )
    call StopSoundBJ( GetLastPlayedSound(), false )
    call PlaySoundBJ( gg_snd_ownage )
    call StopSoundBJ( GetLastPlayedSound(), false )
    call PlaySoundBJ( gg_snd_ultrakill )
    call StopSoundBJ( GetLastPlayedSound(), false )
    // ---------------------------------
    call DestroyTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_5S takes nothing returns nothing
    set gg_trg_5S = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_5S, 5.00 )
    call TriggerAddAction(gg_trg_5S, function Trig_5SActions)
endfunction
//===========================================================================
// Trigger: 15S
//===========================================================================
function Trig_15SActions takes nothing returns nothing
    call DisplayTimedTextToForce( GetPlayersAll(), 15.00, "TRIGSTR_12675" )
    // ---------------------------------
    call PingMinimapLocForForce( GetPlayersAll(), GetUnitLoc(gg_unit_n01L_0362), 8.00 )
    call PingMinimapLocForForce( GetPlayersAll(), GetUnitLoc(gg_unit_n01N_0589), 8.00 )
    call PingMinimapLocForForce( GetPlayersAll(), GetUnitLoc(gg_unit_n01I_0583), 8.00 )
    // ---------------------------------
    // ---------------------------------
    call EnableTrigger( gg_trg_Random_Hero )
    // ---------------------------------
    call DisableTrigger( gg_trg_AH_Mode )
    call DisableTrigger( gg_trg_CRAZY )
    call DisableTrigger( gg_trg_MO )
    call DisableTrigger( gg_trg_SM )
    call DisableTrigger( gg_trg_HIGH )
    call DisableTrigger( gg_trg_CRAZY )
    // ---------------------------------
    call DestroyTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_15S takes nothing returns nothing
    set gg_trg_15S = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_15S, 15.00 )
    call TriggerAddAction(gg_trg_15S, function Trig_15SActions)
endfunction
//===========================================================================
// Trigger: 50S
//===========================================================================
function Trig_50SActions takes nothing returns nothing
    call DisplayTextToForce( GetPlayersAll(), ( "|cff99ccff" + ( "甲斐的武田、 越後的上杉、 西國的毛利響應足利義昭的號召 , 與尾張的織田, 三河的德川開始作戰 !" + "|r" ) ) )
    if ((udg_X_Observer == true)) then
        call EnableTrigger( gg_trg_Army_Born_01_OB )
        call EnableTrigger( gg_trg_Army_Born_02__OB )
        call EnableTrigger( gg_trg_Army_Born_03__OB )
        call EnableTrigger( gg_trg_Army_Turn_MO_OB )
    else
        if ((udg_MO_B == true)) then
            call EnableTrigger( gg_trg_Army_Born_01_MO )
            call EnableTrigger( gg_trg_Army_Born_02__MO )
            call EnableTrigger( gg_trg_Army_Born_03__MO )
            call EnableTrigger( gg_trg_Army_Turn_Normal )
        else
            call EnableTrigger( gg_trg_Army_Born_01 )
            call EnableTrigger( gg_trg_Army_Born_02 )
            call EnableTrigger( gg_trg_Army_Born_03 )
            call EnableTrigger( gg_trg_Army_Turn_Normal )
        endif
    endif
    // ---------------------------------
    call DestroyTrigger(GetTriggeringTrigger())
endfunction
//===========================================================================
function InitTrig_50S takes nothing returns nothing
    set gg_trg_50S = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_50S, 50.00 )
    call TriggerAddAction(gg_trg_50S, function Trig_50SActions)
endfunction
//===========================================================================
// Trigger: 1200S
//===========================================================================
function Trig_1200SActions takes nothing returns nothing
    call EnableTrigger( gg_trg_Surrender_vote_for_B )
    call EnableTrigger( gg_trg_Surrender_vote_for_A )
    call DestroyTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_1200S takes nothing returns nothing
    set gg_trg_1200S = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_1200S, 1200.00 )
    call TriggerAddAction(gg_trg_1200S, function Trig_1200SActions)
endfunction
//===========================================================================
// Trigger: CP revival init
//===========================================================================
globals
real array CP_X
real array CP_Y
integer CP_I=0
endglobals 
function Trig_CP_revival_initFunc001002002 takes nothing returns boolean
    return (((GetFilterUnit() != gg_unit_nsko_0178) and (GetFilterUnit() != gg_unit_nbld_0142)))
endfunction
function Trig_CP_revival_initFunc003A takes nothing returns nothing
local unit u1 = GetEnumUnit()
call SetUnitUserData(u1,CP_I)
set CP_X[CP_I]=GetUnitX(u1)
set CP_Y[CP_I]=GetUnitY(u1)
set CP_I=CP_I+1
set u1 = null
endfunction
function Trig_CP_revival_initActions takes nothing returns nothing
set CP_I=150	
set udg_CP_group = YDWEGetUnitsOfPlayerMatchingNull(Player(PLAYER_NEUTRAL_AGGRESSIVE), Condition(function Trig_CP_revival_initFunc001002002))
call ForGroup(udg_CP_group,function Trig_CP_revival_initFunc003A)
call DestroyGroup(udg_CP_group)
call DestroyTrigger(GetTriggeringTrigger())
endfunction
//===========================================================================
function InitTrig_CP_revival_init takes nothing returns nothing
    set gg_trg_CP_revival_init = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_CP_revival_init, 0.00 )
    call TriggerAddAction(gg_trg_CP_revival_init, function Trig_CP_revival_initActions)
endfunction
//===========================================================================
// Trigger: CP revival start
//===========================================================================
function Trig_Creeps_Revive_Conditions takes nothing returns boolean
    return ( IsUnitIllusion(GetTriggerUnit()) != true and GetUnitUserData(GetTriggerUnit()) != 0 )
endfunction
function Trig_CP_revival_startActions takes nothing returns nothing
local unit u = GetTriggerUnit()	
local integer unitcode=GetUnitTypeId(u)
local integer i=GetUnitUserData(u)
			if unitcode == 'nbrg' or unitcode =='nass' or unitcode =='nrog' or unitcode =='nenf' then
				call YDWEPolledWaitNull(160.00) 
			else
				call YDWEPolledWaitNull(130.00)
			endif 
		call SetUnitUserData(CreateUnit(Player(12),unitcode,CP_X[i],CP_Y[i],GetRandomReal(0,360)),i)
set u = null
endfunction
//===========================================================================
function InitTrig_CP_revival_start takes nothing returns nothing
    set gg_trg_CP_revival_start = CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_CP_revival_start, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_DEATH )
    call TriggerAddCondition( gg_trg_CP_revival_start, Condition( function Trig_Creeps_Revive_Conditions ) )
    call TriggerAddAction(gg_trg_CP_revival_start, function Trig_CP_revival_startActions)
endfunction
//===========================================================================
// Trigger: Boss die
//===========================================================================
function Trig_Boss_dieActions takes nothing returns nothing
    call PlaySoundBJ( gg_snd_NecropolisUpgrade2 )
    call KillSoundWhenDone( GetLastPlayedSound() )
    call DisplayTextToForce( GetPlayersAll(), ( "|cffffcc99" + ( "受詛咒的武士亡靈已經被淨化完畢.." + "|r" ) ) )
    call DestroyTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_Boss_die takes nothing returns nothing
    set gg_trg_Boss_die = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_Boss_die, gg_unit_nsko_0178, EVENT_UNIT_DEATH )
    call TriggerAddAction(gg_trg_Boss_die, function Trig_Boss_dieActions)
endfunction
//===========================================================================
// Trigger: Boss Walk
//===========================================================================
function Trig_Boss_WalkConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetTriggerUnit()) == GetUnitTypeId(gg_unit_nsko_0178)))
endfunction
function Trig_Boss_WalkActions takes nothing returns nothing
    set udg_A_Common_temp1 = GetRectCenter(gg_rct_____________u)
    // ---------------------------------
    call SetUnitPositionLoc( GetTriggerUnit(), udg_A_Common_temp1 )
    // ---------------------------------
    call SetUnitLifePercentBJ( GetTriggerUnit(), 100 )
    // ---------------------------------
    call RemoveLocation( udg_A_Common_temp1 )
endfunction
//===========================================================================
function InitTrig_Boss_Walk takes nothing returns nothing
    set gg_trg_Boss_Walk = CreateTrigger()
    call YDWETriggerRegisterLeaveRectSimpleNull( gg_trg_Boss_Walk, gg_rct________________u )
    call TriggerAddCondition(gg_trg_Boss_Walk, Condition(function Trig_Boss_WalkConditions))
    call TriggerAddAction(gg_trg_Boss_Walk, function Trig_Boss_WalkActions)
endfunction
//===========================================================================
// Trigger: Commotion A
//===========================================================================
globals
timer udg_CommotionA_timer = CreateTimer()
endglobals	
function Trig_Commotion_A_Func003Func001Func002Func002001002 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true)
endfunction
function Trig_Commotion_A_Func003Func001Func002Func002A takes nothing returns nothing
call CreateTextTagUnitBJ(("+300"),GetTriggerUnit(),0,10.00,100.00,85.00,0.00,0)
call ShowTextTagForceBJ(false,GetLastCreatedTextTag(),YDWEGetPlayersEnemiesNull(GetOwningPlayer(GetKillingUnitBJ())))
call SetTextTagPermanent(GetLastCreatedTextTag(),false)
call SetTextTagVelocityBJ(GetLastCreatedTextTag(),60.00,90)
call SetTextTagLifespan(GetLastCreatedTextTag(),3.00)
call SetTextTagFadepoint(GetLastCreatedTextTag(),2.20)
endfunction
function Trig_Commotion_A_Func003Func001Func002A takes nothing returns nothing
call AdjustPlayerStateBJ(300,GetEnumPlayer(),PLAYER_STATE_RESOURCE_GOLD)
call ForGroupBJ(YDWEGetUnitsOfPlayerMatchingNull(GetEnumPlayer(),Condition(function Trig_Commotion_A_Func003Func001Func002Func002001002)),function Trig_Commotion_A_Func003Func001Func002Func002A)
endfunction
function Trig_Commotion_A_Func003Func001Func004Func002001002 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true)
endfunction
function Trig_Commotion_A_Func003Func001Func004Func002A takes nothing returns nothing
call CreateTextTagUnitBJ(("+300"),GetTriggerUnit(),0,10.00,100.00,85.00,0.00,0)
call ShowTextTagForceBJ(false,GetLastCreatedTextTag(),YDWEGetPlayersEnemiesNull(GetOwningPlayer(GetKillingUnitBJ())))
call SetTextTagPermanent(GetLastCreatedTextTag(),false)
call SetTextTagVelocityBJ(GetLastCreatedTextTag(),60.00,90)
call SetTextTagLifespan(GetLastCreatedTextTag(),3.00)
call SetTextTagFadepoint(GetLastCreatedTextTag(),2.20)
endfunction
function Trig_Commotion_A_Func003Func001Func004A takes nothing returns nothing
call AdjustPlayerStateBJ(300,GetEnumPlayer(),PLAYER_STATE_RESOURCE_GOLD)
call ForGroupBJ(YDWEGetUnitsOfPlayerMatchingNull(GetEnumPlayer(),Condition(function Trig_Commotion_A_Func003Func001Func004Func002001002)),function Trig_Commotion_A_Func003Func001Func004Func002A)
endfunction
function Trig_Commotion_A_Func003Func001C takes nothing returns boolean
if(not(IsUnitAlly(GetKillingUnitBJ(),udg_X_PlayerA[0])==true))then
return false
endif
return true
endfunction
function Trig_Commotion_A_Actions takes nothing returns nothing
call StartTimerBJ(udg_CommotionA_timer,true,270.00)
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cFF00EE00強盜之王：...就算...你擊敗了我..但是我其他部落的..弟兄..將會替我報仇的...|r")
	if(Trig_Commotion_A_Func003Func001C())then
			if udg_CRAZY_B then
				call DisplayTextToForce(GetPlayersAll(),(("|cFFFFCC00"+(GetPlayerName(GetOwningPlayer(GetKillingUnit()))+"|r"))+"擊殺了強盜之王！有部份的強盜獻出了黃金，歸順到織田軍旗下！"))
			else	
				call DisplayTextToForce(GetPlayersAll(),(("|cFFFFCC00"+(GetUnitName(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetKillingUnit()))])+"|r"))+"擊殺了強盜之王！有部份的強盜獻出了黃金，歸順到織田軍旗下！"))
			endif	
		call ForForce(YDWEGetPlayersAlliesNull(udg_X_PlayerA[0]),function Trig_Commotion_A_Func003Func001Func004A)
	else
			if udg_CRAZY_B then
				call DisplayTextToForce(GetPlayersAll(),(("|cFFFFCC00"+(GetPlayerName(GetOwningPlayer(GetKillingUnit()))+"|r"))+"擊殺了強盜之王並瓜分了黃金！有部份的強盜獻出了黃金，歸順到聯合軍旗下！"))
			else	
				call DisplayTextToForce(GetPlayersAll(),(("|cFFFFCC00"+(GetUnitName(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetKillingUnit()))])+"|r"))+"擊殺了強盜之王並瓜分了黃金！有部份的強盜獻出了黃金，歸順到聯合軍旗下！"))
				call ForForce(YDWEGetPlayersAlliesNull(udg_X_PlayerB[0]),function Trig_Commotion_A_Func003Func001Func002A)
			endif
		call ForForce(YDWEGetPlayersAlliesNull(udg_X_PlayerB[0]),function Trig_Commotion_A_Func003Func001Func002A)
	endif
endfunction
function InitTrig_Commotion_A takes nothing returns nothing
set gg_trg_Commotion_A=CreateTrigger()
call TriggerRegisterUnitEvent(gg_trg_Commotion_A,gg_unit_nbld_0142,EVENT_UNIT_DEATH)
call TriggerAddAction(gg_trg_Commotion_A,function Trig_Commotion_A_Actions)
endfunction//===========================================================================
// Trigger: Commotion_A_spawn
//===========================================================================
function Trig_Commotion_A_spawn_Actions takes nothing returns nothing
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cFFEE9944注意!!強盜各部落已經集結了大軍，似乎打算趁兩軍交戰之際大肆作亂...|r")
set bj_forLoopBIndex=1
set bj_forLoopBIndexEnd=GetRandomInt(7,12)
loop
	exitwhen bj_forLoopBIndex>bj_forLoopBIndexEnd
	call CreateNUnitsAtLoc(1,'ntws',Player(12),udg_S20_Point[10],bj_UNIT_FACING)
	call IssuePointOrderLoc(GetLastCreatedUnit(),"attack",udg_S20_Point[GetRandomInt(7,8)])
	set bj_forLoopBIndex=bj_forLoopBIndex+1
endloop
endfunction
function InitTrig_Commotion_A_spawn takes nothing returns nothing
set gg_trg_Commotion_A_spawn=CreateTrigger()
call TriggerRegisterTimerExpireEventBJ(gg_trg_Commotion_A_spawn,udg_CommotionA_timer)
call TriggerAddAction(gg_trg_Commotion_A_spawn,function Trig_Commotion_A_spawn_Actions)
endfunction//===========================================================================
// Trigger: Commotion_B
//===========================================================================
function Trig_Commotion_B_Actions takes nothing returns nothing
local integer i 
set i=GetRandomInt(1,5)
if(i==1)then
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cBBEE9944國人武士企圖奪取實權!!開始暴動!!!!|r")	
set bj_forLoopAIndex=1
set bj_forLoopAIndexEnd=2
loop
exitwhen bj_forLoopAIndex>bj_forLoopAIndexEnd
set i=GetRandomInt(11,13)
call CreateNUnitsAtLoc(7,'nspp',Player(12),udg_X_Point[i],bj_UNIT_FACING)
set bj_forLoopAIndex=bj_forLoopAIndex+1
endloop
return
else
endif
if(i==2)then
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cBBEE9944百姓不滿課稅過量，為求減免年貢，佔領了各地商店!!|r") 
call CreateNUnitsAtLoc((1+GetRandomInt(1,3)),'nlps',Player(12),udg_X_Point[GetRandomInt(40,50)],bj_UNIT_FACING)
endif
if(i==3)then
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cBBEE9944國人與百姓生活和諧，無動亂發生。|r")	
endif
if(i==4)then
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cBBEE9944國人武士企圖奪取實權，已經遭到鎮壓。|r")	
endif
if(i==5)then
call DisplayTextToPlayer(GetLocalPlayer(),0,0,"|cBBEE9944百姓不滿課稅過量，但因人數不足，已遭鎮壓|r")	
endif
endfunction
function InitTrig_Commotion_B takes nothing returns nothing
set gg_trg_Commotion_B=CreateTrigger()
call TriggerRegisterTimerEventPeriodic(gg_trg_Commotion_B,686.00)
call TriggerAddAction(gg_trg_Commotion_B,function Trig_Commotion_B_Actions)
endfunction//===========================================================================
// Trigger: Anti Team Attack
//===========================================================================
//===========================================================================
//	條件 = 命令Attack、非中立、非敵對
//===========================================================================
function ATK takes nothing returns boolean	
		if GetIssuedOrderId() == 851983 and IsUnitAlly(GetOrderTargetUnit(),GetOwningPlayer(GetOrderedUnit())) and GetOwningPlayer(GetOrderTargetUnit()) != Player(15) then
			call PauseUnit(GetOrderedUnit(),true)
			call PauseUnit(GetOrderedUnit(),false)
			call IssueImmediateOrder(GetOrderedUnit(),"stop")
		endif
    return false
endfunction
//===========================================================================
//	初始化
//===========================================================================
function InitTrig_Anti_Team_Attack takes nothing returns nothing
   	set gg_trg_Anti_Team_Attack = CreateTrigger()
    call UMI(gg_trg_Anti_Team_Attack,EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
	call TriggerAddCondition(gg_trg_Anti_Team_Attack,Condition(function ATK)) 
endfunction//===========================================================================
// Trigger: Anti Exit Map
//===========================================================================
function Trig_Anti_Exit_MapActions takes nothing returns nothing
    call KillUnit( GetTriggerUnit() )
    // DEBUG 文本
    call TI_RequestBugReport()
endfunction
//===========================================================================
function InitTrig_Anti_Exit_Map takes nothing returns nothing
    set gg_trg_Anti_Exit_Map = CreateTrigger()
    call YDWETriggerRegisterLeaveRectSimpleNull( gg_trg_Anti_Exit_Map, GetEntireMapRect() )
    call TriggerAddAction(gg_trg_Anti_Exit_Map, function Trig_Anti_Exit_MapActions)
endfunction
//===========================================================================
// Trigger: No HotSpring A
//===========================================================================
function Trig_No_HotSpring_AConditions takes nothing returns boolean
    return ((GetOwningPlayer(GetTriggerUnit()) == udg_X_PlayerB[0]))
endfunction
function Trig_No_HotSpring_AActions takes nothing returns nothing
    call IssueNeutralTargetOrderById( udg_X_PlayerB[0], GetTriggerUnit(), 851983, gg_unit_ntn2_0009 )
endfunction
//===========================================================================
function InitTrig_No_HotSpring_A takes nothing returns nothing
    set gg_trg_No_HotSpring_A = CreateTrigger()
    call TriggerRegisterUnitInRangeSimple( gg_trg_No_HotSpring_A, 1000.00, gg_unit_nfoh_0022 )
    call TriggerAddCondition(gg_trg_No_HotSpring_A, Condition(function Trig_No_HotSpring_AConditions))
    call TriggerAddAction(gg_trg_No_HotSpring_A, function Trig_No_HotSpring_AActions)
endfunction
//===========================================================================
// Trigger: No HotSpring B
//===========================================================================
function Trig_No_HotSpring_BConditions takes nothing returns boolean
    return ((GetOwningPlayer(GetTriggerUnit()) == udg_X_PlayerA[0]))
endfunction
function Trig_No_HotSpring_BActions takes nothing returns nothing
    call IssueNeutralTargetOrderById( udg_X_PlayerA[0], GetTriggerUnit(), 851983, gg_unit_ntn2_0372 )
endfunction
//===========================================================================
function InitTrig_No_HotSpring_B takes nothing returns nothing
    set gg_trg_No_HotSpring_B = CreateTrigger()
    call TriggerRegisterUnitInRangeSimple( gg_trg_No_HotSpring_B, 1000.00, gg_unit_nfoh_0366 )
    call TriggerAddCondition(gg_trg_No_HotSpring_B, Condition(function Trig_No_HotSpring_BConditions))
    call TriggerAddAction(gg_trg_No_HotSpring_B, function Trig_No_HotSpring_BActions)
endfunction
//===========================================================================
// Trigger: Game Init
//===========================================================================
//系統 : 烤乳豬
function BarBQ_check2 takes nothing returns nothing
	if GetItemTypeId(GetEnumItem())=='tst2' then
		set udg_TempInteger=(udg_TempInteger+1)
	endif
endfunction
function BarBQ_check takes nothing returns nothing
local real x
local real y
	//織田軍 烤乳豬
	set x=GetRectCenterX(gg_rct_FU_BarBQ_A)
	set y=GetRectCenterY(gg_rct_FU_BarBQ_A)
	set udg_TempInteger=0
	call EnumItemsInRect(gg_rct_FU_BarBQ_A, null, function BarBQ_check2)
	set bj_forLoopAIndex=1
	set bj_forLoopAIndexEnd=(5-udg_TempInteger)
		loop
			exitwhen bj_forLoopAIndex>bj_forLoopAIndexEnd
			call CreateItem('tst2',x,y)
			set bj_forLoopAIndex=bj_forLoopAIndex+1
		endloop
	//聯合軍 烤乳豬
	set x=GetRectCenterX(gg_rct_FU_BarBQ_B)
	set y=GetRectCenterY(gg_rct_FU_BarBQ_B)
	set udg_TempInteger=0
	call EnumItemsInRect(gg_rct_FU_BarBQ_B, null, function BarBQ_check2)
	set bj_forLoopAIndex=1
	set bj_forLoopAIndexEnd=(5-udg_TempInteger)
		loop
			exitwhen bj_forLoopAIndex>bj_forLoopAIndexEnd
			call CreateItem('tst2',x,y)
			set bj_forLoopAIndex=bj_forLoopAIndex+1
		endloop
endfunction
function Trig_BarBQ takes nothing returns nothing
local integer i
local timer t
local real x
local real y
set gg_rct_FU_BarBQ_A=Rect(7008.0, - 7584.0, 7296.0, - 7296.0)
set gg_rct_FU_BarBQ_B=Rect(- 7392.0, 6944.0, - 7104.0, 7232.0)
	set x=GetRectCenterX(gg_rct_FU_BarBQ_A)
	set y=GetRectCenterY(gg_rct_FU_BarBQ_A)
	set i = 1
	loop
		exitwhen i > 5
		call CreateItem('tst2',x,y)
		set i = i + 1
	endloop
	set x=GetRectCenterX(gg_rct_FU_BarBQ_B)
	set y=GetRectCenterY(gg_rct_FU_BarBQ_B)
	set i = 1
	loop
		exitwhen i > 5
		call CreateItem('tst2',x,y)
		set i = i + 1
	endloop
	set t = CreateTimer()
	call TimerStart(t,325,true,function BarBQ_check)
endfunction
//遊戲初始化-設定
function InitTrig_Game_Init takes nothing returns nothing
	call Trig_BarBQ()
endfunction
//===========================================================================
// Trigger: Player Unit Dead
//===========================================================================
//Ｎａｍｅ：小馬死亡
//===========================================================================
//    主觸發
//===========================================================================
function Trig_Horse_DeadActions takes nothing returns nothing	
local unit u1	=	GetDyingUnit()
local unit u2	=	GetKillingUnit()
local player p = GetOwningPlayer(u1)	
local integer i = GetPlayerId(p) + 1
local player	p2	=	GetOwningPlayer(u2)
local integer i2 = GetPlayerId(p2) + 1
local string s 
	///////////////////////
	//檢查有無 SM模式
	//Y 玩家名稱 
	//N 單位名稱
	///////////////////////
		//如果被單位擊殺 要用單位名子
		if i2 > 10 then
			set s = udg_S03_color_of_players[i] + GetHeroProperName(udg_S01_hero_of_player[i]) + "|r的馬被" + udg_S03_color_of_players[i2] +	GetUnitName(u2) + "|r所擊殺"
		else
			set s = udg_S03_color_of_players[i] + GetHeroProperName(udg_S01_hero_of_player[i]) + "|r的馬被" + udg_S03_color_of_players[i2] +	GetHeroProperName(udg_S01_hero_of_player[i2]) + "|r所擊殺"
		endif	
   		
    call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, s)
    
set s = null 
set p = null 
endfunction
//===========================================================================
//    初始化
//===========================================================================
function Trig_Unit_DeadConditions takes nothing returns nothing	
	//馬是否死亡
	if GetUnitPointValue(GetTriggerUnit()) == 90 then
	    call Trig_Horse_DeadActions()
    endif
endfunction
function InitTrig_Player_Unit_Dead takes nothing returns nothing
local trigger ltt = CreateTrigger()
local integer i 
	set i = 0 
	loop 
		exitwhen i > 9
		call TriggerRegisterPlayerUnitEvent(ltt,Player(i),EVENT_PLAYER_UNIT_DEATH,null)
		set i = i + 1 
	endloop
	
	call TriggerAddCondition(ltt, Condition(function Trig_Unit_DeadConditions))	
set ltt = null
endfunction
//===========================================================================
// Trigger: Computer Unit Dead
//===========================================================================
//系統 : 掉落靈魂
function System_Soul_Delete_Item takes nothing returns nothing
local timer t = GetExpiredTimer()
	call RemoveItem(LoadItemHandle(udg_Soul_H,GetHandleId(t),5566))
	call FlushChildHashtable(udg_Soul_H,GetHandleId(t))
	call DestroyTimer(t)
set t = null
endfunction
function System_Soul takes nothing returns nothing
local item itt
local timer t = CreateTimer()
		set itt = PlaceRandomItem( udg_item_pool, GetUnitX(GetTriggerUnit()), GetUnitY(GetTriggerUnit()) )
		
		call SaveItemHandle(udg_Soul_H,GetHandleId(t),5566,itt)
		call TimerStart(t,15.00,false,function System_Soul_Delete_Item )
set itt = null 
endfunction
//多面板 : 破陣
function Trig_Hero_Kill_PawnActions takes nothing returns nothing
local integer i = GetPlayerId(GetOwningPlayer(GetKillingUnit())) + 1
	// 賞金系統 : 破一個建築物 增加 100
	set udg_S11_Money_Number[i] = ( udg_S11_Money_Number[i] + 100 )
	// 破陣更新
	set udg_S12_Building[i] = ( udg_S12_Building[i] + 1 )
	call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, i, 5), I2S(udg_S12_Building[i]) )
endfunction
 // CP 增加兵力
function Trig_CPActions takes integer i returns nothing
    if udg_get_wood[i] then
        set udg_get_wood[i] = false
        call SetPlayerState(Player(i-1), PLAYER_STATE_RESOURCE_LUMBER, GetPlayerState(Player(i-1), PLAYER_STATE_RESOURCE_LUMBER) + 1)
    else
        set udg_get_wood[i] = true
    endif
endfunction
//記分板 : 吃兵破百
function Trig_Kill_100Actions takes integer i returns nothing
	//更新吃兵數
    set udg_S03_number_kill[i] = ( udg_S03_number_kill[i] + 1 )
    	//判斷是否 100 擊殺
		if udg_S03_number_kill[i] - udg_S03_number_kill[i] / 100 * 100 == 0 then
			if udg_CRAZY_B then	
			    if (IsPlayerInForce(GetLocalPlayer(), bj_FORCE_ALL_PLAYERS)) then
			        // Use only local code (no net traffic) within this block to avoid desyncs.
			        call DisplayTimedTextToPlayer(GetLocalPlayer(), 0, 0, 10, udg_S03_color_of_players[i]+GetPlayerName( Player(i - 1))+I2S(udg_S03_number_kill[i])+"敵軍擊破！|r")
			    endif 
			else	
				if (IsPlayerInForce(GetLocalPlayer(), bj_FORCE_ALL_PLAYERS)) then
			        // Use only local code (no net traffic) within this block to avoid desyncs.
			        call DisplayTimedTextToPlayer(GetLocalPlayer(), 0, 0, 10,udg_S03_color_of_players[i]+GetUnitName(udg_S01_hero_of_player[i])+I2S(udg_S03_number_kill[i])+"敵軍擊破！|r")
			    endif
			endif	
	    endif
	    
    //更新賞金 + 多面板
    set udg_S11_Money_Number[i] = ( udg_S11_Money_Number[i] + 2 )
    call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, i, 1), I2S(udg_S03_number_kill[i]) ) 
endfunction
function Trig_Computer_Killed takes nothing returns boolean
local integer i = GetPlayerId(GetOwningPlayer(GetKillingUnit())) + 1	
    if i <= 10 then
	    call Trig_Kill_100Actions(i)
	    	//吃CP怪 有兵力
	    	if	GetTriggerPlayer()==Player(PLAYER_NEUTRAL_AGGRESSIVE) then
	    		call Trig_CPActions(i)
	    	endif	
	    
	    	//靈魂系統
	    	if GetRandomInt(1,100)<=7 then
	    		call System_Soul()
	    	endif
	    		
	    	if IsUnitType(GetDyingUnit(), UNIT_TYPE_STRUCTURE) then
		    	call Trig_Hero_Kill_PawnActions()
		    endif	
    endif
    return false
endfunction
function InitTrig_Computer_Unit_Dead takes nothing returns nothing
    set gg_trg_Computer_Unit_Dead = CreateTrigger()
	//中立單位死亡
	call TriggerRegisterPlayerUnitEvent(gg_trg_Computer_Unit_Dead, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_DEATH, null)
    call TriggerAddCondition(gg_trg_Computer_Unit_Dead, Condition(function Trig_Computer_Killed))
endfunction//===========================================================================
// Trigger: Hero Unit Dead
//===========================================================================
//記分板 : 死亡 - First Kill
function First_Kill_Timer takes nothing returns nothing
local integer int
    set int = 1
    loop
        exitwhen int > 10
	        if udg_Kill_Comboo_T[int] == 0 then
	            set udg_Kill_Comboo[int] = 0
	        else
	            set udg_Kill_Comboo_T[int] = udg_Kill_Comboo_T[int] - 1 
	        endif
        set int = int + 1
    endloop
endfunction
function First_Kill takes integer unitid , integer killid returns nothing
local timer t
	    if (gg_snd_firstblood != null) then
	        call StartSound(gg_snd_firstblood)
	        call StopSound(gg_snd_firstblood, false, true)
	    endif
	    
    call AdjustPlayerStateBJ( 200, GetOwningPlayer(udg_S01_hero_of_player[killid]), PLAYER_STATE_RESOURCE_GOLD )
    if udg_CRAZY_B then
        call DisplayTextToForce( GetPlayersAll(), ( ( "|cffff0000" + GetPlayerName(GetOwningPlayer(udg_S01_hero_of_player[killid])) ) + ( "|r拿下了敵方的首殺!為這場合戰正式揭開了序幕!!他將獲得額外" + "|cffff9900200|r的賞金!" ) ) )
    else
        call DisplayTextToForce( GetPlayersAll(), ( ( "|cffff0000" + GetHeroProperName(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(udg_S01_hero_of_player[killid]))]) ) + ( "|r拿下了敵方的首殺!為這場合戰正式揭開了序幕!!他將獲得額外" + "|cffff9900200|r的賞金!" ) ) )
    endif
    
    // 連殺判斷: -1 / s
    set t = CreateTimer()
    call TimerStart(t, 1.00, true, function First_Kill_Timer)
    //避免重複註冊
    set First_Kill_B = false
set t = null
endfunction
//記分板 : 死亡 - 連殺
function Trig_Kill_Comboo_Actions takes integer unitid , integer killid returns nothing	
local integer i = killid
local integer money = 0 
local boolean b = false
	//連殺控制 : 時間
    set udg_Kill_Comboo_T[i] = 8
    //連殺控制 : 累積
    set udg_Kill_Comboo[i] = udg_Kill_Comboo[i] + 1 
    	//連殺控制 : 判斷
	    if udg_Kill_Comboo[i] == 2 then
		    	// ☆文本
		        if udg_CRAZY_B then
		            call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetPlayerName(ConvertedPlayer(i)) + "|r拿下精彩的雙殺!他將獲得額外|cffff9900100|r的賞金!" ) ) )
		        else
		            call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetHeroProperName(udg_S01_hero_of_player[i]) + "|r拿下精彩的雙殺!他將獲得額外|cffff9900100|r的賞金!" ) ) )
		        endif
		    // ☆播放音樂
		    call StartSound(gg_snd_double_kill)
		    call SetSoundVolume( gg_snd_double_kill, 127 )
		    // ☆增加錢
		    set b = true
		    set money = 100
	    elseif udg_Kill_Comboo[i] == 3 then
	            // ☆文本
	            if udg_CRAZY_B then
	                call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetPlayerName(ConvertedPlayer(i)) + "|r拿下了高超的三連斬! 使敵軍聞風喪膽! 他將獲得額外|cffff9900200|r的賞金!" ) ) )
	            else
	                call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetHeroProperName(udg_S01_hero_of_player[i]) + "|r拿下了高超的三連斬! 使敵軍聞風喪膽! 他將獲得額外|cffff9900200|r的賞金!" ) ) )
	            endif
	        // ☆播放音樂
	        call StartSound(gg_snd_triple_kill)
	        call SetSoundVolume( gg_snd_triple_kill, 127 )
	        // ☆增加錢
	        set b = true
	        set money = 200
	    elseif udg_Kill_Comboo[i] == 4 then
	            // ☆文本
	            if udg_CRAZY_B then
	                call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetPlayerName(ConvertedPlayer(i)) + "|r達到了神一般的四連斬! 無任何敵將可與之匹敵! 他將獲得額外|cffff9900300|r的賞金!" ) ) )
	            else
	                call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetHeroProperName(udg_S01_hero_of_player[i]) + "|r達到了神一般的四連斬! 無任何敵將可與之匹敵! 他將獲得額外|cffff9900300|r的賞金!" ) ) )
	            endif
	        // ☆播放音樂
	        call StartSound(gg_snd_ultrakill)
	        call SetSoundVolume( gg_snd_ultrakill, 127 ) 
	        // ☆增加錢
	        set b = true
	        set money = 300
	    elseif udg_Kill_Comboo[i] == 5 then
		        // ☆文本
		        if udg_CRAZY_B then
		            call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetPlayerName(ConvertedPlayer(i)) + "|r所屬的聯合軍控制了整個戰場! 隻身一人便打得敵方潰不成軍! 他將獲得額外|cffff9900400|r的賞金!" ) ) )
		        else
		            call DisplayTextToForce( GetPlayersAll(), ( "|cffff0000" + ( GetHeroProperName(udg_S01_hero_of_player[i]) + "|r所屬的聯合軍控制了整個戰場! 隻身一人便打得敵方潰不成軍! 他將獲得額外|cffff9900400|r的賞金!" ) ) )
		        endif
	        // ☆播放音樂
	        call StartSound(gg_snd_ownage)
	        call SetSoundVolume( gg_snd_ownage, 127 ) 
	        // ☆增加錢
	        set b = true
	        set money = 400
	    endif
	    if b then
    		call AdjustPlayerStateBJ( money, GetOwningPlayer(udg_S01_hero_of_player[killid]), PLAYER_STATE_RESOURCE_GOLD )
    	endif	
	
endfunction
//多面板 : 殺人
function Trig_Heor_Kill_CHECK takes integer unitid, integer killid returns nothing
local texttag tt 
local player p = Player(killid - 1)
local force f = CreateForce()
    call ForceAddPlayer(f, p)
	//擊殺犒賞
	call SetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) + udg_S11_Money_Number[unitid])
	//創造漂浮文字
	set tt = CreateTextTagUnitBJ(("HeroKill +"+(I2S(udg_S11_Money_Number[unitid]))),udg_S01_hero_of_player[unitid],0,10.00,100.00,85.00,0.00,0)
	call ShowTextTagForceBJ(false,tt,bj_FORCE_ALL_PLAYERS)
	call SetTextTagPermanent(tt,false)
	call SetTextTagVelocityBJ(tt,60.00,90)
	call SetTextTagLifespan(tt,4.00)
	call SetTextTagFadepoint(tt,3.20)
	call ShowTextTagForceBJ(true,tt,f)
	//公告文字
	if udg_CRAZY_B then
		call DisplayTextToForce( GetPlayersAll(), ( "|CFFFF0000" + ( GetPlayerName(ConvertedPlayer(killid)) + ( "|R擊殺了|CFF3232FF" + ( GetPlayerName(ConvertedPlayer(unitid)) + ( "|R，獲得了|CFFFFCC00" + ( I2S(udg_S11_Money_Number[unitid]) + "|R賞金！" ) ) ) ) ) ) )
	else	
		call DisplayTextToForce( GetPlayersAll(), ( "|CFFFF0000" + ( GetHeroProperName(udg_S01_hero_of_player[killid]) + ( "|R擊殺了|CFF3232FF" + ( GetHeroProperName(udg_S01_hero_of_player[unitid]) + ( "|R，獲得了|CFFFFCC00" + ( I2S(udg_S11_Money_Number[unitid]) + "|R賞金！" ) ) ) ) ) ) )
	endif
	
	//增加兇手賞金
	set udg_S11_Money_Number[killid] = udg_S11_Money_Number[killid] + 100 
	
call DestroyForce(f)
set f = null
set tt = null
set p = null
endfunction
//多面板 : 助攻
function Trig_Heor_Assist_CHECK takes nothing returns nothing
local	player	p	=	GetEnumPlayer()
local	integer	i	=	GetPlayerId(p)+1
	//更新助攻數	
	set udg_S13_time[i] = ( udg_S13_time[i] + 1 )
	call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, i, 4), I2S(udg_S13_time[i]) )
	
		//不用當心 死亡單位的賞金突然增加
		//超過賞金上限 =700 / 少於賞金下限=75
		//如果錢少於 300 那麼 +100$ 如果少於 +50$
		if ((udg_S11_Money_Number[i] < 300)) then
			set udg_S11_Money_Number[i] = ( udg_S11_Money_Number[i] + 100 )
		else
			set udg_S11_Money_Number[i] = ( udg_S11_Money_Number[i] + 50 )
		endif	
	//call	BJDebugMsg("助攻玩家"+GetPlayerName(p))
set p	=	null
endfunction
//防小兵搶人頭
function Hero_Assist_Share_The_Gold takes nothing returns nothing
local	player	p =	GetEnumPlayer()
local	player	p2 =	udg_Hero_DiePlayer
local	integer	i =	GetPlayerId(p2)+1
local integer money = udg_S11_Money_Number[i]/Kill_I 
local force f = CreateForce()
	//設定玩家組
    call ForceAddPlayer(f, p)
	//加錢
	call AdjustPlayerStateBJ(money,p,PLAYER_STATE_RESOURCE_GOLD)
	//創造漂浮文字
	call CreateTextTagUnitBJ("Assist + "+I2S(money),udg_S01_hero_of_player[i],0,10.00,100.00,85.00,0.00,0)
	call ShowTextTagForceBJ(false,bj_lastCreatedTextTag,bj_FORCE_ALL_PLAYERS)
	call ShowTextTagForceBJ(true,bj_lastCreatedTextTag,f)
	call SetTextTagPermanent(bj_lastCreatedTextTag,false)
	call SetTextTagVelocityBJ(bj_lastCreatedTextTag,60.00,90)
	call SetTextTagLifespan(bj_lastCreatedTextTag,4.00)
	call SetTextTagFadepoint(bj_lastCreatedTextTag,3.20)
	//clean
	call DestroyForce(f)
	
set f = null	
set p =	null
set p2 =	null
endfunction
function Trig_Heor_Assist_Kill_Actions takes nothing returns nothing
local player	p1 = GetOwningPlayer(GetDyingUnit())
local player	p2 = GetOwningPlayer(GetKillingUnit()) 
local integer unitid = GetPlayerId(p1) + 1
local integer killid = GetPlayerId(p2) + 1	
local integer mostdmgunitcheck = 0
local integer mostdmgunitid = 0
local boolean b = false
local force f = CreateForce()
local integer int 
local integer i
local integer i2
local integer	f_int = 0
local string	s = "助攻玩家:"	
local trigger	ltt = GetTriggeringTrigger()	
set udg_Hero_DiePlayer = p1
set Kill_I = 0
	///////////////
	//賞金確認
	///////////////
	if udg_S11_Money_Number[unitid] < 75 then
		set udg_S11_Money_Number[unitid] = 75
	endif
	if udg_S11_Money_Number[unitid] > 700 then
		set udg_S11_Money_Number[unitid] = 700
	endif
	
	//////////////////
	//更新死亡人數
	//////////////////
	set udg_S18_die_Number[unitid] = ( udg_S18_die_Number[unitid] + 1 )
	call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, unitid, 3), I2S(udg_S18_die_Number[unitid]) )
		/////////////////////////////////
		//	助攻平分賞金用 + 加入temp-force
		/////////////////////////////////
		//unitid 1~10
		/////////////////////////////////
		set int = 1
		loop 
			exitwhen int > 10
				if((R2I(udg_time_R)-udg_Assist_CheckTime[(unitid+(int*(((unitid-1)*10)+int)))])<=6) and int!=killid then	
					set mostdmgunitid = int
					//助攻平分賞金用
					set Kill_I = Kill_I + 1
					call ForceAddPlayer(f,Player(int-1))
					set	s	=	s	+	GetUnitName(udg_S01_hero_of_player[int])
				endif	
			set int = int + 1
		endloop
			//////////////////		
			// 		自殺
			//////////////////
			if unitid==killid then
					if udg_CRAZY_B then
						call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,(("|cFFFF0000"+(GetPlayerName(ConvertedPlayer(unitid)) +"|r"))+"自殺身亡"))
					else	
						call DisplayTextToForce(bj_FORCE_ALL_PLAYERS,(("|cFFFF0000"+(GetUnitName(udg_S01_hero_of_player[unitid])+"|r"))+"自殺身亡"))
					endif	
					call TI_RequestBugReport()
			/////////////////
			//		戰亂
			/////////////////		
			elseif killid == 13 then
					
					if udg_CRAZY_B then
						call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "|CFFFF0000" + ( GetPlayerName(ConvertedPlayer(unitid)) + "|R在戰亂中陣亡!" ) ) )
					else	
						call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "|CFFFF0000" + ( GetHeroProperName(udg_S01_hero_of_player[unitid]) + "|R在戰亂中陣亡!" ) ) )
					endif
			////////////////////
			//更新	助攻 + 擊殺	
			////////////////////
			elseif killid <=10 then
				////////////////////
				//		擊殺
				////////////////////
				set udg_S17_kill_H_num[killid] = ( udg_S17_kill_H_num[killid] + 1 )
				call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, killid, 2), I2S(udg_S17_kill_H_num[killid]) ) 
				call Trig_Heor_Kill_CHECK(unitid,killid)
				
					//////////////////		
					// 		助攻 
					//////////////////
					if mostdmgunitid > 0 then
						call ForForce(f,function Trig_Heor_Assist_CHECK)
						if udg_New_Assist then
							call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,5,s)
						endif 
					endif
			/////////////////				
			// 		圍殺
			/////////////////
			elseif p2==udg_X_PlayerA[0] or p2==udg_X_PlayerB[0] then
				set	f_int	=	CountPlayersInForceBJ(f)
				//如果玩家組裡面只有一個人 那麼就判定那個人為擊殺者
				//否則就特別助攻判定
				if f_int > 0 then
					if	f_int==1 then
						set	killid = GetPlayerId(ForcePickRandomPlayer(f))	+	1
						////////////////////
						//		擊殺
						////////////////////
						set udg_S17_kill_H_num[killid] = ( udg_S17_kill_H_num[killid] + 1 )
						call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, killid, 2), I2S(udg_S17_kill_H_num[killid]) ) 
						call Trig_Heor_Kill_CHECK(unitid,killid) 
						call Trig_Kill_Comboo_Actions(unitid,killid)
					
					    	if First_Kill_B then
						    	call First_Kill(unitid,killid)
						    endif 
					else
					
						//防撿頭
						if udg_CRAZY_B then
							call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "|CFFFF0000" + ( GetPlayerName(p1) + "|R在敵軍的圍殺下陣亡!" ) ) )
						else	
							call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "|CFFFF0000" + ( GetHeroProperName(udg_S01_hero_of_player[unitid]) + "|R在敵軍的圍殺下陣亡!" ) ) )
						endif	
						//更新助攻 + 分享
						call ForForce(f,function Trig_Heor_Assist_CHECK) 
						call ForForce(f,function Hero_Assist_Share_The_Gold)
					endif	
				else
				
					if udg_CRAZY_B then
						call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "|CFFFF0000" + ( GetPlayerName(p1) + "|R在戰亂中陣亡!" ) ) )
					else	
						call DisplayTextToForce( bj_FORCE_ALL_PLAYERS, ( "|CFFFF0000" + ( GetHeroProperName(udg_S01_hero_of_player[unitid]) + "|R在戰亂中陣亡!" ) ) )
					endif	
				endif	
			endif
		///////////////////
		//		Debug
		//////////////////
		if GetKillingUnit() == null then
			
			call TI_RequestBugReport()
			
		endif	
		
	//////////////////////////////////////////////////////
	//減少死亡單位的賞金 + 扣錢
	//////////////////////////////////////////////////////
	set udg_S11_Money_Number[unitid]=R2I((I2R(udg_S11_Money_Number[unitid])*0.70))	
	call AdjustPlayerStateBJ( ( ( udg_die_money * -1 ) * ( 100 + ( 20 * GetHeroLevel(GetTriggerUnit()) ) ) ),ConvertedPlayer(unitid) , PLAYER_STATE_RESOURCE_GOLD )
	//菊基 D
	if TriggerEvaluate(gg_trg_B11D) then
        call TriggerExecute(gg_trg_B11D)
    endif
	/////////////////
	//排泄
	/////////////////
	call DestroyForce(f)
	set f = null
	set	p1	=	null
	set	p2	=	null
	set	ltt	=	null
endfunction
//多面板 : 復活
function Trig_Hero_Revive takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(YDHT,h2i,1001)
		if IsUnitAlly(u1, Player(0)) then
			call ReviveHero(u1,7147.0,-7410.0,true)
				if GetLocalPlayer() == GetOwningPlayer(u1) then
			        // Use only local code (no net traffic) within this block to avoid desyncs.
			        call PanCameraToTimed(7147.0, -7410.0, 0.1)
			    endif
		else
			call ReviveHero(u1,-7292.7,7087.5,true)
				if (GetLocalPlayer() == GetOwningPlayer(u1)) then
			        // Use only local code (no net traffic) within this block to avoid desyncs.
			        call PanCameraToTimed(-7292.7, 7087.5, 0.1)
			    endif
		endif
	call FlushChildHashtable(YDHT,h2i)
	call DestroyTimer(t)
	
set u1 = null
set t = null
endfunction
function Trig_Hero_Die takes nothing returns nothing
local unit u1 =GetDyingUnit()
local real revive = udg_S02_revival_time[( GetHeroLevel(u1) - 1 )]
local integer i = R2I(revive)
local integer id = GetPlayerId(GetOwningPlayer(u1)) + 1
local real x 
local real y 
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
	//開始計時器
	call SaveUnitHandle(YDHT,h2i,1001,u1)
	call TimerStart(t,revive,false,function Trig_Hero_Revive )
	//多面板 : 復活
	set udg_Hero_Number_ReviveTime[id] = i
	call MultiboardSetItemValue( MultiboardGetItem(udg_DMB, id , 6), I2S(i) )
set u1 = null
set t = null
endfunction
function Trig_Hero_Unit_DeadConditions takes nothing returns boolean
local unit u1 = GetTriggerUnit()
local unit u2 = GetKillingUnit()
local player	p1 = GetOwningPlayer(u1)
local player	p2 = GetOwningPlayer(u2) 
local integer unitid = GetPlayerId(p1) + 1
local integer killid = GetPlayerId(p2) + 1	
	    call Trig_Heor_Assist_Kill_Actions()
		//復活
	    call Trig_Hero_Die() 
		//【注意】 一定要分 電腦玩家 跟 普通玩家 擊殺
		// 要不然會造成 電腦玩家 也能觸發。
		if killid <= 10 then 
				
			call Trig_Kill_Comboo_Actions(unitid,killid)
			
		    	if First_Kill_B then
			    	call First_Kill(unitid,killid)
			    endif
			    
		endif
set u1 =	null 
set u2 =	null
set p1 =	null	
set p2 =	null 
    return false
endfunction
//Init
function InitTrig_Hero_Unit_Dead takes nothing returns nothing
    set gg_trg_Hero_Unit_Dead = CreateTrigger()
    call TriggerAddCondition(gg_trg_Hero_Unit_Dead, Condition(function Trig_Hero_Unit_DeadConditions))
endfunction
globals
integer Kill_I = 0
player udg_Hero_DiePlayer = null
boolean First_Kill_B = true
endglobals
//===========================================================================
// Trigger: Hero Demaged
//
// gg_trg_Hero_Demage
// 7
// 8
// 9
// 10
//===========================================================================
//多面板 : 助攻
function Trig_Hero_Assist_startActions takes integer unitid , integer dmgid returns nothing
set udg_Assist_CheckTime[(unitid+(dmgid*(((unitid-1)*10)+dmgid)))]=R2I(udg_time_R)
endfunction
// init
function Trig_Hero_Demaged_startConditions takes nothing returns boolean
local integer unitid 
local integer dmgid 
	if GetEventDamage() > 1 then
		set unitid = GetPlayerId( GetOwningPlayer(GetTriggerUnit() ) ) + 1
		set dmgid = GetPlayerId( GetOwningPlayer(GetEventDamageSource()) ) + 1
			// 1～10玩家 才需要判斷
	 		if dmgid <= 10 then
		 		//同盟不需要助攻
		 		if IsPlayerEnemy( Player(unitid - 1), Player(dmgid - 1) ) then
			 		call Trig_Hero_Assist_startActions(unitid,dmgid)
			 		//秀滿 W
					call TriggerEvaluate(gg_trg_C10W_Spell_for_target)
				endif
			endif
	endif
	return false	
endfunction
function InitTrig_Hero_Demaged takes nothing returns nothing
    set gg_trg_Hero_Demaged = CreateTrigger()
    call TriggerAddCondition(gg_trg_Hero_Demaged, Condition(function Trig_Hero_Demaged_startConditions))
endfunction
globals
integer udg_Assist_X=0
integer udg_Assist_Y=0
integer array udg_Assist_CheckTime
endglobals	
//===========================================================================
// Trigger: KnockBack
//===========================================================================
function Trig_KnockBackFunc011T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local boolean b1= LoadBoolean(YDHT, h2i, 0x96900F29)
local boolean b2= LoadBoolean(YDHT, h2i, 0xD740D5AE)
local unit u = LoadUnitHandle(YDHT, h2i, 0xC303079D)
local real d = LoadReal(YDHT, h2i, 0x9CD60476)
local real a = LoadReal(YDHT, h2i, 0xA1614B4D)
local real x = GetUnitX(u) + d * Cos(a * bj_DEGTORAD)
local real y = GetUnitY(u) + d * Sin(a * bj_DEGTORAD)
    
local real dx
local real dy
local boolean b = false
if b1 then
        if not IsTerrainPathable(x,y,PATHING_TYPE_FLYABILITY) then
            call SetUnitX(u,x)
            call SetUnitY(u,y)
        else
            set b = true
        endif
    else
        call SetUnitPosition(u,x,y)
        set dx = GetUnitX(u) - x
        set dy = GetUnitY(u) - y
        if SquareRoot(dx*dx+dy*dy) > d then
            if b2 then
	            call SaveReal(YDHT, h2i, 0xA1614B4D,bj_RADTODEG * Atan2(GetUnitY(u)-y,GetUnitX(u)-x))
            else
                set b = true
            endif
        endif
    endif
    call SaveReal(YDHT, h2i, 0xDD66C616,LoadReal(YDHT, h2i, 0xDD66C616)+LoadReal(YDHT, h2i, 0x25DAB820))
    if LoadReal(YDHT, h2i, 0xDD66C616) >= LoadReal(YDHT, h2i, 0x312C4181) or b then
	    if LoadTriggerHandle(YDHT, h2i, 0x66BD1F81) != null then
            set udg_KnockBack_Unit = u 
            set udg_KnockBack_Time = LoadReal(YDHT, h2i, 0xDD66C616)
            set udg_KnockBack_Boolean1 = b
            set udg_KnockBack_I2 = LoadInteger(YDHT, h2i, 555)
            if TriggerEvaluate(LoadTriggerHandle(YDHT, h2i, 0x66BD1F81)) then
                call TriggerExecute(LoadTriggerHandle(YDHT, h2i, 0x66BD1F81))
            endif
        endif
        call PauseTimer(t)
        call DestroyTimer(t)
        call FlushChildHashtable(YDHT, h2i)
        
    else
        call SaveReal(YDHT, h2i, 0x9CD60476,d * LoadReal(YDHT, h2i, 0x2FC9F415)) 
    endif
    set t = null
    set u = null
endfunction
function Trig_KnockBackActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call SaveUnitHandle(YDHT, h2i, 0xC303079D, udg_KnockBack_Unit)
    call SaveReal(YDHT, h2i, 0x9CD60476, udg_KnockBack_Dist)
    call SaveReal(YDHT, h2i, 0xA1614B4D, udg_KnockBack_Angle)
    call SaveReal(YDHT, h2i, 0x312C4181, udg_KnockBack_Time)
    call SaveReal(YDHT, h2i, 0x2FC9F415, udg_KnockBack_Rate)
    call SaveReal(YDHT, h2i, 0x25DAB820, udg_KnockBack_Interval)
    call SaveBoolean(YDHT, h2i, 0x96900F29, udg_KnockBack_Boolean1)
    call SaveBoolean(YDHT, h2i, 0xD740D5AE, udg_KnockBack_Boolean2)
    call SaveTriggerHandle(YDHT, h2i, 0x66BD1F81, udg_KnockBack_Trigger)
    call SaveInteger(YDHT, h2i, 555, udg_KnockBack_I2)
    
    call SaveReal(YDHT, h2i, 0xDD66C616, 0.00)
    
    call TimerStart(t, udg_KnockBack_Interval, true, function Trig_KnockBackFunc011T)
set t=null
endfunction
//===========================================================================
function InitTrig_KnockBack takes nothing returns nothing
    set gg_trg_KnockBack=CreateTrigger()
    call TriggerAddAction(gg_trg_KnockBack, function Trig_KnockBackActions)
endfunction//===========================================================================
// Trigger: DooConv
//===========================================================================
function Trig_DooConvActions takes nothing returns nothing
    call Cheat("DooConv")
endfunction
//===========================================================================
function InitTrig_DooConv takes nothing returns nothing
    set gg_trg_DooConv = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_DooConv, 0.00 )
    call TriggerAddAction(gg_trg_DooConv, function Trig_DooConvActions)
endfunction
//===========================================================================
// Trigger: AUD UP
//
// 'A0XA'
//===========================================================================
function Trig_AUD_UPConditions takes nothing returns boolean
    return ((GetUnitAbilityLevel(GetEventTargetUnit(), 'A0XA') == 0) and (IsUnitInGroup(GetEventTargetUnit(), udg_AUD_Group) != true) and (IsUnitType(GetEventTargetUnit(), UNIT_TYPE_STRUCTURE) == false))
endfunction
function Trig_AUD_UPActions takes nothing returns nothing
    call GroupAddUnit( udg_AUD_Group, GetEventTargetUnit() )
    call UnitAddAbility( GetEventTargetUnit(), 'A0XA' )
    call UnitMakeAbilityPermanent( GetEventTargetUnit(), true, 'A0XA' )
    call TriggerRegisterUnitEvent(udg_AUD_Trigger[udg_AUD_time], GetEventTargetUnit(), EVENT_UNIT_DAMAGED)
endfunction
//===========================================================================
function InitTrig_AUD_UP takes nothing returns nothing
    set gg_trg_AUD_UP = CreateTrigger()
    call TriggerAddCondition(gg_trg_AUD_UP, Condition(function Trig_AUD_UPConditions))
    call TriggerAddAction(gg_trg_AUD_UP, function Trig_AUD_UPActions)
endfunction
//===========================================================================
// Trigger: AUD Group
//===========================================================================
function Trig_AUD_GroupConditions takes nothing returns boolean
    return (((GetItemTypeId(GetManipulatedItem()) == 'anfg') or (GetItemTypeId(GetManipulatedItem()) == 'vddl')) and (IsUnitInGroup(GetTriggerUnit(), udg_AUD_Group2) == false))
endfunction
function Trig_AUD_GroupActions takes nothing returns nothing
    call GroupAddUnitSimple( GetTriggerUnit(), udg_AUD_Group2 )
    call TriggerRegisterUnitEvent(gg_trg_AUD_UP, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
endfunction
//===========================================================================
function InitTrig_AUD_Group takes nothing returns nothing
    set gg_trg_AUD_Group = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ( gg_trg_AUD_Group, EVENT_PLAYER_UNIT_PICKUP_ITEM )
    call TriggerAddCondition(gg_trg_AUD_Group, Condition(function Trig_AUD_GroupConditions))
    call TriggerAddAction(gg_trg_AUD_Group, function Trig_AUD_GroupActions)
endfunction
//===========================================================================
// Trigger: AUD GUI
//===========================================================================
function Trig_AUD_GUIFunc004Conditions takes nothing returns nothing
        // 鬼切、鬼蜘蛛
        call ConditionalTriggerExecute( gg_trg_Item13_DemageA )
        // 大谷吉繼
        call ConditionalTriggerExecute( gg_trg_A35T_damage_DD ) 
endfunction
function AUD_ReSet takes nothing returns nothing
call DestroyTimer(GetExpiredTimer())
call DestroyTrigger(udg_AUD_Trigger[udg_AUD_time])
call ConditionalTriggerExecute( gg_trg_AUD_GUI )
endfunction
function AUD_ReGroup takes nothing returns nothing
call TriggerRegisterUnitEvent(udg_AUD_Trigger[udg_AUD_time], GetEnumUnit(), EVENT_UNIT_DAMAGED)
endfunction
function Trig_AUD_GUIActions takes nothing returns nothing
local trigger ydl_trigger
set udg_AUD_time = ( udg_AUD_time + 1 )
set udg_AUD_Trigger[udg_AUD_time] = CreateTrigger()
set ydl_trigger = udg_AUD_Trigger[udg_AUD_time]
//不清試試看
call TriggerAddCondition(ydl_trigger, Condition(function Trig_AUD_GUIFunc004Conditions))
   
set ydl_trigger = null
endfunction
//===========================================================================
function InitTrig_AUD_GUI takes nothing returns nothing
    set gg_trg_AUD_GUI = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_AUD_GUI, 0.00 )
    call TriggerAddAction(gg_trg_AUD_GUI, function Trig_AUD_GUIActions)
endfunction//===========================================================================
// Trigger: ChainAbility
//
// local unit u=GetUnit(lTable,"u")
//===========================================================================
function Trig_ChainAbilityFunc002T takes nothing returns nothing
    local timer t= GetExpiredTimer()
    local integer h2i= GetHandleId(t)
    local unit lTMP= LoadUnitHandle(YDHT, h2i, 0x2D5DEA42)
    local unit u= LoadUnitHandle(YDHT, h2i, 0xC303079D)
    local unit u2
    local unit pre= lTMP
    local real an
    local real dt= LoadReal(YDHT, h2i, 0x4D554656)
    local real v= LoadReal(YDHT, h2i, 0x38344552)
    local real r= LoadReal(YDHT, h2i, 0x2FC9F415)
    local group g= CreateGroup()
    local integer j= LoadInteger(YDHT, h2i, 0x9FDB62AC)
    local integer m= LoadInteger(YDHT, h2i, 0x2B0A6845)
    local integer fu= LoadInteger(YDHT, h2i, 0xC4890E63)
    local integer a= LoadInteger(YDHT, h2i, 0x89CBE375)
    local string s= LoadStr(YDHT, h2i, 0x2D1E4992)
    local boolean b= LoadBoolean(YDHT, h2i, 0xFDF65382)
 
    if j != 0 then
	    set an=Atan2(GetUnitY(lTMP) - GetUnitY(u), GetUnitX(lTMP) - GetUnitX(u))
        call SetUnitX(u, GetUnitX(u) + v * dt * Cos(an))
		call SetUnitY(u, GetUnitY(u) + v * dt * Sin(an))
		call UnitResetCooldown(u)
        call SetUnitManaPercentBJ(u, 100)
        call SetUnitFacing(u,an*bj_RADTODEG)
        if SquareRoot(Pow(GetUnitX(lTMP) - GetUnitX(u), 2) + Pow(GetUnitY(lTMP) - GetUnitY(u), 2)) < 30 then
			set u2=CreateUnit(GetOwningPlayer(u), 'n007', GetUnitX(u), GetUnitY(u), 0)
			if ( m == 3 and not IsUnitAlly(lTMP, GetOwningPlayer(u)) ) or m == 2 then
				set a=LoadInteger(YDHT, h2i, 0x89CBE375)
				set s=LoadStr(YDHT, h2i, 0x65D0C72F)
            endif
            call UnitAddAbility(u2, a)
			call SetUnitAbilityLevelSwapped(a, u2, GetUnitAbilityLevel(u, a))
			call IssueTargetOrder(u2, s, lTMP)
			call GroupEnumUnitsInRange(g, GetUnitX(u), GetUnitY(u), r, null)
		    loop
			    set lTMP=null
                set lTMP=GroupPickRandomUnit(g)
                exitwhen lTMP == null
                if m == 1 then
	                	exitwhen lTMP != pre and lTMP != u and IsUnitAlly(lTMP, GetOwningPlayer(u)) and not ( IsUnitDeadBJ(lTMP) or IsUnitType(lTMP, UNIT_TYPE_STRUCTURE) or IsUnitType(lTMP, UNIT_TYPE_ANCIENT) or GetUnitAbilityLevel(lTMP, 'Aloc') > 0 )
			    elseif m == 2 then
					exitwhen lTMP != pre and lTMP != u and ( not IsUnitAlly(lTMP, GetOwningPlayer(u)) ) and not ( IsUnitDeadBJ(lTMP) or IsUnitType(lTMP, UNIT_TYPE_STRUCTURE) or IsUnitType(lTMP, UNIT_TYPE_ANCIENT) or GetUnitAbilityLevel(lTMP, 'Aloc') > 0 )
				else
					exitwhen lTMP != pre and lTMP != u and not ( IsUnitDeadBJ(lTMP) or IsUnitType(lTMP, UNIT_TYPE_STRUCTURE) or IsUnitType(lTMP, UNIT_TYPE_ANCIENT) or GetUnitAbilityLevel(lTMP, 'Aloc') > 0 )
				endif
				call GroupRemoveUnit(g, lTMP)
                endloop
                if lTMP == null then
                call KillUnit(u)
                                call FlushChildHashtable(YDHT, h2i)
				call RemoveUnit(u)
				call PauseTimer(t)
				call DestroyTimer(t)
                else
                call SaveInteger(YDHT, h2i, 0x9FDB62AC, j - 1)
				call SaveUnitHandle(YDHT, h2i, 0x2D5DEA42, lTMP)
				if ( b == true ) then
                    call KillUnit(u)
                    call FlushChildHashtable(YDHT, h2i)
                    call PauseTimer(t)
		            call DestroyTimer(t)
				endif
			endif
		endif
	else
    call KillUnit(u)
		call RemoveUnit(u)
                call FlushChildHashtable(YDHT, h2i)
		call PauseTimer(t)
		call DestroyTimer(t)
	endif
	call DestroyGroup(g)
	set g=null
	set u=null
	set u2=null
	set pre=null
	set t=null
	set lTMP=null
endfunction
function Trig_ChainAbilityActions takes nothing returns nothing
    local timer t= CreateTimer()
    local integer h2i= GetHandleId(t)
    local unit u1= GetTriggerUnit()
    local unit u2= udg_ChainAbility_U
    local unit u3= CreateUnit(GetOwningPlayer(u1), ( udg_ChainAbility_fu ), GetUnitX(u1), GetUnitY(u1), 0)
    call UnitAddAbility(u3, udg_ChainAbility_a)
	call SetUnitAbilityLevelSwapped(udg_ChainAbility_a, u3, GetUnitAbilityLevel(u1, GetSpellAbilityId()))
	call UnitAddAbility(u3, udg_ChainAbility_a2)
	call SetUnitAbilityLevelSwapped(udg_ChainAbility_a2, u3, GetUnitAbilityLevel(u1, GetSpellAbilityId()))
   
    call SaveReal(YDHT, h2i, 0x4D554656, 0.03)
    call SaveReal(YDHT, h2i, 0x38344552, udg_ChainAbility_v)
    call SaveReal(YDHT, h2i, 0x2FC9F415, udg_ChainAbility_r)
    call SaveStr(YDHT, h2i, 0x2D1E4992, udg_ChainAbility_s)
    call SaveStr(YDHT, h2i, 0x65D0C72F, udg_ChainAbility_s2)
    call SaveInteger(YDHT, h2i, 0x2B0A6845, udg_ChainAbility_m)
    call SaveInteger(YDHT, h2i, 0xA1614B4D, udg_ChainAbility_a)
    call SaveInteger(YDHT, h2i, 0x89CBE375, udg_ChainAbility_a2)
    call SaveInteger(YDHT, h2i, 0xC4890E63, udg_ChainAbility_fu2)
    call SaveBoolean(YDHT, h2i, 0xFDF65382, udg_ChainAbility_b)
    // --------------------------------------------
    call SaveInteger(YDHT, h2i, 0x9FDB62AC, udg_ChainAbility_j)
    call SaveUnitHandle(YDHT, h2i, 0xC303079D, u3)
    call SaveUnitHandle(YDHT, h2i, 0x2D5DEA42, u2)
    // --------------------------------------------
    call TimerStart(t, udg_ChainAbility_t, true, function Trig_ChainAbilityFunc002T)
    
    set t=null
    set u1=null
    set u2=null
    set u3=null
endfunction
//===========================================================================
function InitTrig_ChainAbility takes nothing returns nothing
    set gg_trg_ChainAbility=CreateTrigger()
    call TriggerAddAction(gg_trg_ChainAbility, function Trig_ChainAbilityActions)
endfunction//===========================================================================
// Trigger: illegal
//===========================================================================
function Trig_illegalFunc001A takes nothing returns nothing
    call DisplayTextToPlayer( GetEnumPlayer(), 0, 0, ( "|CFFFF0000" + ( udg_real_name[GetConvertedPlayerId(GetTriggerPlayer())] + ( "(" + ( GetHeroProperName(udg_S01_hero_of_player[GetConvertedPlayerId(GetTriggerPlayer())]) + ( ")疑似輸入非法指令(\"" + ( GetEventPlayerChatString() + "\")，請各位玩家注意是否有人被踢除!" ) ) ) ) ) ) )
endfunction
function Trig_illegalActions takes nothing returns nothing
    call ForForce( GetPlayersAll(), function Trig_illegalFunc001A )
endfunction
//===========================================================================
function InitTrig_illegal takes nothing returns nothing
    set gg_trg_illegal = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_illegal, Player(0), "-lock", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_illegal, Player(0), "-nosay", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_illegal, Player(0), ".xon", false )
    call TriggerRegisterPlayerChatEvent( gg_trg_illegal, Player(0), ".k", false )
    call TriggerAddAction(gg_trg_illegal, function Trig_illegalActions)
endfunction
//===========================================================================
// Trigger: AMH
//===========================================================================
function AMH_7 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
	//每個人的 HASH 值 不同。
	call PanCameraToTimed(LoadReal(YDHT,h2i,1), LoadReal(YDHT,h2i,2), 0.00)
	//call BJDebugMsg(GetUnitName(LoadUnitHandle(YDHT,h2i,0)))
	call RemoveUnit(LoadUnitHandle(YDHT,h2i,0))	
	call FlushChildHashtable(YDHT,h2i)
	call DestroyTimer(t)
set t = null
endfunction
function AMH_3 takes nothing returns nothing
local unit u3 
local real x = 8080
local real y = 8400
local timer t 
local integer h2i 
	if IsVisibleToPlayer(x, y, udg_X_PlayerA[0])== false and IsVisibleToPlayer(x, y, udg_X_PlayerB[0]) == false then
			set u3 = CreateUnit(Player(15),'hfoo',x,y,270.00)
			call UnitAddAbility(u3,'Avul')
			call UnitAddAbility(u3,'A0XC')
			call UnitAddAbility(u3,'ANcl')
			call UnitAddAbility(u3,'Abun')
			call UnitAddAbility(u3,'A0XD')
			call UnitAddAbility(u3,'Aro1')
			call UnitAddAbility(u3,'A0XE')
			call IssueNeutralImmediateOrderById(Player(15),u3,852600)
			//傳導
				if GetPlayerSlotState(GetLocalPlayer()) == PLAYER_SLOT_STATE_PLAYING and GetPlayerController(GetLocalPlayer()) == MAP_CONTROL_USER then
					call CameraSetupApplyForceDuration(TheCam,true,0.0)
					call SetCameraTargetController(u3, 0.00, 0.00, false)
					call PanCameraToTimed(8080.0,8400.0,0.0)
					call SetCameraPosition(8080.0,8400.0)
				endif 
			//set 
			set t = CreateTimer()
			set h2i = GetHandleId(t)
			call SaveUnitHandle(YDHT,h2i,0,u3)
			call SaveReal(YDHT,h2i,1,GetCameraTargetPositionX())
			call SaveReal(YDHT,h2i,2,GetCameraTargetPositionY())
			call TimerStart(t,0.03,false,function AMH_7 )
	endif	
	//call BJDebugMsg("X"+R2S(x)+"Y"+R2S(y))
set t = null
set u3 = null
endfunction
function AMH_Recover takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local trigger ltt = LoadTriggerHandle(YDHT,h2i,1111)
	
	call FlushChildHashtable(YDHT,h2i)
	call DestroyTimer(t)
	call EnableTrigger(ltt)
	
set ltt = null	
set t = null	
endfunction	
function AMH_2 takes nothing returns boolean	
local timer t 
local trigger ltt
	if udg_single_player == false then
	//if udg_single_player == false then
		set t = CreateTimer()
		set ltt = GetTriggeringTrigger()	
		call SaveTriggerHandle(YDHT,GetHandleId(t),1111,ltt)
		call DisableTrigger(ltt)	
		call TimerStart(t,15.00,false,function AMH_Recover)
		call AMH_3()
	endif
set t = null
set ltt = null	
	return false	
endfunction
function InitTrig_AMH takes nothing returns nothing
local trigger ltt = CreateTrigger()
local integer i 
//防鏡頭不能轉移。
set TheCam=CreateCameraSetup()
call CameraSetupSetDestPosition(TheCam,8080.0,8400.0,.0)
	//隱藏圖標
	call SetAltMinimapIcon("lvbu_top.blp")
	//事件登記
	set i = 0
	loop
		exitwhen i>9
		if GetPlayerController(Player(i)) == MAP_CONTROL_USER then
			if GetPlayerSlotState(Player(i)) == PLAYER_SLOT_STATE_PLAYING then
				call TriggerRegisterPlayerChatEvent(ltt,Player(i),"-AMH",true)
				call TriggerAddCondition(ltt,Condition(function AMH_2))
			endif
		endif
		set i=i+1
	endloop
//clean
set ltt = null	
endfunction
globals
camerasetup TheCam=null
endglobals//===========================================================================
// Trigger: MH
//
//     call DisableTrigger( GetTriggeringTrigger() )
//     call UnitSetUsesAltIcon(u, false)
//     call UnitSetUsesAltIcon(u, true)
//===========================================================================
function Trig_MHFunc003Func001A takes nothing returns nothing
local unit u = GetEnumUnit()
    call SetUnitX( u, GetRandomReal(GetRectMinX(gg_rct_AMH_RANGE1), GetRectMaxX(gg_rct_AMH_RANGE1)) )
    call SetUnitY( u, GetRandomReal(GetRectMinY(gg_rct_AMH_RANGE1), GetRectMaxY(gg_rct_AMH_RANGE1)) )
 	call UnitSetUsesAltIcon(u, false)
    call UnitSetUsesAltIcon(u, true)
    
set u = null
endfunction
function Trig_MHFunc003T takes nothing returns nothing
    call ForGroup( udg_MH_group[GetRandomInt(1, 10)], function Trig_MHFunc003Func001A )
endfunction
function Trig_MHFunc004T2 takes nothing returns nothing
local unit u = GetEnumUnit()
	if IsUnitInvisible(u,GetLocalPlayer()) then
		call UnitSetUsesAltIcon(u,true)
	else
		call UnitSetUsesAltIcon(u,false)
	endif
	
set u = null	
endfunction
function Trig_MHFunc004T takes nothing returns nothing
local integer i = 1
	//////////////
	//英雄隱藏小點點
	//////////////
	loop
		exitwhen i >10
			if IsUnitInvisible(udg_S01_hero_of_player[i],GetLocalPlayer() )then
				call UnitSetUsesAltIcon(udg_S01_hero_of_player[i],true)
			else
				call UnitSetUsesAltIcon(udg_S01_hero_of_player[i],false)
			endif
		set i = i + 1
	endloop	
	call ForGroup(udg_MH_group[11], function Trig_MHFunc004T2)
endfunction
function Trig_MHActions takes nothing returns nothing
local timer t = CreateTimer()	
local integer ydul_i
local integer ydul_i2
local real x
local real y
local unit u3
	call DisplayTimedTextToForce( GetPlayersAll(), 5.00, "|cffff0000 MH 系統開啟|r" )
	    
	    set ydul_i = 1
	    loop
	        exitwhen ydul_i > 3
	        set ydul_i2 = 1
	        loop
	            exitwhen ydul_i2 > 10
	            	set x = GetRandomReal(GetRectMinX(gg_rct_AMH_RANGE1), GetRectMaxX(gg_rct_AMH_RANGE1))
	            	set y = GetRandomReal(GetRectMinY(gg_rct_AMH_RANGE1), GetRectMaxY(gg_rct_AMH_RANGE1))
					set u3 = CreateUnit(Player(ydul_i2 - 1),'H01T',x,y,0)
					call SetHeroLevel(u3,024,false)
					call UnitAddAbility(u3,'A0XC')
					call UnitAddAbility(u3,'A0XD')
					call UnitAddAbility(u3,'A0XE')
					call SetUnitFlyHeight(u3,1000000.0,0.0)
					call SetUnitPathing(u3,false)
		            call UnitSetUsesAltIcon(u3, true)
		            call GroupAddUnit( udg_MH_group[ydul_i2], u3 )
	            set ydul_i2 = ydul_i2 + 1
	        endloop
	        set ydul_i = ydul_i + 1
	    endloop
	//地圖小點模擬移動    
    call TimerStart(t, 2.00, true, function Trig_MHFunc003T)
	call DisableTrigger( GetTriggeringTrigger() )
	//地圖小點隱藏
	set t = CreateTimer()
	call TimerStart(t, 1.00, true, function Trig_MHFunc004T)
set t = null 
endfunction
function Trig_MHCondition takes nothing returns boolean
	if udg_single_player==false then
		call Trig_MHActions()
	endif
	return false
endfunction
function InitTrig_MH takes nothing returns nothing
local	integer i	=	0
    set gg_trg_MH = CreateTrigger()
    call TriggerAddCondition(gg_trg_MH, Condition(function Trig_MHCondition))
    
	loop
		exitwhen	i	==	10
		call TriggerRegisterPlayerChatEvent( gg_trg_MH, Player(i), "-mh", true )
		set i	=	i	+	1
	endloop	
	
endfunction//===========================================================================
// Trigger: MH UP
//===========================================================================
function Trig_MH_UPConditions takes nothing returns boolean
local integer id = GetUnitTypeId(GetSoldUnit())
    if id == 'hhes' or id == 'hrdh' then
		call GroupAddUnit( udg_MH_group[11], GetSoldUnit() )	
    endif
    return false
endfunction
function InitTrig_MH_UP takes nothing returns nothing
    set gg_trg_MH_UP = CreateTrigger()
    call TriggerRegisterUnitEvent( gg_trg_MH_UP, gg_unit_ndrk_0128, EVENT_UNIT_SELL )
    call TriggerRegisterUnitEvent( gg_trg_MH_UP, gg_unit_ndrk_0582, EVENT_UNIT_SELL )
    call TriggerAddCondition(gg_trg_MH_UP, Condition(function Trig_MH_UPConditions))
endfunction//===========================================================================
// Trigger: AMH DEBUG
//===========================================================================
function Trig_AMH_DEBUGConditions takes nothing returns boolean
local unit u = GetTriggerUnit()
    if	GetUnitTypeId(u) == 'H01T' then
	    call SetUnitX( u, 0.00 )
    	call SetUnitY( u, 0.00 )
    endif
set u	=	null 
    return false 
endfunction
function InitTrig_AMH_DEBUG takes nothing returns nothing
    local region rectRegion = CreateRegion()
	set gg_trg_AMH_DEBUG = CreateTrigger()
	
	    call RegionAddRect(rectRegion, gg_rct___________________C)
	    call TriggerRegisterEnterRegion(gg_trg_AMH_DEBUG, rectRegion, null)
	    call TriggerAddCondition(gg_trg_AMH_DEBUG, Condition(function Trig_AMH_DEBUGConditions))
    set rectRegion	=	null
endfunction
//===========================================================================
// Trigger: init OB
//===========================================================================
function Trig_init_OBFunc009Func010A takes nothing returns nothing
    call SetUnitOwner( GetEnumUnit(), Player(bj_PLAYER_NEUTRAL_VICTIM), true )
endfunction
function Trig_init_OBFunc009Func017A takes nothing returns nothing
    call SetUnitOwner( GetEnumUnit(), Player(bj_PLAYER_NEUTRAL_EXTRA), true )
endfunction
function Trig_init_OBActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    // 資料設定
    set udg_X_PlayerA[0] = Player(10)
    set udg_X_PlayerB[0] = Player(11)
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_X_PlayerA[GetForLoopIndexA()] = ConvertedPlayer(GetForLoopIndexA())
        set udg_X_PlayerB[GetForLoopIndexA()] = ConvertedPlayer(( GetForLoopIndexA() + 5 ))
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 額外?金系統
    set udg_HIGH = -30
    set udg_soilder = 0
    // 觀察者系統 共用
    if (((IsMapFlagSet(MAP_OBSERVERS) == true) or (IsMapFlagSet(MAP_OBSERVERS_ON_DEATH) == true))) then
        set udg_X_Observer = true
        call DisplayTimedTextToForce( GetPlayersAll(), 10.00, "TRIGSTR_4301" )
        call EnableTrigger( gg_trg_Observer_Support )
        // 不能給他看 要不然會崩潰
        // 觀察者系統 織田軍
        set udg_X_PlayerA[0] = Player(bj_PLAYER_NEUTRAL_VICTIM)
        call YDWESetPlayerColorBJNull( Player(bj_PLAYER_NEUTRAL_VICTIM), PLAYER_COLOR_AQUA, true )
        set udg_A_common_group = YDWEGetUnitsOfPlayerAllNull(Player(10))
        call ForGroupBJ( udg_A_common_group, function Trig_init_OBFunc009Func010A )
        set bj_forLoopAIndex = 0
        set bj_forLoopAIndexEnd = 5
        loop
            exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
            call SetPlayerAlliance(Player(10),udg_X_PlayerA[GetForLoopIndexA()],ConvertAllianceType(0),true)
            call SetPlayerAlliance(Player(10),udg_X_PlayerA[GetForLoopIndexA()],ConvertAllianceType(4),true)
            call SetPlayerAlliance(Player(10),udg_X_PlayerB[GetForLoopIndexA()],ConvertAllianceType(0),false)
            call SetPlayerAlliance(Player(10),udg_X_PlayerB[GetForLoopIndexA()],ConvertAllianceType(4),false)
            set bj_forLoopAIndex = bj_forLoopAIndex + 1
        endloop
        call DestroyGroup( udg_A_common_group )
        // 觀察者系統 織田軍
        set udg_X_PlayerB[0] = Player(bj_PLAYER_NEUTRAL_EXTRA)
        call YDWESetPlayerColorBJNull( Player(bj_PLAYER_NEUTRAL_EXTRA), PLAYER_COLOR_BROWN, true )
        set udg_A_common_group = YDWEGetUnitsOfPlayerAllNull(Player(11))
        call ForGroupBJ( udg_A_common_group, function Trig_init_OBFunc009Func017A )
        set bj_forLoopAIndex = 0
        set bj_forLoopAIndexEnd = 5
        loop
            exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
            call SetPlayerAlliance(Player(11),udg_X_PlayerB[GetForLoopIndexA()],ConvertAllianceType(0),true)
            call SetPlayerAlliance(Player(11),udg_X_PlayerB[GetForLoopIndexA()],ConvertAllianceType(4),true)
            call SetPlayerAlliance(Player(11),udg_X_PlayerA[GetForLoopIndexA()],ConvertAllianceType(0),false)
            call SetPlayerAlliance(Player(11),udg_X_PlayerA[GetForLoopIndexA()],ConvertAllianceType(4),false)
            set bj_forLoopAIndex = bj_forLoopAIndex + 1
        endloop
        call DestroyGroup( udg_A_common_group )
    else
    endif
    // 令編號1~5(洽為織田軍5位玩者)視織田軍為同盟 並設定織田軍視5位玩者為同盟
    call SetPlayerName( udg_X_PlayerA[0], "TRIGSTR_1653" )
    call SetPlayerName( udg_X_PlayerB[0], "TRIGSTR_1658" )
    call SetPlayerAllianceBJ( udg_X_PlayerB[0], ALLIANCE_PASSIVE, false, udg_X_PlayerA[0] )
    call SetPlayerAllianceBJ( udg_X_PlayerA[0], ALLIANCE_PASSIVE, false, udg_X_PlayerB[0] )
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerHandicapXPBJ( ConvertedPlayer(GetForLoopIndexA()), 95.00 )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_SHARED_VISION, true, udg_X_PlayerA[0] )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_PASSIVE, true, udg_X_PlayerA[0] )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_PASSIVE, false, udg_X_PlayerB[0] )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_SHARED_SPELLS, true, udg_X_PlayerA[0] )
        call SetPlayerAllianceBJ( udg_X_PlayerB[0], ALLIANCE_PASSIVE, false, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerA[0], ALLIANCE_PASSIVE, true, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerA[0], ALLIANCE_SHARED_VISION, true, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerA[0], ALLIANCE_SHARED_SPELLS, true, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerA[0], ALLIANCE_SHARED_XP, true, ConvertedPlayer(GetForLoopIndexA()) )
        set bj_forLoopBIndex = 1
        set bj_forLoopBIndexEnd = 5
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_SHARED_XP, true, ConvertedPlayer(GetForLoopIndexB()) )
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 令編號6~10(洽為聯合軍5位玩者)視織田軍為同盟 並設定聯合軍視5位玩者為同盟
    set bj_forLoopAIndex = 6
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerHandicapXPBJ( ConvertedPlayer(GetForLoopIndexA()), 95.00 )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_SHARED_VISION, true, udg_X_PlayerB[0] )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_PASSIVE, true, udg_X_PlayerB[0] )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_PASSIVE, false, udg_X_PlayerA[0] )
        call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_SHARED_SPELLS, true, udg_X_PlayerB[0] )
        call SetPlayerAllianceBJ( udg_X_PlayerA[0], ALLIANCE_PASSIVE, false, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerB[0], ALLIANCE_PASSIVE, true, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerB[0], ALLIANCE_SHARED_VISION, true, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerB[0], ALLIANCE_SHARED_SPELLS, true, ConvertedPlayer(GetForLoopIndexA()) )
        call SetPlayerAllianceBJ( udg_X_PlayerB[0], ALLIANCE_SHARED_XP, true, ConvertedPlayer(GetForLoopIndexA()) )
        set bj_forLoopBIndex = 6
        set bj_forLoopBIndexEnd = 10
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            call SetPlayerAllianceBJ( ConvertedPlayer(GetForLoopIndexA()), ALLIANCE_SHARED_XP, true, ConvertedPlayer(GetForLoopIndexB()) )
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call DestroyTrigger(GetTriggeringTrigger())
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_init_OB takes nothing returns nothing
    set gg_trg_init_OB = CreateTrigger()
    call TriggerAddAction(gg_trg_init_OB, function Trig_init_OBActions)
endfunction
//===========================================================================
// Trigger: Observer Support
//
// 51 52 53 54 55
// 52  53  54  55 51      攻擊
//===========================================================================
function Trig_Observer_SupportConditions takes nothing returns boolean
    return ((GetIssuedOrderIdBJ() == String2OrderIdBJ("move")) and (GetUnitUserData(GetTriggerUnit()) > 5) and (GetUnitUserData(GetTriggerUnit()) < 80))
endfunction
function Trig_Observer_SupportActions takes nothing returns nothing
    call YDWESetLocalVariableInteger( "i", GetUnitUserData(GetTriggerUnit()) )
    call IssuePointOrder( GetTriggerUnit(), "attack", udg_X[YDWEGetLocalVariableInteger("i")], udg_Y[YDWEGetLocalVariableInteger("i")] )
endfunction
//===========================================================================
function InitTrig_Observer_Support takes nothing returns nothing
    set gg_trg_Observer_Support = CreateTrigger()
    call DisableTrigger(gg_trg_Observer_Support)
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Observer_Support, Player(bj_PLAYER_NEUTRAL_VICTIM), EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER )
    call TriggerRegisterPlayerUnitEventSimple( gg_trg_Observer_Support, Player(bj_PLAYER_NEUTRAL_EXTRA), EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER )
    call TriggerAddCondition(gg_trg_Observer_Support, Condition(function Trig_Observer_SupportConditions))
    call TriggerAddAction(gg_trg_Observer_Support, function Trig_Observer_SupportActions)
endfunction
//===========================================================================
// Trigger: Tactics Init
//===========================================================================
function Trig_Tactics_InitActions takes nothing returns nothing
    set udg_Tactics_Skill_List[1] = 'A0QK'
    set udg_Tactics_Skill_List[2] = 'A0QG'
    set udg_Tactics_Skill_List[3] = 'A0QC'
    set udg_Tactics_Skill_List[4] = 'A0QJ'
    set udg_Tactics_Skill_List[5] = 'A0QF'
    set udg_Tactics_Skill_List[6] = 'A0QA'
    set udg_Tactics_Skill_List[7] = 'A0QM'
    set udg_Tactics_Skill_List[8] = 'A0QD'
    set udg_Tactics_Skill_List[9] = 'A0QE'
    set udg_Tactics_Skill_List[10] = 'A0QL'
    set udg_Tactics_Skill_Mana[1] = 15.00
    set udg_Tactics_Skill_Mana[2] = 5.00
    set udg_Tactics_Skill_Mana[3] = 15.00
    set udg_Tactics_Skill_Mana[4] = 20.00
    set udg_Tactics_Skill_Mana[5] = 45.00
    set udg_Tactics_Skill_Mana[6] = 5.00
    set udg_Tactics_Skill_Mana[7] = 25.00
    set udg_Tactics_Skill_Mana[8] = 5.00
    set udg_Tactics_Skill_Mana[9] = 15.00
    set udg_Tactics_Skill_Mana[10] = 15.00
    // 遊戲開始時 將戰法部隊儲存至變數中 以利之後法力調整
    // 織田軍儲存在 tactic_unit1
    set udg_tactic_unit1[0] = gg_unit_n00R_0122
    set udg_tactic_unit1[1] = gg_unit_n00R_0356
    set udg_tactic_unit1[2] = gg_unit_n00R_0357
    set udg_tactic_unit1[3] = gg_unit_n00R_0358
    set udg_tactic_unit1[4] = gg_unit_n00R_0359
    // 聯合軍儲存在 tactic_unit2
    set udg_tactic_unit2[0] = gg_unit_n00R_0599
    set udg_tactic_unit2[1] = gg_unit_n00R_0600
    set udg_tactic_unit2[2] = gg_unit_n00R_0601
    set udg_tactic_unit2[3] = gg_unit_n00R_0602
    set udg_tactic_unit2[4] = gg_unit_n00R_0603
    // 織田軍儲存在 tactic_unit1
    set udg_Click_Rect[0] = CreateRegion()
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______u )
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______2 )
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______3 )
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______4 )
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______5 )
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______6 )
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______7 )
    call RegionAddRect( udg_Click_Rect[0], gg_rct_______8 )
    set udg_Click_Rect[1] = CreateRegion()
    call RegionAddRect( udg_Click_Rect[1], gg_rct_B______1 )
    call RegionAddRect( udg_Click_Rect[1], gg_rct_B______1 )
    call RegionAddRect( udg_Click_Rect[1], gg_rct_B______2 )
    set udg_Click_Rect[2] = CreateRegion()
    call RegionAddRect( udg_Click_Rect[2], gg_rct_C______1 )
    call RegionAddRect( udg_Click_Rect[2], gg_rct_C______2 )
    call RegionAddRect( udg_Click_Rect[2], gg_rct_C______3 )
    call RegionAddRect( udg_Click_Rect[2], gg_rct_C______4 )
    call RegionAddRect( udg_Click_Rect[2], gg_rct_C______5 )
    call RegionAddRect( udg_Click_Rect[2], gg_rct_C______6 )
    call DestroyTrigger(GetTriggeringTrigger())
endfunction
//===========================================================================
function InitTrig_Tactics_Init takes nothing returns nothing
    set gg_trg_Tactics_Init = CreateTrigger()
    call TriggerAddAction(gg_trg_Tactics_Init, function Trig_Tactics_InitActions)
endfunction
//===========================================================================
// Trigger: thirty seconds before tactic MP recover
//===========================================================================
function Trig_thirty_seconds_before_tactic_MP_recoverFunc005Func003T takes nothing returns nothing
    // 時間到達6的整數倍時 恢復戰法法力
    set bj_forLoopAIndex = 0
    set bj_forLoopAIndexEnd = 4
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetUnitManaPercentBJ( udg_tactic_unit1[GetForLoopIndexA()], 100 )
        call SetUnitManaPercentBJ( udg_tactic_unit2[GetForLoopIndexA()], 100 )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_10598" )
    call FlushChildHashtable(YDHT, GetHandleId(GetExpiredTimer()))
    call DestroyTimer(GetExpiredTimer())
endfunction
function Trig_thirty_seconds_before_tactic_MP_recoverFunc005T takes nothing returns nothing
    local timer ydl_timer
    // 補充戰法30秒前  發出提示
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_10595" )
    set ydl_timer = CreateTimer()
    call TimerStart(ydl_timer, 30.00, false, function Trig_thirty_seconds_before_tactic_MP_recoverFunc005Func003T)
    set ydl_timer = null
endfunction
function Trig_thirty_seconds_before_tactic_MP_recoverActions takes nothing returns nothing
    local timer ydl_timer
    call DisableTrigger( GetTriggeringTrigger() )
    // 補充戰法30秒前  發出提示
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_10595" )
    set ydl_timer = CreateTimer()
    call TimerStart(ydl_timer, 120.00, true, function Trig_thirty_seconds_before_tactic_MP_recoverFunc005T)
    call YDWEPolledWaitNull(30.00)
    // 時間到達6的整數倍時 恢復戰法法力
    set bj_forLoopAIndex = 0
    set bj_forLoopAIndexEnd = 4
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetUnitManaPercentBJ( udg_tactic_unit1[GetForLoopIndexA()], 100 )
        call SetUnitManaPercentBJ( udg_tactic_unit2[GetForLoopIndexA()], 100 )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_10598" )
    set ydl_timer = null
endfunction
//===========================================================================
function InitTrig_thirty_seconds_before_tactic_MP_recover takes nothing returns nothing
    set gg_trg_thirty_seconds_before_tactic_MP_recover = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_thirty_seconds_before_tactic_MP_recover, 90.00 )
    call TriggerAddAction(gg_trg_thirty_seconds_before_tactic_MP_recover, function Trig_thirty_seconds_before_tactic_MP_recoverActions)
endfunction
//===========================================================================
// Trigger: Click
//===========================================================================
//影藏排行榜
function Trig_ClickActions_for_HIDE_LQB_0 takes nothing returns nothing
call LeaderboardDisplay( udg_ldb[0], false )
endfunction
function Trig_ClickActions_for_HIDE_LQB_1 takes nothing returns nothing
call LeaderboardDisplay( udg_ldb[1], false )
endfunction
//消失
function Trig_ClickActions_for_Disappear takes boolean b returns nothing
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local player p = GetTriggerPlayer()
local texttag tt
local integer green = ROSE_PercentTo255(50.00)
local integer red = ROSE_PercentTo255(50.00)
local integer blue = ROSE_PercentTo255(50.00)
local integer transparency = ROSE_PercentTo255(50.0)
local real vel = 64 * 0.071 / 128
local real xvel = vel * Cos(90 * bj_DEGTORAD)
local real yvel = vel * Sin(90 * bj_DEGTORAD)
local integer i = GetPlayerId(p) + 1
local string s = "消失"
local string s2
local string s3 = ""
//分 上中下 陸的點
local leaderboard lqb 
local real x2
local real y2
local real dx
local real dy
local real dt1
local real dt2
local real dt3
local real dt4
local real dt5
local real dt6
local real dt7
local real dt8
local real dt9
local real dt10
local real dt11
local real dt
local integer int 
local boolean b2 = false
	//排行榜設定
    if b == false then
    	call LeaderboardDisplay( udg_ldb[0], true )
    	call PauseTimer(udg_ldb_T[0])
    	call TimerStart(udg_ldb_T[0],5.00,false,function Trig_ClickActions_for_HIDE_LQB_0)
    	set lqb = udg_ldb[0]
    else
    	call LeaderboardDisplay( udg_ldb[1], true )
    	call PauseTimer(udg_ldb_T[1])
    	call TimerStart(udg_ldb_T[1],5.00,false,function Trig_ClickActions_for_HIDE_LQB_1)
    	set lqb = udg_ldb[1]
    endif	
    //下路不規則面
	if IsPointInRegion(udg_Click_Rect[0], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路戰線 : 消失 !"
		call LeaderboardSetLabel( lqb, "        |cff999999下路戰線 : 消失" ) 
	elseif IsPointInRegion(udg_Click_Rect[1], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路戰線 : 消失 !"
		call LeaderboardSetLabel( lqb, "        |cff999999上路戰線 : 消失" ) 
	elseif IsPointInRegion(udg_Click_Rect[2], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  中路戰線 : 消失 !"
		call LeaderboardSetLabel( lqb, "        |cff999999中路戰線 : 消失" ) 
	endif
	//確認有沒有 在戰線上
	if b2 == false then
		//上CP
		set x2 = 1726.0
		set y2 = 1548.0
		set dx = x - x2
		set dy = y - y2
		set dt4 = SquareRoot( dx * dx + dy * dy )
		//下CP
		set x2 = -3425.0
		set y2 = -2257.0
		set dx = x - x2
		set dy = y - y2
		set dt5 = SquareRoot( dx * dx + dy * dy )
		//聯合軍大本
		set x2 = -6235
		set y2 = 5937
		set dx = x - x2
		set dy = y - y2
		set dt6 = SquareRoot( dx * dx + dy * dy )
		//織田軍大本
		set x2 = 6671
		set y2 = -6732
		set dx = x - x2
		set dy = y - y2
		set dt7 = SquareRoot( dx * dx + dy * dy )
			//取最小值
			set dt = RMinBJ(dt4, dt5)
			set dt = RMinBJ(dt, dt6)
			set dt = RMinBJ(dt, dt7)	
				if dt == dt4 then
					//上路CP
					set int = 4
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路野區 : 消失 !"
						call LeaderboardSetLabel( lqb, "        |cff999999上路野區 : 消失" ) 
				elseif dt == dt5 then
					//下路CP
					set int = 5
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路野區 : 消失 !"
						call LeaderboardSetLabel( lqb, "        |cff999999下路野區 : 消失" ) 
				elseif dt == dt6 then
					//聯合軍
					set int = 6	
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  失去敵軍消息 !"
						call LeaderboardSetLabel( lqb, "        |cff999999失去敵軍消息" ) 
				elseif dt == dt7 then
					//織田軍
					set int = 7
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  失去敵軍消息 !"
						call LeaderboardSetLabel( lqb, "        |cff999999失去敵軍消息" ) 
				endif
	endif
	//漂浮文字
	set tt = CreateTextTag()
    call SetTextTagText(tt, s , 10.00 * 0.023 / 10)
    call SetTextTagPos(tt, x-50, y, 0)
	call SetTextTagColor(tt, red, green, blue, transparency )
	call SetTextTagPermanent(tt,false)
	call SetTextTagLifespan(tt,2.00)
	call SetTextTagFadepoint(tt,0.00)
	call SetTextTagVelocity(tt, xvel, yvel)
		//是否顯示漂浮文字
		//Q1.一開始建造 就大家都看得到?
		// 測試結果 是的。
	    if IsPlayerAlly(GetLocalPlayer(), p) then
		    //特效
		    set s3 = "war3mapImported\\judgementtarget.mdx"
			//閃燈
			call PingMinimapEx(x, y, 3.00, PercentTo255(50.00), PercentTo255(50.00), PercentTo255(50.00), true)
			//公告
        	// Use only local code (no net traffic) within this block to avoid desyncs.
        	call DisplayTimedTextToPlayer(GetLocalPlayer(), 0, 0, 2.00, s2)
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call SetTextTagVisibility(tt, true)
	    else
	        call SetTextTagVisibility(tt, false) 
	    endif
	    //一定要這樣 要不然會 異步
		call DestroyEffect(AddSpecialEffect(s3, x, y))
set tt = null
set s = null
set s2 = null
set p = null
set lqb = null
endfunction
//支援
function Trig_ClickActions_for_Corver takes boolean b returns nothing
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local player p = GetTriggerPlayer()
local texttag tt
local integer green = ROSE_PercentTo255(0.00)
local integer red = ROSE_PercentTo255(0.00)
local integer blue = ROSE_PercentTo255(100.00)
local integer transparency = ROSE_PercentTo255(50.0)
local real vel = 64 * 0.071 / 128
local real xvel = vel * Cos(90 * bj_DEGTORAD)
local real yvel = vel * Sin(90 * bj_DEGTORAD)
local integer i = GetPlayerId(p) + 1
local string s = "支援"
local string s2
local string s3 = ""
//分 上中下 陸的點
local leaderboard lqb 
local real x2
local real y2
local real dx
local real dy
local real dt1
local real dt2
local real dt3
local real dt4
local real dt5
local real dt6
local real dt7
local real dt8
local real dt9
local real dt10
local real dt11
local real dt
local integer int 
local boolean b2 = false
	//排行榜設定
    if b == false then
    	call LeaderboardDisplay( udg_ldb[0], true )
    	call PauseTimer(udg_ldb_T[0])
    	call TimerStart(udg_ldb_T[0],5.00,false,function Trig_ClickActions_for_HIDE_LQB_0)
    	set lqb = udg_ldb[0]
    else
    	call LeaderboardDisplay( udg_ldb[1], true )
    	call PauseTimer(udg_ldb_T[1])
    	call TimerStart(udg_ldb_T[1],5.00,false,function Trig_ClickActions_for_HIDE_LQB_1)
    	set lqb = udg_ldb[1]
    endif	
    //下路不規則面
	if IsPointInRegion(udg_Click_Rect[0], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路戰線 : 支援 !"
		call LeaderboardSetLabel( lqb, "        |cff00ccff下路戰線 : 支援" ) 
	elseif IsPointInRegion(udg_Click_Rect[1], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路戰線 : 支援 !"
		call LeaderboardSetLabel( lqb, "        |cff00ccff上路戰線 : 支援" ) 
	elseif IsPointInRegion(udg_Click_Rect[2], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  中路戰線 : 支援 !"
		call LeaderboardSetLabel( lqb, "        |cff00ccff中路戰線 : 支援" )
	endif
	//確認有沒有 在戰線上
	if b2 == false then
		//上CP
		set x2 = 1726.0
		set y2 = 1548.0
		set dx = x - x2
		set dy = y - y2
		set dt4 = SquareRoot( dx * dx + dy * dy )
		//下CP
		set x2 = -3425.0
		set y2 = -2257.0
		set dx = x - x2
		set dy = y - y2
		set dt5 = SquareRoot( dx * dx + dy * dy )
		//聯合軍大本
		set x2 = -6235
		set y2 = 5937
		set dx = x - x2
		set dy = y - y2
		set dt6 = SquareRoot( dx * dx + dy * dy )
		//織田軍大本
		set x2 = 6671
		set y2 = -6732
		set dx = x - x2
		set dy = y - y2
		set dt7 = SquareRoot( dx * dx + dy * dy )
			//取最小值
			set dt = RMinBJ(dt4, dt5)
			set dt = RMinBJ(dt, dt6)
			set dt = RMinBJ(dt, dt7)	
				if dt == dt4 then
					//上路CP
					set int = 4
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路野區 : 支援 !"
						call LeaderboardSetLabel( lqb, "        |cff00ccff上路野區 : 支援" ) 
				elseif dt == dt5 then
					//下路CP
					set int = 5
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路野區 : 支援 !"
						call LeaderboardSetLabel( lqb, "        |cff00ccff下路野區 : 支援" ) 
				elseif dt == dt6 then
					//聯合軍
					set int = 6	
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  聯合軍本陣 : 支援 !"
						call LeaderboardSetLabel( lqb, "        |cff00ccff聯合軍本陣 : 支援" ) 
				elseif dt == dt7 then
					//織田軍
					set int = 7
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  織田軍本陣 : 支援 !"
						call LeaderboardSetLabel( lqb, "        |cff00ccff織田軍本陣 : 支援" ) 
				endif
	endif
	//漂浮文字
	set tt = CreateTextTag()
    call SetTextTagText(tt, s , 10.00 * 0.023 / 10)
    call SetTextTagPos(tt, x-50, y, 0)
	call SetTextTagColor(tt, red, green, blue, transparency )
	call SetTextTagPermanent(tt,false)
	call SetTextTagLifespan(tt,2.00)
	call SetTextTagFadepoint(tt,0.00)
	call SetTextTagVelocity(tt, xvel, yvel)
		//是否顯示漂浮文字
		//Q1.一開始建造 就大家都看得到?
		// 測試結果 是的。
	    if IsPlayerAlly(GetLocalPlayer(), p) then
		    //特效
		    set s3 = "war3mapImported\\judgementtarget.mdx"
			//閃燈
			call PingMinimapEx(x, y, 3.00, PercentTo255(0.01), PercentTo255(0.01), PercentTo255(99.01), true)
			//公告
        	// Use only local code (no net traffic) within this block to avoid desyncs.
        	call DisplayTimedTextToPlayer(GetLocalPlayer(), 0, 0, 2.00, s2)
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call SetTextTagVisibility(tt, true)
	    else
	        call SetTextTagVisibility(tt, false) 
	    endif
	    //一定要這樣 要不然會 異步
		call DestroyEffect(AddSpecialEffect(s3, x, y))
set tt = null
set s = null
set s2 = null
set p = null
set lqb = null
endfunction
//撤退
function Trig_ClickActions_for_Retreat takes boolean b returns nothing
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local player p = GetTriggerPlayer()
local texttag tt
local integer green = ROSE_PercentTo255(100.00)
local integer red = ROSE_PercentTo255(0.00)
local integer blue = ROSE_PercentTo255(0.00)
local integer transparency = ROSE_PercentTo255(50.0)
local real vel = 64 * 0.071 / 128
local real xvel = vel * Cos(90 * bj_DEGTORAD)
local real yvel = vel * Sin(90 * bj_DEGTORAD)
local integer i = GetPlayerId(p) + 1
local string s = "撤退"
local string s2
local string s3 = ""
//分 上中下 陸的點
local leaderboard lqb 
local real x2
local real y2
local real dx
local real dy
local real dt1
local real dt2
local real dt3
local real dt4
local real dt5
local real dt6
local real dt7
local real dt8
local real dt9
local real dt10
local real dt11
local real dt
local integer int 
local boolean b2 = false
	//排行榜設定
    if b == false then
    	call LeaderboardDisplay( udg_ldb[0], true )
    	call PauseTimer(udg_ldb_T[0])
    	call TimerStart(udg_ldb_T[0],5.00,false,function Trig_ClickActions_for_HIDE_LQB_0)
    	set lqb = udg_ldb[0]
    else
    	call LeaderboardDisplay( udg_ldb[1], true )
    	call PauseTimer(udg_ldb_T[1])
    	call TimerStart(udg_ldb_T[1],5.00,false,function Trig_ClickActions_for_HIDE_LQB_1)
    	set lqb = udg_ldb[1]
    endif	
    //下路不規則面
	if IsPointInRegion(udg_Click_Rect[0], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路戰線 : 撤退 !"
		call LeaderboardSetLabel( lqb, "        |cff99cc00下路戰線 : 撤退" )
	elseif IsPointInRegion(udg_Click_Rect[1], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路戰線 : 撤退 !"
		call LeaderboardSetLabel( lqb, "        |cff99cc00上路戰線 : 撤退" )
	elseif IsPointInRegion(udg_Click_Rect[2], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  中路戰線 : 撤退 !"
		call LeaderboardSetLabel( lqb, "        |cff99cc00中路戰線 : 撤退" )
	endif
	//確認有沒有 在戰線上
	if b2 == false then
		//上CP
		set x2 = 1726.0
		set y2 = 1548.0
		set dx = x - x2
		set dy = y - y2
		set dt4 = SquareRoot( dx * dx + dy * dy )
		//下CP
		set x2 = -3425.0
		set y2 = -2257.0
		set dx = x - x2
		set dy = y - y2
		set dt5 = SquareRoot( dx * dx + dy * dy )
		//聯合軍大本
		set x2 = -6235
		set y2 = 5937
		set dx = x - x2
		set dy = y - y2
		set dt6 = SquareRoot( dx * dx + dy * dy )
		//織田軍大本
		set x2 = 6671
		set y2 = -6732
		set dx = x - x2
		set dy = y - y2
		set dt7 = SquareRoot( dx * dx + dy * dy )
			//取最小值
			set dt = RMinBJ(dt4, dt5)
			set dt = RMinBJ(dt, dt6)
			set dt = RMinBJ(dt, dt7)	
				if dt == dt4 then
					//上路CP
					set int = 4
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路野區 : 撤退 !"
						call LeaderboardSetLabel( lqb, "        |cff99cc00上路野區 : 撤退" ) 
				elseif dt == dt5 then
					//下路CP
					set int = 5
						set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路野區 : 撤退 !"
						call LeaderboardSetLabel( lqb, "        |cff99cc00下路野區 : 撤退" ) 
				elseif dt == dt6 then
					//聯合軍
					set int = 6 
					set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  全軍撤退 !!"
					call LeaderboardSetLabel( lqb, "        |cff99cc00全軍撤退 !!" )	
				elseif dt == dt7 then
					//織田軍
					set int = 7
					set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  全軍撤退 !!"
					call LeaderboardSetLabel( lqb, "        |cff99cc00全軍撤退 !!" ) 
				endif
	endif
	//漂浮文字
	set tt = CreateTextTag()
    call SetTextTagText(tt, s , 10.00 * 0.023 / 10)
    call SetTextTagPos(tt, x-50, y, 0)
	call SetTextTagColor(tt, red, green, blue, transparency )
	call SetTextTagPermanent(tt,false)
	call SetTextTagLifespan(tt,2.00)
	call SetTextTagFadepoint(tt,0.00)
	call SetTextTagVelocity(tt, xvel, yvel)
		//是否顯示漂浮文字
		//Q1.一開始建造 就大家都看得到?
		// 測試結果 是的。
	    if IsPlayerAlly(GetLocalPlayer(), p) then
		    //特效
		    set s3 = "war3mapImported\\judgementtarget.mdx"
			//閃燈
			call PingMinimapEx(x, y, 3.00, PercentTo255(0.01), PercentTo255(99.00), PercentTo255(0.01), true)
			//公告
        	// Use only local code (no net traffic) within this block to avoid desyncs.
        	call DisplayTimedTextToPlayer(GetLocalPlayer(), 0, 0, 2.00, s2)
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call SetTextTagVisibility(tt, true)
	    else
	        call SetTextTagVisibility(tt, false) 
	    endif
	    //一定要這樣 要不然會 異步
		call DestroyEffect(AddSpecialEffect(s3, x, y))
set tt = null
set s = null
set s2 = null
set p = null
set lqb = null
endfunction
//進攻
function Trig_ClickActions_for_attack takes boolean b returns nothing
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local player p = GetTriggerPlayer()
local texttag tt
local integer green = ROSE_PercentTo255(0.00)
local integer red = ROSE_PercentTo255(100.00)
local integer blue = ROSE_PercentTo255(0.00)
local integer transparency = ROSE_PercentTo255(50.0)
local real vel = 64 * 0.071 / 128
local real xvel = vel * Cos(90 * bj_DEGTORAD)
local real yvel = vel * Sin(90 * bj_DEGTORAD)
local integer i = GetPlayerId(p) + 1
local string s = "進攻"
local string s2
local string s3 = ""
//分 上中下 陸的點
local leaderboard lqb 
local real x2
local real y2
local real dx
local real dy
local real dt1
local real dt2
local real dt3
local real dt4
local real dt5
local real dt6
local real dt7
local real dt8
local real dt9
local real dt10
local real dt11
local real dt
local integer int 
local boolean b2 = false
	//排行榜設定
    if b == false then
    	call LeaderboardDisplay( udg_ldb[0], true )
    	call PauseTimer(udg_ldb_T[0])
    	call TimerStart(udg_ldb_T[0],5.00,false,function Trig_ClickActions_for_HIDE_LQB_0)
    	set lqb = udg_ldb[0]
    else
    	call LeaderboardDisplay( udg_ldb[1], true )
    	call PauseTimer(udg_ldb_T[1])
    	call TimerStart(udg_ldb_T[1],5.00,false,function Trig_ClickActions_for_HIDE_LQB_1)
    	set lqb = udg_ldb[1]
    endif	
    //下路不規則面
	if IsPointInRegion(udg_Click_Rect[0], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路戰線 : 突襲 !"
		call LeaderboardSetLabel( lqb, "        |cffff0000下路戰線 : 突襲" )
	elseif IsPointInRegion(udg_Click_Rect[1], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路戰線 : 突襲 !"
		call LeaderboardSetLabel( lqb, "        |cffff0000上路戰線 : 突襲" )
	elseif IsPointInRegion(udg_Click_Rect[2], x, y) then
		set b2 = true
		set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  中路戰線 : 突襲 !"
		call LeaderboardSetLabel( lqb, "        |cffff0000中路戰線 : 突襲" )
	endif
	//確認有沒有 在戰線上
	if b2 == false then
		//上CP
		set x2 = 1726.0
		set y2 = 1548.0
		set dx = x - x2
		set dy = y - y2
		set dt4 = SquareRoot( dx * dx + dy * dy )
		//下CP
		set x2 = -3425.0
		set y2 = -2257.0
		set dx = x - x2
		set dy = y - y2
		set dt5 = SquareRoot( dx * dx + dy * dy )
		//聯合軍大本
		set x2 = -6235
		set y2 = 5937
		set dx = x - x2
		set dy = y - y2
		set dt6 = SquareRoot( dx * dx + dy * dy )
		//織田軍大本
		set x2 = 6671
		set y2 = -6732
		set dx = x - x2
		set dy = y - y2
		set dt7 = SquareRoot( dx * dx + dy * dy )
			//取最小值
			set dt = RMinBJ(dt4, dt5)
			set dt = RMinBJ(dt, dt6)
			set dt = RMinBJ(dt, dt7)	
				if dt == dt4 then
					//上路CP
					set int = 4
					set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  上路野區 : 突襲 !"
					call LeaderboardSetLabel( lqb, "        |cffff0000上路野區 : 突襲" )	
				elseif dt == dt5 then
					//下路CP
					set int = 5
					set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  下路野區 : 突襲 !"
					call LeaderboardSetLabel( lqb, "        |cffff0000下路野區 : 突襲" )	
				elseif dt == dt6 then
					//聯合軍
					set int = 6
					set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  全軍進攻 !!"
					call LeaderboardSetLabel( lqb, "        |cffff0000全軍進攻 !!" )	
				elseif dt == dt7 then
					//織田軍
					set int = 7
					set s2 = udg_S03_color_of_players[i] + GetPlayerName(p) + "|r  全軍進攻 !!"
					call LeaderboardSetLabel( lqb, "        |cffff0000全軍進攻 !!" ) 
				endif
	endif
	//漂浮文字
	set tt = CreateTextTag()
    call SetTextTagText(tt, s , 10.00 * 0.023 / 10)
    call SetTextTagPos(tt, x-50, y, 0)
	call SetTextTagColor(tt, red, green, blue, transparency )
	call SetTextTagPermanent(tt,false)
	call SetTextTagLifespan(tt,2.00)
	call SetTextTagFadepoint(tt,0.00)
	call SetTextTagVelocity(tt, xvel, yvel)
		//是否顯示漂浮文字
		//Q1.一開始建造 就大家都看得到?
		// 測試結果 是的。
	    if IsPlayerAlly(GetLocalPlayer(), p) then
		    //特效
		    set s3 = "war3mapImported\\judgementtarget.mdx"
			//閃燈
			call PingMinimapEx(x, y, 3.00, PercentTo255(99.00), PercentTo255(0.01), PercentTo255(0.01), true)
			//公告
        	// Use only local code (no net traffic) within this block to avoid desyncs.
        	call DisplayTimedTextToPlayer(GetLocalPlayer(), 0, 0, 2.00, s2)
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call SetTextTagVisibility(tt, true)
	    else
	        call SetTextTagVisibility(tt, false)
	    endif
	    //一定要這樣 要不然會 異步
		call DestroyEffect(AddSpecialEffect(s3, x, y))
set tt = null
set s = null
set s2 = null
set p = null
set lqb = null
endfunction
//===========================================================================
//	戰法 : X
//===========================================================================
function Trig_X_TacticsFunc001Conditions takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
local integer h2i = GetHandleId(ltt)
local unit u2 = LoadUnitHandle(YDHT, h2i, 151515)
local effect	e =	LoadEffectHandle( YDHT,h2i,0xA1614B4D )
local player	p =	GetOwningPlayer(u2)
local real dmg =	GetEventDamage()
	//防止被魔獸預警傷害破壞
	if	dmg >	0.00 or C17T_CHECK_B	==	true	then
		//clean
		call FlushChildHashtable(YDHT,h2i)
		call DestroyTrigger(	ltt )
		call DestroyEffect (	e )
		
	endif	
	
	    if GetTriggerUnit() ==null then 
			//clean
			call FlushChildHashtable(YDHT,h2i)
			call DestroyTrigger(	ltt )
			call DestroyEffect (	e ) 
			//effect
			call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTarget.mdl",u2,"origin"))
			
				//判斷回家的點    
		    	if IsPlayerAlly(p, Player(0)) then
		    		call SetUnitPositionLoc(u2, udg_X_Point[3])
	    			    if (GetLocalPlayer() == p) then
					        // Use only local code (no net traffic) within this block to avoid desyncs.
					        call PanCameraToTimed(GetLocationX(udg_X_Point[3]), GetLocationY(udg_X_Point[3]), 0.00)
					    endif
						    
				else
				
					call SetUnitPositionLoc(u2, udg_X_Point[4])
						if (GetLocalPlayer() == p) then
						    // Use only local code (no net traffic) within this block to avoid desyncs.
						    call PanCameraToTimed(GetLocationX(udg_X_Point[4]), GetLocationY(udg_X_Point[4]), 0.00)
						endif
						
				endif	
			
	    endif	
set p =	null 
set ltt = null
set u2 = null
set e =	null	
endfunction
function Trig_X_TacticsActions takes nothing returns nothing
local trigger ltt = CreateTrigger()
local integer h2i = GetHandleId(ltt)
local unit u2 = GetSpellTargetUnit()
	call SaveEffectHandle(YDHT, h2i, 0xA1614B4D,AddSpecialEffectTarget("Objects\\InventoryItems\\BattleStandard\\BattleStandard.mdl", u2, "chest") )
	call SaveUnitHandle(YDHT, h2i, 151515, u2)
	
	/////////////////////////////////////////////////////
	// if unit be damaged then destory effect
	// else 8.00 sec after set unit to home
	//////////////////////////////////////////////////////
	call TriggerRegisterTimerEvent(ltt, 8.00, false)
    call TriggerRegisterUnitEvent( ltt, u2, EVENT_UNIT_DAMAGED )
    call TriggerAddCondition(ltt, Condition(function Trig_X_TacticsFunc001Conditions)) 
    
set ltt = null
set u2 = null
endfunction 
//===========================================================================
//	戰法 : Z
//===========================================================================
function Trig_tactic_FActions takes nothing returns nothing
local unit u	=	GetTriggerUnit()
local	unit	u2	=	gg_unit_nfoh_0022
local	unit	u3	=	gg_unit_nfoh_0366
local	player	p	=	GetOwningPlayer(u)
local	real	x	=	GetSpellTargetX()
local	real	y	=	GetSpellTargetY()
local	real	x1	=	GetUnitX(u2)
local	real	y1	=	GetUnitY(u2)
local	real	x2	=	GetUnitX(u3)
local	real	y2	=	GetUnitY(u3)
local real dx = x1 - x
local real dy = y1 - y
local	real	dt	=	SquareRoot(dx * dx + dy * dy)
local real dx2 = x2 - x
local real dy2 = y2 - y
local	real	dt2	=	SquareRoot(dx2 * dx2 + dy2 * dy2)
local	integer	id	=	GetSpellAbilityId()
// 施展偵隱時 給予短暫視野
local	unit	u4	
	if	id	==	'A0QC' then
		set	u4=	CreateUnit(p,'nitr',x,y,270.0)	
		call UnitApplyTimedLife( u4, 'BTLF', 30.00 )
    	call SetUnitPathing( u4, false )
    else
    	set	u4=	CreateUnit(p,'ndsa',x,y,270.0)	
		call UnitApplyTimedLife( u4, 'BTLF', 10.00 )
    	call SetUnitPathing( u4, false )
    	call SetUnitTimeScale(u4, 40 * 0.01)
    endif	
	//避免獲得溫泉視野
    if dt2 < 1350.00 or dt < 1350.00 then
	    
	    call KillUnit( u4 )
        call RemoveUnit( u4 ) 
    endif
set p	=	null
set u	=	null
set u2	=	null
set u3	=	null
set u4	=	null
endfunction
//===========================================================================
//	戰法 : Q
//===========================================================================
//初始化 判斷單位組用
function Trig_tactic_QFunc012002002 takes nothing returns boolean
local	unit	u	= GetFilterUnit()
    if IsUnitType(u, UNIT_TYPE_STRUCTURE) and GetOwningPlayer(u)==Player(10) and GetUnitAbilityLevel(u,'Avul')==0 then
	    set u	=	null
	    return true
	else
		set u	=	null
		return false
	endif 
endfunction
function Trig_tactic_QFunc0120020023 takes nothing returns boolean
local	unit	u	= GetFilterUnit()
    if IsUnitType(u, UNIT_TYPE_STRUCTURE) and GetOwningPlayer(u)==Player(11) and GetUnitAbilityLevel(u,'Avul')==0 then
	    set u	=	null
	    return true
	else
		set u	=	null
		return false
	endif 
endfunction
//					技能刪除/給予
function Trig_tactic_QFunc013A takes nothing returns nothing
local unit	u	= GetEnumUnit()
    call UnitAddAbility(	u	,	'A00W'	)
    call UnitAddAbility(	u	,	'A0QI'	)
    call UnitAddAbility(	u	,	'A0R6'	) 
    
set u	= null 
endfunction
function Trig_tactic_QFunc017A takes nothing returns nothing
local unit	u	= GetEnumUnit()	
    call UnitRemoveAbility( u	,	'A00W'	)
    call UnitRemoveAbility( u	,	'A0QI'	)
    call UnitRemoveAbility( u	,	'A0R6'	) 
set u	= null 
endfunction
//					計時器
function Trig_tactic_QActions2 takes nothing returns nothing
	local	timer	t	=	GetExpiredTimer()
	local	integer	h2i	=	GetHandleId(t)
	local	group	g	=	LoadGroupHandle(YDHT,h2i,1)
		call PauseTimer(t)	
	
	    call ForGroup( g, function Trig_tactic_QFunc017A )
	    
    set g = null
	set t	=	null
endfunction
//					動作
function Trig_tactic_QActions takes nothing returns nothing
    local group g	
	local	player p	=	GetTriggerPlayer()
	local	integer i	=	GetPlayerId(p)	+	1
	local	timer t	
	local	boolexpr	f1	=	Condition(function Trig_tactic_QFunc012002002)
	local	boolexpr	f2	=	Condition(function Trig_tactic_QFunc0120020023)
	
		if i	<=	5	then
			set g	=	udg_tactic_Q_Group1
			set t	=	udg_tactic_Q_Timer1
		elseif	i	<=	10	then
		
			set g	=	udg_tactic_Q_Group2
			set t	=	udg_tactic_Q_Timer2
			
		endif	
		
	    //開啟堅守戰法時 挑取地圖上所有友方建築 給他們魔免和防禦加成
	    call ForGroup( g, function Trig_tactic_QFunc013A )
		//計時器
		call PauseTimer(t)
		call TimerStart(t,5.00,false,function Trig_tactic_QActions2)
    set g = null
    set p	=	null
    set t	=	null
endfunction
//===========================================================================
//	戰法 : 提升魔量
//===========================================================================
function Trig_tactic_MP_increaseActions takes nothing returns nothing
local unit u =	GetTriggerUnit()
local	player p =	GetOwningPlayer(u)
local	force f =	CreateForce()
local	string s =	"TRIGSTR_2785"
local	string s2 =	"TRIGSTR_11547"
local	integer i
local	integer iend
local	trigger ltt =	GetTriggeringTrigger()
local	playerstate	ps =	PLAYER_STATE_RESOURCE_LUMBER
	//添加玩家組進去
    call ForceAddPlayer(f, p)
            
    // 使用犒賞戰法時 判斷兵力是否大於30
    if GetUnitState(u, UNIT_STATE_MAX_MANA) >= 150.00 then
	    
	    	//15/11/9 更新內容 : 訊息只讓觸發玩家自己看 自己聽
	        call DisplayTimedTextToPlayer(p, 0, 0, bj_TEXT_DELAY_WARNING, " ")
	        call DisplayTimedTextToPlayer(p, 0, 0, bj_TEXT_DELAY_WARNING, s)
	        
		        if GetLocalPlayer()==p then
		        	call StartSound(bj_questWarningSound) 
		        endif	
  
              
    else
        if GetPlayerState(p, PLAYER_STATE_RESOURCE_LUMBER) >= IAbsBJ(udg_HIGH) then
	        
            // 兵力足夠 則以昇級的方式增加隊友戰法總法力
            //增加用 PLAYER_STATE_LUMBER_GATHERED ， 減少用 PLAYER_STATE_RESOURCE_LUMBER
            call SetPlayerState(p, ps, GetPlayerState(p, ps) + udg_HIGH)
            if IsPlayerAlly(p, Player(0)) then
                set i = 0
                set iend = 4
                loop
                    exitwhen i > iend
                    call AddPlayerTechResearched( Player(i), 'Rews', 1 )
                    set i = i + 1
                endloop
            else
                set i = 5
                set iend = 9
                loop
                    exitwhen i > iend
                    call AddPlayerTechResearched( Player(i), 'Rews', 1 )
                    set i = i + 1
                endloop
            endif
            
        else
        
            // 否則 顯示兵力不足
	        call DisplayTimedTextToPlayer(p, 0, 0, bj_TEXT_DELAY_WARNING, " ")
	        call DisplayTimedTextToPlayer(p, 0, 0, bj_TEXT_DELAY_WARNING, s2)
	        
		        if GetLocalPlayer()==p then
		        	call StartSound(bj_questWarningSound) 
		        endif	
        endif
    endif
    
    // 接著 讓所有玩者戰法進入CD狀態 即讓他們都施展此技能 先關閉觸發以免重覆觸發
    call DisableTrigger( ltt )
    
	    if IsPlayerAlly(p, Player(0)) then
	        set i = 0
	        set iend = 4
	        loop
	            exitwhen i > iend
	            call IssueImmediateOrder( udg_tactic_unit1[i], "channel" )
	            set i = i + 1
	        endloop
	    else
	        set i = 0
	        set iend = 4
	        loop
	            exitwhen i > iend
	            call IssueImmediateOrder( udg_tactic_unit2[i], "channel" )
	            set i = i + 1
	        endloop
	    endif
	    
    //重新開啟觸發
    call EnableTrigger( ltt )
	//clean
    call DestroyForce(f)
set u =	null
set p =	null
set f =	null
set ltt =	null
set ps =	null 
endfunction
//===========================================================================
//	戰法 : 提示戰法文本
//===========================================================================
function Trig_tacticActions takes nothing returns nothing
    local integer ydl_localvar_step = LoadInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76)
    set ydl_localvar_step = ydl_localvar_step + 3
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76, ydl_localvar_step)
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xECE825E7, ydl_localvar_step)
    // 當戰法啟動時 同時扣除其他戰法部隊的法力
    // 如果發動者隸屬織田軍 則扣除織田軍戰法(儲存在變數tactic_unit1)反之則扣除tactic_unit2
    if ((IsPlayerAlly(GetOwningPlayer(GetTriggerUnit()), Player(0)) == true)) then
        set udg_tmpPF = YDWEGetPlayersEnemiesNull(Player(0))
        // 給出訊息 提示敵方已發動戰法
        call DisplayTextToForce( udg_tmpPF, "TRIGSTR_6627" )
        call DestroyForce(udg_tmpPF)
        set udg_tmpPF = YDWEGetPlayersAlliesNull(Player(0))
        // 給出訊息 提示我方已發動戰法
        // 這裡應該要顯示出發動戰法的玩者 但是還沒有紀錄玩者英雄的變數
        call DisplayTextToForce( udg_tmpPF, ( "|CFF858585\"傳令：眾將注意!|R" + ( udg_S03_color_of_players[10] + ( GetHeroProperName(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) + ( "|R|CFF858585軍已經發動了" + ( udg_S03_color_of_players[10] + ( GetAbilityName(GetSpellAbilityId()) + "|R!" ) ) ) ) ) ) )
        call DestroyForce(udg_tmpPF)
        call SaveReal(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0xA1614B4D, GetUnitState(GetTriggerUnit(), UNIT_STATE_MANA))
        set bj_forLoopBIndex = 1
        set bj_forLoopBIndexEnd = 10
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            if ((GetSpellAbilityId() == udg_Tactics_Skill_List[GetForLoopIndexB()])) then
                set bj_forLoopAIndex = 0
                set bj_forLoopAIndexEnd = 4
                loop
                    exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
                    if ((GetOwningPlayer(udg_tactic_unit1[GetForLoopIndexA()]) != GetOwningPlayer(GetTriggerUnit()))) then
                        call SetUnitManaBJ( udg_tactic_unit1[GetForLoopIndexA()], ( LoadReal(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0xA1614B4D) - udg_Tactics_Skill_Mana[GetForLoopIndexB()] ) )
                    else
                    endif
                    set bj_forLoopAIndex = bj_forLoopAIndex + 1
                endloop
            else
            endif
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
    else
        set udg_tmpPF = YDWEGetPlayersAlliesNull(Player(0))
        // 給出訊息 提示敵方已發動戰法
        call DisplayTextToForce( udg_tmpPF, "TRIGSTR_6628" )
        call DestroyForce(udg_tmpPF)
        set udg_tmpPF = YDWEGetPlayersEnemiesNull(Player(0))
        // 給出訊息 提示我方已發動戰法
        call DisplayTextToForce( udg_tmpPF, ( "|CFF858585\"傳令：眾將注意!|R" + ( udg_S03_color_of_players[10] + ( GetHeroProperName(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]) + ( "|R|CFF858585軍已經發動了" + ( "|cff86cce8" + ( GetAbilityName(GetSpellAbilityId()) + "|R!" ) ) ) ) ) ) )
        call DestroyForce(udg_tmpPF)
        call SaveReal(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0xA1614B4D, GetUnitState(GetTriggerUnit(), UNIT_STATE_MANA))
        set bj_forLoopBIndex = 1
        set bj_forLoopBIndexEnd = 10
        loop
            exitwhen bj_forLoopBIndex > bj_forLoopBIndexEnd
            if ((GetSpellAbilityId() == udg_Tactics_Skill_List[GetForLoopIndexB()])) then
                set bj_forLoopAIndex = 0
                set bj_forLoopAIndexEnd = 4
                loop
                    exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
                    if ((GetOwningPlayer(udg_tactic_unit2[GetForLoopIndexA()]) != GetOwningPlayer(GetTriggerUnit()))) then
                        call SetUnitManaBJ( udg_tactic_unit2[GetForLoopIndexA()], ( LoadReal(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0xA1614B4D) - udg_Tactics_Skill_Mana[GetForLoopIndexB()] ) )
                    else
                    endif
                    set bj_forLoopAIndex = bj_forLoopAIndex + 1
                endloop
            else
            endif
            set bj_forLoopBIndex = bj_forLoopBIndex + 1
        endloop
    endif
    call FlushChildHashtable(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step)
endfunction
//===========================================================================
//	戰法 : F
//===========================================================================
function Trig_tacticActions_F takes nothing returns nothing
	local unit u1	=	GetTriggerUnit()
	local real x	=	GetSpellTargetX()
	local real y	=	GetSpellTargetY()
	local player	p	=	GetOwningPlayer(u1)
	local unit u3	
		call	GroupEnumUnitsInRange(udg_Group[6], x, y, 300.00, null)
		loop
			set	u3 =	FirstOfGroup(udg_Group[6])
			exitwhen	u3	==	null
			call GroupRemoveUnit(udg_Group[6],u3)
			
				if IsUnitEnemy(u3,p)	then
					call UnitDamageTargetBJ( u1, u3, 0.5, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID )
				endif
		endloop 
	set u1	=	null
	set u3	=	null
	set p	=	null
endfunction
//===========================================================================
//							條件判斷區
//==========================================================================
function Trig_ClickConditions takes nothing returns boolean
local integer id = GetSpellAbilityId()
local integer i = GetPlayerId(GetTriggerPlayer()) + 1
local boolean b = false
//test
//local unit u3 = CreateUnit(GetTriggerPlayer(),'h02K',GetSpellTargetX(),GetSpellTargetY(),0)
		//確定玩家組
		if i <= 5 then
			set b = false
		else
			set b = true
		endif
	//共同判斷區
	if	id != 'A0R8' and id != 'A0X1' and id != 'A0U5' and id != 'A0X3' and id != 'A0X2'	then
		call	Trig_tacticActions()
	endif
	
	//個別判斷區
    if id == 'A0X1' then
	    call Trig_ClickActions_for_attack(b)
	elseif id == 'A0U5' then
		call Trig_ClickActions_for_Retreat(b)
	elseif id == 'A0X3' then
		call Trig_ClickActions_for_Corver(b)
	elseif id == 'A0X2' then
		call Trig_ClickActions_for_Disappear(b)
	//戰法Q
	elseif id == 'A0QG' then 
	    call	Trig_tactic_QActions()
	//戰法X
	elseif id == 'A0QD' then 
	    call	Trig_X_TacticsActions() 
	//戰法Z
	elseif id == 'A0QC' or id == 'A0QA' then 
	    call	Trig_tactic_FActions() 
	//提升戰法魔量
	elseif id == 'A0R8' then 
	    call	Trig_tactic_MP_increaseActions()	
	//戰法F
	elseif id == 'A0QF' then 
	    call	Trig_tacticActions_F() 
    endif
    return false
endfunction
function InitTrig_Click_Timer takes nothing returns nothing
local integer i
local	boolexpr	f1	=	Condition(function Trig_tactic_QFunc012002002)
local	boolexpr	f2	=	Condition(function Trig_tactic_QFunc0120020023)	
local timer t	
local	integer h2i
	//初始化 for 戰法-Q	
	set udg_tactic_Q_Timer1	=	CreateTimer()
	set t =	udg_tactic_Q_Timer1
	set h2i =	GetHandleId(t)
	set udg_tactic_Q_Group1	=	CreateGroup() 
	call GroupEnumUnitsInRect(udg_tactic_Q_Group1, bj_mapInitialPlayableArea, f1)
	call SaveGroupHandle(YDHT,h2i,1,udg_tactic_Q_Group1)
	set udg_tactic_Q_Timer2	=	CreateTimer()
	set t =	udg_tactic_Q_Timer2
	set h2i =	GetHandleId(t)
	
	set udg_tactic_Q_Group2	=	CreateGroup()
	call GroupEnumUnitsInRect(udg_tactic_Q_Group2, bj_mapInitialPlayableArea, f2)
	call SaveGroupHandle(YDHT,h2i,1,udg_tactic_Q_Group2)
	call DestroyBoolExpr(f1)
	call DestroyBoolExpr(f2)
	//初始化 排行榜
    set udg_ldb[0] = CreateLeaderboard()
    call LeaderboardSetLabel(udg_ldb[0], "")
    
    set udg_ldb[1] = CreateLeaderboard()
    call LeaderboardSetLabel(udg_ldb[1], "")
	//0 1 2 3 4
	set i = 0
	loop
		exitwhen i > 4
		call PlayerSetLeaderboard(Player(i), udg_ldb[0])
		call LeaderboardDisplay(udg_ldb[0], false)
		set i = i + 1
	endloop
	//5 6 7 8 9
	set i = 5
	loop
		exitwhen i > 9
		call PlayerSetLeaderboard(Player(i), udg_ldb[1])
		call LeaderboardDisplay(udg_ldb[1], false)
		set i = i + 1
	endloop
	//初始化 需要用的計時器
	set udg_ldb_T[0] = CreateTimer()
	set udg_ldb_T[1] = CreateTimer()
	//clean
	call DestroyTimer(GetExpiredTimer())	
set f1	=	null
set f2	=	null 
set t	=	null
endfunction
function InitTrig_Click takes nothing returns nothing
		//註冊
	    set gg_trg_Click=CreateTrigger()
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0122, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0356, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0357, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0359, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0358, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0599, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0600, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0601, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0602, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerRegisterUnitEvent(gg_trg_Click, gg_unit_n00R_0603, EVENT_UNIT_SPELL_EFFECT)
	    call TriggerAddCondition(gg_trg_Click, Condition(function Trig_ClickConditions))
		//註冊排行榜
		call TimerStart(CreateTimer(),0.01,false,function InitTrig_Click_Timer )
endfunction
globals
leaderboard array udg_ldb
timer array udg_ldb_T
endglobals
globals
timer udg_tactic_Q_Timer1
timer udg_tactic_Q_Timer2 
group udg_tactic_Q_Group1	
group udg_tactic_Q_Group2	
endglobals	//===========================================================================
// Trigger: MO
//===========================================================================
function Trig_MOActions takes nothing returns nothing
    call PlaySoundBJ( gg_snd_GoodJob )
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_9953" )
    // ---------------------------------
    set udg_MO_B = true
    // ---------------------------------
    call DisableTrigger( gg_trg_CP_revival_start )
    call DisableTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_MO takes nothing returns nothing
    set gg_trg_MO = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_MO, Player(0), "-mo", true )
    call TriggerAddAction(gg_trg_MO, function Trig_MOActions)
endfunction
//===========================================================================
// Trigger: HIGH
//===========================================================================
function Trig_HIGHActions takes nothing returns nothing
    set udg_HIGH = -30
    // ---------------------------------
    call DisplayTextToForce( GetPlayersAll(), "TRIGSTR_7523" )
    // ---------------------------------
    call PlaySoundBJ( gg_snd_GoodJob )
    // ---------------------------------
    set udg_die_money = 0
    set udg_Pay_money = ( udg_Pay_money + 18 )
    set udg_Pay_Money2 = ( udg_Pay_Money2 + 18 )
    set udg_High_Boolen = true
    // ---------------------------------
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        call SetPlayerHandicapXPBJ( ConvertedPlayer(GetForLoopIndexA()), 150.00 )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // ---------------------------------
    call DisableTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_HIGH takes nothing returns nothing
    set gg_trg_HIGH = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_HIGH, Player(0), "-HIGH", true )
    call TriggerAddAction(gg_trg_HIGH, function Trig_HIGHActions)
endfunction
//===========================================================================
// Trigger: SM
//===========================================================================
function Trig_SMActions takes nothing returns nothing
    call PlaySoundBJ( gg_snd_GoodJob )
    set udg_CRAZY_B = true
    set udg_SM_B=true
    call DisplayTextToForce( GetPlayersAll(), ( "<<已經啟動 |cffffcc00SM(相同武將)|r模式>>" + ",雙方陣營可以選擇一名相同武將。" ) )
    call DisableTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_SM takes nothing returns nothing
    set gg_trg_SM = CreateTrigger()
    call TriggerRegisterPlayerChatEvent( gg_trg_SM, Player(0), "-SM", true )
    call TriggerAddAction(gg_trg_SM, function Trig_SMActions)
endfunction
//===========================================================================
// Trigger: NEW
//===========================================================================
function Trig_NEWActions takes nothing returns nothing
		if GetLocalPlayer()==GetTriggerPlayer()then
			if udg_computer_B == false then
	        	// Use only local code (no net traffic) within this block to avoid desyncs.
	        	call TimerDialogDisplay(bj_lastCreatedTimerDialog, true) 
				set udg_computer_B = true
				call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"|c0000FF00開啟完整計分板")
			else
				call TimerDialogDisplay(bj_lastCreatedTimerDialog, false)
				set udg_computer_B = false
				call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"|c00FFFF00開啟簡易計分板")
			endif 
				
		endif 
endfunction
//===========================================================================
function InitTrig_NEW takes nothing returns nothing
    set gg_trg_NEW = CreateTrigger()
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(0), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(1), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(2), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(3), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(4), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(5), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(6), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(7), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(8), "-NEW", true )
        call TriggerRegisterPlayerChatEvent( gg_trg_NEW, Player(9), "-NEW", true )
    call TriggerAddCondition(gg_trg_NEW, function Trig_NEWActions)
endfunction
//===========================================================================
// Trigger: Hero Spell Item Ability
//===========================================================================
//大炎上之書
function Trig_Item01Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
		//i like this change for sign
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G', x , y ,0)
		call UnitApplyTimedLife(u3,'BHwe',0.01)
		//effectf
		set u3 = CreateUnit(GetOwningPlayer(u1),'h01E', x , y ,0)
        call UnitApplyTimedLife(u3,'BHwe',9.00)
        call UnitAddAbility(u3,'A0CC')
        call IssuePointOrder(u3,"rainoffire",x,y)
		//demage
		set u3 = CreateUnit(GetOwningPlayer(u1),'h01E', x , y ,0)
		call SetUnitScalePercent( u3, 300.00, 300.00, 300.00 )
    	call SetUnitFlyHeight( u3, 850.00, 0.00 )
        call UnitApplyTimedLife(u3,'BHwe',9.00)
        call UnitAddAbility(u3,'A08X')
        call IssuePointOrder(u3,"healingspray",x,y)
set u1 = null
set u3 = null
endfunction
//吹雪護肩
function Trig_ice_shieldActions_timer2 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
	call UnitMakeAbilityPermanent( u1, false, 'A0R1' )
	call UnitRemoveAbility(u1,'A0R1')
		call FlushChildHashtable(udg_Item_H,h2i)
		call DestroyTimer(t)
set t = null
set u1 = null
endfunction
function Trig_ice_shieldActions_timer1 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
	call IssueNeutralImmediateOrderById( GetOwningPlayer(u1), u1, 852589 )
	call TimerStart(t,15.00,false,function Trig_ice_shieldActions_timer2)
set t = null
set u1 = null
endfunction
function Trig_ice_shieldActions takes nothing returns nothing
local timer t = CreateTimer()
local unit u1 = GetTriggerUnit()
local integer h2i = GetHandleId(t)
	call UnitAddAbility(u1,'A0R1')
	call UnitMakeAbilityPermanent( u1, true, 'A0R1' )
		call SaveUnitHandle(udg_Item_H,h2i,1,u1)
		call TimerStart(t,0.01,false,function Trig_ice_shieldActions_timer1)
set u1 = null
set t = null
endfunction
//狂風之書
function Trig_Item02Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a = Atan2(GetSpellTargetY()-y,GetSpellTargetX()-x )
local real x1 = x + 10.00*Cos(a)
local real y1 = y + 10.00*Sin(a)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
    call UnitApplyTimedLife(u3,'BHwe',9.00)
    call UnitAddAbility(u3,'A0CF')
    call IssuePointOrder(u3,"stampede",x1,y1)
set u1 = null
set u3 = null
endfunction
//水技之書
function Trig_item023Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local player p = GetOwningPlayer(u1)
local real x1
local real y1
local real a
local integer i
local unit ydl_unit
	//effect
	set i = 1
    loop
        exitwhen i > 4
        set a = 90.00 * I2R(i) * bj_DEGTORAD
		set x1 = x + 160.00*Cos(a)
		set y1 = y + 160.00*Sin(a)	
		call DestroyEffect( AddSpecialEffect("war3mapImported\\aquaspikeversion2.mdx", x1 , y1) )
       	set i = i + 1
    endloop
	//擊退
	call GroupEnumUnitsInRange(udg_Group[0], x, y, 350.00, null)
	loop
		set ydl_unit = FirstOfGroup(udg_Group[0])
		exitwhen (ydl_unit == null)
    	call GroupRemoveUnit(udg_Group[0], ydl_unit)
    		if IsUnitEnemy(ydl_unit,p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false and IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false and GetUnitPointValue(ydl_unit) != 1 then
    			call UnitDamageTarget(u1, ydl_unit, 300.00, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
				set x1 = GetUnitX(ydl_unit)
				set y1 = GetUnitY(ydl_unit)
				set udg_KnockBack_Angle = Atan2(y1-y,x1-x)*bj_RADTODEG
				set udg_KnockBack_Boolean1 = false
			    set udg_KnockBack_Dist = 25.00
			    set udg_KnockBack_Time = 1.85
			    set udg_KnockBack_Rate = 0.90
			    set udg_KnockBack_Unit = ydl_unit
			    set udg_KnockBack_Interval = 0.01
			    set	udg_KnockBack_Trigger	= null
			    call TriggerExecute(gg_trg_KnockBack)
   			endif
	endloop
	
set u1 = null
set p = null
set ydl_unit = null
endfunction
//鬼丸國綱
function Trig_Item03Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a
local real x1
local real y1
local unit u3
local integer i
local player p = GetOwningPlayer(u1)
set i = 1
    loop
        exitwhen i > 18
        set a = 20.00 * I2R(i) * bj_DEGTORAD
		set x1 = x + 200.00*Cos(a)
		set y1 = y + 200.00*Sin(a)
		set u3 = CreateUnit(p,'h01E',x,y,0)
    	call UnitApplyTimedLife(u3,'BHwe',5.00)
    	call UnitAddAbility(u3,'A0CQ')
    	call IssuePointOrder(u3,"impale",x1,y1)
       	set i = i + 1
    endloop
set u1 = null
set u3 = null
set p = null
endfunction
//爆裂彈
function Trig_Item04Actions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local player p = GetOwningPlayer(u1)
	//effect
	call DestroyEffect( AddSpecialEffect("Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl", x,y) )
 	//demage
 	call GroupEnumUnitsInRange(udg_Group[0], x, y, 440.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null)
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( IsUnitEnemy(ydl_unit,p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
	  				call UnitDamageTargetBJ( u1, ydl_unit, 400.00, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
       			endif
    	endloop
set u1 = null
set p = null
set ydl_unit = null
endfunction
//清酒
function Trig_Item05Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real heal = GetUnitStatePercent(u1, UNIT_STATE_LIFE, UNIT_STATE_MAX_LIFE)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
    call UnitApplyTimedLife(u3,'BHwe',9.00)
    call UnitAddAbility(u3,'A0JV')
		//level check
		if heal < 50.00 then
			call SetUnitAbilityLevel( u3, 'A0JV', 2 )
		endif
	call IssueTargetOrder( u3, "bloodlust", u1 )
set u1 = null
set u3 = null
endfunction
//長捲
function Trig_Item06Actions_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
	call UnitMakeAbilityPermanent( u1, false, 'A0L5' )
	call UnitRemoveAbility( u1, 'A0L5' )
		call FlushChildHashtable(udg_Item_H,h2i)
		call DestroyTimer(t)
set t = null
set u1 = null
endfunction
function Trig_Item06Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local timer t = CreateTimer()
    call SetUnitState( u1, UNIT_STATE_LIFE, ( 0.90 * GetUnitState(u1, UNIT_STATE_LIFE) ))
    call UnitAddAbility( u1, 'A0L5' )
    call UnitMakeAbilityPermanent( u1, true, 'A0L5' )
 		call SaveUnitHandle(udg_Item_H,GetHandleId(t),1,u1)
    	call TimerStart(t,15.00,false,function Trig_Item06Actions_timer)
set u1 = null
set t = null
endfunction
//鬼之籠手
function Trig_Item07Actions_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
	call KillUnit( LoadUnitHandle(udg_Item_H,h2i,1) )
call FlushChildHashtable(udg_Item_H,h2i)
call DestroyTimer(t)
set t = null
endfunction
function Trig_Item07Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local timer t = CreateTimer()
	call SetUnitState( u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + GetUnitState(u2, UNIT_STATE_LIFE))
	call SaveUnitHandle(udg_Item_H,GetHandleId(t),1,u2)
	call TimerStart(t,0.01/100,false,function Trig_Item07Actions_timer)
set u1 = null
set u2 = null
set t = null
endfunction
//法術書
function Trig_Item10Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',1.00)
	
		//check Ally
		if IsUnitAlly(u1, GetOwningPlayer(u2)) then
			call UnitAddAbility( u3, 'A0BZ' )
			call IssueTargetOrder( u3, "rejuvination", u2 )
		else
			call UnitAddAbility( u3, 'A0BY' )
	        call IssueTargetOrder( u3, "slow", u2 )
		endif
		
set u1 = null
set u3 = null
endfunction
//無上雷暴之書
function Trig_Item11Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local unit u3
	set u3 = CreateUnit(GetOwningPlayer(u1),'h01E', x , y ,0)
    call UnitApplyTimedLife(u3,'BHwe',15.00)
    call UnitAddAbility(u3,'A092')
    call IssuePointOrder(u3,"deathanddecay",x,y)
set u1 = null
set u3 = null
endfunction
//吉光骨食
function Trig_Item12Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real HP = GetUnitState(u2, UNIT_STATE_LIFE)
	call UnitDamageTargetBJ( u1, u2, 500.00, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID )
		if HP > 500.00 then
			call SetUnitState( u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + 500.00 )
		else
			call SetUnitState( u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + HP )
		endif
set u1 = null
set u2 = null
endfunction
//怒雷之書
function Trig_Item15C______uActions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local player p = GetOwningPlayer(u1)
	//decrease mana
	call SetUnitState( u1, UNIT_STATE_MANA, GetUnitState(u1, UNIT_STATE_MANA) -75.00)
	//demage
 	call GroupEnumUnitsInRange(udg_Group[0], x, y, 405.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null)
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( IsUnitEnemy(ydl_unit,p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
	  				call UnitDamageTargetBJ( u1, ydl_unit, 190.00, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
	  				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\LightningBolt\\LightningBoltMissile.mdl",ydl_unit,"chest"))
       			endif
    	endloop
set u1 = null
set p = null
set ydl_unit = null
endfunction
function Trig_Item15AActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
	if udg_item_strom_book[i] then
		set udg_item_strom_book[i] = false
        call UnitRemoveAbility( u1, 'A0M9' )
	else
		set udg_item_strom_book[i] = true
		call UnitAddAbility( u1, 'A0M9' )
		call UnitMakeAbilityPermanent( u1, true, 'A0M9' )
	endif
set u1 = null
endfunction
//預魂
function Trig_Item16Actions_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
	call UnitRemoveAbility( u1, 'A0G4' )
		call FlushChildHashtable(udg_Item_H,h2i)
		call DestroyTimer(t)
set t = null
set u1 = null
endfunction
function Trig_Item16Actions takes nothing returns nothing
local unit u1 = GetSpellTargetUnit()
local timer t = CreateTimer()
    call UnitAddAbility( u1, 'A0G4' )
 		call SaveUnitHandle(udg_Item_H,GetHandleId(t),1,u1)
    	call TimerStart(t,12.00,false,function Trig_Item16Actions_Timer)
set u1 = null
set t = null
endfunction
//制魔腹卷
function Trig_Item17Actions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local player p = GetOwningPlayer(u1)
local unit u3
	set u3 = CreateUnit(p,'h01E', x , y ,0)
    call UnitApplyTimedLife(u3,'BHwe',2.00)
    call UnitAddAbility(u3,'Aam2')
	//demage
 	call GroupEnumUnitsInRange(udg_Group[0], x, y, 500.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null)
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( IsUnitAlly(ydl_unit,p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
					call IssueTargetOrder( u3, "antimagicshell", ydl_unit )
       			endif
    	endloop
set u1 = null
set p = null
set ydl_unit = null
set u3 = null
endfunction
function Trig_omamori_CheckConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'ANss'
endfunction
//禦守系統
function Trig_omamori_CheckActions1_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
local player	p =	GetOwningPlayer(u1)
local integer i =	GetPlayerId(p) +	1
	//clean
	call FlushChildHashtable(udg_Item_H,h2i)
	call DestroyTimer(t)
	set udg_omamori_Check[i] = false
	
set t = null
set u1 = null
set p =	null
endfunction
function Trig_omamori_CheckActions1 takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local timer t = CreateTimer()
local player	p	=	GetOwningPlayer(u1)
local integer i =	GetPlayerId(p) +	1
local real time=	(0.0002)
    set udg_omamori_Check[i] = true
    //init
 	call SaveUnitHandle(udg_Item_H,GetHandleId(t),1,u1)
    call TimerStart(t,time,false,function Trig_omamori_CheckActions1_timer)
    	
set u1 = null
set t = null
set p	=	null
endfunction
//禦魔護符、南蠻胴具足
function Trig_Item37Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',1.00)
	call UnitAddAbility( u3, 'A0PH' )
	call IssueTargetOrder( u3, "antimagicshell", u1 )
set u1 = null
set u3 = null
endfunction
//神直毘御劍
function Trig_Item24Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
	call SetUnitX(u1,GetUnitX(u2))
	call SetUnitY(u1,GetUnitY(u2))
	call IssueTargetOrder( u1, "attack", u2 )
set u1 = null
set u2 = null
endfunction
//火計之書
function Trig_Item26Actions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local player p = GetOwningPlayer(u1)
 	call GroupEnumUnitsInRange(udg_Group[0], x, y, 800.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null)
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( IsUnitEnemy(ydl_unit,p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
					call UnitDamageTargetBJ( u1, ydl_unit, 560.00, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
       			endif
    	endloop
set u1 = null
set p = null
set ydl_unit = null
endfunction
//浪人十手 1~3階
function Trig_Item29Actions takes real dmg returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real x = GetUnitX(u2)
local real y = GetUnitY(u2)
local real x1
local real y1
local real a
local integer i
	//effect
	set i = 1
	    loop
            exitwhen i > 8
				set a = 45.00 * I2R(i) * bj_DEGTORAD
				set x1 = x + 100.00*Cos(a)
				set y1 = y + 100.00*Sin(a)
				call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Human\\Feedback\\ArcaneTowerAttack.mdl",x1,y1) )
            set i = i + 1
        endloop
	//damage
	call UnitDamageTargetBJ( u1, u2, dmg + 0.17 * GetUnitState(u1, UNIT_STATE_MAX_MANA ) , ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
set u1 = null
set u2 = null
endfunction
//村正
function Trig_Item39Actions_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
    call UnitMakeAbilityPermanent( u1, false, 'A0QX' )
    call UnitRemoveAbility( u1, 'A0QX' )
		call FlushChildHashtable(udg_Item_H,h2i)
		call DestroyTimer(t)
set t = null
set u1 = null
endfunction
function Trig_Item39Actions takes nothing returns nothing
local unit u1 = GetSpellTargetUnit()
local timer t = CreateTimer()
    call UnitAddAbility( u1, 'A0QX' )
    call UnitMakeAbilityPermanent( u1, true, 'A0QX' )
 		call SaveUnitHandle(udg_Item_H,GetHandleId(t),1,u1)
    	call TimerStart(t,15.00,false,function Trig_Item39Actions_timer)
set u1 = null
set t = null
endfunction
//大典太光世_銘刀
function Trig_Item40Actions takes nothing returns nothing
    call UnitDamageTargetBJ( GetTriggerUnit(), GetSpellTargetUnit(), ( 3.50 * I2R(GetHeroInt(GetTriggerUnit(), true)) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNIVERSAL )
endfunction
//落石之書
function Trig_item010_Actions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local real x1
local real y1
local real a = Atan2( y-GetUnitY(u1),x-GetUnitX(u1) )
local player p = GetOwningPlayer(u1)
local unit u3 
	set x1 = x + 76.00*Cos(a + 90.00*bj_DEGTORAD)
	set y1 = y + 76.00*Sin(a + 90.00*bj_DEGTORAD)
	set u3 = CreateUnit(p,'hrtt',x1,y1,270)
	call UnitApplyTimedLife(u3,'BHwe',6.00)
	set x1 = x + 76.00*Cos(a - 90.00*bj_DEGTORAD)
	set y1 = y + 76.00*Sin(a - 90.00*bj_DEGTORAD)
	set u3 = CreateUnit(p,'hrtt',x1,y1,270)
	call UnitApplyTimedLife(u3,'BHwe',6.00)
	 	call GroupEnumUnitsInRange(udg_Group[0], x, y, 265.00, null)
	    	loop
	    		set ydl_unit = FirstOfGroup(udg_Group[0])
	    		exitwhen (ydl_unit == null)
	        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
	        		if ( IsUnitEnemy(ydl_unit,p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
	    				call UnitDamageTargetBJ( u1, ydl_unit, 150.00, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
	       			endif
	    	endloop
set u1 = null
set p = null
set ydl_unit = null
set u3 = null
endfunction
//備前兼光
function Trig_Item23Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',1.00)
	call UnitAddAbility( u3, 'A0MR' )
	call IssueTargetOrder( u3, "innerfire", u1 )
set u1 = null
set u3 = null
endfunction
//逝者之笏
function Trig_item035_Actions_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
local unit u2 = LoadUnitHandle(udg_Item_H,h2i,2)
local player	p =	GetOwningPlayer(u2)
local integer i =	GetPlayerId(p)	+	1
local integer hero_int	=	GetHeroInt(u1,true)
local integer DMG_I =	R2I((I2R(hero_int)/20.00))
local real DMG_R
	//clean	
	call FlushChildHashtable(udg_Item_H,h2i)
	call DestroyTimer(t)
	if(DMG_I>=10)then
		set DMG_I=10
	endif	
	
		//如果有御守效果 就沒有用
		if udg_omamori_Check[i]==false then
			
			set DMG_R=(GetUnitState(u2,UNIT_STATE_LIFE)*(0.45+(0.03*I2R(DMG_I))))
			call UnitDamageTargetBJ(u1,u2,DMG_R,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL)
			
		else
			
			set DMG_R=(GetUnitState(u2,UNIT_STATE_LIFE)*(0.225+(0.015*I2R(DMG_I))))
			call UnitDamageTargetBJ(u1,u2,DMG_R,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL) 
			
		endif
	
	//避免特殊情況用
	set udg_omamori_Check[i] = false
set t = null
set u1 = null
set p =	null
set u2 =	null
endfunction
function Trig_item035_Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local timer t = CreateTimer()
local real	time	=	0.0001
		call SaveUnitHandle(udg_Item_H,GetHandleId(t),1,u1)
		call SaveUnitHandle(udg_Item_H,GetHandleId(t),2,u2)
    	call TimerStart(t,time,false,function Trig_item035_Actions_Timer)
set u1 = null
set u2 = null
set t = null
endfunction
//天之叢雲
function Trig_item032_Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real x = GetUnitX(u2)
local real y = GetUnitY(u2)
local unit u3 
local integer i 
	//check level
	set i=R2I((I2R(GetHeroInt(u1,true))/40.00))
	set i=(i+1)
		if i>=8 then
			set i=8
		endif
		
	set u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
	call UnitApplyTimedLife(u3,'BTLF',3.00)
    call ShowUnit(u3, false)
	call UnitAddAbility(u3,'A0MW')
	call SetUnitAbilityLevel(u3,'A0MW',i)
	call IssueTargetOrder(u3,"hex",u2)
	call CreateTextTagUnitBJ((R2S((I2R(i)*0.60))+" sec"),u2,0,9.00,50.00,50.00,90.00,0)
	call ShowTextTagForceBJ(false,GetLastCreatedTextTag(),YDWEGetPlayersEnemiesNull(GetOwningPlayer(u1)))
	call SetTextTagPermanent(GetLastCreatedTextTag(),false)
	call SetTextTagVelocityBJ(GetLastCreatedTextTag(),64,90)
	call SetTextTagLifespan(GetLastCreatedTextTag(),5.00)
	call SetTextTagFadepoint(GetLastCreatedTextTag(),2.50)
set u1 = null
set u2 = null
set u3 = null
endfunction
//山之捲
function Trig_item018_Actions_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(udg_Item_H,h2i,1)
    call UnitMakeAbilityPermanent( u1, false, 'A0HQ' )
    call UnitRemoveAbility( u1, 'A0HQ' )
		call FlushChildHashtable(udg_Item_H,h2i)
		call DestroyTimer(t)
set t = null
set u1 = null
endfunction
function Trig_item018_Actions takes nothing returns nothing
local unit u1 = GetSpellTargetUnit()
local timer t = CreateTimer()
	call UnitAddAbility( u1, 'A0HQ' )
    call UnitMakeAbilityPermanent( u1, true, 'A0HQ' )
 		call SaveUnitHandle(udg_Item_H,GetHandleId(t),1,u1)
    	call TimerStart(t,4.90,false,function Trig_item018_Actions_timer)
set u1 = null
set t = null
endfunction
//久棄邪物
function Trig_Item21AActions takes nothing returns nothing
    if GetSpellAbilityId() == 'A0MN' then
        call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Undead\\CarrionSwarm\\CarrionSwarmDamage.mdl", GetTriggerUnit(), "chest") )
        call UnitDamageTargetBJ( GetTriggerUnit(), GetSpellTargetUnit(), ( 50.00 * I2R(GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'clsd'))) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_FIRE )
        call SetUnitLifeBJ( GetTriggerUnit(), ( GetUnitState(GetTriggerUnit(), UNIT_STATE_LIFE) + ( ( I2R(GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'clsd'))) * 50.00 ) / 2.00 ) ) )
        call SetItemCharges( YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'clsd'), 0 )
    else
        call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\ZigguratMissile\\ZigguratMissile.mdl", GetTriggerUnit(), "overhead") )
        if ((I2R(GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'clsd'))) < 6.00)) then
            call SetItemCharges( YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'clsd'), ( GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'clsd')) + 1 ) )
        else
        endif
    endif
endfunction
//闇牙黃泉津
function Trig_Item25CActions takes nothing returns nothing
    if GetSpellAbilityId() == 'A0MV' then
        set udg_A_common_TemP[101] = GetUnitLoc(GetSpellTargetUnit())
        call UnitDamageTargetBJ( GetTriggerUnit(), GetSpellTargetUnit(), ( 90.00 * I2R(GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'sor8'))) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_FIRE )
        call SetUnitLifeBJ( GetTriggerUnit(), ( GetUnitState(GetTriggerUnit(), UNIT_STATE_LIFE) + ( ( I2R(GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'sor8'))) * 90.00 ) / 2.00 ) ) )
        call SetItemCharges( YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'sor8'), 0 )
        set bj_forLoopAIndex = 1
        set bj_forLoopAIndexEnd = 5
        loop
            exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
            set udg_A_common_TemP[102] = PolarProjectionBJ(udg_A_common_TemP[101], 120.00, (((72.00))*( I2R(GetForLoopIndexA()))))
            call AddSpecialEffectLocBJ( udg_A_common_TemP[102], "Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl" )
            call DestroyEffect( GetLastCreatedEffectBJ() )
            call RemoveLocation( udg_A_common_TemP[102] )
            set bj_forLoopAIndex = bj_forLoopAIndex + 1
        endloop
        call RemoveLocation( udg_A_common_TemP[101] )
    else
        call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\ZigguratMissile\\ZigguratMissile.mdl", GetTriggerUnit() ,"overhead") )
        if ((I2R(GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'sor8'))) < 6.00)) then
            call UnitAddAbilityBJ( 'A0MU', GetTriggerUnit() )
            call SetItemCharges( YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'sor8'), ( GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'sor8')) + 1 ) )
            call SetUnitAbilityLevel( GetTriggerUnit(), 'A0MU', ( GetItemCharges(YDWEGetItemOfTypeFromUnitBJNull(GetTriggerUnit(), 'sor8')) + 1 ) )
        else
        endif
    endif
endfunction
///////////////////////////////////////////////////////
//                條件
///////////////////////////////////////////////////////
function Trig_Hero_Spell_Item_Ability takes nothing returns nothing
local integer i = GetSpellAbilityId()
local unit u	= GetTriggerUnit()	
////////////////////////////////////////////////////////////////////
//                      至頂區                             'A0M9'
////////////////////////////////////////////////////////////////////
	//怒雷之書:damage + check 一定要放至頂
	if	GetUnitAbilityLevel(u, 'A0M9') > 0 and i != 'A0GK' and i != 'A0VW' and i !='A0AE' and i !='A021' then
		call Trig_Item15C______uActions()
	endif
	//備前兼光
	if GetUnitAbilityLevel(u, 'A0MQ') > 0 and i != 'A001' and i != 'A0JT' and i != 'A0B1' then
		call Trig_Item23Actions()
	endif	
	//久棄邪物
	if GetUnitAbilityLevel(u, 'A0MN') > 0 then
		call Trig_Item21AActions()
	endif	
	//闇牙黃泉津
    if GetUnitAbilityLevel(u, 'A0MV') > 0 and i != 'A001' and i!= 'A0JT' and i != 'A0B1' and i != 'A08K' and i != 'A0AE' and i != 'A02R' then
    	call Trig_Item25CActions()
	endif
////////////////////////////////////////////////////////////////////
//                      判斷區                             
////////////////////////////////////////////////////////////////////
	//怒雷之書 check
	if i == 'A0GK' then
		call Trig_Item15AActions()
	//落石之書
	elseif i == 'A0PC' then
		call Trig_item010_Actions()
	//禦守系統
	elseif i == 'ANss' then
		call Trig_omamori_CheckActions1()
	//山之捲
	elseif i == 'A0PB' then
		call Trig_item018_Actions()
	//逝者之笏
	elseif i == 'A0P8' then
		call Trig_item035_Actions()
	//禦魔護符、南蠻胴具足
	elseif i == 'A0N5' then
		call Trig_omamori_CheckActions1()
		call Trig_Item37Actions()
	//法術書
	elseif i == 'A0GX' then
		call Trig_Item10Actions()
	//天之叢雲
	elseif i == 'A0MX' then
		call Trig_item032_Actions()
	//鬼丸國綱
	elseif i == 'A0CP' then
		call Trig_Item03Actions()
	//浪人十手 1~3階
	elseif i == 'A097' then
		call Trig_Item29Actions(300.00)
	elseif i == 'A0N0' then
		call Trig_Item29Actions(400.00)
	elseif i == 'A0PA' then
		call Trig_Item29Actions(500.00)
	//水技之書
	elseif i == 'A0CX' then
		call Trig_item023Actions()
	//火計之書
	elseif i == 'A0C9' then
		call Trig_Item26Actions()
	//狂風之書
	elseif i == 'A0CE' then
		call Trig_Item02Actions()
	//吉光骨食
	elseif i == 'ACfd' then
		call Trig_Item12Actions()
	//村正
	elseif i == 'A0QY' then
		call Trig_Item39Actions()
	//大炎上之書
	elseif i == 'A0CB' then
		call Trig_Item01Actions()
	//無上雷暴之書
	elseif i == 'A090' then
		call Trig_Item11Actions()
	//神直毘御劍
	elseif i == 'A0MS' then
		call Trig_Item24Actions()
	//御魂
	elseif i == 'A0DR' then
		call Trig_Item16Actions()
	//長捲
	elseif i == 'A0D8' then
		call Trig_Item06Actions()
	//吹雪護肩
	elseif i == 'A0I3' then
		call Trig_ice_shieldActions()
	//制魔腹卷
	elseif i == 'A08L' then
		call Trig_Item17Actions()
	//爆裂彈
	elseif i == 'A0DI' then
		call Trig_Item04Actions()
	//清酒
	elseif i == 'A0JS' then
		call Trig_Item05Actions()
	//鬼之籠手
	elseif i == 'A0DQ' then
		call Trig_Item07Actions()
	//大典太光世_銘刀
	elseif i == 'A0OW' then
		call Trig_Item40Actions()
	endif
	
set u	=	null
endfunction
//////////////////////////////////////////////////////////
//IDEA: 根據使用物品技能的 CD 使用率 來做判斷的安排
//      來達到 省效率的方法
//      這樣省下效率 達到百倍
//////////////////////////////////////////////////////////
//===========================================================================
function InitTrig_Hero_Spell_Item_Ability takes nothing returns nothing
    set gg_trg_Hero_Spell_Item_Ability = CreateTrigger()
    call TriggerAddCondition(gg_trg_Hero_Spell_Item_Ability, Condition(function Trig_Hero_Spell_Item_Ability))
endfunction
//===========================================================================
// Trigger: Unit Drop or Sell Item
//===========================================================================
function Trig_Unit_Drop_or_Sell_ItemConditions takes nothing returns boolean
    return (((GetItemTypeId(GetManipulatedItem()) == 'sor8') or (GetItemTypeId(GetManipulatedItem()) == 'tmsc')) and (IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) == true))
endfunction
function Trig_Unit_Drop_or_Sell_ItemActions takes nothing returns nothing
    local integer i = 0
    if ((GetItemTypeId(GetManipulatedItem()) == 'sor8')) then
        call UnitRemoveAbility( GetTriggerUnit(), 'A0MU' )
    else
        if ((GetItemTypeId(GetManipulatedItem()) == 'tmsc')) then
            set bj_forLoopAIndex = 1
            set bj_forLoopAIndexEnd = 6
            loop
                exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
                if ((GetItemTypeId(UnitItemInSlotBJ(GetTriggerUnit(), GetForLoopIndexA())) == 'tmsc')) then
                    set i = 1
                else
                endif
                set bj_forLoopAIndex = bj_forLoopAIndex + 1
            endloop
            if ((i == 1)) then
                call UnitRemoveAbility( GetTriggerUnit(), 'A0M9' )
                set udg_item_strom_book[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] = false
            else
            endif
        else
        endif
    endif
endfunction
//===========================================================================
function InitTrig_Unit_Drop_or_Sell_Item takes nothing returns nothing
    set gg_trg_Unit_Drop_or_Sell_Item = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Unit_Drop_or_Sell_Item, EVENT_PLAYER_UNIT_DROP_ITEM )
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Unit_Drop_or_Sell_Item, EVENT_PLAYER_UNIT_SELL_ITEM )
    call TriggerAddCondition(gg_trg_Unit_Drop_or_Sell_Item, Condition(function Trig_Unit_Drop_or_Sell_ItemConditions))
    call TriggerAddAction(gg_trg_Unit_Drop_or_Sell_Item, function Trig_Unit_Drop_or_Sell_ItemActions)
endfunction
//===========================================================================
// Trigger: Unit Pick Item
//===========================================================================
//漂浮文字-系統
function Trig_Anti_Shared_Items01_texttag takes string s returns nothing
local item itm = GetManipulatedItem()
local unit u = GetTriggerUnit()
local texttag tt
local integer green = ROSE_PercentTo255(100.00)
local integer red = ROSE_PercentTo255(0.00)
local integer blue = ROSE_PercentTo255(0.00)
local integer transparency = ROSE_PercentTo255(100.0)
local real vel = 64 * 0.071 / 128
local real xvel = vel * Cos(90 * bj_DEGTORAD)
local real yvel = vel * Sin(90 * bj_DEGTORAD)
    set tt = CreateTextTag()
    call SetTextTagText(tt, s , 10.00 * 0.023 / 10)
    call SetTextTagPosUnit(tt, u, 0)
	call SetTextTagColor(tt, green, red, blue, transparency )
	call SetTextTagPermanent(tt,false)
	call SetTextTagLifespan(tt,2.80)
	call SetTextTagFadepoint(tt,1.50)
	call SetTextTagVelocity(tt, xvel, yvel)
set itm = null
set u = null	
endfunction
	
//其他玩家不可以撿取 : 馬票
function Trig_its_not_yoursActions takes nothing returns nothing
local item itm = GetManipulatedItem()
local unit u = GetTriggerUnit()
	//如果第一次 拿到物品 那麼物品的所屬玩家是 中立玩家
	if GetItemPlayer(itm)==Player(15) then
		call SetItemPlayer(itm,GetOwningPlayer(u),false)
	else
		//如果不是所有人 那麼丟棄物品
		if GetItemPlayer(itm)!=GetOwningPlayer(u) then
			call Trig_Anti_Shared_Items01_texttag("It's not yours !")
		    call UnitRemoveItem(u, itm)
		endif
	endif
	
set itm = null
set u = null 
endfunction
function Trig_Item_Only_VActions takes nothing returns nothing
local integer i
local item itt = GetManipulatedItem()
local integer id 
local integer id2 = GetItemTypeId(itt)
local unit u = GetTriggerUnit()
local boolean b = false
////////////////
//first delete the item
////////////////
call RemoveItem( itt )
	/////////////////////////////
	// 檢驗有沒有其他同類物品在身上
	/////////////////////////////
	set i=0
	loop
		set id = GetItemTypeId(UnitItemInSlot(u, i))
		if id == 'I040' or id == 'I01W' or id == 'I041' or id == 'I04J' or id == 'I04L' or id == 'I04M' or id == 'I04K' or id == 'I03Z' or id== 'I01K' then
			///////////////////////////////////
	        // 如果有 就創造原本拿到的物品在地上
	        ///////////////////////////////////
	        set itt = CreateItem(id2,GetUnitX(u), GetUnitY(u))
	        set b = true
		endif
		set i = i + 1
		exitwhen i > 6
	endloop
		////////////////////////////////////////////
		// 否則 關掉這個觸發(避免重覆判斷)後創造給英雄
		////////////////////////////////////////////
		if b ==false then
	        call DisableTrigger( GetTriggeringTrigger() )
			call UnitAddItem(u, CreateItem(id2,GetUnitX(u), GetUnitY(u)))
			call EnableTrigger( GetTriggeringTrigger() )
		endif
set u = null
set itt = null
endfunction
//////////////////////////
//【邏輯補充道具使用量】
//運用時間事件 filiter = null
//來判斷是否時間事件
////////////////////////////
function Trig_Item_GetFunc001Func003Func001Conditions takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
    if GetManipulatedItem() == LoadItemHandle(YDHT, GetHandleId(ltt), 0xA1614B4D) then
        call FlushChildHashtable(YDHT, GetHandleId(ltt))
        call DestroyTrigger(ltt)
    else
        if GetManipulatedItem() == null then
            if GetItemCharges(LoadItemHandle(YDHT, GetHandleId(ltt), 0xA1614B4D)) < 4 then
                call SetItemCharges(LoadItemHandle(YDHT, GetHandleId(ltt), 0xA1614B4D), GetItemCharges(LoadItemHandle(YDHT, GetHandleId(ltt), 0xA1614B4D)) + 1 )
            endif
        endif
    endif
set ltt = null
endfunction
function Trig_Item_GetActions takes nothing returns nothing
    local trigger ltt
    local unit u = GetTriggerUnit()
    local item it = GetManipulatedItem()
	    //黃泉
	    if GetItemTypeId(it) == 'sor8' then
	        call UnitAddAbility( u, 'A0MU' )
	        //【注意】這邊是因為 丟到地上 黃泉的使用量不會變0 所以要+ 這個觸發
	        call SetUnitAbilityLevel( u, 'A0MU', GetItemCharges(it) + 1 )
	    else
	    	//落石之書
	        if GetItemTypeId(it) == 'mnsf' and IsUnitType(u, UNIT_TYPE_HERO) then
	            set ltt = CreateTrigger()
	            call SaveItemHandle(YDHT, GetHandleId(ltt), 0xA1614B4D, it)
	            call TriggerRegisterUnitEvent( ltt, u, EVENT_UNIT_DROP_ITEM )
	            call TriggerRegisterUnitEvent( ltt, u, EVENT_UNIT_SELL_ITEM )
	            call TriggerRegisterTimerEvent(ltt, 13.00, true)
	            call TriggerAddCondition(ltt, Condition(function Trig_Item_GetFunc001Func003Func001Conditions))
	        else
	        endif
	    endif
    set ltt = null
    set u = null
    set it = null
endfunction
//唯一:久棄+利刃刀+黃泉
function Trig_Item_OnlyActions takes integer id2 returns nothing
local integer i
local item itt = GetManipulatedItem()
local integer id 
local unit u = GetTriggerUnit()
local integer check = 0
	/////////////////////////////
	//【原理】
	//當拿到的時候 物品已經在物品欄了
	//所以要設一個整數變量 來記錄數量
	//如果超過一把 那麼丟掉
	/////////////////////////////
	set i=0
	loop
		set id = GetItemTypeId(UnitItemInSlot(u, i))
		if id == id2 then
	        set check = check + 1
		endif
		set i = i + 1
		exitwhen i > 6 or check > 1
	endloop
		//丟棄
		if check > 1 then
	        call UnitRemoveItem(u, itt)
	    endif 
set u = null
set itt = null
endfunction
//物品添加配方
function Trig_Combination_Add_Func007Func001C takes nothing returns boolean
    if ( not ( udg_ICTemp[udg_ICA] != udg_NoItemType ) ) then
        return false
    endif
    return true
endfunction
function Trig_Combination_Add_Actions takes nothing returns nothing
    set udg_ICN = ( 7 * udg_ICNumber )
    set udg_ICM = 1
    set udg_ICTable[udg_ICN] = udg_ICTemp[0]
    // 把ICTemp內的配方填到ICTable內
    set udg_ICA = 1
    loop
        exitwhen udg_ICA > 6
        if ( Trig_Combination_Add_Func007Func001C() ) then
            set udg_ICTable[( udg_ICN + udg_ICM )] = udg_ICTemp[udg_ICA]
            set udg_ICM = ( udg_ICM + 1 )
        else
        endif
        set udg_ICA = udg_ICA + 1
    endloop
    // 缺項補零
    set udg_ICA = udg_ICM
    loop
        exitwhen udg_ICA > 6
        set udg_ICTable[( udg_ICN + udg_ICM )] = udg_NoItemType
        set udg_ICA = udg_ICA + 1
    endloop
    set udg_ICNumber = ( udg_ICNumber + 1 )
    // 清空ICTemp
    set udg_ICA = 0
    loop
        exitwhen udg_ICA > 6
        set udg_ICTemp[udg_ICA] = udg_NoItemType
        set udg_ICA = udg_ICA + 1
    endloop
endfunction
function Trig_Combination_Add_Func002C takes nothing returns boolean
    if ( ( udg_ICTemp[1] != udg_NoItemType ) ) then
        return true
    endif
    if ( ( udg_ICTemp[2] != udg_NoItemType ) ) then
        return true
    endif
    if ( ( udg_ICTemp[3] != udg_NoItemType ) ) then
        return true
    endif
    if ( ( udg_ICTemp[4] != udg_NoItemType ) ) then
        return true
    endif
    if ( ( udg_ICTemp[5] != udg_NoItemType ) ) then
        return true
    endif
    if ( ( udg_ICTemp[6] != udg_NoItemType ) ) then
        return true
    endif
    return false
endfunction
function Trig_Combination_Add_Conditions takes nothing returns boolean
    if ( not ( udg_ICTemp[0] != udg_NoItemType ) ) then
        return false
    endif
    if ( not Trig_Combination_Add_Func002C() ) then
        return false
    endif
    call Trig_Combination_Add_Actions()
    return false
endfunction
//執行合成
function Trig_Combination_Core_Func006Func003Func001001 takes nothing returns boolean
    return ( udg_ICTemp[0] == udg_ICTable[( udg_ICN + udg_ICM )] )
endfunction
function Trig_Combination_Core_Func006Func004Func004Func002C takes nothing returns boolean
    if ( not ( udg_ICTable[( udg_ICN + udg_ICM )] == udg_NoItemType ) ) then
        return false
    endif
    return true
endfunction
function Trig_Combination_Core_Func006Func004Func004Func004Func001C takes nothing returns boolean
    if ( not ( udg_ICTemp[udg_ICB] == udg_ICTable[( udg_ICN + udg_ICM )] ) ) then
        return false
    endif
    return true
endfunction
function Trig_Combination_Core_Func006Func004Func004Func006C takes nothing returns boolean
    if ( not ( udg_ICB > 6 ) ) then
        return false
    endif
    return true
endfunction
function Trig_Combination_Core_Func006Func004Func006Func002Func001C takes nothing returns boolean
    if ( not ( udg_ICTemp[udg_ICB] == udg_NoItemType ) ) then
        return false
    endif
    return true
endfunction
function Trig_Combination_Core_Func006Func004Func006C takes nothing returns boolean
    if ( not ( udg_ICM > 6 ) ) then
        return false
    endif
    return true
endfunction
function Trig_Combination_Core_Func006Func004C takes nothing returns boolean
    if ( not ( udg_ICM < 7 ) ) then
        return false
    endif
    return true
endfunction
function Trig_Combination_Core_Actions takes nothing returns nothing
    // 清空ICTemp
    set udg_ICA = 0
    loop
        exitwhen udg_ICA > 6
        set udg_ICTemp[udg_ICA] = udg_NoItemType
        set udg_ICA = udg_ICA + 1
    endloop
    set udg_ICTemp[0] = GetItemTypeId(GetManipulatedItem())
    // 用陣列跑合成表
    set udg_ICA = 0
    loop
        exitwhen udg_ICA > ( udg_ICNumber - 1 )
        set udg_ICN = ( 7 * udg_ICA )
        // 搜尋包含拾得物品的配方
        set udg_ICM = 1
        loop
            exitwhen udg_ICM > 6
            if ( Trig_Combination_Core_Func006Func003Func001001() ) then
                exitwhen true
            else
                call DoNothing( )
            endif
            set udg_ICM = udg_ICM + 1
        endloop
        if ( Trig_Combination_Core_Func006Func004C() ) then
            // 把物品欄物品填到ICTemp方便處理
            set udg_ICB = 1
            loop
                exitwhen udg_ICB > 6
                set udg_ICTemp[udg_ICB] = GetItemTypeId(UnitItemInSlotBJ(GetTriggerUnit(), udg_ICB))
                set udg_ICB = udg_ICB + 1
            endloop
            // 用陣列跑配方中的每個材料
            set udg_ICM = 1
            loop
                exitwhen udg_ICM > 6
                // 跳過空材料
                if ( Trig_Combination_Core_Func006Func004Func004Func002C() ) then
                    set udg_ICM = 7
                    exitwhen true
                else
                endif
                // 檢查物品欄物品有無該種材料
                set udg_ICB = 1
                loop
                    exitwhen udg_ICB > 6
                    if ( Trig_Combination_Core_Func006Func004Func004Func004Func001C() ) then
                        set udg_ICTemp[udg_ICB] = udg_NoItemType
                        exitwhen true
                    else
                    endif
                    set udg_ICB = udg_ICB + 1
                endloop
                // 一種材料找不到就跳出
                if ( Trig_Combination_Core_Func006Func004Func004Func006C() ) then
                    exitwhen true
                else
                endif
                set udg_ICM = udg_ICM + 1
            endloop
            // 開始合成
            if ( Trig_Combination_Core_Func006Func004Func006C() ) then
                // 移除物品欄內材料
                set udg_ICB = 1
                loop
                    exitwhen udg_ICB > 6
                    if ( Trig_Combination_Core_Func006Func004Func006Func002Func001C() ) then
                        call RemoveItem( UnitItemInSlotBJ(GetTriggerUnit(), udg_ICB) )
                    else
                    endif
                    set udg_ICB = udg_ICB + 1
                endloop
                // 給予物品及產生特效
                call UnitAddItemByIdSwapped( udg_ICTable[udg_ICN], GetTriggerUnit() )
                call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIlm\\AIlmTarget.mdl",GetTriggerUnit() ,"origin"))
                exitwhen true
            else
            endif
        else
        endif
        set udg_ICA = udg_ICA + 1
    endloop
endfunction
function Unit_Pick_Item takes nothing returns boolean
	local integer id = GetItemTypeId(GetManipulatedItem())
		//物品合成
		call Trig_Combination_Core_Actions()
		
		//物品技能
	    if id == 'mnsf'then
		    call Trig_Item_GetActions()
		//黃泉   
		elseif id == 'sor8' then
			call Trig_Item_GetActions()
			call Trig_Item_OnlyActions(id) 
		//鞋子唯一
		elseif id == 'I01K' or id == 'I01W' or id == 'I03Z' or id == 'I040' or id == 'I041' or id == 'I04K' or id == 'I04L' or id == 'I04M' or id == 'I04J' then
    		call Trig_Item_Only_VActions()
    	//物品排泄	
    	elseif id == 'rhe1' or id == 'rres' or id == 'rdis' or id == 'rre1' then	
    		call RemoveItem( GetManipulatedItem() ) 
    	//久棄+利刃
		elseif id == 'clsd' or id == 'I01F' then
    		call Trig_Item_OnlyActions(id)
    	//馬票	
    	elseif id == 'fgrg' then
    		call Trig_its_not_yoursActions()
	    endif
    return false
endfunction
function InitTrig_Unit_Pick_Item takes nothing returns nothing
    set gg_trg_Unit_Pick_Item = CreateTrigger()
	call UMI(gg_trg_Unit_Pick_Item,EVENT_PLAYER_UNIT_PICKUP_ITEM)
    call TriggerAddCondition(gg_trg_Unit_Pick_Item, Condition(function Unit_Pick_Item))
	//物品初始初始化
    set udg_ICNumber = 0
    set udg_NoItemType = 0
    set udg_ICA = 0
    loop
        exitwhen udg_ICA > 6
        set udg_ICTemp[udg_ICA] = udg_NoItemType
        set udg_ICA = udg_ICA + 1
    endloop
    // ICTemp[0] = ICTemp[1] + ICTemp[2] + ...... + ICTemp[6]
    // 防具合成
    set udg_ICTemp[0] = 'sor8'
    set udg_ICTemp[1] = 'I01N'
    set udg_ICTemp[2] = 'clsd'
    set udg_ICTemp[3] = 'I03O'
    call Trig_Combination_Add_Conditions()
    set udg_ICTemp[0] = 'I020'
    set udg_ICTemp[2] = 'lure'
    set udg_ICTemp[1] = 'mnsf'
    set udg_ICTemp[6] = 'I00V'
    call Trig_Combination_Add_Conditions()
   
endfunction
globals
integer udg_ICNumber=0
integer udg_ICA=0
integer array udg_ICTemp
integer udg_NoItemType=0
integer udg_ICN=0
integer udg_ICM=0
integer array udg_ICTable
integer udg_ICB=0
endglobals
//===========================================================================
// Trigger: Unit Summend
//===========================================================================
function Trig_Unit_SummendConditions takes nothing returns boolean
    return (((GetUnitTypeId(GetTriggerUnit()) == 'hbew') or (GetUnitTypeId(GetSummonedUnit()) == 'ndrj')))
endfunction
function Trig_Unit_SummendActions takes nothing returns nothing
    if ((GetUnitTypeId(GetSummonedUnit()) == 'ndrj')) then
        // -----------------
        if ((udg_auto[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == true)) then
            call SelectUnitAddForPlayer( GetSummonedUnit(), GetOwningPlayer(GetSummoningUnit()) )
        else
            call DoNothing( )
        endif
        // -----------------
        if ((GetHeroLevel(GetSummoningUnit()) >= 6) and (GetHeroLevel(GetSummoningUnit()) < 12)) then
            call SetUnitAbilityLevel( GetSummonedUnit(), 'A0L0', 2 )
            call SetUnitAbilityLevel( GetSummonedUnit(), 'A0KQ', 2 )
        else
            if ((GetHeroLevel(GetSummoningUnit()) >= 12) and (GetHeroLevel(GetSummoningUnit()) < 21)) then
                call SetUnitAbilityLevel( GetSummonedUnit(), 'A0L0', 3 )
                call SetUnitAbilityLevel( GetSummonedUnit(), 'A0KQ', 3 )
            else
            endif
        endif
    else
        if ((GetUnitTypeId(GetTriggerUnit()) == 'hbew')) then
            call TriggerRegisterUnitEvent(gg_trg_Item18A, GetTriggerUnit(), EVENT_UNIT_SPELL_EFFECT)
            call GroupAddUnit( udg_MH_group[11], GetTriggerUnit() )
        else
        endif
    endif
endfunction
//===========================================================================
function InitTrig_Unit_Summend takes nothing returns nothing
    set gg_trg_Unit_Summend = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Unit_Summend, EVENT_PLAYER_UNIT_SUMMON )
    call TriggerAddCondition(gg_trg_Unit_Summend, Condition(function Trig_Unit_SummendConditions))
    call TriggerAddAction(gg_trg_Unit_Summend, function Trig_Unit_SummendActions)
endfunction
//===========================================================================
// Trigger: Unit Use Item
//===========================================================================
function Get_change_Summend_Unit takes player p , integer id , real life ,unit u returns unit
local unit u3 
	if GetPlayerId(p) + 1 <= 5 then
		set u3 = CreateUnit(udg_X_PlayerB[0],id,GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
		call SetUnitOwner( u3, rose_p, true )
		call UnitApplyTimedLife( u3, 0x42544C46, life ) 
	else
		set u3 = CreateUnit(udg_X_PlayerA[0],id,GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
		call SetUnitOwner( u3, rose_p, true )
		call UnitApplyTimedLife( u3, 0x42544C46, life )
	endif
return u3
endfunction 
function Trig_Item_USEActions takes nothing returns nothing
    local unit u = GetTriggerUnit()
    local unit u3
    local item itt=GetManipulatedItem()
    local integer id = GetItemTypeId(itt) 
    	//數珠丸恆次‧銘刀
    	if id == 'I043' then
	        call TriggerSleepAction(0.00)
	        call RemoveItem( itt )
		    // Create the item at the hero's feet first, and then give it to him.
		    // This is to ensure that the item will be left at the hero's feet if
		    // his inventory is full. 
		    call UnitAddItem(u, CreateItem('I01U', GetUnitX(u), GetUnitY(u))) 
		//數珠丸恆次‧銘刀‧解放           
    	elseif id == 'I01U' then
            call TriggerSleepAction(0.00)
            call RemoveItem( itt )
            call UnitAddItem(u, CreateItem('I043', GetUnitX(u), GetUnitY(u))) 
        //童子切安綱‧銘刀    
    	elseif id == 'I045' then
            call SetItemDroppable( itt, false )
            call UnitAddAbility( u, 'A0WM' )
            call UnitMakeAbilityPermanent( u, true, 'A0WM' )
            call SetPlayerAbilityAvailable( GetOwningPlayer(u), 'A0WM', false )
            call TriggerSleepAction(20.00)
            call UnitMakeAbilityPermanent( u, false, 'A0WM' )
            call UnitRemoveAbility( u, 'A0WM' )
            call SetItemDroppable( itt, true )
        //當世具足    
        elseif id == 'I016' and IsUnitType(u, UNIT_TYPE_HERO) then
            call SetUnitState(u, UNIT_STATE_LIFE, GetUnitState(u, UNIT_STATE_LIFE) + 400.00 )
            call SetUnitState(u, UNIT_STATE_MANA, GetUnitState(u, UNIT_STATE_MANA) + 400.00 )
        //風之卷    
        elseif id == 'I023' or id == 'thdm' then
        	set rose_p = GetOwningPlayer(u)
			set u3 = CreateUnit(rose_p,'h000',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
			call UnitApplyTimedLife( u3, 'BHwe', 22.00 )
			//call BJDebugMsg(GetUnitName(u3))
		//孫子兵法斷簡	
        elseif id == 'gldo' then
        	set rose_p = GetOwningPlayer(u)
            /////////////
            //fast + 30%
            /////////////
			set u3 = CreateUnit(rose_p,'h000',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
			call UnitApplyTimedLife( u3, 'BTLF', 20.00 )
			//////////////////
			//def + 50
			//////////////////
			set u3 = CreateUnit(rose_p,'h01E',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
            call UnitAddAbility( u3, 'A02B' )
			call UnitApplyTimedLife( u3, 'BTLF', 3.10 )
		//林捲  
        elseif id == 'I02F' and IsUnitType(u, UNIT_TYPE_HERO) then
        	set rose_p = GetOwningPlayer(u)
        	set rose_b = udg_auto[GetPlayerId(rose_p) + 1]
        	//下級伏兵軍師 lv 1
        	set u3 = Get_change_Summend_Unit(rose_p,'nwiz',35.00,u)
			call Auto_chose(rose_b,u3,rose_p)
			//下級伏兵先鋒 * 1 lv 1
			set u3 = Get_change_Summend_Unit(rose_p,'ndrp',35.00,u)
			call Auto_chose(rose_b,u3,rose_p)
    	//孫子兵法．林之章 
        elseif id == 'rde0' and IsUnitType(u, UNIT_TYPE_HERO) then
        	set rose_p = GetOwningPlayer(u)
        	set rose_b = udg_auto[GetPlayerId(rose_p) + 1]
        	//下級伏兵軍師 lv 2
	        set u3 = CreateUnit(rose_p,'nwiz',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
			call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
			call IncUnitAbilityLevel( u3, 'Amnb' )
			call Auto_chose(rose_b,u3,rose_p)
			//下級伏兵先鋒 * 2 lv 1
			set u3 = CreateUnit(rose_p,'ndrp',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
			call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
			call Auto_chose(rose_b,u3,rose_p)
			set u3 = CreateUnit(rose_p,'ndrp',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
			call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
			call Auto_chose(rose_b,u3,rose_p)
		//孫子兵法殘冊	
		elseif id == 'frgd' and IsUnitType(u, UNIT_TYPE_HERO) then
        	set rose_p = GetOwningPlayer(u)
        	set rose_b = udg_auto[GetPlayerId(rose_p) + 1]
        	//中級伏兵軍師 lv 3
	        set u3 = CreateUnit(rose_p,'nwzr',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
			call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
			call IncUnitAbilityLevel( u3, 'Amnb' )
			call IncUnitAbilityLevel( u3, 'Amnb' )
			call Auto_chose(rose_b,u3,rose_p)
			//中級伏兵先鋒 * 1 lv 2
			set u3 = CreateUnit(rose_p,'ndrf',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
			call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
			call IncUnitAbilityLevel( u3, 'ACen' )
			call Auto_chose(rose_b,u3,rose_p)
		//孫子兵法全本	
    	elseif id == 'ram3' and IsUnitType(u, UNIT_TYPE_HERO) then
        	set rose_p = GetOwningPlayer(u)
        	set rose_b = udg_auto[GetPlayerId(rose_p) + 1]
        	//上級伏兵軍師 lv 3
		    if GetPlayerId(rose_p) + 1 <= 5 then
				set u3 = CreateUnit(udg_X_PlayerA[0],'nwzg',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
				call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
				call IncUnitAbilityLevel( u3, 'Amnb' )
				call IncUnitAbilityLevel( u3, 'Amnb' )
				call SetUnitOwner( u3, rose_p, true )
				call IssueImmediateOrder(u3,"autodispeloff")
				call Auto_chose(rose_b,u3,rose_p)
				//上級伏兵先鋒 * 1 lv 2
				set u3 = CreateUnit(udg_X_PlayerA[0],'ndrm',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
				call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
				call IncUnitAbilityLevel( u3, 'ACen' )
				call SetUnitOwner( u3, rose_p, true )
				call Auto_chose(rose_b,u3,rose_p)
		    else
		    	set u3 = CreateUnit(udg_X_PlayerB[0],'nwzg',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
				call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
				call IncUnitAbilityLevel( u3, 'Amnb' )
				call IncUnitAbilityLevel( u3, 'Amnb' )
				call SetUnitOwner( u3, rose_p, true )
				call Auto_chose(rose_b,u3,rose_p)
				//上級伏兵先鋒 * 1 lv 2
				set u3 = CreateUnit(udg_X_PlayerB[0],'ndrm',GetUnitX(u), GetUnitY(u),bj_UNIT_FACING)
				call UnitApplyTimedLife( u3, 'BTLF', 35.00 )
				call IncUnitAbilityLevel( u3, 'ACen' )
				call SetUnitOwner( u3, rose_p, true )
				call Auto_chose(rose_b,u3,rose_p)
		    endif
    	endif
    set u = null
    set itt = null
    set u3 = null
endfunction
function Trig_Item_USEConditions takes nothing returns boolean
local integer id = GetItemTypeId(GetManipulatedItem())
	return id == 'I043' or id == 'I01U' or id == 'I045' or id == 'I016' or id == 'I023' or id == 'thdm' or id == 'gldo' or id == 'I02F' or id == 'rde0' or id == 'frgd' or id == 'ram3'
endfunction
function InitTrig_Unit_Use_Item takes nothing returns nothing
local trigger t=CreateTrigger()
	set t=CreateTrigger()
	call UMI(t,EVENT_PLAYER_UNIT_USE_ITEM)
    call TriggerAddCondition(t, Condition(function Trig_Item_USEConditions))
    call TriggerAddAction(t, function Trig_Item_USEActions)
set t=null 
endfunction
//===========================================================================
// Trigger: Unit Spell Cast
//===========================================================================
//統率者鐵扇 
function Trig_Item34Actions takes nothing returns nothing
    local unit ydl_unit
    local player p = GetOwningPlayer(GetTriggerUnit())
    call GroupEnumUnitsInRange(udg_Group[3], GetSpellTargetX(), GetSpellTargetY(), 270.00, null)
    loop
        set ydl_unit = FirstOfGroup(udg_Group[3])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[3], ydl_unit)
        if IsUnitEnemy(ydl_unit, p) then
            call UnitRemoveAbility( ydl_unit, 'B068' )
        endif
    endloop
    set ydl_unit = null
    set p = null
endfunction
function Trig_Spell_CastConditions takes nothing returns nothing
local integer i = GetSpellAbilityId()
	//統率者鐵扇 
	if i == 'AIse' then
		call Trig_Item34Actions()
		return
	endif
endfunction
//===========================================================================
function InitTrig_Unit_Spell_Cast takes nothing returns nothing
    set gg_trg_Unit_Spell_Cast = CreateTrigger()
    call TriggerAddCondition(gg_trg_Unit_Spell_Cast, Condition(function Trig_Spell_CastConditions))
endfunction//===========================================================================
// Trigger: Unit Additional Item Ability
//===========================================================================
function Trig_Unit_Additional_Item_AbilityActions takes nothing returns nothing
    call YDWEItemAbilityStorage( 'ram3', 'AIx4' )
    call YDWEItemAbilityStorage( 'I01U', 'A0OU' )
    call YDWEItemAbilityStorage( 'I01U', 'A0BA' )
    call YDWEItemAbilityStorage( 'I04A', 'AIrn' )
    call DisableTrigger( GetTriggeringTrigger() )
endfunction
//===========================================================================
function InitTrig_Unit_Additional_Item_Ability takes nothing returns nothing
    set gg_trg_Unit_Additional_Item_Ability = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_Unit_Additional_Item_Ability, 0.00 )
    call TriggerAddAction(gg_trg_Unit_Additional_Item_Ability, function Trig_Unit_Additional_Item_AbilityActions)
endfunction
//===========================================================================
// Trigger: Combination Init HASH I
//===========================================================================
function Trig_Combination_Init_HASH_IActions takes nothing returns nothing
    // 製魔
    call YDWENewItemsFormula( 'I00R', 2, 'I01I', 1, 'I010', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I004' )
    call YDWENewItemsFormula( 'rag1', 2, 'I023', 1, 'I03E', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'thdm' )
    call YDWENewItemsFormula( 'I003', 2, 'I012', 1, 'I03D', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'sfog' )
    call YDWENewItemsFormula( 'rin1', 2, 'I02F', 1, 'I03I', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'rde0' )
    call YDWENewItemsFormula( 'rst1', 2, 'I025', 1, 'I00X', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'fwss' )
    call YDWENewItemsFormula( 'I02J', 2, 'gemt', 1, 'I01X', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'gsou' )
    call YDWENewItemsFormula( 'I00R', 2, 'I01K', 1, 'I03L', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I03Z' )
    call YDWENewItemsFormula( 'I00Y', 2, 'I006', 0, 'I03C', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I01G' )
    call YDWENewItemsFormula( 'mcou', 2, 'I01I', 1, 'I02Q', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I01J' )
    call YDWENewItemsFormula( 'I017', 2, 'odef', 1, 'I029', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I015' )
    call YDWENewItemsFormula( 'I00Y', 2, 'I01I', 1, 'I02H', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I02G' )
    call YDWENewItemsFormula( 'I00B', 2, 'I006', 1, 'I03B', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I02L' )
    call YDWENewItemsFormula( 'I002', 2, 'I02Z', 1, 'I03B', 0, 'ches', 0, 'ches', 0, 'ches', 0, 'I01F' )
    call YDWENewItemsFormula( 'rin1', 2, 'I00S', 1, 'I00J', 1, 'ches', 0, 'ches', 0, 'ches', 0, 'I022' )
endfunction
//===========================================================================
function InitTrig_Combination_Init_HASH_I takes nothing returns nothing
    set gg_trg_Combination_Init_HASH_I = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_Combination_Init_HASH_I, 0.00 )
    call TriggerAddAction(gg_trg_Combination_Init_HASH_I, function Trig_Combination_Init_HASH_IActions)
endfunction
//===========================================================================
// Trigger: Combination Init HASH II
//===========================================================================
//function Create_item_Error takes nothing returns nothing
//call BJDebugMsg("物品合成出問題")
//call PauseGameOn(  )	
//endfunction
//function Create_item takes integer id1 ,integer int1, integer id2 ,integer int2, integer id3  ,integer int3, integer id4 ,integer int4, integer id5 ,integer int5, integer id6,integer int6 returns nothing
//local item itt 
//local real x =  7000
//local real y = -7200
//	set itt = CreateItem(id1,x,y)
//	set itt = CreateItem(id2,x,y)
//	set itt = CreateItem(id3,x,y)
//	set itt = CreateItem(id4,x,y)
//	set itt = CreateItem(id5,x,y)
//	set itt = CreateItem(id6,x,y)
//		if id1 != 0 and int1 == 0 then
//			call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)
//		elseif id2 != 0 and int2 == 0 then
//			call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)
//		elseif id3 != 0 and int3 == 0 then
//			call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)
//		elseif id4 != 0 and int4 == 0 then
//			call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)
//		elseif id5 != 0 and int5 == 0 then
//			call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)
//		elseif id6 != 0 and int6 == 0 then
//			call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)		
//		endif
		
//		//if id1 == id2 or id1 == id3 or id1 == id4 or id1 == id5 or id1 == id6 then
//		//	call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)
//		//elseif id2 == id1 or id2 == id3 or id2 == id4 or id2 == id5 or id2 == id6 then
//		//	call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)
//		//elseif id3 == id1 or id3 == id2 or id3 == id4 or id3 == id5 or id3 == id6 then
//		//	call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)		
//		//elseif id4 == id1 or id4 == id2 or id4 == id3 or id4 == id5 or id4 == id6 then
//		//	call TimerStart(CreateTimer(),6.00,true,function Create_item_Error)		
//		//endif
			
//set itt = null
//endfunction
function Trig_Combination_Init_HASH_2Actions takes nothing returns nothing
	
	
	//鬼面
    call YDWENewItemsFormula( 'I039', 1, 'rst1', 1, 'rag1', 1, 'rin1', 1, 0, 0, 0, 0, 'I038' )
	//鬼頰當
    call YDWENewItemsFormula( 'I006', 1, 'I008', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I017' )
	//靜心兜
    call YDWENewItemsFormula( 'I00D', 1, 'I00C', 1, 'I01B', 1, 0, 0, 0, 0, 0, 0, 'I01D' )
	//陣太刀
    call YDWENewItemsFormula( 'rst1', 1, 'rag1', 1, 'rin1', 1, 'I00F', 1, 0, 0, 0, 0, 'I00Q' )
	//長捲
    call YDWENewItemsFormula( 'rst1', 1, 'I00R', 1, 'I02J', 1, 'I02U', 1, 0, 0, 0, 0, 'I00E' )
	//野太刀
	call YDWENewItemsFormula( 'rde1', 1, 'I00F', 1, 'I003', 1, 0, 0, 0, 0, 0, 0, 'I005' )
	//真知短甲
	call YDWENewItemsFormula( 'gemt', 1, 'I00B', 1, 'I00I', 1, 0, 0, 0, 0, 0, 0, 'I00H' )
	//薩摩銃
	call YDWENewItemsFormula( 'I04D', 1, 'afac', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I03S' )
	//舞雷刀
	call YDWENewItemsFormula( 'I002', 1, 'I003', 1, 'I00S', 1, 0, 0, 0, 0, 0, 0, 'I00T' )
	//統率者鐵扇
    call YDWENewItemsFormula( 'I00F', 1, 'I00W', 1, 'I00Y', 1, 'I03A', 1, 0, 0, 0, 0, 'I01P' )
	//禦神法輪‧一階
    call YDWENewItemsFormula( 'I00Y', 1, 'I01L', 1, 'rin1', 1, 'I01Q', 1, 0, 0, 0, 0, 'I01R' )
	//禦神法輪‧二階
    call YDWENewItemsFormula( 'I01R', 1, 'I01Q', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I050' )
	//破魔‧禦魔長踏
    call YDWENewItemsFormula( 'I03Z', 1, 'I04I', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I04K' )
	//破魔‧琉球浪人木屐
    call YDWENewItemsFormula( 'I041', 1, 'I04I', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I04M' )
	//破魔‧暗部長靴
    call YDWENewItemsFormula( 'I01W', 1, 'I04I', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I04L' )
	//破魔‧仕手能靴
    call YDWENewItemsFormula( 'I040', 1, 'I04I', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I04J' )
	//皆朱槍
    call YDWENewItemsFormula( 'I00W', 1, 'I012', 1, 'I02W', 1, 0, 0, 0, 0, 0, 0, 'I011' )
	//當世具足
    call YDWENewItemsFormula( 'I00L', 1, 'I01C', 1, 'I006', 1, 'I02D', 1, 0, 0, 0, 0, 'I016' )
	//琉璃光姬
    call YDWENewItemsFormula( 'I00Y', 1, 'I01C', 1, 'I00R', 1, 'I030', 1, 0, 0, 0, 0, 'I01A' )
	//狐火大鎧
    call YDWENewItemsFormula( 'I007', 1, 'I00R', 1, 'I02P', 1, 0, 0, 0, 0, 0, 0, 'I00Z' )
	//琉球浪人木屐
    call YDWENewItemsFormula( 'I01K', 1, 'I006', 1, 'I047', 1, 'I00B', 1, 0, 0, 0, 0, 'I041' )
	//武士服．一階
    call YDWENewItemsFormula( 'I00R', 1, 'I01H', 1, 'mcou', 1, 'I01L', 1, 0, 0, 0, 0, 'I01M' )
	//暗部長靴
    call YDWENewItemsFormula( 'I01K', 1, 'I01L', 1, 'I02J', 1, 'I02C', 1, 0, 0, 0, 0, 'I01W' )
	//斬月槍
    call YDWENewItemsFormula( 'I00W', 1, 'rst1', 1, 'I02J', 1, 0, 0, 0, 0, 0, 0, 'I014' )
	//戒杖刀
    call YDWENewItemsFormula( 'I00F', 1, 'I01O', 1, 'rin1', 1, 0, 0, 0, 0, 0, 0, 'I00U' )
	//忍者刀
    call YDWENewItemsFormula( 'I002', 1, 'I00F', 1, 'I033', 1, 0, 0, 0, 0, 0, 0, 'I02O' )
	//御魔護符
    call YDWENewItemsFormula( 'odef', 1, 'I03J', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'I03K' )
	//平蜘蛛釜
    call YDWENewItemsFormula( 'kgal', 1, 'I006', 1, 'I036', 1, 0, 0, 0, 0, 0, 0, 'I042' )
	//嗜血妖刀
    call YDWENewItemsFormula( 'I038', 1, 'I01N', 1, 'I031', 1, 0, 0, 0, 0, 0, 0, 'I013' )
	//仕手能靴
    call YDWENewItemsFormula( 'I01K', 1, 'I01B', 1, 'I04Q', 1, 0, 0, 0, 0, 0, 0, 'I040' )
	//和泉守兼定
    call YDWENewItemsFormula( 'I002', 1, 'I00R', 1, 'I035', 1, 0, 0, 0, 0, 0, 0, 'I02N' )
	//八幡鈴
    call YDWENewItemsFormula( 'I01B', 1, 'rag1', 1, 'I02A', 1, 0, 0, 0, 0, 0, 0, 'I028' )
	//黑漆塗五枚胴
    call YDWENewItemsFormula( 'I01D', 1, 'I00K', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'brag' )
	//鬼蜘蛛．夜哭
    call YDWENewItemsFormula( 'anfg', 1, 'shhn', 1, 'I00O', 1, 0, 0, 0, 0, 0, 0, 'vddl' )
	//鞍切．二階
    call YDWENewItemsFormula( 'jdrn', 1, 'I01S', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'tmmt' )
	//鬼切
    call YDWENewItemsFormula( 'I00Q', 1, 'I00M', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'anfg' )
	//鞍切．三階
    call YDWENewItemsFormula( 'tmmt', 1, 'I01S', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'hbth' )
	//鞍切．一階
    call YDWENewItemsFormula( 'mcou', 1, 'I01N', 1, 'I01S', 1, 0, 0, 0, 0, 0, 0, 'jdrn' )
	//靈都宮燈
    call YDWENewItemsFormula( 'I01I', 1, 'rej6', 1, 'I019', 1, 0, 0, 0, 0, 0, 0, 'ram4' )
	//雷切
    call YDWENewItemsFormula( 'I00T', 1, 'I01N', 1, 'I021', 1, 0, 0, 0, 0, 0, 0, 'rnsp' )
	//雪走
    call YDWENewItemsFormula( 'I00F', 1, 'oli2', 1, 'I02I', 1, 0, 0, 0, 0, 0, 0, 'spre' )
	//逝者之笏
    call YDWENewItemsFormula( 'I01C', 1, 'I00P', 1, 'I03Q', 1, 0, 0, 0, 0, 0, 0, 'blba' )
	//蜘蛛切
    call YDWENewItemsFormula( 'I00W', 1, 'I02J', 1, 'rin1', 1, 'I00N', 1, 0, 0, 0, 0, 'shhn' )
	//紅雪左文字
    call YDWENewItemsFormula( 'I005', 1, 'I011', 1, 'I000', 1, 0, 0, 0, 0, 0, 0, 'mlst' )
	//神直毘御劍
    call YDWENewItemsFormula( 'I00P', 1, 'I014', 1, 'I03M', 1, 0, 0, 0, 0, 0, 0, 'sksh' )
	//無上雷暴之書
    call YDWENewItemsFormula( 'tmsc', 1, 'dtsb', 1, 'I00A', 1, 0, 0, 0, 0, 0, 0, 'btst' )
	//浪人十手．二階
    call YDWENewItemsFormula( 'amrc', 1, 'I03P', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'gobm' )
	//浪人十手．一階
    call YDWENewItemsFormula( 'I00W', 1, 'I01C', 1, 'I03P', 1, 0, 0, 0, 0, 0, 0, 'amrc' )
	//浪人十手．三階
    call YDWENewItemsFormula( 'gobm', 1, 'I03P', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'tels' )
	//武士服．二階
    call YDWENewItemsFormula( 'I01M', 1, 'I01H', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'iwbr' )
	//桔梗仙冬月
    call YDWENewItemsFormula( 'I00Y', 1, 'spre', 1, 'I03H', 1, 0, 0, 0, 0, 0, 0, 'ram2' )
	//月輪鏡
    call YDWENewItemsFormula( 'kgal', 1, 'I00G', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'rej6' )
	//星杵
    call YDWENewItemsFormula( 'I02J', 1, 'I01E', 1, 0, 0, 0, 0, 0, 0, 0, 0, 'soul' )
	//忍者裝束
    call YDWENewItemsFormula( 'I01L', 1, 'I01J', 1, 'I03N', 1, 0, 0, 0, 0, 0, 0, 'sor9' )
	//巨龍
    call YDWENewItemsFormula( 'I006', 1, 'I032', 1, 'soul', 1, 'I01B', 1, 0, 0, 0, 0, 'srtl' )
	//孫子兵法殘冊
    call YDWENewItemsFormula( 'sfog', 1, 'rde0', 1, 'I03F', 1, 0, 0, 0, 0, 0, 0, 'frgd' )
	//孫子兵法斷簡
    call YDWENewItemsFormula( 'thdm', 1, 'fwss', 1, 'I001', 1, 0, 0, 0, 0, 0, 0, 'gldo' )
	//孫子兵法全本
    call YDWENewItemsFormula( 'frgd', 1, 'gldo', 1, 'I009', 1, 0, 0, 0, 0, 0, 0, 'ram3' )
	//妖化河童殼
    call YDWENewItemsFormula( 'I01C', 1, 'I00C', 1, 'I03R', 1, 0, 0, 0, 0, 0, 0, 'axas' )
	//凍雲
    call YDWENewItemsFormula( 'spre', 1, 'I00F', 1, 'I034', 1, 0, 0, 0, 0, 0, 0, 'oflg' )
	//備前兼光
    call YDWENewItemsFormula( 'I049', 1, 'I02N', 1, 'I00U', 1, 0, 0, 0, 0, 0, 0, 'envl' )
endfunction
//===========================================================================
function InitTrig_Combination_Init_HASH_II takes nothing returns nothing
    set gg_trg_Combination_Init_HASH_II = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg_Combination_Init_HASH_II, 0.00 )
    call TriggerAddAction(gg_trg_Combination_Init_HASH_II, function Trig_Combination_Init_HASH_2Actions)
    
endfunction
//===========================================================================
// Trigger: Combination Core 
//===========================================================================
function Trig_Combination_CoreActions takes nothing returns nothing
    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIlm\\AIlmTarget.mdl", GetTriggerUnit(), "origin") )
endfunction
//===========================================================================
function InitTrig_Combination_Core takes nothing returns nothing
    set gg_trg_Combination_Core = CreateTrigger()
    call YDWESyStemItemCombineRegistTrigger( gg_trg_Combination_Core )
    call TriggerAddAction(gg_trg_Combination_Core, function Trig_Combination_CoreActions)
endfunction
//===========================================================================
// Trigger: Item18A
//===========================================================================
function Trig_Item18AActions takes nothing returns nothing
local unit u1 = GetSpellTargetUnit()
local integer id = GetSpellAbilityId()	
local real HP
	if id == 'A0JL' then
	    call UnitAddAbility( u1, 'A0LM' )
	    call TriggerSleepAction(10.00)
	    call UnitRemoveAbility( u1, 'A0LM' )
	else
		if id == 'A0JK' then 
			set HP = GetUnitState(u1, UNIT_STATE_LIFE) + GetUnitState(u1, UNIT_STATE_MAX_LIFE) * 0.07 
			call SetUnitState( u1, UNIT_STATE_LIFE, HP )
		endif
	endif 
set u1 = null
endfunction
//===========================================================================
function InitTrig_Item18A takes nothing returns nothing
    set gg_trg_Item18A = CreateTrigger()
    call TriggerAddAction(gg_trg_Item18A, function Trig_Item18AActions)
endfunction//===========================================================================
// Trigger: Item20B
//===========================================================================
function Trig_Item20BConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0KY'))
endfunction
function Trig_Item20BActions takes nothing returns nothing
    call UnitDamageTargetBJ( GetTriggerUnit(), GetSpellTargetUnit(), 200.00, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_FIRE )
endfunction
//===========================================================================
function InitTrig_Item20B takes nothing returns nothing
    set gg_trg_Item20B = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Item20B, EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition(gg_trg_Item20B, Condition(function Trig_Item20BConditions))
    call TriggerAddAction(gg_trg_Item20B, function Trig_Item20BActions)
endfunction
//===========================================================================
// Trigger: Item22B
//===========================================================================
function Trig_Item22BConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0NR'))
endfunction
function Trig_Item22BActions takes nothing returns nothing
    set udg_A_common_TemP[31] = GetUnitLoc(GetTriggerUnit())
    // ---------------------------------
    call CreateNUnitsAtLoc( 1, 'h000', GetOwningPlayer(GetTriggerUnit()), udg_A_common_TemP[31], bj_UNIT_FACING )
    call UnitApplyTimedLife( GetLastCreatedUnit(), 'BHwe', 20.00 )
    call CreateNUnitsAtLoc( 1, 'h01E', GetOwningPlayer(GetTriggerUnit()), udg_A_common_TemP[31], bj_UNIT_FACING )
    call UnitAddAbility( GetLastCreatedUnit(), 'A02B' )
    call UnitApplyTimedLife( GetLastCreatedUnit(), 'BHwe', 4.00 )
    // ---------------------------------
    call RemoveLocation( udg_A_common_TemP[31] )
endfunction
//===========================================================================
function InitTrig_Item22B takes nothing returns nothing
    set gg_trg_Item22B = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Item22B, EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition(gg_trg_Item22B, Condition(function Trig_Item22BConditions))
    call TriggerAddAction(gg_trg_Item22B, function Trig_Item22BActions)
endfunction
//===========================================================================
// Trigger: Item13_DemageA
//===========================================================================
function Trig_Item13_DemageAConditions takes nothing returns boolean
    return ((UnitHasBuffBJ(GetTriggerUnit(), 'B06F') == true))
endfunction
function Trig_Item13_DemageAFunc007002001 takes nothing returns boolean
    return ((IsUnitInvisible(GetTriggerUnit(), GetFilterPlayer()) == true))
endfunction
function Trig_Item13_DemageAActions takes nothing returns nothing
    call UnitRemoveAbility( GetTriggerUnit(), 'B06F' )
    if ((( GetUnitStateSwap(UNIT_STATE_LIFE, GetTriggerUnit()) * 0.14 ) <= 115.00)) then
        call UnitDamageTargetBJ( GetEventDamageSource(), GetTriggerUnit(), 115.00, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID )
        call CreateTextTagUnitBJ( "TRIGSTR_7725", GetTriggerUnit(), 0, 8.00, 80.00, 50.00, 100.00, 0 )
    else
        call UnitDamageTargetBJ( GetEventDamageSource(), GetTriggerUnit(), ( 0.14 * GetUnitStateSwap(UNIT_STATE_LIFE, GetTriggerUnit()) ), ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID )
        call CreateTextTagUnitBJ( I2S(R2I(( 0.14 * GetUnitStateSwap(UNIT_STATE_LIFE, GetTriggerUnit()) ))), GetTriggerUnit(), 0, 8.00, 80.00, 50.00, 100, 0 )
    endif
    call SetTextTagPermanent( GetLastCreatedTextTag(), false )
    call SetTextTagVelocityBJ( GetLastCreatedTextTag(), 64.00, 90 )
    call SetTextTagLifespan( GetLastCreatedTextTag(), 2.00 )
    call SetTextTagFadepoint( GetLastCreatedTextTag(), 1.50 )
    set udg_tmpPF = YDWEGetPlayersMatchingNull(Condition(function Trig_Item13_DemageAFunc007002001))
    call ShowTextTagForceBJ( false, GetLastCreatedTextTag(), udg_tmpPF )
    call DestroyForce( udg_tmpPF )
endfunction
//===========================================================================
function InitTrig_Item13_DemageA takes nothing returns nothing
    set gg_trg_Item13_DemageA = CreateTrigger()
    call TriggerAddCondition(gg_trg_Item13_DemageA, Condition(function Trig_Item13_DemageAConditions))
    call TriggerAddAction(gg_trg_Item13_DemageA, function Trig_Item13_DemageAActions)
endfunction
//===========================================================================
// Trigger: B01T 
//===========================================================================
function Trig_B01TActions2 takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
    local unit u = LoadUnitHandle(YDHT,h2i,1)
		//刪除技能
	    call UnitRemoveAbility( u, 'A0UE' )
		//clean
		call FlushChildHashtable(YDHT,h2i)
		call DestroyTimer(t)
		//// Looks up the "name" field for any object (unit, item, ability)
		//constant native GetObjectName               takes integer objectId          returns string
		//call BJDebugMsg(GetObjectName('A0UE'))
	set t = null 
    set u = null
endfunction
function Trig_B01TActions takes nothing returns nothing
    local unit u = GetTriggerUnit()
    local timer t = CreateTimer()
    local integer h2i =	GetHandleId(t)
    	//給予技能
	    call UnitAddAbility( u, 'A0UE' )
	    call UnitMakeAbilityPermanent( u, true, 'A0UE' )
		//註冊
	    call SaveUnitHandle(YDHT,h2i,1,u)
	    call TimerStart(t,10.00,false,function Trig_B01TActions2 )
	    
	set t = null 
    set u = null
endfunction
function Trig_B01TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A043' then
	    call Trig_B01TActions()
	endif
	return false
endfunction
function InitTrig_B01T takes nothing returns nothing
    set gg_trg_B01T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B01T, Condition(function Trig_B01TConditions))
endfunction
//===========================================================================
// Trigger: B02W
//===========================================================================
function Trig_B02WConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A04I' and IsUnitIllusion(GetTriggerUnit()) != true then
		call SetUnitAbilityLevel( GetTriggerUnit(), 'A01E', GetUnitAbilityLevel(GetTriggerUnit(), 'A04I') + 1 )
	endif 
	return false 
endfunction
function InitTrig_B02W takes nothing returns nothing
    set gg_trg_B02W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B02W, Condition(function Trig_B02WConditions))
endfunction//===========================================================================
// Trigger: B02E R T
//===========================================================================
globals
integer array B02R_I
unit array B02R_U
integer array B02E_I
real array B02E_X
real array B02E_Y
integer array B02T_I
unit array B02T_U
endglobals
//B02E
function Trig_B02EFunc002T takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local unit spell_caster =	LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local integer i = GetPlayerId(GetOwningPlayer(spell_caster)) + 1
	local real x
	local real y
	local real dt
	local unit hide_caster 
	
		if	(B02E_I[i]>=300)	then
			
			call FlushChildHashtable(YDHT, h2i)
			call DestroyTimer(t)
			set B02E_I[i]=0
			
		else
		
			set B02E_I[i]=(B02E_I[i]+1)
			set x=GetUnitX(spell_caster)
			set y=GetUnitY(spell_caster)
			set dt = SquareRoot( Pow(x-B02E_X[i],2) + Pow(y-B02E_Y[i],2) )
				//if Distance between	p(old),p(new) then Create new effect unit
				//
				//考量 效率(不會創造一堆單位)、視覺(不會看起來很雜)
			    if dt > 100.00 then
			        set hide_caster = CreateUnit(GetOwningPlayer(spell_caster),'h01V',x,y,0)
			        call SetUnitAbilityLevel( hide_caster, 'A099', GetUnitAbilityLevel(spell_caster, 'A08C') )
			        call UnitApplyTimedLife(hide_caster,'BHwe',10.00)
			        //更新點位置
			        set B02E_X[i] = x
			        set B02E_Y[i] = y
			        
			    endif
			    
		endif
		
	set spell_caster = null
	set t =	null
	set hide_caster = null
endfunction
function Trig_B02EActions takes nothing returns nothing
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	local unit spell_caster = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(spell_caster)) + 1
		set B02E_X[i]=GetUnitX(spell_caster)
		set B02E_Y[i]=GetUnitY(spell_caster)
		
		call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, spell_caster )
		call TimerStart(t, 0.05, true, function Trig_B02EFunc002T)
			
	set spell_caster = null
	set t = null
endfunction
//B02R
function Trig_B02RFunc001T takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local unit spell_caster =	LoadUnitHandle(YDHT, h2i, 0x9C0F555E)
	local integer i = GetPlayerId(GetOwningPlayer(spell_caster)) + 1
	local unit target_unit =	B02R_U[i]
	local real x = GetUnitX(target_unit)
	local real y = GetUnitY(target_unit)
	local real x1
	local real y1
	local unit hide_caster
	
	    if B02R_I[i] >= 19 then 
	        call FlushChildHashtable(YDHT, h2i)
	        call DestroyTimer(t) 
	    else 
	    
	    	//clock
		    set B02R_I[i]=B02R_I[i]+1
		    //location
		    set x1 = x + 420*Cos(I2R(B02R_I[i]*20)*bj_DEGTORAD)
		    set y1 = y + 420*Sin(I2R(B02R_I[i]*20)*bj_DEGTORAD)
		    //hide unit
		    set hide_caster = CreateUnit(GetOwningPlayer(spell_caster), 'h02G', x1,y1,0)
		    call UnitAddAbility(hide_caster, 'A0DD')
		    call SetUnitAbilityLevel(hide_caster, 'A0DD', GetUnitAbilityLevel(spell_caster, 'A04J'))
		    call ShowUnit(hide_caster, false)
		    call UnitApplyTimedLife(hide_caster, 'BHwe', 1.00)
		    call IssueTargetOrder(hide_caster, "thunderbolt", target_unit)	
		    	    
	    endif
	    
	set spell_caster =	null
	set target_unit =	null
	set hide_caster =	null
	set t = null
endfunction
function Trig_B02RActions takes nothing returns nothing
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	local unit spell_caster = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(spell_caster)) + 1
	
		set B02R_I[i]=0
		set B02R_U[i]=GetSpellTargetUnit()
		
		call SaveUnitHandle(YDHT, h2i, 0x9C0F555E, GetTriggerUnit())
		call TimerStart(t, 0.10, true, function Trig_B02RFunc001T)
		    
	set t =	null
	set spell_caster = null
endfunction
//B02T
function Trig_B02TFunc001T takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local unit spell_caster =	LoadUnitHandle(YDHT, h2i, 0x9C0F555E)
	local integer i = GetPlayerId(GetOwningPlayer(spell_caster)) + 1
	local unit target_unit =	B02T_U[i]
	local real x = GetUnitX(target_unit)
	local real y = GetUnitY(target_unit)	
	local real x1
	local real y1	
	local integer i2 
	local unit hide_caster
	
	    if B02T_I[i] ==0 then
	        call FlushChildHashtable(YDHT, h2i)
	        call DestroyTimer(t)
		else
			//Clock
			set B02T_I[i]=B02T_I[i]-1
			//暈眩效果
		    set hide_caster = CreateUnit(GetOwningPlayer(spell_caster), 'h02G', x,y,0)
		    call UnitAddAbility(hide_caster, 'A08B')
		    call ShowUnit(hide_caster, false)
		    call UnitApplyTimedLife(hide_caster, 'BHwe', 1.00)
		    call IssueTargetOrder(hide_caster, "thunderbolt", target_unit)
		        //effect
			    set i2 = 1
			    loop
			        exitwhen i2 > 4
			        set x1 = x + 245.00*Cos(I2R(i2*90)*bj_DEGTORAD)
			        set y1 = y + 245.00*Sin(I2R(i2*90)*bj_DEGTORAD)
			        set hide_caster = CreateUnit(GetOwningPlayer(spell_caster), 'h01E', x1,y1,0)
			        call UnitAddAbility(hide_caster, 'A0X7')
			        call UnitApplyTimedLife(hide_caster, 'BHwe', 3.00)
			        call IssueTargetOrder(hide_caster, "chainlightning", target_unit) 
			        set i2 = i2 + 1 
			    endloop
			//Damage     
		    call UnitDamageTarget(spell_caster,target_unit,175.00, true, false, ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
		endif 
		
	set t = null
	set spell_caster = null
	set target_unit = null
	set hide_caster = null
endfunction
function Trig_B02TActions takes nothing returns nothing
	local timer t =	CreateTimer()
	local integer h2i = GetHandleId(t)
	local unit spell_caster = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(spell_caster)) + 1
	
		set B02T_I[i]=3 + GetUnitAbilityLevel(spell_caster, 'A089') 
		set B02T_U[i]=GetSpellTargetUnit()
		call SaveUnitHandle(YDHT, h2i, 0x9C0F555E, GetTriggerUnit())
		call TimerStart(t, 1.00, true, function Trig_B02TFunc001T)
		    
    set t =	null
    set spell_caster = null
endfunction
function Trig_B02E_R_TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A08C' then
	    call Trig_B02EActions()
	elseif GetSpellAbilityId() == 'A04J' then
		call Trig_B02RActions() 
	elseif GetSpellAbilityId() == 'A089' then
		call Trig_B02TActions() 
	endif
	return false 
endfunction
function InitTrig_B02E_R_T takes nothing returns nothing
    set gg_trg_B02E_R_T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B02E_R_T, Condition(function Trig_B02E_R_TConditions))
endfunction
//===========================================================================
// Trigger: B03
//===========================================================================
globals
unit array B03T_U
unit array Random_U
endglobals
//B03W_1
function Trig_B03W_learnActions takes nothing returns nothing
local unit u = GetTriggerUnit()
    if GetUnitAbilityLevel(u, 'A04L') == 0 then
        call UnitAddAbility( u, 'A04L' )
        call UnitAddAbility( u, 'A04M' )
    else
        call SetUnitAbilityLevel( u, 'A04L', GetUnitAbilityLevel( u, 'A04K') )
        call SetUnitAbilityLevel( u, 'A04M', GetUnitAbilityLevel( u, 'A04K') )
    endif
set u = null 
endfunction
function Trig_B03W_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A04K' and IsUnitIllusion(GetTriggerUnit()) != true then
	    call Trig_B03W_learnActions()
    endif
    return false
endfunction
//B03W_2
function Trig_B03W_castActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u3
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    local real a = GetUnitFacing(u1)*3.14159/180.0
    local real x1 
    local real y1 
    local integer i = GetSpellAbilityId()
		    if i == 'A04K' then
		        set x1 = x + 100.00*Cos(a)
		        set y1 = y + 100.00*Sin(a)
		    else
		        if i == 'A04L' then
		            set x1 = x + 400.00*Cos(a)
		            set y1 = y + 400.00*Sin(a)
		        else
		            if i == 'A04M' then
		                set x1 = x + 700.00*Cos(a)
		                set y1 = y + 700.00*Sin(a)
		            endif
		        endif
		    endif
		//for sign    
	    set u3=CreateUnit(GetOwningPlayer(u1), 'h02G', x1,y1, 0)
	    call UnitApplyTimedLife(u3, 'BHwe', 0.01) 
	    call ShowUnit(u3, false)
		//for spell
	    set u3=CreateUnit(GetOwningPlayer(u1), 'h01E', x1,y1, 0)
	    call UnitApplyTimedLife(u3, 'BHwe', 4.00) 
	    call UnitAddAbility(u3, 'A0F6')
	    call SetUnitAbilityLevel(u3, 'A0F6', GetUnitAbilityLevel(u1, 'A04K'))
	    call IssueImmediateOrder(u3, "stomp")
	    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Thunderclap\\ThunderClapCaster.mdl", x1,y1))
    set u1=null
    set u3=null
endfunction
function Trig_B03W_castConditions takes nothing returns boolean
	local integer i = GetSpellAbilityId()
    if i == 'A04K' or i == 'A04L' or i == 'A04M' then
	    call Trig_B03W_castActions()
    endif
    return false
endfunction
//B03E
function Trig_B03E_learnActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B03E_damage, GetTriggerUnit(), EVENT_UNIT_DAMAGED)
    set udg_B03E_B[GetPlayerId(GetOwningPlayer(GetTriggerUnit())) + 1] = true
	    if GetTriggerExecCount(GetTriggeringTrigger()) == 1 then
	        call TriggerRegisterAnyUnitEventBJ(gg_trg_B03E_kill, EVENT_PLAYER_UNIT_DEATH)
	    endif
endfunction
function Trig_B03E_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A04O' and GetUnitAbilityLevel(GetTriggerUnit(), 'A04O') == 1 and IsUnitIllusion(GetTriggerUnit()) != true then
    	call Trig_B03E_learnActions()
	endif
    return false
endfunction
//B03R
function Trig_B03R_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A04P' and GetUnitAbilityLevel(GetTriggerUnit(), 'A04P') == 1 and IsUnitIllusion(GetTriggerUnit()) != true then
    	call TriggerRegisterUnitEvent(gg_trg_B03R_start, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
	endif
    return false
endfunction
//B03T
//////////////////////////////////////////////////////////////////
//自製隨機系統: 一個整數,一個單位陣列 達成 
//             挑取為了防特別情況 設一個 exitwhen end > 10
//////////////////////////////////////////////////////////////////
function Trig_B03T_STartFunc018T takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local unit u1 =LoadUnitHandle(YDHT, h2i, 0x9C0F555E)
	local player p = GetOwningPlayer(u1)
	local integer i = GetPlayerId(p) + 1
	local unit u3 =B03T_U[i]
	local integer end = 0
	local real x 
	local real y 
	local unit ydl_unit	
    	if GetUnitAbilityLevel(u1, 'B06R') <= 0 or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 then
    		call FlushChildHashtable(YDHT, h2i)
    		call DestroyTimer(t)
    	else
    		set x = GetUnitX(u1)
    		set y = GetUnitY(u1)	
    		call SetUnitX(u3,x)
			call SetUnitY(u3,y)
    		call GroupEnumUnitsInRange(udg_Group[4], x, y, 600.00, null)
				loop
					set ydl_unit=FirstOfGroup(udg_Group[4])
					exitwhen ydl_unit == null or end > 5
						call GroupRemoveUnit(udg_Group[4], ydl_unit) 
							if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true and GetUnitPointValue(ydl_unit) != 1 then
								set end = end + 1
								set Random_U[end] = ydl_unit 
							endif
				endloop 
			////////////////////
			//隨機單位系統
			////////////////////	
			call GroupClear(udg_Group[4]) 
			if end > 0 then
				call IssueTargetOrder(u3, "thunderbolt", Random_U[GetRandomInt(1,end)] )
			endif	
    	endif 
   	set p = null
  	set ydl_unit=null 
    set u1=null
    set u3=null
    set t=null
endfunction
function Trig_B03T_STartActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local unit u3 =CreateUnit(GetOwningPlayer(u1), 'h01E', 0.00,0.00, 0)
	call UnitAddAbility(u3, 'A04Q')
	call SetUnitAbilityLevel(u3, 'A04Q', GetUnitAbilityLevel(u1, 'A011'))
	call UnitApplyTimedLife(u3, 'BHwe', 30.00)
	set B03T_U[i]=u3
    call SaveUnitHandle(YDHT, h2i, 0x9C0F555E, GetTriggerUnit())
    call TimerStart(t, 0.80, true, function Trig_B03T_STartFunc018T )
set t=null
set u1 = null
endfunction
function Trig_B03T_STartConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A011' then
	    call Trig_B03T_STartActions()
    endif
    return false
endfunction
function InitTrig_B03_INIT takes trigger ltt_init returns nothing
///////////////////////////////////////////////////////
//【注意】a.一定要 h2i = ltt_init 要不然會沒有重複 h2i
// ////////////////////////////////////////////////////
local trigger ltt
local integer h2i = GetHandleId(ltt_init)
    // -------------
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_B03W_learnConditions))
	call SaveTriggerHandle(udg_Trigger_H,h2i,1,ltt) 
    // -------------	 
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_B03W_castConditions))
	call SaveTriggerHandle(udg_Trigger_H,h2i,2,ltt)
    // -------------	
	set ltt = CreateTrigger() 
	call TriggerAddCondition(ltt, Condition(function Trig_B03E_learnConditions))
    call SaveTriggerHandle(udg_Trigger_H,h2i,3,ltt)
    // -------------    
    set ltt = CreateTrigger() 
    call TriggerAddCondition(ltt, Condition(function Trig_B03R_learnConditions))
    call SaveTriggerHandle(udg_Trigger_H,h2i,5,ltt) 
    // -------------  
    set ltt = CreateTrigger() 
    call TriggerAddCondition(ltt, Condition(function Trig_B03T_STartConditions))
    call SaveTriggerHandle(udg_Trigger_H,h2i,6,ltt) 
set ltt = null 
endfunction
function Trig_B03Actions takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
local integer h2i = GetHandleId(ltt)
local unit u = udg_A_common_HERO
	/////////////////////
	//第一次註冊 TC , TA
	////////////////////
	if GetTriggerExecCount(ltt) == 1 then
		call InitTrig_B03_INIT(ltt)
	endif 
	/////////////
	//註冊 TE
	//////////// 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,1)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_HERO_SKILL) 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,2)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
    // -------------
	set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,3)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_HERO_SKILL) 
    // -------------
	set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,5)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_HERO_SKILL) 
    // -------------
	set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,6)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
    // -------------
set u = null
set ltt = null 
endfunction
//===========================================================================
function InitTrig_B03 takes nothing returns nothing
    set gg_trg_B03 = CreateTrigger()
    call TriggerAddAction(gg_trg_B03, function Trig_B03Actions)
endfunction
//===========================================================================
// Trigger: B03E damage
//===========================================================================
function Trig_B03E_damageConditions takes nothing returns nothing
local unit u1 
	if GetEventDamage() > 1.00 then
		set u1 = GetTriggerUnit()
			if GetRandomInt(1, 100) <= 4 + 4 * GetUnitAbilityLevel(u1, 'A04O') and GetUnitState(u1, UNIT_STATE_LIFE) / GetUnitState(u1, UNIT_STATE_MAX_LIFE) * 100.0 >= 15.00 then
				call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + GetEventDamage() )
				call SetUnitState(u1, UNIT_STATE_MANA, GetUnitState(u1, UNIT_STATE_MANA) - 0.02*GetUnitState(u1, UNIT_STATE_MAX_MANA) )
			endif
	endif	
set u1 = null 
endfunction
//===========================================================================
function InitTrig_B03E_damage takes nothing returns nothing
    set gg_trg_B03E_damage = CreateTrigger()
    call TriggerAddCondition(gg_trg_B03E_damage, Condition(function Trig_B03E_damageConditions))
endfunction//===========================================================================
// Trigger: B03E kill
//===========================================================================
function Trig_B03E_killConditions takes nothing returns nothing
local integer i = GetPlayerId(GetOwningPlayer(GetKillingUnit())) + 1
local real mana
	if udg_B03E_B[i] then	
		set mana = GetUnitState(udg_S01_hero_of_player[i], UNIT_STATE_MANA) + 2.00 + 3.00 * I2R(GetUnitAbilityLevel(udg_S01_hero_of_player[i], 'A04O')) 
		call SetUnitState(udg_S01_hero_of_player[i], UNIT_STATE_MANA, mana)
    endif	
endfunction
//===========================================================================
function InitTrig_B03E_kill takes nothing returns nothing
    set gg_trg_B03E_kill = CreateTrigger()
    call DisableTrigger(gg_trg_B03E_kill)
    call TriggerAddCondition(gg_trg_B03E_kill, Condition(function Trig_B03E_killConditions))
endfunction//===========================================================================
// Trigger: B03R start
//===========================================================================
function Trig_B03R_startFunc003Conditions takes nothing returns nothing	
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local real dmg = I2R(GetHeroStr(u1, true)) * 0.35 * I2R(GetUnitAbilityLevel(u1, 'A04P')) 
		//Avoid crash
        call FlushChildHashtable(YDHT, h2i)
		call DestroyTrigger(ltt)
		set udg_B12R_B[i]=false
		//////////////
		//傷害+特效
		//////////////
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
	    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\DragonHawkMissile\\DragonHawkMissile.mdl", u2, "chest") )
	    call UnitDamageTarget(u1, u2, dmg, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS)
	set ltt = null
	set u1 = null
    set u2 = null
endfunction
function Trig_B03R_startActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit()
    local trigger ltt
    local integer h2i 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local triggercondition ltc
    	if udg_B12R_B[i]==false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false then
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
    		///////////
    		//參數設定
    		//////////	    	
	    	set udg_B12R_B[i]=true
		    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    set ltc = TriggerAddCondition(ltt, Condition(function Trig_B03R_startFunc003Conditions))
		    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
	    	/////////////////////////////////////////////////////////////
		    //timer check + 觸發器登記
		    /////////////////////////////////////////////////////////////
		    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
            call Normal_Attack_Timer_for_Trigger(ltt,0.30 , ltc , i)	
		endif 
	set ltc = null	
    set ltt=null
    set u1 = null
    set u2 = null
endfunction
function InitTrig_B03R_start takes nothing returns nothing
    set gg_trg_B03R_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_B03R_start, Condition(function Trig_B03R_startActions))
endfunction//===========================================================================
// Trigger: B04
//===========================================================================
globals
real array B04W_R
real array B04W_A
endglobals
//B04W
function Trig_B04WFunc010T takes nothing returns nothing
    local timer t=GetExpiredTimer()
    local integer h2i = GetHandleId(t)
    local unit u1=LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1 
    local real x1=GetUnitX(u1)
    local real y1=GetUnitY(u1)
    local real x2
    local real y2
    local real a =B04W_A[i]
	    if B04W_R[i] > 45.00 then
		    set x2=( x1 + ( 45.00 * Cos(a) ) )
		    set y2=( y1 + ( 45.00 * Sin(a) ) )
		    set B04W_R[i] = B04W_R[i] - 45
		    call SetUnitX(u1, x2)
    		call SetUnitY(u1, y2)
	    else
		    set x2=( x1 + ( 35 * Cos(a) ) )
		    set y2=( y1 + ( 35 * Sin(a) ) )
		    call SetUnitX(u1, x2)
    		call SetUnitY(u1, y2)
		    call FlushChildHashtable(YDHT, h2i)
		    call DestroyTimer(t)
		    call UnitRemoveAbility(u1,'A08F')
    	endif
    set t=null
    set u1=null
endfunction
function Trig_B04WActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
local real x=GetUnitX(u1)
local real y=GetUnitY(u1)
local real x1=GetSpellTargetX()
local real y1=GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
local real dt = SquareRoot(Pow((x1-x),2)+Pow((y1-y),2))
	call UnitAddAbility(u1, 'A08F')
	call SetUnitAbilityLevel(u1, 'A08F', GetUnitAbilityLevel(u1, 'A08E'))
	set B04W_R[i]=dt
	set B04W_A[i]=a
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, GetTriggerUnit())
    call TimerStart(t, 0.01, true, function Trig_B04WFunc010T)
set t=null
set u1 = null
endfunction
//B04E
function Trig_B04EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u3
    local real x = GetSpellTargetX()
    local real y = GetSpellTargetY()
	    set u3 = CreateUnit(GetOwningPlayer(u1), 'nbee', x, y, 270)
	    call UnitApplyTimedLife( u3, 'BHwe', 2.00 )
	    set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', x, y, 0)
	    call UnitApplyTimedLife( u3, 'BHwe', 4.00 )
	    call UnitAddAbility( u3, 'A04V' )
	    call SetUnitAbilityLevel( u3, 'A04V', GetUnitAbilityLevel(u1, 'A04U') )
	    call IssueImmediateOrder( u3, "stomp" )
    set u1 = null
    set u3 = null
endfunction
function Trig_B04Conditions takes nothing returns boolean
local integer id = GetSpellAbilityId()
    if id == 'A08E' then
	    call Trig_B04WActions()
	elseif id == 'A04U' then
		call Trig_B04EActions()
    endif
    return false
endfunction
function InitTrig_B04 takes nothing returns nothing
    set gg_trg_B04=CreateTrigger()
    call TriggerAddCondition(gg_trg_B04, Condition(function Trig_B04Conditions))
endfunction
//===========================================================================
// Trigger: B05R Learn
//===========================================================================
function Trig_B05R_LearnActions takes nothing returns nothing
	local unit u = GetTriggerUnit()
	local player p = GetTriggerPlayer()
	local integer id =	GetPlayerId(p)	+	1
	local integer	level	=	GetUnitAbilityLevel(u, 'A013')
		//FOR FIRST LEARN THE ABILITY
	    if GetUnitAbilityLevel(u, 'A04T') == 0 then
		    //FOR PLAYER LOOL
	        call UnitAddAbility( u,'A04T' )
	        //FOR HERO DEAD THE EFFECT IS STILL WORK
	        set	udg_B05R_HIDE_UNIT[id]	=	CreateUnit(p,'n02X',0,0,0)
	        call UnitAddAbility( udg_B05R_HIDE_UNIT[id],'A04T' )
	        //REGISTERUNIT SPELL EFFECT EVENT
	        call TriggerRegisterUnitEvent(gg_trg_B05R, u, EVENT_UNIT_SPELL_EFFECT)
	    endif
	//FOR PLAYER UI    
    call SetUnitAbilityLevel( u, 'A04T', level )
    	//AVIOD CRASH
    	if	udg_B05R_HIDE_UNIT[id]	!= null and GetUnitState(udg_B05R_HIDE_UNIT[id],UNIT_STATE_LIFE) > 0 then
	    	call SetUnitAbilityLevel( udg_B05R_HIDE_UNIT[id], 'A04T', level )
    	endif
    set u	=	null
    set p	=	null
endfunction
function Trig_B05R_LearnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A013' and IsUnitIllusion(GetTriggerUnit()) != true then
	    call Trig_B05R_LearnActions()
    endif
    return false
endfunction
function InitTrig_B05R_Learn takes nothing returns nothing
    set gg_trg_B05R_Learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B05R_Learn, Condition(function Trig_B05R_LearnConditions))
endfunction
globals
unit	array udg_B05R_HIDE_UNIT
endglobals//===========================================================================
// Trigger: B05R
//===========================================================================
function Trig_B05RConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A013' then
	    call UnitDamageTarget(GetTriggerUnit(), GetSpellTargetUnit(), I2R(GetHeroInt(GetTriggerUnit(), true)) * 2.00 , true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
    endif
    return false
endfunction
function InitTrig_B05R takes nothing returns nothing
    set gg_trg_B05R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B05R, Condition(function Trig_B05RConditions))
endfunction
//===========================================================================
// Trigger: B06
//===========================================================================
globals
group array udg_B06W_G
integer array udg_B06W_I
endglobals
//B06W
function Trig_B06_WFunc009Func006A takes nothing returns nothing	
    call UnitRemoveAbility(GetEnumUnit(), 'A0LB') 
endfunction
function Trig_B06_WFunc009Func012A takes nothing returns nothing
local unit ydl_unit = GetEnumUnit() 
	call SetUnitState(ydl_unit, UNIT_STATE_MANA, GetUnitState(ydl_unit, UNIT_STATE_MANA) + rose_real)
set ydl_unit = null
endfunction
function Trig_B06_W_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(YDHT, h2i, 1)
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	if udg_B06W_I[i] > 12 then
		call ForGroup(udg_B06W_G[i],function Trig_B06_WFunc009Func006A)
	    call FlushChildHashtable(YDHT, h2i)
	    call DestroyGroup(udg_B06W_G[i])
	    call DestroyTimer(t) 
	else 
		set udg_B06W_I[i] = udg_B06W_I[i] + 1
		//傳遞全域變數
		set rose_real = 5.00 + 5.00 * I2R(GetUnitAbilityLevel(u1, 'A0LA')) 
		call ForGroup(udg_B06W_G[i],function Trig_B06_WFunc009Func012A)
	endif
set u1 = null
set t = null
endfunction
function Trig_B06_WActions takes nothing returns nothing
	local unit ydl_unit
	local unit u1 = GetTriggerUnit()
	local player p =GetOwningPlayer(u1)
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	local real x = GetUnitX(u1)
	local real y = GetUnitY(u1)
	local integer i =GetPlayerId(p) + 1
	local integer level = GetUnitAbilityLevel(u1, 'A0LA')
		//參數設定
		set udg_B06W_I[i] = 0
		set udg_B06W_G[i] = CreateGroup()
		call SaveUnitHandle(YDHT, h2i, 1, u1 )
			//選取單位組
		    call GroupEnumUnitsInRange(udg_Group[6], x, y, 300.00, null)
		    loop
		    set ydl_unit = FirstOfGroup(udg_Group[6])
		    exitwhen ydl_unit == null 
		        call GroupRemoveUnit(udg_Group[6], ydl_unit)
		        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitAlly(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false then
			        call GroupAddUnit(udg_B06W_G[i],ydl_unit)
			        call UnitAddAbility(ydl_unit, 'A0LB')
			        call SetUnitAbilityLevel(ydl_unit,'A0LB', level)
		        endif
		    endloop
		call TimerStart(t, 1.00, true, function Trig_B06_W_timer)
    set ydl_unit=null
    set t = null
    set u1 = null
    set p = null
endfunction
function Trig_B06_WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0LA' then
	    call Trig_B06_WActions()
    endif
    return false
endfunction
//B06E
function Trig_B06E_startConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0IV' then
	    call ChainAbility(0,"",'A04Z',"thunderbolt",'e007','n007',525,5,800,2)
    endif
    return false
endfunction
function Trig_B06_INIT takes trigger ltt_init returns nothing
///////////////////////////////////////////////////////
//【注意】a.一定要 h2i = ltt_init 要不然會沒有重複 h2i
// ////////////////////////////////////////////////////
local trigger ltt
local integer h2i = GetHandleId(ltt_init)
    // -------------
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_B06_WConditions ))
	call SaveTriggerHandle(udg_Trigger_H,h2i,1,ltt) 
    // -------------	 
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_B06E_startConditions))
	call SaveTriggerHandle(udg_Trigger_H,h2i,2,ltt) 
set ltt = null 
endfunction
function Trig_B06Actions takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
local integer h2i = GetHandleId(ltt)
local unit u = udg_A_common_HERO
	/////////////////////
	//第一次註冊 TC , TA
	////////////////////
	if GetTriggerExecCount(ltt) == 1 then
		call Trig_B06_INIT(ltt)
		call TriggerRegisterAnyUnitEventBJ( gg_trg_B06R, EVENT_PLAYER_UNIT_SPELL_EFFECT )
	endif 
	/////////////
	//註冊 TE
	//////////// 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,1)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,2)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
set u = null
set ltt = null
endfunction
//===========================================================================
function InitTrig_B06 takes nothing returns nothing
    set gg_trg_B06 = CreateTrigger()
    call TriggerAddAction(gg_trg_B06, function Trig_B06Actions)
endfunction
//===========================================================================
// Trigger: B06R
//===========================================================================
function Trig_B06RConditions takes nothing returns boolean
local unit u2 = GetSpellTargetUnit()	
    if GetUnitAbilityLevel(u2, 'A050') > 0 and IsUnitEnemy(GetTriggerUnit(), GetOwningPlayer(u2)) and udg_B06R_B[GetPlayerId(GetOwningPlayer(u2)) + 1] == false then
    	set u2 = null
    	return true
    else
    	set u2 = null
		return false 
	endif
endfunction
function Trig_B06RActions takes nothing returns nothing
    local unit u2=GetSpellTargetUnit()
    local integer i = GetPlayerId(GetOwningPlayer(u2)) + 1
    local real time = 44.00 - 8.00 * I2R(GetUnitAbilityLevel( u2, 'A050')) 
	    call UnitAddAbility( u2, 'A0LL' )
	    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Demon\\ReviveDemon\\ReviveDemon.mdl",u2, "chest") ) 
	    // 多人判斷用
	    set udg_B06R_B[i] = true
	    //remove ability
	    call YDWEPolledWaitNull(3.00)
	    call UnitRemoveAbility(u2, 'A0LL' )
	    //重新計算
	    call YDWEPolledWaitNull( time )
    	set udg_B06R_B[i] = false
    set u2 = null
endfunction
//===========================================================================
function InitTrig_B06R takes nothing returns nothing
    set gg_trg_B06R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B06R, Condition(function Trig_B06RConditions))
    call TriggerAddAction(gg_trg_B06R, function Trig_B06RActions)
endfunction//===========================================================================
// Trigger: B07
//===========================================================================
function Trig_B07Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B07_Upgrade, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B07E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B07E_drop, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_PICKUP_ITEM)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B07E_die, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_DEATH)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B07E_spell, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B07R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    set udg_B07_ability[0] = 'A0WV'
    set udg_B07_ability[1] = 'A0WW'
    set udg_B07_ability[2] = 'A0WU'
endfunction
//===========================================================================
function InitTrig_B07 takes nothing returns nothing
    set gg_trg_B07 = CreateTrigger()
    call TriggerAddAction(gg_trg_B07, function Trig_B07Actions)
endfunction
//===========================================================================
// Trigger: B07 Upgrade
//===========================================================================
function Trig_B07_UpgradeConditions takes nothing returns boolean
    return ((ModuloInteger(GetHeroLevel(GetTriggerUnit()), 4) == 0))
endfunction
function Trig_B07_UpgradeActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rhgb', ( GetHeroLevel(GetTriggerUnit()) / 4 ), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_B07_Upgrade takes nothing returns nothing
    set gg_trg_B07_Upgrade = CreateTrigger()
    call TriggerAddCondition(gg_trg_B07_Upgrade, Condition(function Trig_B07_UpgradeConditions))
    call TriggerAddAction(gg_trg_B07_Upgrade, function Trig_B07_UpgradeActions)
endfunction
//===========================================================================
// Trigger: B07E
//
// A_tool[0]修正原本被寫成1的部分以免第二格有童子切等東西國崩隊就不能拿東西
// 設置最後創建的物品 不掉落在死亡時
// I01V
//===========================================================================
function Trig_B07EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A05Y' ) )
endfunction
function Trig_B07EActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local integer h2i = GetHandleId(u1)
local unit u3 
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local item tem1 
local item tem2 
local integer code1
local integer code2
call SaveUnitHandle(udg_B07_H,h2i,3,LoadUnitHandle(udg_B07_H,h2i,2))
call SaveUnitHandle(udg_B07_H,h2i,2,LoadUnitHandle(udg_B07_H,h2i,1))
call DisableTrigger(gg_trg_B07E_drop)
set u3 = CreateUnit(GetOwningPlayer(u1),'nhym',x,y,0)
call UnitAddAbility(u3, 'A052')
call SetUnitAbilityLevel(u3, 'A052', GetUnitAbilityLevel(u1, 'A05Y'))
    if ( ( GetUnitAbilityLevel(u1, 'A05Y') != 1 ) ) then
	    call UnitAddAbility(u3, udg_B07_ability[( GetUnitAbilityLevel(u1, 'A05Y') - 2 )])
    endif
call SaveUnitHandle(udg_B07_H,h2i,1,u3) 
set tem1=UnitItemInSlot(u1, 0)
set tem2=UnitItemInSlot(u1, 1)
set code1=GetItemTypeId(tem1)
set code2=GetItemTypeId(tem2)
    if ( ( code1 != 'I01V' ) and ( code1 != 'I02F' ) and ( code1 != 'rde0' ) and ( code1 != 'frgd' ) and ( code1 != 'ram3' ) and ( code1 != 'gemt' ) and ( code1 != 'fgrg' ) and ( code1 != 'ankh' ) and ( code1 != 'I01F' ) and ( code1 != 'I045' ) and ( code1 != 'I044' ) and ( code1 != 'sor8' ) and ( code1 != 'clsd' ) and ( code1 != 'lgdh' ) and ( code1 != GetItemTypeId(null) ) ) then
	    call UnitAddItemToSlotById(u3, code1, 0)
	    call SetItemDroppable(UnitItemInSlotBJ(u3, 1), false)
	    call SetItemDropOnDeath(UnitItemInSlotBJ(u3, 1), false)
    else
    	call UnitAddItemToSlotById(u3, 'I03W', 0)
    endif
    if ( ( code2 != 'I01V' ) and ( code2 != 'gemt' ) and ( code2 != 'ram3' ) and ( code2 != 'frgd' ) and ( code2 != 'rde0' ) and ( code2 != 'I02F' ) and ( code2 != 'fgrg' ) and ( code2 != 'I01F' ) and ( code2 != 'ankh' ) and ( code2 != 'I045' ) and ( code2 != 'sor8' ) and ( code2 != 'clsd' ) and ( code2 != GetItemTypeId(null) ) and ( code2 != 'lgdh' ) ) then
	    call UnitAddItemToSlotById(u3, code2, 1)
	    call SetItemDroppable(UnitItemInSlotBJ(u3, 2), false)
	    call SetItemDropOnDeath(UnitItemInSlotBJ(u3, 2), false)
    else
    	call UnitAddItemToSlotById(u3, 'I03W', 1)
    endif
    
call EnableTrigger(gg_trg_B07E_drop)
    if ( ( IsUnitAliveBJ(LoadUnitHandle(udg_B07_H,h2i,3)) == true ) ) then
    call KillUnit(LoadUnitHandle(udg_B07_H,h2i,3))
    endif
set u1 = null
set u3 = null
set tem1 = null
set tem2 = null
endfunction
//===========================================================================
function InitTrig_B07E takes nothing returns nothing
    set gg_trg_B07E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B07E, Condition(function Trig_B07EConditions))
    call TriggerAddAction(gg_trg_B07E, function Trig_B07EActions)
endfunction
//===========================================================================
// Trigger: B07E drop
//===========================================================================
function Trig_B07E_dropConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetTriggerUnit()) == 'nhym'))
endfunction
function Trig_B07E_dropActions takes nothing returns nothing
    call UnitRemoveItemSwapped( GetManipulatedItem(), GetTriggerUnit() )
endfunction
//===========================================================================
function InitTrig_B07E_drop takes nothing returns nothing
    set gg_trg_B07E_drop = CreateTrigger()
    call TriggerAddCondition(gg_trg_B07E_drop, Condition(function Trig_B07E_dropConditions))
    call TriggerAddAction(gg_trg_B07E_drop, function Trig_B07E_dropActions)
endfunction
//===========================================================================
// Trigger: B07E die
//
// 改爲B07e_creat[1]=b07e_creat[2].原本會讓B07e_creat[1]暫時無儲存東西
//===========================================================================
function Trig_B07E_dieConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetTriggerUnit()) == 'nhym'))
endfunction
function Trig_B07E_dieActions takes nothing returns nothing
    call RemoveItem( UnitItemInSlot(GetTriggerUnit(), 0) )
    call RemoveItem( UnitItemInSlot(GetTriggerUnit(), 1) )
    if ((IsUnit(GetDyingUnit(), LoadUnitHandle(udg_B07_H, YDWEH2I(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]), 1)) == true)) then
        call SaveUnitHandle( udg_B07_H, YDWEH2I(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]), 1, LoadUnitHandle(udg_B07_H, YDWEH2I(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]), 2) )
        call SaveUnitHandle( udg_B07_H, YDWEH2I(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]), 2, null )
    else
    endif
endfunction
//===========================================================================
function InitTrig_B07E_die takes nothing returns nothing
    set gg_trg_B07E_die = CreateTrigger()
    call TriggerAddCondition(gg_trg_B07E_die, Condition(function Trig_B07E_dieConditions))
    call TriggerAddAction(gg_trg_B07E_die, function Trig_B07E_dieActions)
endfunction
//===========================================================================
// Trigger: B07E spell
//===========================================================================
function Trig_B07E_spellConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetTriggerUnit()) == 'nhym'))
endfunction
function Trig_B07E_spellActions takes nothing returns nothing
    call ConditionalTriggerExecute( gg_trg_Hero_Spell_Item_Ability )
endfunction
//===========================================================================
function InitTrig_B07E_spell takes nothing returns nothing
    set gg_trg_B07E_spell = CreateTrigger()
    call TriggerAddCondition(gg_trg_B07E_spell, Condition(function Trig_B07E_spellConditions))
    call TriggerAddAction(gg_trg_B07E_spell, function Trig_B07E_spellActions)
endfunction
//===========================================================================
// Trigger: B07R learn
//===========================================================================
function Trig_B07R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0IJ') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_B07R_learnActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rhra', GetUnitAbilityLevel(GetTriggerUnit(), 'A0IJ'), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_B07R_learn takes nothing returns nothing
    set gg_trg_B07R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B07R_learn, Condition(function Trig_B07R_learnConditions))
    call TriggerAddAction(gg_trg_B07R_learn, function Trig_B07R_learnActions)
endfunction
//===========================================================================
// Trigger: B08
//===========================================================================
function Trig_B08Actions takes nothing returns nothing
local integer i = GetPlayerId(GetOwningPlayer(udg_A_common_HERO)) + 1
    call TriggerRegisterUnitEvent(gg_trg_B08_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B08_R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    set udg_B08R_T[i] = CreateTimer()
    call SaveInteger(YDHT, GetHandleId(udg_B08R_T[i]), 0xA1614B4D, i)
endfunction
//===========================================================================
function InitTrig_B08 takes nothing returns nothing
    set gg_trg_B08 = CreateTrigger()
    call TriggerAddAction(gg_trg_B08, function Trig_B08Actions)
endfunction//===========================================================================
// Trigger: B08 E
//===========================================================================
function Trig_B08_EConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0EP'
endfunction
function Trig_B08_EActions takes nothing returns nothing
    local unit u1 =	GetTriggerUnit()
    local unit u2 =	GetSpellTargetUnit()
    local integer	level	=	GetUnitAbilityLevel(u1,'A0EP')
    local real mana 
    
	    call TriggerSleepAction(0.00)
	    //move
	    call SetUnitPosition( u1, GetUnitX(u2), GetUnitY(u2) )
	    //decreast mana
	    set mana = GetUnitState(u2,UNIT_STATE_MANA) - 40.00 - 60.00 * I2R(level) 
	    call SetUnitState(u2, UNIT_STATE_MANA, mana) 
	    //Issue
	    call IssueTargetOrderById( u1, 851983, u2 )
	    
    set u1 = null
    set u2 = null
endfunction
//===========================================================================
function InitTrig_B08_E takes nothing returns nothing
    set gg_trg_B08_E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B08_E, Condition(function Trig_B08_EConditions))
    call TriggerAddAction(gg_trg_B08_E, function Trig_B08_EActions)
endfunction//===========================================================================
// Trigger: B08 R learn
//===========================================================================
function Trig_B08_R_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A056' and GetUnitAbilityLevel(GetTriggerUnit(), 'A056') == 1 and IsUnitIllusion(GetTriggerUnit()) != true then
    	call TriggerRegisterUnitEvent(gg_trg_B08_R_add, GetTriggerUnit(), EVENT_UNIT_SPELL_EFFECT)
    	call TriggerRegisterUnitEvent(gg_trg_B08_R_reduce_damage, GetTriggerUnit(), EVENT_UNIT_DAMAGED)
	endif
	return false
endfunction
function InitTrig_B08_R_learn takes nothing returns nothing
    set gg_trg_B08_R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B08_R_learn, Condition(function Trig_B08_R_learnConditions))
endfunction
//===========================================================================
// Trigger: B08 R add
//===========================================================================
globals
integer array B08R_I
endglobals
function Trig_B08_R_addFunc014T takes nothing returns nothing
local integer i =LoadInteger(YDHT, GetHandleId(GetExpiredTimer()), 0xA1614B4D)
    call SetUnitAbilityLevel(udg_S01_hero_of_player[i], 'A0D2', 1)
    call PauseTimer(GetExpiredTimer()) 
    //call BJDebugMsg(I2S(i))  
endfunction
function Trig_B08_R_addConditions takes nothing returns boolean
local timer t 
local unit u1 = GetTriggerUnit()
local integer i =GetPlayerId(GetOwningPlayer(u1)) + 1
		//攻擊力
        if GetUnitAbilityLevel(u1, 'A0D2') < 4 + GetUnitAbilityLevel(u1, 'A056') then
            call IncUnitAbilityLevel(u1, 'A0D2')
        endif 
    //call BJDebugMsg( R2S(TimerGetElapsed(udg_B08R_T[i])) )        
    call PauseTimer(udg_B08R_T[i])
    call TimerStart(udg_B08R_T[i], 8.00, false, function Trig_B08_R_addFunc014T)
set t=null
set u1 = null
return false
endfunction
function InitTrig_B08_R_add takes nothing returns nothing
    set gg_trg_B08_R_add=CreateTrigger()
    call TriggerAddCondition(gg_trg_B08_R_add, Condition(function Trig_B08_R_addConditions))
endfunction//===========================================================================
// Trigger: B08 R reduce damage
//===========================================================================
function Trig_B08_R_reduce_damageActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local real R
    	//這邊要減1 是因為基礎等級已經是 1了
	    if GetUnitAbilityLevel(u1, 'A0D2') <= 3 + GetUnitAbilityLevel(u1, 'A056') then
	    	set R = I2R(GetUnitAbilityLevel(u1, 'A0D2') - 1 ) * 0.05 
	    else
	    	set R = I2R(GetUnitAbilityLevel(u1, 'A056') + 3 ) * 0.05
	    endif
    call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1,UNIT_STATE_LIFE) + GetEventDamage() * R )
  	//call BJDebugMsg(R2S(R))//%
    set u1 = null
endfunction
function Trig_B08_R_reduce_damageConditions takes nothing returns boolean
    if GetEventDamage() > 1.00 and GetUnitAbilityLevel(GetTriggerUnit(), 'A0D2') > 1 then
	    call Trig_B08_R_reduce_damageActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_B08_R_reduce_damage takes nothing returns nothing
    set gg_trg_B08_R_reduce_damage = CreateTrigger()
    call TriggerAddCondition(gg_trg_B08_R_reduce_damage, Condition(function Trig_B08_R_reduce_damageConditions))
endfunction
//===========================================================================
// Trigger: B10
//===========================================================================
function Trig_B10Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B10R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B10T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_B10 takes nothing returns nothing
    set gg_trg_B10 = CreateTrigger()
    call TriggerAddAction(gg_trg_B10, function Trig_B10Actions)
endfunction
//===========================================================================
// Trigger: B10R learn
//===========================================================================
function Trig_B10R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A05D'))
endfunction
function Trig_B10R_learnActions takes nothing returns nothing
    call DisableTrigger( GetTriggeringTrigger() )
    call TriggerRegisterAnyUnitEventBJ(gg_trg_B10R, EVENT_PLAYER_UNIT_ATTACKED)
endfunction
//===========================================================================
function InitTrig_B10R_learn takes nothing returns nothing
    set gg_trg_B10R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B10R_learn, Condition(function Trig_B10R_learnConditions))
    call TriggerAddAction(gg_trg_B10R_learn, function Trig_B10R_learnActions)
endfunction
//===========================================================================
// Trigger: B10R
//===========================================================================
function Trig_B10RActions takes nothing returns nothing
    local unit u1	=	GetTriggerUnit()
    local unit u2	=	GetAttacker()
   	local real	dmg	=	0.10 * GetUnitState(u1,UNIT_STATE_LIFE) 
	    call SetUnitState(u2, UNIT_STATE_LIFE, GetUnitState(u2,UNIT_STATE_LIFE) + dmg )
	    call UnitDamageTarget(u2,u1, dmg, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)	
	    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\GargoyleMissile\\GargoyleMissile.mdl",u1, "head") )
	    
    set u1 = null
    set u2 = null
endfunction
function Trig_B10RConditions takes nothing returns boolean
	
    if GetUnitAbilityLevel(GetAttacker(),'B01O') > 0 and GetRandomInt(1, 100) <= 17 and IsUnitType(GetTriggerUnit(), UNIT_TYPE_STRUCTURE) == false and IsUnitType(GetTriggerUnit(), UNIT_TYPE_MECHANICAL) == false	then
		call	Trig_B10RActions()
	endif
    return false
endfunction
//===========================================================================
function InitTrig_B10R takes nothing returns nothing
    set gg_trg_B10R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B10R, Condition(function Trig_B10RConditions))
endfunction//===========================================================================
// Trigger: B10T
//===========================================================================
function Trig_B10TFunc009T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u =	LoadUnitHandle(YDHT, h2i, 0x9C0F555E)
local real hp =	( 0.01 * GetUnitState( u, UNIT_STATE_MAX_LIFE) * 75.00 )
	//call BJDebugMsg(R2S(hp))
	//call BJDebugMsg(R2S(TimerGetElapsed(t)))
	if GetUnitAbilityLevel(u, 'B01P') > 0 then
		call SetUnitState(u, UNIT_STATE_LIFE, GetUnitState(u, UNIT_STATE_LIFE) + hp)
		
	else
		//clean
	    call FlushChildHashtable(YDHT, h2i)
	    call DestroyTimer(t)
	  	//刪除扣防技能
		call UnitRemoveAbility( u, 'A0K6' )
	endif 
	
set t = null
set u = null
endfunction
function Trig_B10TActions takes nothing returns nothing
local unit u =	GetTriggerUnit()
local player	p =	GetOwningPlayer(u)
local integer i =	GetPlayerId(p) + 1
local timer t = CreateTimer()
local integer h2i =	GetHandleId(t)
local integer	level	=	GetUnitAbilityLevel(u, 'A05E')
local real time	=	(	31.00 - 6.00 * I2R(level)	)
	//給於減防光環
	call UnitAddAbility( u, 'A0K6' )
	call SetUnitAbilityLevel( u, 'A0K6', level )
	
	//直接這樣來取滿血最快
	call SetUnitState(u, UNIT_STATE_LIFE, GetUnitState(u, UNIT_STATE_MAX_LIFE))
	
	//timer for timer 
	call SaveUnitHandle(YDHT, h2i, 0x9C0F555E,u)
	call TimerStart(t, time , true, function Trig_B10TFunc009T)
	
set u = null
set t = null
set p	=	null
endfunction
function Trig_B10TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A05E' then
	    call	Trig_B10TActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_B10T takes nothing returns nothing
    set gg_trg_B10T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B10T, Condition(function Trig_B10TConditions))
endfunction//===========================================================================
// Trigger: B11
//===========================================================================
function Trig_B11Actions takes nothing returns nothing
    call EnableTrigger( gg_trg_B11D )
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B11W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B11E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B11_R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B11_T_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B11_T_add, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_B11 takes nothing returns nothing
    set gg_trg_B11 = CreateTrigger()
    call TriggerAddAction(gg_trg_B11, function Trig_B11Actions)
endfunction
//===========================================================================
// Trigger: B11D
//===========================================================================
//這邊修正素質 應該是 白字部分
function Trig_B11DConditions takes nothing returns boolean
    if IsTriggerEnabled(GetTriggeringTrigger()) and GetUnitAbilityLevel(udg_S01_hero_of_player[GetPlayerId(GetOwningPlayer(GetKillingUnit()))+1], 'A0NX') > 0 then
	    call SetHeroAgi(GetKillingUnit(), GetHeroAgi(GetKillingUnit(), false) + 3 , true)
    endif
    return false
endfunction
function InitTrig_B11D takes nothing returns nothing
    set gg_trg_B11D = CreateTrigger()
    call DisableTrigger(gg_trg_B11D)
    call TriggerAddCondition(gg_trg_B11D, Condition(function Trig_B11DConditions))
endfunction
//function Trig_B11D_Func001C takes nothing returns boolean
//if(not(udg_B11_Hero!=null))then
//return false
//endif
//if(not(IsUnitDeadBJ(udg_B11_Hero)==false))then
//return false
//endif
//return true
//endfunction
//function Trig_B11D_Actions takes nothing returns nothing
//if(Trig_B11D_Func001C())then
//call UnitAddItemByIdSwapped(0x4930315A,udg_B11_Hero)
//else
//call DoNothing()
//endif
//endfunction
//function InitTrig_B11D takes nothing returns nothing
//set gg_trg_B11D=CreateTrigger()
//call DisableTrigger(gg_trg_B11D)
//call TriggerRegisterAnyUnitEventBJ(gg_trg_B11D,EVENT_PLAYER_UNIT_DEATH)
//call TriggerAddCondition(gg_trg_B11D,Condition(function Trig_B11D_Conditions))
//call TriggerAddAction(gg_trg_B11D,function Trig_B11D_Actions)
//endfunction
//function Trig_B11W_Conditions takes nothing returns boolean
//if(not(GetSpellAbilityId()==0x41303547))then
//return false
//endif
//return true
//endfunction//===========================================================================
// Trigger: B11W
//===========================================================================
function Trig_B11WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A05G'))
endfunction
function Trig_B11WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local player p = GetOwningPlayer(u1)
    local real dmg = ( I2R(GetHeroAgi(u1, true)) * ( 0.80 + ( 0.20 * I2R(GetUnitAbilityLevel(u1, 'A05G')) ) ) )
        call GroupEnumUnitsInRange(udg_Group[7], GetUnitX(u1), GetUnitY(u1), 925.00, null)
        loop
            set ydl_unit=FirstOfGroup(udg_Group[7])
            exitwhen ydl_unit == null
                call GroupRemoveUnit(udg_Group[7], ydl_unit)
		            if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false then
		                call UnitDamageTargetBJ(u1, ydl_unit, dmg, ATTACK_TYPE_CHAOS, DAMAGE_TYPE_UNKNOWN)
		            endif
        endloop
    set ydl_unit=null
    set u1=null
    set p = null
endfunction
//===========================================================================
function InitTrig_B11W takes nothing returns nothing
    set gg_trg_B11W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B11W, Condition(function Trig_B11WConditions))
    call TriggerAddAction(gg_trg_B11W, function Trig_B11WActions)
endfunction//===========================================================================
// Trigger: B11E
//===========================================================================
function Trig_B11EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0IL'))
endfunction
function Trig_B11EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    call UnitAddAbility( u1, 'A07F' )
    call SetUnitAbilityLevel( u1, 'A07F', GetUnitAbilityLevel(u1, 'A0IL') )
    call TriggerSleepAction( 10.00 )
    call UnitRemoveAbility( u1, 'A07F' )
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B11E takes nothing returns nothing
    set gg_trg_B11E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B11E, Condition(function Trig_B11EConditions))
    call TriggerAddAction(gg_trg_B11E, function Trig_B11EActions)
endfunction//===========================================================================
// Trigger: B11 R learn
//===========================================================================
function Trig_B11_R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A05J') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A05J') == 1))
endfunction
function Trig_B11_R_learnActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B11_R_damage, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
    call TriggerRegisterUnitEvent(gg_trg_B11_R_start, GetTriggerUnit(), EVENT_UNIT_DAMAGED)
endfunction
//===========================================================================
function InitTrig_B11_R_learn takes nothing returns nothing
    set gg_trg_B11_R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B11_R_learn, Condition(function Trig_B11_R_learnConditions))
    call TriggerAddAction(gg_trg_B11_R_learn, function Trig_B11_R_learnActions)
endfunction
//===========================================================================
// Trigger: B11 R start
//===========================================================================
function Trig_B11_R_startConditions takes nothing returns boolean
    return GetUnitAbilityLevel(GetEventDamageSource(), 'B01Q') == 0 and IsUnitType(GetEventDamageSource(), UNIT_TYPE_STRUCTURE) == false and udg_B11_R_T[GetPlayerId(GetTriggerPlayer()) + 1] == false
endfunction
function Trig_B11_R_startActions takes nothing returns nothing
    local unit u1 =	GetTriggerUnit()
    local unit u2 =	GetEventDamageSource()
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    local player p = GetOwningPlayer(u1) 
    local integer i = GetPlayerId(p) + 1
    local integer	level	=	GetUnitAbilityLevel(u1, 'A05J')
    local unit u3 =	null
	    set udg_B11_R_I2[i] = udg_B11_R_I2[i] + 1 
	    	//Create Hide Unit and longer the watch's time
		    set u3 = CreateUnit(p, 'h01E', x , y, 0)
		    call UnitApplyTimedLife( u3, 'BHwe', 4.00 )
		    call UnitAddAbility( u3, 'A0MG' )
		    call SetUnitAbilityLevel(u3,'A0MG',level)
		    //Order
		    call IssueTargetOrder( u3, "faeriefire", u2 )
		    	//ATTENTION : HRER USE THE TRIGGERSLEEP 
		        if udg_B11_R_I2[i] >= 5 then
		            set udg_B11_R_I2[i] = 0
		            set udg_B11_R_T[i] = true
		            call TriggerSleepAction( 22.00 - 4.00 * I2R(level) )
		            set udg_B11_R_T[i] = false
		        endif
	set p = null 
    set u1 = null
    set u2 = null
    set u3 = null
endfunction
//===========================================================================
function InitTrig_B11_R_start takes nothing returns nothing
    set gg_trg_B11_R_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_B11_R_start, Condition(function Trig_B11_R_startConditions))
    call TriggerAddAction(gg_trg_B11_R_start, function Trig_B11_R_startActions)
endfunction
//===========================================================================
// Trigger: B11 R damage
//===========================================================================
function Trig_B11_R_damageActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local unit u2=GetEventTargetUnit()
local player p = GetOwningPlayer(u1)
local real dmg = GetHeroAgi(u1, true) * 1.40
local texttag tt
local string s = ("+ "+(I2S(R2I(dmg))+" dmg"))
local integer green = ROSE_PercentTo255(80.00)
local integer red = ROSE_PercentTo255(20.00)
local integer blue = ROSE_PercentTo255(90.00)
local integer transparency = ROSE_PercentTo255(100.0)
local real vel = 64 * 0.071 / 128
local real xvel = vel * Cos(90 * bj_DEGTORAD)
local real yvel = vel * Sin(90 * bj_DEGTORAD)
	call UnitRemoveAbility(u2, 'B01Q')
	//傷害
	call UnitDamageTarget(u1, u2, dmg , true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
    //回2%血量
    call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + 0.02*GetUnitState(u1, UNIT_STATE_MAX_LIFE) )
	//製造漂浮文字
    set tt = CreateTextTag()
    call SetTextTagText(tt, s , 9.00 * 0.023 / 10)
    call SetTextTagPosUnit(tt, u2, 0)
	call SetTextTagColor(tt, green, red, blue, transparency )
	call SetTextTagPermanent(tt,false)
	call SetTextTagLifespan(tt,5.00)
	call SetTextTagFadepoint(tt,2.50)
	call SetTextTagVelocity(tt, xvel, yvel)
		//是否顯示漂浮文字
		//Q1.一開始建造 就大家都看得到?
		// 測試結果 是的。
	    if IsPlayerEnemy(GetLocalPlayer(), p) then
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call SetTextTagVisibility(tt, false)
	    endif
	set tt = null
	set s = null
	set p = null
    set u1 = null
    set u2 = null
endfunction
function Trig_B11_R_damageConditions takes nothing returns boolean
    if GetUnitAbilityLevel(GetEventTargetUnit(), 'B01Q') > 0 then
	    call Trig_B11_R_damageActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_B11_R_damage takes nothing returns nothing
    set gg_trg_B11_R_damage = CreateTrigger()
    call TriggerAddCondition(gg_trg_B11_R_damage, Condition(function Trig_B11_R_damageConditions))
endfunction
//===========================================================================
// Trigger: B11 T start
//===========================================================================
function Trig_B11_T_startConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0MH'))
endfunction
function Trig_B11_T_startActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
        set udg_B11_T_I2[i] = 0
		    call SetPlayerAbilityAvailable( GetOwningPlayer(u1), 'A0MH', false )
		    call UnitAddAbility( u1, 'A0MI' )
		    call UnitAddAbility( u1, 'A05K' )
		    call TriggerSleepAction(22.00)
		    call SetPlayerAbilityAvailable( GetOwningPlayer(u1), 'A0MH', true )
		    call UnitRemoveAbility( u1, 'A0MI' )
		    call UnitRemoveAbility( u1, 'A05K' )
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B11_T_start takes nothing returns nothing
    set gg_trg_B11_T_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_B11_T_start, Condition(function Trig_B11_T_startConditions))
    call TriggerAddAction(gg_trg_B11_T_start, function Trig_B11_T_startActions)
endfunction
//===========================================================================
// Trigger: B11 T add
//===========================================================================
function Trig_B11_T_addConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0MI'))
endfunction
function Trig_B11_T_addActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u2 = GetSpellTargetUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    local real x1=GetUnitX(u2)
    local real y1=GetUnitY(u2)
	    call TriggerSleepAction(0.00)
	    call SetUnitX(u1,x1)
	    call SetUnitY(u1,y1)
    set udg_B11_T_I2[i] = ( udg_B11_T_I2[i] + 1 )
    call UnitDamageTargetBJ( u1, u2, ( I2R(GetHeroAgi(u1,true))*1.25 ), ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID )
    call IssueTargetOrder(u1,"attack",u2)
        if ((udg_B11_T_I2[i] >= ( 1 + ( GetUnitAbilityLevel(u1, 'A0MH') * 2 ) ))) then
            call SetPlayerAbilityAvailable( GetOwningPlayer(u1), 'A0MH', true )
            call UnitRemoveAbility( u1, 'A0MI' )
            call UnitRemoveAbility( u1, 'A05K' )
        endif
    set u1 = null
    set u2 = null
endfunction
//===========================================================================
function InitTrig_B11_T_add takes nothing returns nothing
    set gg_trg_B11_T_add = CreateTrigger()
    call TriggerAddCondition(gg_trg_B11_T_add, Condition(function Trig_B11_T_addConditions))
    call TriggerAddAction(gg_trg_B11_T_add, function Trig_B11_T_addActions)
endfunction
//===========================================================================
// Trigger: B12
//===========================================================================
function Trig_B12Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B12D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B12D_stop, udg_A_common_HERO, EVENT_UNIT_SPELL_CHANNEL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B12W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B12R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
//===========================================================================
function InitTrig_B12 takes nothing returns nothing
    set gg_trg_B12 = CreateTrigger()
    call TriggerAddAction(gg_trg_B12, function Trig_B12Actions)
endfunction
//===========================================================================
// Trigger: B12D
//===========================================================================
function Trig_B12DConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A05O'
endfunction
function Trig_B12DActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local real x = GetSpellTargetX()
    local real y = GetSpellTargetY()
        call TriggerSleepAction( 0.00 )
        call SetUnitPosition( u1, x , y )
    set u1 = null
endfunction
function InitTrig_B12D takes nothing returns nothing
    set gg_trg_B12D = CreateTrigger()
    call TriggerAddCondition(gg_trg_B12D, Condition(function Trig_B12DConditions))
    call TriggerAddAction(gg_trg_B12D, function Trig_B12DActions)
endfunction
//===========================================================================
// Trigger: B12D stop 
//===========================================================================
function Trig_B12D_stopConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A05O' and IsTerrainPathable(GetSpellTargetX(),GetSpellTargetY(), PATHING_TYPE_WALKABILITY) then
	    call DisplayTimedTextToPlayer( GetOwningPlayer(GetTriggerUnit()), 0, 0, 3.00, "TRIGSTR_12200" )
    	call IssueImmediateOrder(GetTriggerUnit(),"stop")
	endif
	return false 
endfunction
function InitTrig_B12D_stop takes nothing returns nothing
    set gg_trg_B12D_stop = CreateTrigger()
    call TriggerAddCondition(gg_trg_B12D_stop, Condition(function Trig_B12D_stopConditions))
endfunction//===========================================================================
// Trigger: B12W
//===========================================================================
function Trig_B12WConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A05P'
endfunction
function Trig_B12WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real r1 =	80.00 + 120.00 * I2R(GetUnitAbilityLevel(u1, 'A05P')) 
local real r2 = GetUnitState(u1, UNIT_STATE_LIFE) * ( 0.01 + 0.01 * I2R(GetUnitAbilityLevel(u1, 'A05P')) ) 
	/////////////////////////////
	//百地特殊傷害 + 有視防禦
	////////////////////////////
	call UnitDamageTarget(u1, u2, r1, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS)
	call UnitDamageTarget(u1, u2, r2, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS)
set u1 = null
set u2 = null
endfunction
function InitTrig_B12W takes nothing returns nothing
    set gg_trg_B12W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B12W, Condition(function Trig_B12WConditions))
    call TriggerAddAction(gg_trg_B12W, function Trig_B12WActions)
endfunction
//===========================================================================
// Trigger: B12R learn
//===========================================================================
function Trig_B12R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A05Q') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A05Q') == 1) and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_B12R_learnActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B12R_attack_start, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
    // ----------------------------------------------------------------------
    if ((GetTriggerExecCount(GetTriggeringTrigger()) == 1)) then
        call TriggerRegisterAnyUnitEventBJ(gg_trg_B12_R_recover, EVENT_PLAYER_UNIT_DEATH)
    else
    endif
endfunction
//===========================================================================
function InitTrig_B12R_learn takes nothing returns nothing
    set gg_trg_B12R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B12R_learn, Condition(function Trig_B12R_learnConditions))
    call TriggerAddAction(gg_trg_B12R_learn, function Trig_B12R_learnActions)
endfunction
//===========================================================================
// Trigger: B12R attack start
//===========================================================================
function Trig_B12R_attack_startActionsConditions takes nothing returns nothing
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local real dmg = 0.01 * I2R( GetUnitAbilityLevel(u1,'A05Q') + 1 ) * GetUnitState(u1,UNIT_STATE_LIFE) 
		//Avoid crash
		////////////////////////////////
		//會不會 剛清完 就被使用h2i?
		//因為這時候 都刪除 ltt 的HANDLE了
		////////////////////////////////
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)
		set udg_B12R_B[i]=false
		//////////////
		//傷害+特效
		//////////////
	    call DestroyEffect( AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\HeroBloodElfBlood.mdl", u2, "chest") )
	    call UnitDamageTarget(u1, u2, dmg, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
	set ltt = null
	set u1 = null
    set u2 = null
endfunction
function Trig_B12R_attack_startActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit()
    local trigger ltt
    local integer h2i 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local triggercondition ltc
    	if udg_B12R_B[i]==false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false then
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
	    		///////////
	    		//參數設定
	    		//////////
		    	set udg_B12R_B[i]=true
		    	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    	set ltc = TriggerAddCondition(ltt, Condition(function Trig_B12R_attack_startActionsConditions))
			    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
		    	/////////////////////////////////////////////////////////////
			    //timer check + 觸發器登記
			    /////////////////////////////////////////////////////////////
			    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
			    call Normal_Attack_Timer_for_Trigger(ltt,0.30 , ltc , i)
		endif 
    set ltt = null
    set ltc = null
    set u1 = null
    set u2 = null
endfunction
function InitTrig_B12R_attack_start takes nothing returns nothing
    set gg_trg_B12R_attack_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_B12R_attack_start, Condition(function Trig_B12R_attack_startActions))
endfunction
//===========================================================================
// Trigger: B12 R recover
//===========================================================================
function Trig_B12_R_recoverConditions takes nothing returns boolean
    return ((GetUnitAbilityLevel(GetKillingUnitBJ(), 'A05Q') != 0))
endfunction
function Trig_B12_R_recoverActions takes nothing returns nothing
    call SetUnitLifeBJ( GetKillingUnitBJ(), ( GetUnitStateSwap(UNIT_STATE_LIFE, GetKillingUnitBJ()) + ( GetUnitStateSwap(UNIT_STATE_MAX_LIFE, GetTriggerUnit()) * ( 0.01 * ( 5.00 + I2R(GetUnitAbilityLevelSwapped('A05Q', GetKillingUnitBJ())) ) ) ) ) )
endfunction
//===========================================================================
function InitTrig_B12_R_recover takes nothing returns nothing
    set gg_trg_B12_R_recover = CreateTrigger()
    call TriggerAddCondition(gg_trg_B12_R_recover, Condition(function Trig_B12_R_recoverConditions))
    call TriggerAddAction(gg_trg_B12_R_recover, function Trig_B12_R_recoverActions)
endfunction
//===========================================================================
// Trigger: B13
//===========================================================================
function Trig_B13Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B13W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B13D, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B13R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B13T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B13 takes nothing returns nothing
    set gg_trg_B13 = CreateTrigger()
    call TriggerAddAction(gg_trg_B13, function Trig_B13Actions)
endfunction
//===========================================================================
// Trigger: B13D
//===========================================================================
function Trig_B13DConditions takes nothing returns boolean
    return ((GetUnitLevel(GetTriggerUnit()) >= 8) and (GetUnitAbilityLevel(GetTriggerUnit(), 'A0JW') == 0))
endfunction
function Trig_B13DActions takes nothing returns nothing
    call UnitAddAbilityBJ( 'A0JW', GetTriggerUnit() )
    call UnitMakeAbilityPermanent( GetTriggerUnit(), true, 'A0JW' )
endfunction
//===========================================================================
function InitTrig_B13D takes nothing returns nothing
    set gg_trg_B13D = CreateTrigger()
    call TriggerAddCondition(gg_trg_B13D, Condition(function Trig_B13DConditions))
    call TriggerAddAction(gg_trg_B13D, function Trig_B13DActions)
endfunction
//===========================================================================
// Trigger: B13W
//===========================================================================
function Trig_B13WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0XB'))
endfunction
function Trig_B13WActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    call TriggerSleepAction(0.00)
    call SetUnitAbilityLevel( u1, 'A0QV', GetUnitAbilityLevel(u1, 'A0XB') )
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B13W takes nothing returns nothing
    set gg_trg_B13W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B13W, Condition(function Trig_B13WConditions))
    call TriggerAddAction(gg_trg_B13W, function Trig_B13WActions)
endfunction
//===========================================================================
// Trigger: B13R
//===========================================================================
function Trig_B13RConditions takes nothing returns boolean
    return ((GetLearnedSkill() == 'A0JX') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_B13RActions takes nothing returns nothing
    if ((GetUnitAbilityLevel(GetTriggerUnit(), 'A0JX') == 1)) then
        call UnitAddAbilityBJ( 'A0JY', GetTriggerUnit() )
        call UnitMakeAbilityPermanent( GetTriggerUnit(), true, 'A0JY' )
    else
    endif
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A0JY', GetUnitAbilityLevelSwapped('A0JX', GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_B13R takes nothing returns nothing
    set gg_trg_B13R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B13R, Condition(function Trig_B13RConditions))
    call TriggerAddAction(gg_trg_B13R, function Trig_B13RActions)
endfunction
//===========================================================================
// Trigger: B13T
//===========================================================================
globals
integer array B13T_I
endglobals
function Trig_B13TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0K0'))
endfunction
function Trig_B13TFunc014T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    set B13T_I[i] = ( B13T_I[i] - 1 )
	    if (B13T_I[i] <= 0) or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 then
	        call FlushChildHashtable(YDHT, h2i)
	        call DestroyTimer(t)
	    else
	        call SetUnitX( udg_B13_Creat2[i], GetUnitX(u1) )
	        call SetUnitY( udg_B13_Creat2[i], GetUnitY(u1) )
	        call IssueTargetOrderById( udg_B13_Creat2[i], 852274, u1 )
	    endif
    set u1 = null
    set t = null
endfunction
function Trig_B13TActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 =GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
	set udg_B13_Creat2[i] = CreateUnit(GetOwningPlayer(u1), 'h01E', x,y, 0)
    call UnitApplyTimedLife( udg_B13_Creat2[i], 'BHwe', 17.00 )
    call UnitAddAbility( udg_B13_Creat2[i], 'A0JZ' ) 
	set B13T_I[i] = 12
	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, GetTriggerUnit())
	call TimerStart(t, ( 0.90 - ( 0.20 * I2R(GetUnitAbilityLevel(u1, 'A0K0')) ) ), true, function Trig_B13TFunc014T)
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_B13T takes nothing returns nothing
    set gg_trg_B13T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B13T, Condition(function Trig_B13TConditions))
    call TriggerAddAction(gg_trg_B13T, function Trig_B13TActions)
endfunction
//===========================================================================
// Trigger: B14
//===========================================================================
function Trig_B14Actions takes nothing returns nothing
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B14W, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_DEATH)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B14E, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B14R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B14T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call EnableTrigger( gg_trg_B14W_attack )
    // ---------------------------------
endfunction
//===========================================================================
function InitTrig_B14 takes nothing returns nothing
    set gg_trg_B14 = CreateTrigger()
    call TriggerAddAction(gg_trg_B14, function Trig_B14Actions)
endfunction
//===========================================================================
// Trigger: B14W
//===========================================================================
function Trig_B14WConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetDyingUnit()) == 'o01H'))
endfunction
function Trig_B14WActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1
local real y1
local real a 
local integer i=1
local unit u3
	    loop
	    exitwhen i > 20
	    	set a = I2R(18*i)*bj_DEGTORAD
	        set x1 = x + 400.00*Cos(a)
	        set y1 = y + 400.00*Sin(a)
	        call DestroyEffect( AddSpecialEffect("Abilities\\Weapons\\SkeletalMageMissile\\SkeletalMageMissile.mdl", x1,y1) )
	    set i = i + 1
	    endloop
	set u3 = CreateUnit(GetOwningPlayer(u1),'osp4',x,y,270.0)
	call UnitApplyTimedLife( u3, 'BTLF', 5.00 )
set u1 = null
set u3 = null 
endfunction
//===========================================================================
function InitTrig_B14W takes nothing returns nothing
    set gg_trg_B14W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B14W, Condition(function Trig_B14WConditions))
    call TriggerAddAction(gg_trg_B14W, function Trig_B14WActions)
endfunction//===========================================================================
// Trigger: B14W attack
//===========================================================================
function Trig_B14W_attackConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetAttacker()) == 'osp4'))
endfunction
function Trig_B14W_attackActions takes nothing returns nothing
    call UnitDamageTargetBJ( GetAttacker(), GetTriggerUnit(), ( 1.30 * I2R(GetHeroAgi(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetAttacker()))], true)) ), ATTACK_TYPE_HERO, DAMAGE_TYPE_NORMAL )
endfunction
//===========================================================================
function InitTrig_B14W_attack takes nothing returns nothing
    set gg_trg_B14W_attack = CreateTrigger()
    call DisableTrigger(gg_trg_B14W_attack)
    call TriggerRegisterAnyUnitEventBJ( gg_trg_B14W_attack, EVENT_PLAYER_UNIT_ATTACKED )
    call TriggerAddCondition(gg_trg_B14W_attack, Condition(function Trig_B14W_attackConditions))
    call TriggerAddAction(gg_trg_B14W_attack, function Trig_B14W_attackActions)
endfunction
//===========================================================================
// Trigger: B14E
//===========================================================================
function Trig_B14EConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A05W'))
endfunction
function Trig_B14EActions takes nothing returns nothing
    if ((GetUnitAbilityLevel(GetTriggerUnit(), 'A03S') == 0)) then
        call UnitAddAbilityBJ( 'A03S', GetTriggerUnit() )
    else
    endif
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A03S', GetUnitAbilityLevel(GetTriggerUnit(), 'A05W') )
endfunction
//===========================================================================
function InitTrig_B14E takes nothing returns nothing
    set gg_trg_B14E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B14E, Condition(function Trig_B14EConditions))
    call TriggerAddAction(gg_trg_B14E, function Trig_B14EActions)
endfunction
//===========================================================================
// Trigger: B14R
//===========================================================================
function Trig_B14RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0LC'))
endfunction
function Trig_B14RActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local unit ydl_unit
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local integer level =GetUnitAbilityLevel(u1,'A0LC')
local player p = GetOwningPlayer(u1)
    call GroupEnumUnitsInRange(udg_Group[3], x, y, 300.00, null)
    loop
    set ydl_unit = FirstOfGroup(udg_Group[3])
    exitwhen ydl_unit == null 
        call GroupRemoveUnit(udg_Group[3], ydl_unit)
        if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
            call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\CarrionSwarm\\CarrionSwarmDamage.mdl",ydl_unit,"head"))
                if IsUnitType(ydl_unit,UNIT_TYPE_MAGIC_IMMUNE) then
	                call UnitDamageTargetBJ(u1,ydl_unit,(150.00*I2R(level)),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_ACID)
	            else
	                call UnitDamageTargetBJ(u1,ydl_unit,(100.00*I2R(level)),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC) 
	            endif 
        endif
    endloop
set p = null
set ydl_unit=null
set u1 = null
endfunction
//===========================================================================
function InitTrig_B14R takes nothing returns nothing
    set gg_trg_B14R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B14R, Condition(function Trig_B14RConditions))
    call TriggerAddAction(gg_trg_B14R, function Trig_B14RActions)
endfunction//===========================================================================
// Trigger: B14T
//===========================================================================
function Trig_B14TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A04Y'))
endfunction
function Trig_B14TActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1
local real y1 
local real a
local integer i=1
    loop
    exitwhen i > 15
    	set a = I2R(24*i)*3.14159/180
        set x1 = x + 105.00*Cos(a)
        set y1 = y + 105.00*Sin(a)
        call DestroyEffect( AddSpecialEffect("Abilities\\Weapons\\AvengerMissile\\AvengerMissile.mdl", x1,y1) )
    set i = i + 1
    endloop
set u1 = null
endfunction
//===========================================================================
function InitTrig_B14T takes nothing returns nothing
    set gg_trg_B14T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B14T, Condition(function Trig_B14TConditions))
    call TriggerAddAction(gg_trg_B14T, function Trig_B14TActions)
endfunction//===========================================================================
// Trigger: B15E
//===========================================================================
function Trig_B15EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A061'))
endfunction
function Trig_B15EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    //for sign
    local unit u3 = CreateUnit(GetOwningPlayer(u1), 'h02G', GetSpellTargetX(),GetSpellTargetY(), 0)
	call UnitApplyTimedLife( u3, 'BHwe', 0.01 )
	call ShowUnit(u3, false)
	//for spell
    set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', GetSpellTargetX(),GetSpellTargetY(), 0)
    call UnitApplyTimedLife( u3, 'BHwe', 4.00 )
    call UnitAddAbility( u3, 'A062' )
    call SetUnitAbilityLevel( u3, 'A062', GetUnitAbilityLevel(u1, 'A061') )
    call IssueImmediateOrder( u3, "stomp" )
    set u1 = null
    set u3 = null
endfunction
//===========================================================================
function InitTrig_B15E takes nothing returns nothing
    set gg_trg_B15E = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ( gg_trg_B15E, EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition(gg_trg_B15E, Condition(function Trig_B15EConditions))
    call TriggerAddAction(gg_trg_B15E, function Trig_B15EActions)
endfunction//===========================================================================
// Trigger: B16
//===========================================================================
function Trig_B16Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B16W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B16E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B16R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B16T_Start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B16 takes nothing returns nothing
    set gg_trg_B16 = CreateTrigger()
    call TriggerAddAction(gg_trg_B16, function Trig_B16Actions)
endfunction
//===========================================================================
// Trigger: B16W
//===========================================================================
function Trig_B16WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A063'))
endfunction
function Trig_B16WActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife( u3, 'BHwe', 4.00 )
	call UnitAddAbility( u3, 'A065' )
	call SetUnitAbilityLevel( u3, 'A065', GetUnitAbilityLevel(u1, 'A063') )
	call IssuePointOrder(u3,"clusterrockets",x1,y1)
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_B16W takes nothing returns nothing
    set gg_trg_B16W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B16W, Condition(function Trig_B16WConditions))
    call TriggerAddAction(gg_trg_B16W, function Trig_B16WActions)
endfunction//===========================================================================
// Trigger: B16E
//
// GetTriggerUnit()
//===========================================================================
function Trig_B16EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A066'))
endfunction
function Trig_B16EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit ydl_unit
    local player p = GetOwningPlayer(u1)
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    // ---------------------------------
    call GroupEnumUnitsInRange(udg_Group[3], x, y, 630.00, null)
    loop
        set ydl_unit = FirstOfGroup(udg_Group[3])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[3], ydl_unit)
        if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false and IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false and GetUnitPointValue(ydl_unit) != 1 and IsUnitHidden(ydl_unit) != true then
            call SetUnitPosition( ydl_unit, x, y)
        endif
    endloop
    set ydl_unit = null
    set u1 = null
    set p = null
endfunction
//===========================================================================
function InitTrig_B16E takes nothing returns nothing
    set gg_trg_B16E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B16E, Condition(function Trig_B16EConditions))
    call TriggerAddAction(gg_trg_B16E, function Trig_B16EActions)
endfunction
//===========================================================================
// Trigger: B16R learn
//===========================================================================
function Trig_B16R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A067') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A067') == 1) and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_B16R_learnActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B16R, GetTriggerUnit(), EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_B16R_learn takes nothing returns nothing
    set gg_trg_B16R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B16R_learn, Condition(function Trig_B16R_learnConditions))
    call TriggerAddAction(gg_trg_B16R_learn, function Trig_B16R_learnActions)
endfunction
//===========================================================================
// Trigger: B16R
//===========================================================================
function Trig_B16RConditions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local integer i = GetUnitAbilityLevel(u1, 'A067')
local real r = GetUnitState(u1, UNIT_STATE_LIFE) / GetUnitState(u1, UNIT_STATE_MAX_LIFE) * 100.0
	call SetUnitState(u1, UNIT_STATE_MANA, GetUnitState(u1, UNIT_STATE_MANA) + GetUnitState(u1, UNIT_STATE_MAX_MANA) * 2.00 * I2R(i) * 0.01)
		if r < 50.00 then
			call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + GetUnitState(u1, UNIT_STATE_MAX_LIFE) * I2R(i) * 0.01)
		endif
set u1 = null
endfunction
//===========================================================================
function InitTrig_B16R takes nothing returns nothing
    set gg_trg_B16R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B16R, Condition(function Trig_B16RConditions))
endfunction//===========================================================================
// Trigger: B16T Start
//
// YDTriggerGetEx(unit, YDTriggerH2I(GetExpiredTimer()), 0xA1614B4D)
//===========================================================================
globals
integer array B16T_I
endglobals
function Trig_B16T_StartConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A068' ) )
endfunction
function Trig_B16T_StartFunc009T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
    if ( ( B16T_I[i] == 17 ) ) then
		call FlushChildHashtable(YDHT, h2i)
        call DestroyTimer(t)
    else
    	set B16T_I[i] = B16T_I[i] + 1
        call SetUnitX(udg_B16T_Unit[i], x)
        call SetUnitY(udg_B16T_Unit[i], y) 
        call IssueImmediateOrder(udg_B16T_Unit[i], "thunderclap")
        call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl", x, y))
    endif
set u1 =null
set t = null 
endfunction
function Trig_B16T_StartActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 =GetTriggerUnit()
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
	set B16T_I[i]=0
	set udg_B16T_Unit[i]=CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1),GetUnitY(u1), 0)
	call UnitApplyTimedLife(udg_B16T_Unit[i], 'BHwe', 15.00)
	call UnitAddAbility(udg_B16T_Unit[i], 'A069')
	call SetUnitAbilityLevel(udg_B16T_Unit[i], 'A069', GetUnitAbilityLevel(u1, 'A068'))
	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
	call TimerStart(t, 0.50, true, function Trig_B16T_StartFunc009T)
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_B16T_Start takes nothing returns nothing
    set gg_trg_B16T_Start=CreateTrigger()
    call TriggerAddCondition(gg_trg_B16T_Start, Condition(function Trig_B16T_StartConditions))
    call TriggerAddAction(gg_trg_B16T_Start, function Trig_B16T_StartActions)
endfunction//===========================================================================
// Trigger: B17
//
// set udg_B17_HERO = CreateUnit(Player(0), 'hfoo', GetUnitX(GetTriggerUnit()), GetUnitY(GetTriggerUnit()), 0)
//===========================================================================
function Trig_B17Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B17E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B17R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B17T, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
function InitTrig_B17 takes nothing returns nothing
    set gg_trg_B17 = CreateTrigger()
    call TriggerAddAction(gg_trg_B17, function Trig_B17Actions)
endfunction//===========================================================================
// Trigger: B17E
//===========================================================================
function Trig_B17EActions takes nothing returns nothing
    local unit u1 =	GetTriggerUnit()
    local player p = GetOwningPlayer(u1)
    local unit u3 = CreateUnit(p, 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
    local unit ydl_unit
        //Hide Caster
	    call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
	    call UnitAddAbility( u3, 'A06C' )
	    	//擊暈
	    	call GroupEnumUnitsInRange(udg_Group[7], GetUnitX(u1), GetUnitY(u1), 650.00, null)
		    loop
		        set ydl_unit = FirstOfGroup(udg_Group[7])
		        exitwhen ydl_unit == null
		        call GroupRemoveUnit(udg_Group[7], ydl_unit)
			        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsPlayerEnemy(GetOwningPlayer(ydl_unit), p) and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false and GetUnitLifePercent(ydl_unit) < 65.00 then
			            call IssueTargetOrder( u3, "thunderbolt", ydl_unit )
			        endif
		    endloop
		    
    set u1 = null
    set u3 = null
    set ydl_unit = null
    set p = null
endfunction
function Trig_B17EConditions takes nothing returns boolean
    if	GetSpellAbilityId() == 'A06B'	then
	    call	Trig_B17EActions()
    endif
    return false
endfunction
function InitTrig_B17E takes nothing returns nothing
    set gg_trg_B17E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B17E, Condition(function Trig_B17EConditions))
endfunction
//===========================================================================
// Trigger: B17R learn
//===========================================================================
function Trig_B17R_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A06D'	and	GetUnitAbilityLevel(GetTriggerUnit(), 'A06D') == 1 and IsUnitIllusion(GetTriggerUnit())==false	then
	    call TriggerRegisterUnitEvent(gg_trg_B17R, GetTriggerUnit(), EVENT_UNIT_ATTACKED)
    endif
    return false
endfunction
function InitTrig_B17R_learn takes nothing returns nothing
    set gg_trg_B17R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B17R_learn, Condition(function Trig_B17R_learnConditions))
endfunction
//===========================================================================
// Trigger: B17R
//===========================================================================
function Trig_B17RConditions takes nothing returns boolean
	local	unit	u =	GetTriggerUnit()
	local	unit	u2 =	GetAttacker()
	local	integer	level	=	GetUnitAbilityLevel(u, 'A06D')
	local real	dmg =	( 20.00 * I2R(level) )
		//call	BJDebugMsg(R2S(dmg))
		
		if	IsUnitType(GetAttacker(), UNIT_TYPE_STRUCTURE) == false then
			call UnitDamageTarget(u, u2, dmg, true, false, ATTACK_TYPE_CHAOS, DAMAGE_TYPE_UNKNOWN, WEAPON_TYPE_WHOKNOWS)
	    	call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\ThornsAura\\ThornsAuraDamage.mdl", u2, "chest") ) 
		endif
	set u	=	null
	set u2	=	null	
    return false
endfunction
function InitTrig_B17R takes nothing returns nothing
    set gg_trg_B17R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B17R, Condition(function Trig_B17RConditions))
endfunction//===========================================================================
// Trigger: B17T 
//
// YDTriggerGetEx(unit, YDTriggerH2I(GetExpiredTimer()), 0xA1614B4D)
//===========================================================================
function Trig_B17TFunc001T takes nothing returns nothing
	local integer h2i = GetHandleId(GetExpiredTimer())
	local unit u =	LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local integer level = GetUnitAbilityLevel(u, 'A06E')
	local real hp =	( 100.00 - GetUnitLifePercent(u) ) / ( 25.00 - ( 5.00 * I2R(level) ) ) 
	local integer i = R2I(	hp	)
	
	    if i <= level + 4 then
		    call SetUnitAbilityLevel( u, 'A06G', i + 1 )
		    call SetUnitAbilityLevel( u, 'A06F', i + 1 )
	    else
		    call SetUnitAbilityLevel( u, 'A06G', level + 4	)
		    call SetUnitAbilityLevel( u, 'A06F', level + 4	)
	    endif
	    
	set u = null
endfunction
function Trig_B17TActions takes nothing returns nothing
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	local unit u =	GetTriggerUnit()
	
		call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u)
		call TimerStart(t, 1.00, true, function Trig_B17TFunc001T)
		
	set t = null
	set u = null
endfunction
function Trig_B17TConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A06E' and GetUnitAbilityLevel(GetTriggerUnit(), 'A06E') == 1	then
	    call Trig_B17TActions()
	endif
    return false
endfunction
function InitTrig_B17T takes nothing returns nothing
    set gg_trg_B17T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B17T, Condition(function Trig_B17TConditions))
endfunction//===========================================================================
// Trigger: B18
//===========================================================================
function Trig_B18Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B18_Upgrade, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B18W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B18E, udg_A_common_HERO, EVENT_UNIT_SUMMON)
    call TriggerRegisterUnitEvent(gg_trg_B18E_HeroDie, udg_A_common_HERO, EVENT_UNIT_DEATH)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B18R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B18T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B18 takes nothing returns nothing
    set gg_trg_B18 = CreateTrigger()
    call TriggerAddAction(gg_trg_B18, function Trig_B18Actions)
endfunction
//===========================================================================
// Trigger: B18_Upgrade
//===========================================================================
function Trig_B18_UpgradeActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rhar', ( GetHeroLevel(GetTriggerUnit()) / 2 ), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_B18_Upgrade takes nothing returns nothing
    set gg_trg_B18_Upgrade = CreateTrigger()
    call TriggerAddAction(gg_trg_B18_Upgrade, function Trig_B18_UpgradeActions)
endfunction
//===========================================================================
// Trigger: B18W
//
// GetLocationX(udg_tmpP[0]), GetLocationY(udg_tmpP[0])
//===========================================================================
function Trig_B18WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A06I'))
endfunction
function Trig_B18WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    local real x1 = GetSpellTargetX()
    local real y1 = GetSpellTargetY()
    local real x2
    local real y2
    local player p = GetOwningPlayer(u1)
    local integer level = GetUnitAbilityLevel(u1, 'A06I')
    local unit u3= CreateUnit(p, 'h01E', x, y, 0)
    local integer i=1
    local real a
	    // effect + Create Stone
	    loop
	    exitwhen i > 8
	        set a = I2R(i)*45*3.14159/180.0
	        set x2 = x1 + 220.00*Cos(a)
	        set y2 = y1 + 220.00*Sin(a)
			call DestroyEffect( AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\EntBirthTarget\\EntBirthTarget.mdl",x1,y1))
			set u3 =CreateUnit(p, 'ehip', x2, y2, 0)
	        call UnitApplyTimedLife( u3, 'BHwe', ( 1.50 + ( 0.50 * I2R(level) ) ) )
	    set i = i + 1
	    endloop
    
	    call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
	    call UnitAddAbility( u3, 'A06J' )
	    // ---------------------------------
	    call GroupEnumUnitsInRange(udg_Group[6], x1, y1, 200, null)
	    loop
	    set ydl_unit = FirstOfGroup(udg_Group[6])
	    exitwhen ydl_unit == null
	    call GroupRemoveUnit(udg_Group[6], ydl_unit)
	        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) then
	            call IssueTargetOrder( u3, "entanglingroots", ydl_unit )
	        endif
	    endloop
    set u1 = null
    set u3 = null
    set ydl_unit = null
    set p = null
endfunction
//===========================================================================
function InitTrig_B18W takes nothing returns nothing
    set gg_trg_B18W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B18W, Condition(function Trig_B18WConditions))
    call TriggerAddAction(gg_trg_B18W, function Trig_B18WActions)
endfunction//===========================================================================
// Trigger: B18E
//===========================================================================
function Trig_B18EConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetSummonedUnit()) == 'efon'))
endfunction
function Trig_B18EActions takes nothing returns nothing
    // 召喚亡魂時 把他加到群組中
    call SelectUnitAddForPlayer( GetSummonedUnit(), GetOwningPlayer(GetSummoningUnit()) )
endfunction
//===========================================================================
function InitTrig_B18E takes nothing returns nothing
    set gg_trg_B18E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B18E, Condition(function Trig_B18EConditions))
    call TriggerAddAction(gg_trg_B18E, function Trig_B18EActions)
endfunction
//===========================================================================
// Trigger: B18E HeroDie
//===========================================================================
function Trig_B18E_HeroDieConditions takes nothing returns boolean
    return ((IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_B18E_HeroDieFunc002A takes nothing returns nothing
    call KillUnit( GetEnumUnit() )
endfunction
function Trig_B18E_HeroDieActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    set udg_A_common_Group[2] = YDWEGetUnitsOfPlayerAndTypeIdNull(GetOwningPlayer(GetDyingUnit()), 'efon')
    call ForGroupBJ( udg_A_common_Group[2], function Trig_B18E_HeroDieFunc002A )
    call GroupClear( udg_A_common_Group[2] )
    call DestroyGroup( udg_A_common_Group[2] )
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B18E_HeroDie takes nothing returns nothing
    set gg_trg_B18E_HeroDie = CreateTrigger()
    call TriggerAddCondition(gg_trg_B18E_HeroDie, Condition(function Trig_B18E_HeroDieConditions))
    call TriggerAddAction(gg_trg_B18E_HeroDie, function Trig_B18E_HeroDieActions)
endfunction
//===========================================================================
// Trigger: B18R
//===========================================================================
function Trig_B18RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A06K') and (IsUnitEnemy(GetSpellTargetUnit(), GetOwningPlayer(GetTriggerUnit())) == true))
endfunction
function Trig_B18RActions takes nothing returns nothing
    call UnitDamageTargetBJ( GetTriggerUnit(), GetSpellTargetUnit(), ( 100.00 + ( 100.00 * I2R(GetUnitAbilityLevelSwapped('A06K', GetTriggerUnit())) ) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
endfunction
//===========================================================================
function InitTrig_B18R takes nothing returns nothing
    set gg_trg_B18R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B18R, Condition(function Trig_B18RConditions))
    call TriggerAddAction(gg_trg_B18R, function Trig_B18RActions)
endfunction
//===========================================================================
// Trigger: B18T
//===========================================================================
globals
integer array B18T_I
endglobals
function Trig_B18TFunc007T takes nothing returns nothing
local unit ydl_unit	
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local player p = GetOwningPlayer(u1)
local integer i= GetPlayerId(p) + 1
local real r
    if B18T_I[i] >= 60 then
		    if GetUnitState(udg_B18T_soul2[i], UNIT_STATE_LIFE) > 1 then
			    set r = ( 500.00 + ( 400.00 * I2R(GetUnitAbilityLevel(u1, 'A08W')) ) )
		        call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Thunderclap\\ThunderClapCaster.mdl", GetUnitX(udg_B18T_soul2[i]),GetUnitY(udg_B18T_soul2[i])))
		            call GroupEnumUnitsInRange(udg_Group[6], GetUnitX(udg_B18T_soul2[i]), GetUnitY(udg_B18T_soul2[i]), 800.00, null)
		            loop
		                set ydl_unit=FirstOfGroup(udg_Group[6])
		                exitwhen ydl_unit == null
		                call GroupRemoveUnit(udg_Group[6], ydl_unit)
		                if IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false and IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 then
		                    call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\NightElf\\NEDeathSmall\\NEDeathSmall.mdl", ydl_unit, "chest"))
		                    call UnitDamageTarget(u1, ydl_unit, r, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
		                endif
		            endloop
		        call KillUnit(udg_B18T_soul2[i]) 
		    endif 
	    call FlushChildHashtable(YDHT, h2i)
	    call DestroyTimer(t)
    else
        call SetUnitScalePercent(udg_B18T_soul2[i],(100.00+(15.00*I2R(B18T_I[i]))),(100.00+(15.00*I2R(B18T_I[i]))),(100.00+(15.00*I2R(B18T_I[i]))))
        set B18T_I[i]=B18T_I[i]+1
    endif
set ydl_unit=null
set t=null
set u1=null
endfunction
function Trig_B18TActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 =GetTriggerUnit()
local integer i= GetPlayerId(GetOwningPlayer(u1)) + 1
	set udg_B18T_soul2[i]=CreateUnit(GetOwningPlayer(u1), 'hmil', GetSpellTargetX(), GetSpellTargetY(), 0) 
	set B18T_I[i]=0
	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
	call TimerStart(t, 0.05, true, function Trig_B18TFunc007T)
set t = null
set u1 = null
endfunction
function Trig_B18TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A08W' then
	    call Trig_B18TActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_B18T takes nothing returns nothing
    set gg_trg_B18T=CreateTrigger()
    call TriggerAddCondition(gg_trg_B18T, Condition(function Trig_B18TConditions))
    call TriggerAddAction(gg_trg_B18T, function Trig_B18TActions)
endfunction//===========================================================================
// Trigger: B19
//===========================================================================
function Trig_B19Actions takes nothing returns nothing
    set udg_B19_HERO[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = udg_A_common_HERO
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B19D_level, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B19D_summon, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B19D_summon_ability_stop, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_SPELL_CHANNEL)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B19D_summon_ability, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_SPELL_FINISH)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B19D_summon_die, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_DEATH)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B19W_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_B19W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B19E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B19T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call SetPlayerAbilityAvailableBJ( false, 'A06N', GetOwningPlayer(udg_A_common_HERO) )
    call SetPlayerAbilityAvailableBJ( false, 'A06M', GetOwningPlayer(udg_A_common_HERO) )
    call SetPlayerAbilityAvailableBJ( false, 'A06O', GetOwningPlayer(udg_A_common_HERO) )
endfunction
//===========================================================================
function InitTrig_B19 takes nothing returns nothing
    set gg_trg_B19 = CreateTrigger()
    call TriggerAddAction(gg_trg_B19, function Trig_B19Actions)
endfunction
//===========================================================================
// Trigger: B19D level
//
// CreateNUnitsAtLoc( 1, 'o00X', GetOwningPlayer(GetTriggerUnit()), udg_TempPoint[0], bj_UNIT_FACING )
//===========================================================================
function Trig_B19D_levelActions takes nothing returns nothing
    if ModuloInteger(GetHeroLevel(GetTriggerUnit()), 2) == 0 then
	    call SetPlayerTechResearched(GetTriggerPlayer(), 'Rhpm', ( GetHeroLevel(GetTriggerUnit()) / 2 ))
	    
	    //call	BJDebugMsg("升等")
	    
    endif
endfunction
function InitTrig_B19D_level takes nothing returns nothing
    set gg_trg_B19D_level = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19D_level, Condition(function Trig_B19D_levelActions))
endfunction
//===========================================================================
// Trigger: B19D summon
//
// CreateNUnitsAtLoc( 1, 'o00X', i, p1, bj_UNIT_FACING )
// CreateUnit(GetOwningPlayer(u1), 'o00X', GetUnitX(u1), GetUnitY(u1), 0)
//===========================================================================
function Trig_B19D_summonActions takes nothing returns nothing
    local unit u =	GetTriggerUnit()
    local	real x =	GetUnitX(u)
    local	real y =	GetUnitY(u)
    local	player p =	GetTriggerPlayer()
    local integer i = GetPlayerId(p) + 1
    local	integer level	=	GetUnitAbilityLevel(u, 'A06S')
	local	unit u2 =	udg_B19_DOG2[i]
    
	    if u2 == null then
		    	set	u2 = CreateUnit(p, 'o00X', x, y, 0)
	        	set udg_B19_DOG2[i] = u2 
	        
	    else
	    
	        call SetUnitX( u2, x )
	        call SetUnitY( u2, y )
	        call SetUnitState(u2, UNIT_STATE_LIFE, GetUnitState(u2, UNIT_STATE_MAX_LIFE))	
	                
	    endif
        // 給予忍犬隱形
        if GetUnitAbilityLevel(u, 'A06P') == 4 then
        	call UnitAddAbility( u2, 'A06M' )
        endif
        
    	// 給予忍犬忍法‧迅雷
        if level != 0 then
	        
        	call UnitAddAbility( u2, 'A0LK' )
        	call SetUnitAbilityLevel( u2, 'A0LK', level )
        	
        endif
	set p =	null
    set u = null
    set u2 =	null
endfunction
function Trig_B19D_summonConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0D0' then
	    call	Trig_B19D_summonActions()
    endif
    return	false
endfunction
function InitTrig_B19D_summon takes nothing returns nothing
    set gg_trg_B19D_summon = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19D_summon, Condition(function Trig_B19D_summonConditions))
endfunction
//===========================================================================
// Trigger: B19D summon ability stop
//===========================================================================
function Trig_B19D_summon_ability_stopActions takes nothing returns nothing
    local unit u1	=	GetTriggerUnit()
    local player p	=	GetOwningPlayer(u1)
    local integer i = GetPlayerId(p) + 1
    local unit u2	=	udg_B19_HERO[i]
	local real x1	=	GetUnitX(u1)
	local real y1	=	GetUnitY(u1)
	local	real x2	=	GetUnitX(u2)
	local	real y2	=	GetUnitY(u2)	
	local	real dx	=	x2	-	x1
	local	real dy	=	y2	-	y1
	local	real dt	=	SquareRoot(Pow(dx,2)+Pow(dy,2))
	local	boolean b	=	dt	>	1000.0
	local string s	=	"望月千代女 距離過遠"
		if	b	then
			call DisplayTimedTextToPlayer( p, 0, 0, 3.00, s )
			call IssueImmediateOrder( u1, "stop" )	
		endif
		//call	BJDebugMsg(R2S(dt))
	set u1	=	null
	set u2	=	null
	set p	=	null
endfunction
function Trig_B19D_summon_ability_stopConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A06O'	then
	    call	Trig_B19D_summon_ability_stopActions()
    endif
    return	false
endfunction
function InitTrig_B19D_summon_ability_stop takes nothing returns nothing
    set gg_trg_B19D_summon_ability_stop = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19D_summon_ability_stop, Condition(function Trig_B19D_summon_ability_stopConditions))
endfunction
//===========================================================================
// Trigger: B19D summon ability 
//===========================================================================
function Trig_B19D_summon_abilityActions takes nothing returns nothing
    local unit u1 =	GetTriggerUnit()
    local player p =	GetOwningPlayer(u1)
    local integer i = GetPlayerId(p) + 1
    local unit u2 =	udg_B19_HERO[i]
	local real x1 =	GetUnitX(u1)
	local real y1 =	GetUnitY(u1)
	local	real x2 =	GetUnitX(u2)
	local	real y2 =	GetUnitY(u2)	
	local	real angle	=	GetUnitFacing(u1)
		//轉移-忍犬
    	call SetUnitX( u1, x2 )
    	call SetUnitY( u1, y2 )
    	//Effect
    	call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Blink\\BlinkTarget.mdl", u2, "chest") )
    	call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Blink\\BlinkTarget.mdl", u1, "chest") )
		//轉移-狗女
		call	SetUnitPosition(u2,x1,y1)
		
	set u1	=	null
	set u2	=	null
	set p	=	null
endfunction
function Trig_B19D_summon_abilityConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A06O'	then
	    call	Trig_B19D_summon_abilityActions()
    endif
    return	false
endfunction
function InitTrig_B19D_summon_ability takes nothing returns nothing
    set gg_trg_B19D_summon_ability = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19D_summon_ability, Condition(function Trig_B19D_summon_abilityConditions))
endfunction
//===========================================================================
// Trigger: B19D summon die
//===========================================================================
function Trig_B19D_summon_dieConditions takes nothing returns boolean
    if GetUnitTypeId(GetTriggerUnit()) == 'o00X' and IsUnitIllusion(GetTriggerUnit()) != true then
	    set udg_B19_DOG2[GetPlayerId(GetTriggerPlayer()) + 1] = null
    	//call	BJDebugMsg(GetUnitName(udg_B19_DOG2[GetPlayerId(GetTriggerPlayer()) + 1]))
	endif
    return	false
endfunction
function InitTrig_B19D_summon_die takes nothing returns nothing
    set gg_trg_B19D_summon_die = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19D_summon_die, Condition(function Trig_B19D_summon_dieConditions))
endfunction
//===========================================================================
// Trigger: B19W learn
//===========================================================================
function Trig_B19W_learnActions takes nothing returns nothing
    local unit u =	GetTriggerUnit()
	local	player	p =	GetTriggerPlayer()
	local	integer	level	=	GetUnitAbilityLevel(u, 'A06P')
    
	    // 給予忍犬掃擊
	    if level >= 2 then
		    call SetPlayerAbilityAvailable(p, 'A06N', true)
	    endif
	    
	    // 給予忍犬相移
	    if level >= 3 then
		    call SetPlayerAbilityAvailable(p, 'A06O', true)
	    endif
	    
	    // 給予忍犬隱形
	    if level >= 4 then
		    
	        call UnitAddAbility( udg_B19_DOG2[GetPlayerId(p)+1],'A06M' )
	    endif
    
    set u = null
    set p	=	null
endfunction
function Trig_B19W_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A06P' and IsUnitIllusion(GetTriggerUnit()) != true	then
		call	Trig_B19W_learnActions()
    endif
    return	false
endfunction
function InitTrig_B19W_learn takes nothing returns nothing
    set gg_trg_B19W_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19W_learn, Condition(function Trig_B19W_learnConditions))
endfunction
//===========================================================================
// Trigger: B19W
//
// call SetUnitX( udg_B16T_Unit[i], GetUnitX(u1) )
//         call SetUnitY( udg_B16T_Unit[i], GetUnitY(u1) )
//===========================================================================
function Trig_B19WActions2 takes nothing returns nothing
	local	timer	t	=	GetExpiredTimer()
	local	integer	h2i	=	GetHandleId(t)
	local	unit	u	=	LoadUnitHandle(YDHT,h2i,1)
	local	player	p	=	GetOwningPlayer(u)
	local	integer	id	=	GetPlayerId(p)+1
		//clean
		call	FlushChildHashtable(YDHT,h2i)
		call	DestroyTimer(t)
		
		//設定	增加攻擊力技能 回1等
		call SetUnitAbilityLevel( u , 'A06Q'	, 1 )
	    call SetUnitAbilityLevel( udg_B19_DOG2[id]	, 'A06Q'	, 1 )
		
	set t	=	null
	set u	=	null
	set p	=	null
endfunction
function Trig_B19WActions takes nothing returns nothing
    local unit u =	GetTriggerUnit()
    local unit u2 = GetSpellTargetUnit()
    local	player p =	GetTriggerPlayer()
    local integer i = GetPlayerId(p) + 1
    local	integer level	=	GetUnitAbilityLevel(u,'A06P')
    local	real dmg =	( 100.00 * I2R(level) )
    local	unit u3 =	udg_B19_DOG2[i]
	local	timer t =	CreateTimer()
	local	integer h2i =	GetHandleId(t)
	local	real time	=	10.00
		call	SaveUnitHandle(YDHT,h2i,1,u)
		call	TimerStart(t,time,false,function Trig_B19WActions2)
    	//傷害
	    call UnitDamageTarget(u, u2, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
	    //effect
	    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\BattleRoar\\RoarCaster.mdl", u3, "chest") )
		//位移忍犬 並命令攻擊目標單位
	    call SetUnitX( u3, GetUnitX(u2) )
	    call SetUnitY( u3, GetUnitY(u2) )
	    call IssueTargetOrder( udg_B19_DOG2[i], "attack", u2 )
		//增加攻擊力
	    call SetUnitAbilityLevel( u , 'A06Q'	, level + 1 )
	    call SetUnitAbilityLevel( udg_B19_DOG2[i]	, 'A06Q'	, level + 1 )
		//call	BJDebugMsg(R2S(time))
	    
    set u = null
    set u2 = null
    set u3 =	null 
    set p =	null
endfunction
function Trig_B19WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A06P'	then
	    call	Trig_B19WActions()
    endif
	return	false
endfunction
function InitTrig_B19W takes nothing returns nothing
    set gg_trg_B19W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19W, Condition(function Trig_B19WConditions))
endfunction
//===========================================================================
// Trigger: B19E
//===========================================================================
function Trig_B19EActions takes nothing returns nothing
	local	unit	u	=	GetTriggerUnit()
	local	player	p	=	GetTriggerPlayer()
	local	real	x	=	GetUnitX(u)
	local	real	y	=	GetUnitY(u)
	local	unit	u3	=	CreateUnit(p,'nwgs',x,y,270.0)
		//call	BJDebugMsg(GetPlayerName(p))
	set u	=	null
	set u3	=	null
	set p	=	null
endfunction
function Trig_B19EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A06R' then
	    call	Trig_B19EActions()
    endif
    return	false
endfunction
function InitTrig_B19E takes nothing returns nothing
    set gg_trg_B19E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19E, Condition(function Trig_B19EConditions))
endfunction
//===========================================================================
// Trigger: B19T
//
// ( 8.00 + ( 7.00 * I2R(GetUnitAbilityLevel(u1, 'A00K')) )
// AddSpecialEffectTarget("Abilities\\Spells\\Items\\ScrollOfRejuvenation\\ScrollManaHealth.mdl", u1, "chest")
// AddSpecialEffectTarget("Abilities\\Spells\\Items\\ScrollOfRejuvenation\\ScrollManaHealth.mdl", udg_B19_Doger2[i], "chest") 
//===========================================================================
function Trig_B19TActions2 takes nothing returns nothing
	local	timer	t	=	GetExpiredTimer()
	local	integer	h2i	=	GetHandleId(t)
	local	unit	u	=	LoadUnitHandle(YDHT,h2i,1)
	local	player	p	=	GetOwningPlayer(u)
	local	integer	i	=	GetPlayerId(p)	+	1
		//clean
		call	FlushChildHashtable(YDHT,h2i)
		call	DestroyTimer(t)
		//刪除技能
	    call UnitRemoveAbility( u , 'A0LX' )
	    call UnitRemoveAbility( udg_B19_DOG2[i]	, 'A0LX' ) 
		//刪除特效
	    call UnitRemoveAbility( u , 'A0T2' )
	    call UnitRemoveAbility( udg_B19_DOG2[i]	, 'A0T2' ) 
	set p	=	null	
	set t	=	null
	set u	=	null	
endfunction
function Trig_B19TActions takes nothing returns nothing
    local unit u =	GetTriggerUnit()
    local	player p =	GetOwningPlayer(u)
    local integer i = GetPlayerId(p)	+	1
	local	timer t =	CreateTimer()
	local	integer h2i =	GetHandleId(t)
	local	integer level	=	GetUnitAbilityLevel(u, GetSpellAbilityId())
	local	real time	=	( 8.00 + 7.00 * I2R(level) )
		//clock
		call	SaveUnitHandle(YDHT,h2i,1,u)
		call	TimerStart(t,time,false,function Trig_B19TActions2)
		//增加隱藏攻擊總攻擊
	    call UnitAddAbility( u , 'A0LX' )
	    call UnitAddAbility( udg_B19_DOG2[i], 'A0LX' )
		//特效
	    call UnitAddAbility( u , 'A0T2' )
	    call UnitAddAbility( udg_B19_DOG2[i], 'A0T2' )
	    //call	BJDebugMsg(R2S(time))
	    
    set u = null
    set t =	null
    set p =	null
endfunction
function Trig_B19TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A00K'	then
	    call	Trig_B19TActions()
    endif
	return	false
endfunction
function InitTrig_B19T takes nothing returns nothing
    set gg_trg_B19T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B19T, Condition(function Trig_B19TConditions))
endfunction
	//local	effect		e1	=	AddSpecialEffectTarget("Abilities\\Spells\\Items\\ScrollOfRejuvenation\\ScrollManaHealth.mdl",udg_B19_DOG2[i],"chest")
	//local	effect		e2	=	AddSpecialEffectTarget("Abilities\\Spells\\Items\\ScrollOfRejuvenation\\ScrollManaHealth.mdl",u,"chest")//===========================================================================
// Trigger: B21
//===========================================================================
function Trig_B21Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B21R_Upgrade, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B21E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B21R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B21T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_B21 takes nothing returns nothing
    set gg_trg_B21 = CreateTrigger()
    call TriggerAddAction(gg_trg_B21, function Trig_B21Actions)
endfunction
//===========================================================================
// Trigger: B21E
//===========================================================================
function Trig_B21EFunc001Condition2 takes unit u2 returns nothing
	local	trigger	ltt	=	GetTriggeringTrigger()
	local	integer h2i =	GetHandleId(ltt)
	local	unit	u1	=	LoadUnitHandle(YDHT,h2i,1)
	local	real	x	=	GetUnitX(u2)
	local	real	y	=	GetUnitY(u2)
		//MOVE HERO TO THE TARGETUNIT
		call	SetUnitX(u1,x)
		call	SetUnitY(u1,y)
		//CLEAN
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT,h2i)
	set ltt	=	null
	set u1	=	null	
endfunction
function Trig_B21EFunc001Conditions takes nothing returns nothing
	local	trigger	ltt	=	GetTriggeringTrigger()
	local	integer h2i =	GetHandleId(ltt)
	local	unit	u2	=	GetTriggerUnit()
		//AFTER 5 SEC , CLEAN THE TRIGGER
		if	u2	==	null	then
			call DestroyTrigger(ltt)
			call FlushChildHashtable(YDHT,h2i)
		elseif (GetUnitAbilityLevel(u2, 'B0AL') > 0) then
			call Trig_B21EFunc001Condition2(u2)
		endif
		
	set u2	=	null
	set ltt	=	null	
endfunction
function Trig_B21EActions takes nothing returns nothing
    local trigger ltt = CreateTrigger()
    local	integer h2i =	GetHandleId(ltt)
    local unit u1 =	GetTriggerUnit()
    local	unit u2 =	GetSpellTargetUnit()
		//SAVE UNIT ID
		call SaveUnitHandle(YDHT,h2i,1,u1)
    	
	    call TriggerRegisterUnitEvent( ltt, u2, EVENT_UNIT_DAMAGED )
	    call TriggerRegisterTimerEventSingle(ltt, 5.00 )
	    call TriggerAddCondition(ltt, Condition(function Trig_B21EFunc001Conditions))
	    
    set ltt = null
    set u1 =	null
    set u2 =	null
endfunction
function Trig_B21EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A06Y' then
	    call	Trig_B21EActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_B21E takes nothing returns nothing
    set gg_trg_B21E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B21E, Condition(function Trig_B21EConditions))
endfunction
//===========================================================================
// Trigger: B21R Upgrade
//===========================================================================
function Trig_B21R_UpgradeConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A07G' then
	    call AddPlayerTechResearched( GetTriggerPlayer(), 'R008', 1 )
    endif
    return false
endfunction
function InitTrig_B21R_Upgrade takes nothing returns nothing
    set gg_trg_B21R_Upgrade = CreateTrigger()
    call TriggerAddCondition(gg_trg_B21R_Upgrade, Condition(function Trig_B21R_UpgradeConditions))
endfunction//===========================================================================
// Trigger: B21R
//===========================================================================
function Trig_B21RActions_time_out takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u = LoadUnitHandle(YDHT,h2i,5566)
		call FlushChildHashtable(YDHT,h2i)
		call DestroyTimer(t)
		
	    call SetUnitVertexColor( u, 255, 255, 255, 255 )
	    call UnitRemoveAbility( u, 'A06Z' )
	    call UnitRemoveAbility( u, 'A00W' )
set u = null
set t = null	
endfunction
function Trig_B21RActions takes nothing returns nothing
local unit u =	GetTriggerUnit()
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local real r = (	2.00 + I2R(GetUnitAbilityLevel(u, 'A07G')) )
    
	    call UnitAddAbility( u, 'A00W' )
	    call UnitAddAbility( u, 'A06Z' )
	    call SetUnitAbilityLevel( u, 'A06Z', GetUnitAbilityLevel(u, 'A07G') )
	    call SetUnitVertexColor( u, 150, 150, 255, 255 )
	    
	    call SaveUnitHandle(YDHT,h2i,5566,u)
	    call TimerStart(t,r,false,function Trig_B21RActions_time_out)
set u = null
endfunction
function Trig_B21RConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A07G' then
	    call Trig_B21RActions()
    endif
    return false
endfunction
function InitTrig_B21R takes nothing returns nothing
    set gg_trg_B21R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B21R, Condition(function Trig_B21RConditions))
endfunction
//===========================================================================
// Trigger: B21T
//===========================================================================
function Rose_TerrainDeformationRippleBJ takes real duration, boolean limitNeg, location where, real startRadius, real endRadius, real depth, real wavePeriod, real waveWidth returns terraindeformation
    local real spaceWave
    local real timeWave
    local real radiusRatio
	//避免 分母為0
    if (endRadius <= 0 or waveWidth <= 0 or wavePeriod <= 0) then
        return null
    endif
    set timeWave = 2.0 * duration / wavePeriod
    set spaceWave = 2.0 * endRadius / waveWidth
    set radiusRatio = startRadius / endRadius
    set bj_lastCreatedTerrainDeformation = TerrainDeformRipple(GetLocationX(where), GetLocationY(where), endRadius, depth, R2I(duration * 1000), 1, spaceWave, timeWave, radiusRatio, limitNeg)
    return bj_lastCreatedTerrainDeformation
endfunction
function Trig_B21_T_reduce_damageActions takes nothing returns nothing
	local unit u = GetTriggerUnit()
	local real dmg = GetEventDamage()
	local integer	level	=	GetUnitAbilityLevel(u,'A070')
	local real rehp	=	( 0.20 + 0.15 * I2R(level) ) 
		if dmg > 1.00 then
			call SetUnitState(u,	UNIT_STATE_LIFE,GetUnitState(u,UNIT_STATE_LIFE) +	dmg *	rehp )
		endif
		//call BJDebugMsg(R2S(rehp))
		
	set u = null	
endfunction
function Trig_B21_TActions_timer_out takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local trigger ltt = LoadTriggerHandle(YDHT,h2i,1)
	local triggercondition ltc =	LoadTriggerConditionHandle(YDHT,h2i,2)
		//call BJDebugMsg(R2S(TimerGetElapsed(t)))
		
		call FlushChildHashtable(YDHT,h2i)
		call DestroyTimer(t)
		call TriggerRemoveCondition(ltt,ltc)
		call DestroyTrigger(ltt)
	set t = null	
	set ltt = null
	set ltc =	null
endfunction
function Trig_B21_TActions takes nothing returns nothing
    local unit u =	GetTriggerUnit()
    local location point = GetUnitLoc(u)
    local player p = GetOwningPlayer(u)
    local integer i = GetPlayerId(p) + 1
    local trigger ltt = CreateTrigger()
    local integer level	=	GetUnitAbilityLevel(u, 'A070')
	local real time	=	( 4.00 + 1.50 * I2R(level) )
	local timer t =	CreateTimer()
	local integer h2i =	GetHandleId(t)
	local triggercondition	ltc 
		//特效
	    call Rose_TerrainDeformationRippleBJ(2.00,false,point,1000.00,1000.00,64,0.40,250.00)
	    call RemoveLocation( point )
		//註冊傷害事件
	    set ltc =	TriggerAddCondition(ltt, function Trig_B21_T_reduce_damageActions)
	    call TriggerRegisterUnitEvent(ltt,u,EVENT_UNIT_DAMAGED)
		call SaveTriggerHandle(YDHT,h2i,1,ltt)
		call SaveTriggerConditionHandle(YDHT,h2i,2,ltc)
		call TimerStart(t,time,false,function Trig_B21_TActions_timer_out)
    set u = null
    set point = null
    set ltt = null
    set p = null
    set t =	null
    set ltc =	null
endfunction
function Trig_B21_TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A070' then
    	call Trig_B21_TActions() 
    endif
    return false
endfunction
function InitTrig_B21T takes nothing returns nothing
    set gg_trg_B21T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B21T, Condition(function Trig_B21_TConditions))
endfunction//===========================================================================
// Trigger: B22
//===========================================================================
function Trig_B22Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B22R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B22T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B22 takes nothing returns nothing
    set gg_trg_B22 = CreateTrigger()
    call TriggerAddAction(gg_trg_B22, function Trig_B22Actions)
endfunction
//===========================================================================
// Trigger: B22R
//===========================================================================
function Trig_B22RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A073'))
endfunction
function Trig_B22RActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    // ---------------------------------
    call UnitAddAbility( u1, 'A072' )
    call SetUnitAbilityLevel( u1, 'A072', GetUnitAbilityLevel(u1, 'A073') )
    // ---------------------------------
    call YDWEPolledWaitNull(12.00)
    // ---------------------------------
    call UnitRemoveAbility( u1, 'A072' )
    // ---------------------------------
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B22R takes nothing returns nothing
    set gg_trg_B22R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B22R, Condition(function Trig_B22RConditions))
    call TriggerAddAction(gg_trg_B22R, function Trig_B22RActions)
endfunction//===========================================================================
// Trigger: B22T
//
//        if ((GetUnitPointValue(ydl_unit) != 1) and (IsUnitEnemy(ydl_unit, GetOwningPlayer(u1)) == true) and (IsUnitAliveBJ(ydl_unit) == true) and (IsUnitHiddenBJ(ydl_unit) != true) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true)) then
//  
//===========================================================================
function Trig_B22TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A074'))
endfunction
function Trig_B22TActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local unit u3
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    local real x1 
    local real y1 
    local real a
    local player p = GetOwningPlayer(u1)
  
    call GroupEnumUnitsInRange(udg_Group[4], GetSpellTargetX(), GetSpellTargetY(), 600.00, null)
    loop
        set ydl_unit = FirstOfGroup(udg_Group[4])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[4], ydl_unit)
        if ( (IsUnitEnemy(ydl_unit, p) == true) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and GetUnitPointValue(ydl_unit) != 1 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true ) then
            set u3= CreateUnit(p, 'h01E', x, y, 0)
            call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
            call UnitAddAbility( u3, 'A075' )
            call SetUnitAbilityLevel( u3, 'A075', GetUnitAbilityLevel(u1, 'A074') )
            call IssueTargetOrder( u3, "chainlightning", ydl_unit )
        endif
    endloop
    set u1 = null
    set u3 = null
    set p = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B22T takes nothing returns nothing
    set gg_trg_B22T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B22T, Condition(function Trig_B22TConditions))
    call TriggerAddAction(gg_trg_B22T, function Trig_B22TActions)
endfunction//===========================================================================
// Trigger: B23
//===========================================================================
function Trig_B23Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B23E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B23R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B23 takes nothing returns nothing
    set gg_trg_B23 = CreateTrigger()
    call TriggerAddAction(gg_trg_B23, function Trig_B23Actions)
endfunction
//===========================================================================
// Trigger: B23E
//===========================================================================
function Trig_B23EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0FM'))
endfunction
function Trig_B23EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    // ---------------------------------
    call UnitAddAbility( u1, 'A0FN' )
    call SetUnitAbilityLevel( u1, 'A0FN', GetUnitAbilityLevel(u1, 'A0FM') )
    // ---------------------------------
    call YDWEPolledWaitNull(8.00)
    // ---------------------------------
    call UnitRemoveAbility( u1, 'A0FN' )
    // ---------------------------------
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B23E takes nothing returns nothing
    set gg_trg_B23E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B23E, Condition(function Trig_B23EConditions))
    call TriggerAddAction(gg_trg_B23E, function Trig_B23EActions)
endfunction
//===========================================================================
// Trigger: B23R
//===========================================================================
function Trig_B23RConditions takes nothing returns boolean
    return ((GetLearnedSkill() == 'A078'))
endfunction
function Trig_B23RActions takes nothing returns nothing
    // ---------------------------------
    call IncUnitAbilityLevel( GetTriggerUnit(), 'A0GV' )
    // ---------------------------------
endfunction
//===========================================================================
function InitTrig_B23R takes nothing returns nothing
    set gg_trg_B23R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B23R, Condition(function Trig_B23RConditions))
    call TriggerAddAction(gg_trg_B23R, function Trig_B23RActions)
endfunction
//===========================================================================
// Trigger: B24
//===========================================================================
function Trig_B24Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B24_W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B24R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B24T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B24 takes nothing returns nothing
    set gg_trg_B24 = CreateTrigger()
    call TriggerAddAction(gg_trg_B24, function Trig_B24Actions)
endfunction
//===========================================================================
// Trigger: B24 W
//===========================================================================
function Trig_B24_W__reduce_damageActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	    set udg_B24_R[i] = udg_B24_R[i] + GetEventDamage() 
	    call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) + GetEventDamage() ))
    set u1 = null
endfunction
function Trig_B24_WConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A07C'
endfunction
function Trig_B24_WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
	local player p = GetOwningPlayer(u1)
	local integer i = GetPlayerId(p) + 1
	local trigger ltt 
	
		//註冊傷害事件
		set ltt = CreateTrigger()
	    call TriggerAddCondition(ltt, function Trig_B24_W__reduce_damageActions)
	    call TriggerRegisterUnitEvent(ltt,u1,EVENT_UNIT_DAMAGED)
    	set udg_B24_R[i] = 0.00
    	
    	call TriggerSleepAction(2.45)
    	
    	//clean
    	call DestroyTrigger(ltt)
    	//時間到期傷害
	        if ((udg_B24_R[i] >= GetUnitState(u1, UNIT_STATE_MAX_LIFE))) then
	            set udg_B24_R[i] = GetUnitState(u1, UNIT_STATE_MAX_LIFE)
	        endif
	    call GroupEnumUnitsInRange(udg_Group[4], GetUnitX(u1), GetUnitY(u1), 700.00, null)
		    loop
		        set ydl_unit = FirstOfGroup(udg_Group[4])
		        exitwhen ydl_unit == null
		        call GroupRemoveUnit(udg_Group[4], ydl_unit)
		            if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true then
		                call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Incinerate\\FireLordDeathExplode.mdl", ydl_unit, "chest") )
		                call UnitDamageTarget(u1, ydl_unit, udg_B24_R[i], true, false, ATTACK_TYPE_MELEE, DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS) 
		            endif
		    endloop
		    
    set u1 = null
    set ydl_unit = null
    set ltt = null
endfunction
//===========================================================================
function InitTrig_B24_W takes nothing returns nothing
    set gg_trg_B24_W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B24_W, Condition(function Trig_B24_WConditions))
    call TriggerAddAction(gg_trg_B24_W, function Trig_B24_WActions)
endfunction//===========================================================================
// Trigger: B24R
//
// call UnitDamageTargetBJ( u1, u2, ( ( 85.00 + ( 55.00 * I2R(GetUnitAbilityLevel(u1, 'A07E')) ) ) + ( 2.50 * I2R(GetHeroAgi(u1, true)) ) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_NORMAL )
//===========================================================================
function Trig_B24RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A07E'))
endfunction
function Trig_B24RActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u2=GetSpellTargetUnit()
    	call TriggerSleepAction(0.00)
    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl", u1, "origin") )
    call SetUnitPosition(u1,GetUnitX(u2),GetUnitY(u2))
        if IsUnitEnemy(u2, GetOwningPlayer(u1)) then
            call UnitDamageTargetBJ( u1, u2, ( ( 2.50 * I2R(GetHeroAgi(u1, true)) ) + ( 85.00 + ( 55.00 * I2R(GetUnitAbilityLevel(u1, 'A07E')) ) ) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
                if ((GetUnitLifePercent(u2) <= 60.00)) then
                    call SetUnitLifeBJ( u1, ( GetUnitState(u1, UNIT_STATE_LIFE) + ( 0.18 * GetUnitState(u1, UNIT_STATE_MAX_LIFE) ) ) )
                    call SetUnitManaBJ( u1, ( GetUnitState(u1, UNIT_STATE_MANA) + ( 0.18 * GetUnitState(u1, UNIT_STATE_MAX_MANA) ) ) )
                endif 
            call IssueImmediateOrder( u2, "stop" ) 
        endif
    set u1 = null
    set u2 = null
endfunction
//===========================================================================
function InitTrig_B24R takes nothing returns nothing
    set gg_trg_B24R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B24R, Condition(function Trig_B24RConditions))
    call TriggerAddAction(gg_trg_B24R, function Trig_B24RActions)
endfunction//===========================================================================
// Trigger: B24T
//
// CreateUnitAtLoc( GetOwningPlayer(u1), 'e005', p1, YDWEDeg2R(AngleBetweenPoints(p1, p2)) )
// local unit u3= CreateUnitAtLoc( GetOwningPlayer(u1), 'e005', p1, YDWEDeg2R(AngleBetweenPoints(p1, p2)) )
//===========================================================================
function Trig_B24TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0LT'))
endfunction
function Trig_B24TActions takes nothing returns nothing
local real a = GetUnitFacing(GetTriggerUnit())
local unit u3= CreateUnit( GetOwningPlayer(GetTriggerUnit()), 'e005', GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()), a )
set u3 = null
endfunction
//===========================================================================
function InitTrig_B24T takes nothing returns nothing
    set gg_trg_B24T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B24T, Condition(function Trig_B24TConditions))
    call TriggerAddAction(gg_trg_B24T, function Trig_B24TActions)
endfunction//===========================================================================
// Trigger: B25
//===========================================================================
function Trig_B25Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B25W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B25E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B25R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    set udg_B25_group2[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B25 takes nothing returns nothing
    set gg_trg_B25 = CreateTrigger()
    call TriggerAddAction(gg_trg_B25, function Trig_B25Actions)
endfunction
//===========================================================================
// Trigger: B25W
//
// set udg_A_Common_temp1 = PolarProjectionBJ(P, 50.00, GetRandomDirectionDeg())
//===========================================================================
function Trig_B25WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A07L'))
endfunction
function Trig_B25WActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u2=GetSpellTargetUnit()
    	call TriggerSleepAction(0.00)
    call UnitAddAbility( u1, 'A07M' )
    call SetUnitAbilityLevel( u1, 'A07M', GetUnitAbilityLevel(u1, 'A07L') )
	    call SetUnitX( u1, GetUnitX(u2) )
	    call SetUnitY( u1, GetUnitY(u2) )
	    call IssueTargetOrder(u1,"attack",u2)
			call TriggerSleepAction(7.90)
    call UnitRemoveAbility( u1, 'A07M' )
    set u1 = null
    set u2 = null
endfunction
//===========================================================================
function InitTrig_B25W takes nothing returns nothing
    set gg_trg_B25W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B25W, Condition(function Trig_B25WConditions))
    call TriggerAddAction(gg_trg_B25W, function Trig_B25WActions)
endfunction//===========================================================================
// Trigger: B25E
//
// call KillUnit( YDTriggerGetEx(unit, YDTriggerH2I(GetExpiredTimer()), 0xA1614B4D) )
//     call KillUnit( YDTriggerGetEx(unit, YDTriggerH2I(GetExpiredTimer()), 0x9C0F555E) )
//===========================================================================
globals
real array B25E_R
real array B25E_A
unit array B25E_U
endglobals
function Trig_B25EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A07I' ) )
endfunction
function Trig_B25EFunc011T takes nothing returns nothing
local unit ydl_unit	
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a = B25E_A[i]
local real x2
local real y2
local real x4
local real y4
local unit u3 
local player p = GetOwningPlayer(u1)
	if B25E_R[i] > 55.00 then
	    set B25E_R[i]=B25E_R[i]-55.00
	    set x2= x + 55.00 * Cos(a) 
	    set y2= y + 55.00 * Sin(a) 
	else
	    set x2= x + B25E_R[i] * Cos(a) 
	    set y2= y + B25E_R[i] * Sin(a) 
	    // ---------------------------------
	    call FlushChildHashtable(YDHT, h2i)
	    call DestroyTimer(t)
	endif
	    call SetUnitX(u1, x2)
	    call SetUnitY(u1, y2) 
	    call GroupEnumUnitsInRange(udg_Group[5], x2, y2, 190.00, null)
	        loop
	            set ydl_unit=FirstOfGroup(udg_Group[5])
	            exitwhen ydl_unit == null
	            call GroupRemoveUnit(udg_Group[5], ydl_unit)
	                if ( ( IsUnitInGroup(ydl_unit, udg_B25_group2[i]) != true ) and IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and ( IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true ) ) then
	                    call GroupAddUnit(udg_B25_group2[i],ydl_unit)
	                   	set u3 = CreateUnit(p,'h02G',x,y,0)
	    				call UnitAddAbility(u3,'A07J')
						call SetUnitAbilityLevel(u3, 'A07J', GetUnitAbilityLevel(u1, 'A07I'))
	                    call IssueTargetOrder(u3, "thunderbolt", ydl_unit)
	                    call UnitApplyTimedLife(u3,0x42544C46,2.50)
	                endif
	        endloop 
	    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\FrostNova\\FrostNovaTarget.mdl", x2, y2))
    set t=null
    set u1=null
    set ydl_unit=null
    set p = null
    set u3 = null
endfunction
function Trig_B25EActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local real x=GetUnitX(u1)
local real y=GetUnitY(u1)
local real x1=GetSpellTargetX()
local real y1=GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
local real dt = SquareRoot(Pow((x1-x),2)+Pow((y1-y),2))
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
	set B25E_A[i]=a
	set B25E_R[i]=dt
	call GroupClear(udg_B25_group2[i])
    call SaveUnitHandle(YDHT, h2i, 1, u1)
    call TimerStart(t, 0.01, true, function Trig_B25EFunc011T) 
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_B25E takes nothing returns nothing
    set gg_trg_B25E=CreateTrigger()
    call TriggerAddCondition(gg_trg_B25E, Condition(function Trig_B25EConditions))
    call TriggerAddAction(gg_trg_B25E, function Trig_B25EActions)
endfunction//===========================================================================
// Trigger: B25R_learn
//===========================================================================
function Trig_B25R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A05V') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A05V') == 1) and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_B25R_learnActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B25R, GetTriggerUnit(), EVENT_UNIT_ATTACKED)
endfunction
//===========================================================================
function InitTrig_B25R_learn takes nothing returns nothing
    set gg_trg_B25R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B25R_learn, Condition(function Trig_B25R_learnConditions))
    call TriggerAddAction(gg_trg_B25R_learn, function Trig_B25R_learnActions)
endfunction
//===========================================================================
// Trigger: B25R
//===========================================================================
function Trig_B25RActions22 takes nothing returns nothing
    local timer t =	GetExpiredTimer()
    local integer	h2i =	GetHandleId(t)	
    //--LOAD THE PLAYER'S NUMBER
    local integer	i =	LoadInteger(YDHT,h2i,1)
    //--USE FOR THE TIMER
	set udg_B25R_B[i] = false
	//--CLEAN
	call DestroyTimer(t)
	call FlushChildHashtable(YDHT,h2i)
	//--CLEAN
	set t =	null	
endfunction
function Trig_B25RActions takes nothing returns nothing
    local unit u1 =	GetTriggerUnit()
    local player p = GetOwningPlayer(u1)
    local integer i = GetPlayerId(p)	+	1
    //--GET THE LEVEL 
    local integer level = GetUnitAbilityLevel(u1, 'A05V')
    //--CREATE THE TIMER FOR HASHTABLE
    local timer t =	CreateTimer()
    local integer	h2i =	GetHandleId(t)
    local real time =	4.00
    //--FOR TEMPLE 
    local unit ydl_unit
    local real dmg
    local real remana
	//--SET THE REAL FOR DMG AND dmg
	set dmg = 80.00 + 10.00 * I2R(level) 
	set remana = 30.00 + 10.00 * I2R(level) 
	//--IF THE ATTACKER'S HERO then DOUBLE THE DMG AND THE REREAL
    if ((IsUnitType(GetAttacker(), UNIT_TYPE_HERO) == true)) then
        set dmg = dmg	*	2
        set remana = remana	*	2
    else
        set dmg = dmg	*	1
        set remana = remana	*	1
    endif 
    
    //--RECURE THE HERO'S MANA
    call SetUnitState( u1, UNIT_STATE_MANA, GetUnitState(u1,UNIT_STATE_MANA) +	remana )
    //--CHOSE THE GROUP AROUND "上杉謙信" , AND ATTANTION FOR DAMAGE
	call GroupEnumUnitsInRange(udg_Group[6], GetUnitX(u1), GetUnitY(u1), 550.00, null)
    loop
        set ydl_unit = FirstOfGroup(udg_Group[6])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[6], ydl_unit)
        //IF NOT USE THE BOOLEAN FOR POINT VALUE , IT'LL EFFECT THE MH SYSTEM BUG	
        if ( IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true) ) and GetUnitPointValue(ydl_unit)!=1 then
            call UnitDamageTarget(u1, ydl_unit, dmg, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
            call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\FrostWyrmMissile\\FrostWyrmMissile.mdl", ydl_unit, "chest") )
        endif
    endloop
	//IF udg_B25R_B IS TRUE , THEN THE ATTANTION FOR B25R_TRIGGER WILL NOT PLAY
	set udg_B25R_B[i] = true	
	//START TIMER AND SAVE THE HASH FOR PLAYER'S NUMBER
	call	SaveInteger(YDHT,h2i,1,i)
	call	TimerStart(t,time,false,function Trig_B25RActions22)
	
	//CLEAN
    set u1 = null
    set ydl_unit = null
    set p =	null
endfunction
function Trig_B25RConditions takes nothing returns boolean
    if (udg_B25R_B[GetPlayerId(GetTriggerPlayer())	+	1] == false) then
	    call	Trig_B25RActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_B25R takes nothing returns nothing
    set gg_trg_B25R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B25R, Condition(function Trig_B25RConditions))
endfunction
//===========================================================================
// Trigger: B26
//===========================================================================
function Trig_B26Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B26W_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_B26W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B26E_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_B26E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B26R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B26T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_B26 takes nothing returns nothing
    set gg_trg_B26 = CreateTrigger()
    call TriggerAddAction(gg_trg_B26, function Trig_B26Actions)
endfunction
//===========================================================================
// Trigger: B26W learn
//===========================================================================
function Trig_B26W_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A08Q'))
endfunction
function Trig_B26W_learnActions takes nothing returns nothing
    // ---------------------------------
    call UnitAddAbility( GetTriggerUnit(), 'A07P' )
    // ---------------------------------
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A07P', GetUnitAbilityLevelSwapped('A08Q', GetTriggerUnit()) )
    // ---------------------------------
endfunction
//===========================================================================
function InitTrig_B26W_learn takes nothing returns nothing
    set gg_trg_B26W_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B26W_learn, Condition(function Trig_B26W_learnConditions))
    call TriggerAddAction(gg_trg_B26W_learn, function Trig_B26W_learnActions)
endfunction
//===========================================================================
// Trigger: B26W
//===========================================================================
function Trig_B26WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A08Q'))
endfunction
function Trig_B26WActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    // ---------------------------------
    call UnitAddAbilityBJ( 'A0QP', u1 )
    call SetUnitAbilityLevel( u1, 'A0QP', GetUnitAbilityLevelSwapped('A08Q', u1) )
    // ---------------------------------
    call YDWEPolledWaitNull(9.00)
    // ---------------------------------
    call UnitRemoveAbilityBJ( 'A0QP', u1 )
    // ---------------------------------
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B26W takes nothing returns nothing
    set gg_trg_B26W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B26W, Condition(function Trig_B26WConditions))
    call TriggerAddAction(gg_trg_B26W, function Trig_B26WActions)
endfunction
//===========================================================================
// Trigger: B26E learn
//===========================================================================
function Trig_B26E_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0LI'))
endfunction
function Trig_B26E_learnActions takes nothing returns nothing
    call UnitAddAbility( GetTriggerUnit(), 'A091' )
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A091', GetUnitAbilityLevelSwapped('A0LI', GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_B26E_learn takes nothing returns nothing
    set gg_trg_B26E_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B26E_learn, Condition(function Trig_B26E_learnConditions))
    call TriggerAddAction(gg_trg_B26E_learn, function Trig_B26E_learnActions)
endfunction
//===========================================================================
// Trigger: B26E
//===========================================================================
globals
integer array B26E_I
endglobals
function Trig_B26EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0LI' ) )
endfunction
function Trig_B26EFunc004T takes nothing returns nothing
local timer t= GetExpiredTimer()
local integer h2i= GetHandleId(t)
local unit u1=LoadUnitHandle(YDHT, h2i, 1)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
local real x= GetUnitX(u1)
local real y= GetUnitY(u1)
local unit u3= CreateUnit(GetOwningPlayer(u1), 'h01E', x, y, 0)
	call SetUnitScalePercent(u3, 150.00, 150.00, 150.00)
	call UnitApplyTimedLife(u3, 'BHwe', 2.50)
	call UnitAddAbility(u3, 'A07Q')
	call SetUnitAbilityLevel(u3, 'A07Q', GetUnitAbilityLevel(u1, 'A0LI'))
	set B26E_I[i]=B26E_I[i] + 1
		if B26E_I[i] >= 8 then
			call FlushChildHashtable(YDHT, h2i)
		    call DestroyTimer(t)
		else
		    call IssuePointOrder(u3, "stampede", x, y)
		endif
    set t=null
    set u1=null
    set u3=null
endfunction
function Trig_B26EActions takes nothing returns nothing
    local unit u1= GetTriggerUnit()
    local real x=GetUnitX(u1)
    local real y=GetUnitY(u1)
    local timer t= CreateTimer()
    local integer h2i= GetHandleId(t)
    local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
    set B26E_I[i]=0
    call SaveUnitHandle(YDHT, h2i, 1, u1)
    call UnitAddAbility(u1, 'A0U1')
    call SetUnitAbilityLevel(u1, 'A0U1', GetUnitAbilityLevel(u1, 'A0LI'))
    call TimerStart(t, 1.00, true, function Trig_B26EFunc004T)
    call YDWEPolledWaitNull(7.00)
    call UnitRemoveAbility(u1,'A0U1')
    set t=null
    set u1=null
endfunction
//===========================================================================
function InitTrig_B26E takes nothing returns nothing
    set gg_trg_B26E=CreateTrigger()
    call TriggerAddCondition(gg_trg_B26E, Condition(function Trig_B26EConditions))
    call TriggerAddAction(gg_trg_B26E, function Trig_B26EActions)
endfunction//===========================================================================
// Trigger: B26R learn
//===========================================================================
//R 使用
function Trig_B26RConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0B9'
endfunction
function Trig_B26RActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    	//給予特效技能
	    set udg_B26R_I[i] = 1
	    call DestroyEffect(udg_B26R_SE2[i])
	    call UnitAddAbility( u1, 'A0DO' )
	  	call YDWEPolledWaitNull(6.00)
	  	//刪除特效技能
	    call UnitRemoveAbility( u1 ,'A0DO' )
	    set udg_B26R_I[i] = 0 
    	set udg_B26R_SE2[i] = AddSpecialEffectTarget("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl", u1, "origin")
    set u1 = null
endfunction
//R 每兩秒傷害
function Trig_B26R_Dmg takes nothing returns nothing
	local unit ydl_unit 
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
	local player p = GetOwningPlayer(u1)
	local real dmg = 5.00 + 5 * GetHeroLevel(u1)*udg_B26R_I[GetPlayerId(p) + 1] + 15.00 * I2R(GetUnitAbilityLevel(u1, 'A0B9')) 
	    call GroupEnumUnitsInRange(udg_Group[4], GetUnitX(u1), GetUnitY(u1), 450.00, null)
	        loop
	            set ydl_unit = FirstOfGroup(udg_Group[4])
	            exitwhen ydl_unit == null
	            call GroupRemoveUnit(udg_Group[4], ydl_unit)
	            if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true then
	            	call UnitDamageTarget(u1, ydl_unit, dmg, true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
	                call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\SoulBurn\\SoulBurnbuff.mdl", ydl_unit, "origin") )
	            endif
	        endloop
	set p = null
	set u1 = null
	set ydl_unit = null
	set t = null
endfunction
//R 學習
function Trig_B26R_learnActions takes nothing returns nothing
	local unit u1= GetTriggerUnit()
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local trigger ltt = CreateTrigger()
		call TriggerAddAction(ltt,function Trig_B26RActions)
		call TriggerAddCondition(ltt, function Trig_B26RConditions)
		call TriggerRegisterUnitEvent(ltt,u1,EVENT_UNIT_SPELL_EFFECT)
		set B26R_T[i]=t
	    set udg_B26R_I[i]=0
	    call DestroyEffect(udg_B26R_SE2[i])
		set udg_B26R_SE2[i] = AddSpecialEffectTarget("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl", u1, "origin")
	    call SaveUnitHandle(YDHT, h2i, 1, u1)
	    call TimerStart(B26R_T[i], 2.00, true, function Trig_B26R_Dmg) 
	set t = null
	set u1 = null 
	set ltt = null
endfunction
function Trig_B26R_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0B9' and GetUnitAbilityLevel(GetTriggerUnit(),'A0B9') == 1 then
	    call Trig_B26R_learnActions()
    endif
    return false
endfunction
function InitTrig_B26R_learn takes nothing returns nothing
    set gg_trg_B26R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B26R_learn, Condition(function Trig_B26R_learnConditions))
endfunction
globals
    timer array B26R_T
    integer array udg_B26R_I
endglobals//===========================================================================
// Trigger: B26T
//===========================================================================
function Trig_B26TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A07S'))
endfunction
function Trig_B26TActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    // ---------------------------------
    call UnitAddAbilityBJ( 'A05F', u1 )
    // ---------------------------------
    call YDWEPolledWaitNull(25.00)
    // ---------------------------------
    call UnitRemoveAbilityBJ( 'A05F', u1 )
    // ---------------------------------
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B26T takes nothing returns nothing
    set gg_trg_B26T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B26T, Condition(function Trig_B26TConditions))
    call TriggerAddAction(gg_trg_B26T, function Trig_B26TActions)
endfunction
//===========================================================================
// Trigger: B27
//===========================================================================
function Trig_B27Conditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0NK' then
	    call UnitAddAbility( GetTriggerUnit(), 'A0MZ' )
    	call SetUnitAbilityLevel( GetTriggerUnit(), 'A0MZ', GetUnitAbilityLevel(GetTriggerUnit(), 'A0NK') )
    	call UnitMakeAbilityPermanent( GetTriggerUnit(), true, 'A0MZ' )
	endif
	return false
endfunction
function InitTrig_B27 takes nothing returns nothing
    set gg_trg_B27 = CreateTrigger()
    call TriggerAddCondition(gg_trg_B27, Condition(function Trig_B27Conditions))
endfunction
//===========================================================================
// Trigger: B27R_U
//===========================================================================
function Trig_B27R_UConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0NK'
endfunction
function Trig_B27R_UActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    call TriggerSleepAction(0.00)
    call SetUnitAbilityLevel( u1, 'A0H9', GetUnitAbilityLevel(u1, 'A0NK') )
    set u1 = null
endfunction
function InitTrig_B27R_U takes nothing returns nothing
    set gg_trg_B27R_U = CreateTrigger()
    call TriggerAddCondition(gg_trg_B27R_U, Condition(function Trig_B27R_UConditions))
    call TriggerAddAction(gg_trg_B27R_U, function Trig_B27R_UActions)
endfunction//===========================================================================
// Trigger: B28
//===========================================================================
function Trig_B28Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B28W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B28_Upgrade, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    call TriggerRegisterUnitEvent(gg_trg_B28T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_B28 takes nothing returns nothing
    set gg_trg_B28 = CreateTrigger()
    call TriggerAddAction(gg_trg_B28, function Trig_B28Actions)
endfunction
//===========================================================================
// Trigger: B28_Upgrade 
//===========================================================================
function Trig_B28_UpgradeConditions takes nothing returns boolean
    return ((ModuloInteger(GetHeroLevel(GetTriggerUnit()), 2) == 0))
endfunction
function Trig_B28_UpgradeActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rhme', ( GetHeroLevel(GetTriggerUnit()) / 2 ), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_B28_Upgrade takes nothing returns nothing
    set gg_trg_B28_Upgrade = CreateTrigger()
    call TriggerAddCondition(gg_trg_B28_Upgrade, Condition(function Trig_B28_UpgradeConditions))
    call TriggerAddAction(gg_trg_B28_Upgrade, function Trig_B28_UpgradeActions)
endfunction
//===========================================================================
// Trigger: B28W
//
// A0WB
//===========================================================================
function Trig_B28WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A07Y'))
endfunction
function Trig_B28WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local real x= GetSpellTargetX()
    local real y = GetSpellTargetY()
    local real dmg = 135.00 * I2R(GetUnitAbilityLevel(u1, 'A07Y')) 
    local player p = GetOwningPlayer(u1)
    local unit u3 = CreateUnit(p, 'h02D', x,y, 0)
	    call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
	    call UnitAddAbility( u3, 'A0WB')
	    call SetUnitAbilityLevel( u3, 'A0WB', GetUnitAbilityLevel(u1, 'A07Y') )
		    call GroupEnumUnitsInRange(udg_Group[3], x, y, 415.00, null)
		    loop
		        set ydl_unit = FirstOfGroup(udg_Group[3])
		        exitwhen ydl_unit == null
		        call GroupRemoveUnit(udg_Group[3], ydl_unit)
			        if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true then
			            call UnitDamageTargetBJ( u1, ydl_unit, dmg, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
			            call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\DragonHawkMissile\\DragonHawkMissile.mdl", ydl_unit, "chest") )
			        endif
		    endloop
 	set p = null
    set u1 = null
    set u3 = null
    set ydl_unit = null
endfunction
function InitTrig_B28W takes nothing returns nothing
    set gg_trg_B28W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B28W, Condition(function Trig_B28WConditions))
    call TriggerAddAction(gg_trg_B28W, function Trig_B28WActions)
endfunction//===========================================================================
// Trigger: B28T
//===========================================================================
function Trig_B28TConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A055' ) )
endfunction
function Trig_B28TActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    local real x1
    local real y1
    local unit u3
    local real a
    local integer i=1
	    set u3=CreateUnit(GetOwningPlayer(u1), 'h01E', x,y, 0)
	    call UnitApplyTimedLife(u3, 'BTLF', 3.00)
	    call UnitAddAbility(u3, 'A083')
	    call SetUnitAbilityLevel(u3, 'A083', GetUnitAbilityLevel(u1, 'A055'))
		    loop
			    exitwhen i > 32
			    set a = I2R(i)* 11.25*3.14159/180.0
			    set x1 = x + 200*Cos(a)
			    set y1 = y + 200*Sin(a)
			    call IssuePointOrder(u3,"breathoffrost",x1,y1)
			    set i=i + 1
		    endloop
    set u1=null
    set u3=null
endfunction
function InitTrig_B28T takes nothing returns nothing
    set gg_trg_B28T=CreateTrigger()
    call TriggerAddCondition(gg_trg_B28T, Condition(function Trig_B28TConditions))
    call TriggerAddAction(gg_trg_B28T, function Trig_B28TActions)
endfunction//===========================================================================
// Trigger: B29
//===========================================================================
function Trig_B29Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B29W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B29E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B29R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
//===========================================================================
function InitTrig_B29 takes nothing returns nothing
    set gg_trg_B29 = CreateTrigger()
    call TriggerAddAction(gg_trg_B29, function Trig_B29Actions)
endfunction
//===========================================================================
// Trigger: B29W
//===========================================================================
function Trig_B29WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A095'))
endfunction
function Trig_B29WActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    //for 1.2 sec sign
    local unit u3 = CreateUnit(GetOwningPlayer(u1), 'h02G', GetSpellTargetX(),GetSpellTargetY(), 0)
	    call UnitApplyTimedLife( u3, 'BHwe', 1.20 )
	    call UnitAddAbility( u3, 'A04N' )
	    call SetUnitAbilityLevel( u3, 'A04N', GetUnitAbilityLevel(u1, 'A095') )
	    call IssueImmediateOrder( u3, "stomp" )
    set u1 = null
    set u3 = null
endfunction
//===========================================================================
function InitTrig_B29W takes nothing returns nothing
    set gg_trg_B29W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B29W, Condition(function Trig_B29WConditions))
    call TriggerAddAction(gg_trg_B29W, function Trig_B29WActions)
endfunction//===========================================================================
// Trigger: B29E
//
// local timer t = GetExpiredTimer()
// call YDTriggerClearTable(YDTriggerH2I(GetExpiredTimer()))
//         call DestroyTimer(GetExpiredTimer())
//===========================================================================
globals
integer array B29E_I
endglobals
function Trig_B29EConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0EU' 
endfunction
function Trig_B29EFunc002T takes nothing returns nothing
local unit ydl_unit	
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =	LoadUnitHandle(YDHT, h2i, 1)
local player p = GetOwningPlayer(u1)
local integer i = GetPlayerId(p) + 1
local group g = CreateGroup() 
local unit u2
local unit u3
local integer random = 0
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
	//計次數
	set B29E_I[i] = B29E_I[i] + 1
	
		if B29E_I[i] == 10 or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 then
			call FlushChildHashtable(YDHT, h2i)
		    call DestroyTimer(t)
		else
		    call GroupEnumUnitsInRange(udg_Group[7], x, y, 600.00, null)
		    loop
		        set ydl_unit = FirstOfGroup(udg_Group[7])
		        exitwhen ydl_unit == null or random == 4
		        call GroupRemoveUnit(udg_Group[7], ydl_unit)
		        if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and GetUnitPointValue(ydl_unit) != 1 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true then
		            set random = random + 1
					set Random_U[random] = ydl_unit 
		        endif
		    endloop
		    //avoid reuse the same Group
			call GroupClear(udg_Group[7])
				if random>0 then
					//random chose Unit
					set ydl_unit = Random_U[GetRandomInt(1,random)]
					set x = GetUnitX(ydl_unit)
			    	set y = GetUnitY(ydl_unit)
			    	//for sign 1.20 sec
			        set u3=CreateUnit(p, 'h02G', x,y, 0)
			        call UnitApplyTimedLife(u3, 'BHwe', 1.20)
			        call UnitAddAbility(u3, 'A0EV')
			        call SetUnitAbilityLevel(u3, 'A0EV', GetUnitAbilityLevel(u1, 'A0EU'))
			        call IssueImmediateOrder(u3, "stomp")
	    			call DestroyEffect(AddSpecialEffect( "Abilities\\Spells\\Other\\Volcano\\VolcanoDeath.mdl" ,x,y) )
	    		endif	
		endif
		
set t =	null
set u1 =	null
set u3 =	null
set ydl_unit = null
set p = null
endfunction
function Trig_B29EActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local integer i= GetPlayerId(GetOwningPlayer(u1)) + 1
	set B29E_I[i] = 0
    	call SaveUnitHandle(YDHT, h2i, 1, u1)
    	call TimerStart(t, 1.00, true, function Trig_B29EFunc002T)
set t=null
set u1=null
endfunction
function InitTrig_B29E takes nothing returns nothing
    set gg_trg_B29E=CreateTrigger()
    call TriggerAddCondition(gg_trg_B29E, Condition(function Trig_B29EConditions))
    call TriggerAddAction(gg_trg_B29E, function Trig_B29EActions)
endfunction//===========================================================================
// Trigger: B29R
//===========================================================================
////===========================================================================
//// This version differs from the common.j interface in that the alpha value
//// is reversed so as to be displayed as transparency, and all four parameters
//// are treated as percentages rather than bytes.
////
//function SetUnitVertexColorBJ takes unit whichUnit, real red, real green, real blue, real transparency returns nothing
//    call SetUnitVertexColor(whichUnit, PercentTo255(red), PercentTo255(green), PercentTo255(blue), PercentTo255(100.0-transparency))
//endfunction
function Trig_B29RFunc002Func003T takes nothing returns nothing
	local timer	t = GetExpiredTimer()
	local	unit	u = LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D)
	local	integer	level	= GetUnitAbilityLevel(u, 'A0EW')
	local	real	r = ( 24.00 * I2R(level) )
	    call SetUnitVertexColor(u, 255, 255, 255, PercentTo255(100.0-r))
	set t = null
	set u = null 
endfunction
function Trig_B29RActions takes nothing returns nothing
    local timer t
    local unit u =	GetTriggerUnit()
    local integer	level	=	GetUnitAbilityLevel(u, 'A0EW')
    local player	p =	GetTriggerPlayer()	
	//提升防禦
    call SetPlayerTechResearched(p,'Rhst',level)
    	//淡化英雄
	    if level == 1 then
	        set t=CreateTimer()
	        call SaveUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D, u)
	        call TimerStart(t, 1.00, true, function Trig_B29RFunc002Func003T)
	    endif
	set u =	null
	set p =	null 
    set t =	null
endfunction
function Trig_B29RConditions takes nothing returns boolean
	if GetLearnedSkill() == 'A0EW' then
		call	Trig_B29RActions()
	endif
	return	false
endfunction
function InitTrig_B29R takes nothing returns nothing
    set gg_trg_B29R=CreateTrigger()
    call TriggerAddCondition(gg_trg_B29R, Condition(function Trig_B29RConditions))
endfunction
//===========================================================================
// Trigger: B30
//===========================================================================
function Trig_B30Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B30E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B30R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B30R_count, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B30T_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
//===========================================================================
function InitTrig_B30 takes nothing returns nothing
    set gg_trg_B30 = CreateTrigger()
    call TriggerAddAction(gg_trg_B30, function Trig_B30Actions)
endfunction
//===========================================================================
// Trigger: B30E
//===========================================================================
function Trig_B30EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0EZ'))
endfunction
function Trig_B30EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u3
    local integer i
    local integer level=GetUnitAbilityLevel(u1, 'A0EZ')
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    local real x1 = GetSpellTargetX()
    local real y1 = GetSpellTargetY()
    local real x2
    local real y2
    local real x3
    local real y3
    local real a1 = Atan2(y1-y,x1-x)
    	set u3 = CreateUnit(GetOwningPlayer(u1), 'ncks', x1,y1, 270)
        call SetUnitAbilityLevel( u3, 'A0F0', level )
        call SetUnitAbilityLevel( u3, 'A0F1', level )
        call UnitApplyTimedLife( u3, 'BHwe', 16.00 )
        call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Undead\\DarkRitual\\DarkRitualTarget.mdl", x1,y1) )
        set i = 1
        loop
	        exitwhen i > 8
            set x2 = x1 + 138.00*I2R(i)*Cos(a1+90.00*3.14159/180)
            set y2 = y1 + 138.00*I2R(i)*Sin(a1+90.00*3.14159/180)
            set x3 = x1 + 138.00*I2R(i)*Cos(a1-90.00*3.14159/180)
            set y3 = y1 + 138.00*I2R(i)*Sin(a1-90.00*3.14159/180)
                    call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Undead\\DarkRitual\\DarkRitualTarget.mdl", x2,y2) )
                    call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Undead\\DarkRitual\\DarkRitualTarget.mdl", x3,y3) )
    
                    set u3 = CreateUnit(GetOwningPlayer(u1), 'ncks', x2,y2, 270)
                    call SetUnitAbilityLevel( u3, 'A0F0', level )
                    call SetUnitAbilityLevel( u3, 'A0F1', level )
                    call UnitApplyTimedLife( u3, 'BHwe', 16.00 )
                    set u3 = CreateUnit(GetOwningPlayer(u1), 'ncks', x3,y3, 270)
                    call SetUnitAbilityLevel( u3, 'A0F0', level )
                    call SetUnitAbilityLevel( u3, 'A0F1', level )
                    call UnitApplyTimedLife( u3, 'BHwe', 16.00 )
            set i = i + 1
        endloop 
    set u1 = null
    set u3 = null
endfunction
//===========================================================================
function InitTrig_B30E takes nothing returns nothing
    set gg_trg_B30E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B30E, Condition(function Trig_B30EConditions))
    call TriggerAddAction(gg_trg_B30E, function Trig_B30EActions)
endfunction//===========================================================================
// Trigger: B30R
//===========================================================================
function Trig_B30RActions takes nothing returns nothing
    local unit u1	=	GetTriggerUnit()
    local player p	=	GetOwningPlayer(u1)
    local integer i = GetPlayerId(p) + 1
    
	    set udg_B30R_I[i] = 6
 
    	call UnitAddAbility( u1, 'A0F4' )
    	call SetUnitAbilityLevel( u1, 'A0F4', GetUnitAbilityLevel(u1, 'A0F3') )
    	
    set u1	=	null
    set p	=	null
endfunction
function Trig_B30RConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0F3' then
		call	Trig_B30RActions()
 	endif
 	return	false
endfunction
//===========================================================================
function InitTrig_B30R takes nothing returns nothing
    set gg_trg_B30R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B30R, Condition(function Trig_B30RConditions))
endfunction//===========================================================================
// Trigger: B30R count
//===========================================================================
function Trig_B30R_countConditions takes nothing returns boolean
    return ((GetUnitAbilityLevelSwapped('A0F4', GetTriggerUnit()) != 0))
endfunction
function Trig_B30R_countActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    // ---------------------------------
    set udg_B30R_I[i] = ( udg_B30R_I[i] - 1 )
    // ---------------------------------
    if ((udg_B30R_I[i] == 0)) then
        call UnitRemoveAbilityBJ( 'A0F4', u1 )
    else
    endif
    // ---------------------------------
    set u1=null
endfunction
//===========================================================================
function InitTrig_B30R_count takes nothing returns nothing
    set gg_trg_B30R_count = CreateTrigger()
    call TriggerAddCondition(gg_trg_B30R_count, Condition(function Trig_B30R_countConditions))
    call TriggerAddAction(gg_trg_B30R_count, function Trig_B30R_countActions)
endfunction
//===========================================================================
// Trigger: B30T learn
//===========================================================================
function Trig_B30T_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0F5') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A0F5') == 1) and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_B30T_learnActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B30T, GetTriggerUnit(), EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_B30T_learn takes nothing returns nothing
    set gg_trg_B30T_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B30T_learn, Condition(function Trig_B30T_learnConditions))
    call TriggerAddAction(gg_trg_B30T_learn, function Trig_B30T_learnActions)
endfunction
//===========================================================================
// Trigger: B30T 
//===========================================================================
function Trig_B30TConditions takes nothing returns boolean
    local unit u1=GetTriggerUnit()
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    // ---------------------------------
    local unit u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', x, y, 0)
    call UnitApplyTimedLife( u3, 'BTLF', 3.00 )
    call UnitAddAbility( u3 , 'A0FY' )
    call SetUnitAbilityLevel( u3, 'A0FY', GetUnitAbilityLevel( u1, 'A0F5') )
    call IssueImmediateOrderById( u3, 852096 )
    // ---------------------------------
    call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\NightElf\\\\BattleRoar\\RoarCaster.mdl", x, y) )
    call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl", x, y) )
    // ---------------------------------
    set u1=null
    set u3=null
    return false
endfunction
//===========================================================================
function InitTrig_B30T takes nothing returns nothing
    set gg_trg_B30T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B30T, Condition(function Trig_B30TConditions))
endfunction
//===========================================================================
// Trigger: B31
//
// if ( not ( ModuloReal(( GetTimeOfDay() + 6.00 ), 24.00) < 12.00 ) )
//===========================================================================
function Trig_B31Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B31D, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B31W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B31E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B31_R_enable, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B31T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_B31 takes nothing returns nothing
    set gg_trg_B31 = CreateTrigger()
    call TriggerAddAction(gg_trg_B31, function Trig_B31Actions)
endfunction
//===========================================================================
// Trigger: B31D 
//
// 0xA1614B4D    local timer t = GetExpiredTimer()
//     local unit u1 = YDTriggerGetEx(unit, YDTriggerH2I(GetExpiredTimer()), 0xCFDE6C76)
//===========================================================================
function Trig_B31DFunc003Func002T takes nothing returns nothing
    local unit u1= LoadUnitHandle(YDHT, GetHandleId(GetExpiredTimer()), 0xA1614B4D)
	    if ModuloReal( GetFloatGameState(GAME_STATE_TIME_OF_DAY) + 6.00 , 24.00) < 12.00 then
	        if GetUnitAbilityLevel(u1, 'A0FF') == 0 then
	        	call UnitAddAbility(u1, 'A0FF')
	        endif
	    elseif GetUnitAbilityLevel(u1, 'A0FF') == 1 then
		    call UnitRemoveAbility(u1, 'A0FF')
	    endif
	    //魔獸的初始時間是 6:00 = 0 : 0
	    //call BJDebugMsg(R2S(ModuloReal( GetFloatGameState(GAME_STATE_TIME_OF_DAY) + 6.00 , 24.00)))
    set u1=null
endfunction
function Trig_B31DActions takes nothing returns nothing
    local timer t
    call SetUnitAbilityLevel(GetTriggerUnit(), 'A0FG', GetUnitAbilityLevel(GetTriggerUnit(), 'A0GQ') + 1 )
        if GetUnitAbilityLevel(GetTriggerUnit(), 'A0GQ') == 1 then
            set t=CreateTimer()
            call SaveUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D, GetTriggerUnit())
            call TimerStart(t, 1.00, true, function Trig_B31DFunc003Func002T)
        endif
    set t=null
endfunction
function Trig_B31DConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0GQ' then
	    call Trig_B31DActions()
    endif
    return false
endfunction
function InitTrig_B31D takes nothing returns nothing
    set gg_trg_B31D=CreateTrigger()
    call TriggerAddCondition(gg_trg_B31D, Condition(function Trig_B31DConditions))
    call TriggerAddAction(gg_trg_B31D, function Trig_B31DActions)
endfunction//===========================================================================
// Trigger: B31W 
//===========================================================================
function Trig_B31WConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0F7'
endfunction
function Trig_B31WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local unit u2=GetSpellTargetUnit()
    local real dmg = 20.00 + 80.00 * I2R(GetUnitAbilityLevel(u1, 'A0F7')) + I2R(GetHeroStr(u1, true)) 
    local player p = GetOwningPlayer(u1)
    local integer i= GetPlayerId(p) + 1
    
    // 傷害+特效
    call GroupEnumUnitsInRange(udg_Group[6], GetUnitX(u2), GetUnitY(u2), 400.00, null)
    loop
        set ydl_unit=FirstOfGroup(udg_Group[6])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[6], ydl_unit)
            if IsUnitEnemy(ydl_unit, p)and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false then
            	call UnitDamageTarget(u1, ydl_unit, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
                call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl", ydl_unit, "chest"))
            endif
    endloop
    	//夜晚沒有暈眩效果
        if ModuloReal( GetFloatGameState(GAME_STATE_TIME_OF_DAY) + 6.00 , 24.00) > 12.00 then
            call YDWEPolledWaitNull(0.10)
            call UnitRemoveAbility(u2, 'BPSE')
        endif
    set u1=null
    set u2=null
    set ydl_unit=null
    set p = null
endfunction
function InitTrig_B31W takes nothing returns nothing
    set gg_trg_B31W=CreateTrigger()
    call TriggerAddCondition(gg_trg_B31W, Condition(function Trig_B31WConditions))
    call TriggerAddAction(gg_trg_B31W, function Trig_B31WActions)
endfunction//===========================================================================
// Trigger: B31E
//===========================================================================
function Trig_B31EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u2=GetSpellTargetUnit()
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local unit u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
    	//沉默
	    call UnitApplyTimedLife( u3, 'BTLF', 3.00 )
	    call UnitAddAbility( u3 , 'A0FB' )
	    call SetUnitAbilityLevel( u3, 'A0FB', GetUnitAbilityLevel( u1, 'A0F9') )
	    call IssueTargetOrderById( u3, 852668, u2 )
	    	//夜晚魔抗
	        if ModuloReal( GetFloatGameState(GAME_STATE_TIME_OF_DAY) + 6.00 , 24.00) < 12.00 then
	            set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
	            call UnitApplyTimedLife( u3, 'BTLF', 3.00 )
	            call UnitAddAbility( u3 , 'A0FV' )
	            call SetUnitAbilityLevel( u3,'A0FV', GetUnitAbilityLevel( u1, 'A0F9') )
	            call IssueTargetOrderById( u3, 852186, u1 )
	        endif
    set u1 = null
    set u2 = null
    set u3 = null
endfunction
function Trig_B31EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0F9' then
	    call Trig_B31EActions()
    endif
    return false
endfunction
function InitTrig_B31E takes nothing returns nothing
    set gg_trg_B31E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B31E, Condition(function Trig_B31EConditions))
endfunction//===========================================================================
// Trigger: B31 R enable
//===========================================================================
function Trig_B31_R_reduce_damageActions takes nothing returns nothing
local unit u1 
	if GetEventDamage() > 1 then
		set u1 = GetTriggerUnit()
		call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1,UNIT_STATE_LIFE) + GetEventDamage() * ( 0.02 + 0.05 * I2R(GetUnitAbilityLevel(u1,'A0FE')))) 
		//call BJDebugMsg(R2S( 0.02 +  0.05 * I2R(GetUnitAbilityLevel(u1,'A0FE'))))
	endif
set u1 = null	
endfunction
function Trig_B31_R_enableActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local trigger ltt = CreateTrigger()
	    call TriggerAddCondition(ltt, function Trig_B31_R_reduce_damageActions)
	    call TriggerRegisterUnitEvent(ltt,u1,EVENT_UNIT_DAMAGED)
    set u1 = null
    set ltt = null
endfunction
function Trig_B31_R_enableConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0FE' and GetUnitAbilityLevel(GetTriggerUnit(), 'A0FE') == 1 and IsUnitIllusion(GetTriggerUnit()) != true then
    	call Trig_B31_R_enableActions()
	endif
    return false
endfunction
//===========================================================================
function InitTrig_B31_R_enable takes nothing returns nothing
    set gg_trg_B31_R_enable = CreateTrigger()
    call TriggerAddCondition(gg_trg_B31_R_enable, Condition(function Trig_B31_R_enableConditions))
endfunction//===========================================================================
// Trigger: B31T
//
// call UnitRemoveAbilityBJ( 'A0GR', u1 )
//===========================================================================
function Trig_B31TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0GQ'))
endfunction
function Trig_B31TActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
	    call SetUnitMoveSpeed( u1, ( GetUnitDefaultMoveSpeed(u1) + ( GetUnitDefaultMoveSpeed(u1) * ( 0.05 + ( 0.10 * I2R(GetUnitAbilityLevel(u1, GetSpellAbilityId()))) ) ) ) )
	    call UnitAddAbility( u1, 'A0GR' )
	    call SetUnitAbilityLevel( u1, 'A0GR', GetUnitAbilityLevel(u1, 'A0GQ') )
    call YDWEPolledWaitNull(20.00)
	    call SetUnitMoveSpeed( u1, GetUnitDefaultMoveSpeed(u1) )
	    call UnitRemoveAbility( u1, 'A0GR' )
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B31T takes nothing returns nothing
    set gg_trg_B31T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B31T, Condition(function Trig_B31TConditions))
    call TriggerAddAction(gg_trg_B31T, function Trig_B31TActions)
endfunction//===========================================================================
// Trigger: B32
//===========================================================================
function Trig_B32Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B32W_use, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B32W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B32E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B32R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ----------------------------------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_B32T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ----------------------------------------------------------------------
    call SetPlayerAbilityAvailableBJ( false, 'A0NG', GetOwningPlayer(udg_A_common_HERO) )
    // ----------------------------------------------------------------------
    set udg_B32W_G[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
endfunction
//===========================================================================
function InitTrig_B32 takes nothing returns nothing
    set gg_trg_B32 = CreateTrigger()
    call TriggerAddAction(gg_trg_B32, function Trig_B32Actions)
endfunction
//===========================================================================
// Trigger: B32W
//===========================================================================
globals
boolean array B32W_B
timer array B32W_T
endglobals
	
function Trig_B32WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0NF'))
endfunction
function Trig_B32W_learnFunc003T takes nothing returns nothing
local unit ydl_unit 
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local real dmg = ( 5.00 + ( 3.00 * I2R(GetUnitAbilityLevel(u1, 'A0NF')) ) )
local player p =GetOwningPlayer(u1)
        call GroupEnumUnitsInRange(udg_Group[4], GetUnitX(u1), GetUnitY(u1), 500.00, null)
        loop
            set ydl_unit = FirstOfGroup(udg_Group[4])
            exitwhen ydl_unit == null
            call GroupRemoveUnit(udg_Group[4], ydl_unit)
            if (IsUnitEnemy(ydl_unit, p) and (GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) ) then
                call UnitDamageTargetBJ( u1, ydl_unit, dmg, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
                call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\LordofFlameMissile\\LordofFlameMissile.mdl", ydl_unit, "head") )
            endif
        endloop
    // ---------------------------------
    set u1 = null
    set ydl_unit = null
    set p = null
endfunction
function Trig_B32WActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local unit u3
local integer h2i 
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
	set B32W_B[i] = true
	call SetPlayerAbilityAvailable( GetOwningPlayer(u1),'A0NF',false )
	call SetPlayerAbilityAvailable( GetOwningPlayer(u1),'A0NG',true )
		set B32W_T[i]=CreateTimer()
		set h2i = GetHandleId(B32W_T[i])
	    call SaveUnitHandle(YDHT, h2i, 1, u1)
		call TimerStart(B32W_T[i], 0.20, true, function Trig_B32W_learnFunc003T)
			call YDWEPolledWaitNull(8.00)
		call PauseTimer(B32W_T[i])
		call DestroyTimer(B32W_T[i])
		call FlushChildHashtable(YDHT, h2i) 
	call SetPlayerAbilityAvailable( GetOwningPlayer(u1),'A0NF',true )
	call SetPlayerAbilityAvailable( GetOwningPlayer(u1),'A0NG',false ) 
    	if ((B32W_B[i] == true)) then
	        set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
	        call UnitApplyTimedLife( u3, 'BTLF', 3.00 )
	        call UnitAddAbility( u3 , 'A0J5' )
	        call SetUnitAbilityLevel( u3, 'A0J5', GetUnitAbilityLevel( u1, 'A0NF') )
	        call IssueImmediateOrderById( u3, 852096 )
	        call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl", GetUnitX(u1), GetUnitY(u1)) )
	    endif
set B32W_B[i] = false
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_B32W takes nothing returns nothing
    set gg_trg_B32W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B32W, Condition(function Trig_B32WConditions))
    call TriggerAddAction(gg_trg_B32W, function Trig_B32WActions)
endfunction//===========================================================================
// Trigger: B32W use
//===========================================================================
function Trig_B32W_useConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0NG'))
endfunction
function Trig_B32W_useActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local unit u3
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    local integer h2i = GetHandleId(B32W_T[i])
    	set B32W_B[i] = false
	    call PauseTimer(B32W_T[i]) 
	    call DestroyTimer(B32W_T[i])
		call FlushChildHashtable(YDHT, h2i)
    set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
    call UnitApplyTimedLife( u3, 'BTLF', 3.00 )
    call UnitAddAbility( u3 , 'A0J5' )
    call SetUnitAbilityLevel( u3, 'A0J5', GetUnitAbilityLevel( u1, 'A0NF') )
    call IssueImmediateOrderById( u3, 852096 )
    call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl", GetUnitX(u1), GetUnitY(u1)) )
	    call SetPlayerAbilityAvailable( GetOwningPlayer(u1), 'A0NG', false )
	    call SetPlayerAbilityAvailable( GetOwningPlayer(u1), 'A0NF', true)
    set u1 = null
    set u3 = null
endfunction
//===========================================================================
function InitTrig_B32W_use takes nothing returns nothing
    set gg_trg_B32W_use = CreateTrigger()
    call TriggerAddCondition(gg_trg_B32W_use, Condition(function Trig_B32W_useConditions))
    call TriggerAddAction(gg_trg_B32W_use, function Trig_B32W_useActions)
endfunction
//===========================================================================
// Trigger: B32E 
//===========================================================================
function Trig_B32EConditions takes nothing returns boolean
    return ( (GetSpellAbilityId() == 'A0DK'))
endfunction
function Trig_B32EActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    // -------------
    call UnitAddAbility( u1 ,'A00W')
    // -------------
    call SetUnitVertexColor( u1, 255, 100, 50, 255 )
    // -------------
    call YDWEPolledWaitNull( ( 2.00 + ( 1.00 * I2R(GetUnitAbilityLevelSwapped( 'A0DK', u1)) ) ) )
    // -------------
    call UnitRemoveAbility( u1 , 'A00W')
    // -------------
    call SetUnitVertexColor( u1, 255, 255, 255, 255 )
    // -------------
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B32E takes nothing returns nothing
    set gg_trg_B32E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B32E, Condition(function Trig_B32EConditions))
    call TriggerAddAction(gg_trg_B32E, function Trig_B32EActions)
endfunction
//===========================================================================
// Trigger: B32R learn
//===========================================================================
function Trig_B32R_damageConditions takes nothing returns boolean
    return ((GetEventDamage() > 1.00) and (GetRandomInt(1, 100) <= (GetUnitAbilityLevel(GetTriggerUnit(),'A0EQ') * 4 ) + 1))
endfunction
function Trig_B32R_damageActions takes nothing returns nothing
    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\LavaSpawnMissile\\LavaSpawnMissile.mdl", GetTriggerUnit(), "overhead") )
    call SetUnitState(GetTriggerUnit(), UNIT_STATE_LIFE, GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE) + GetEventDamage()) 
endfunction
function Trig_B32R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkill() == 'A0EQ') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A0EQ') == 1) and (IsUnitIllusion(GetTriggerUnit()) != true))
endfunction
function Trig_B32R_learnActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local trigger ltt = CreateTrigger()
    call TriggerAddAction(ltt,function Trig_B32R_damageActions)
    call TriggerAddCondition(ltt, function Trig_B32R_damageConditions)
    call TriggerRegisterUnitEvent(ltt,u1,EVENT_UNIT_DAMAGED)
    set u1 = null
    set ltt = null
endfunction
//===========================================================================
function InitTrig_B32R_learn takes nothing returns nothing
    set gg_trg_B32R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B32R_learn, Condition(function Trig_B32R_learnConditions))
    call TriggerAddAction(gg_trg_B32R_learn, function Trig_B32R_learnActions)
endfunction//===========================================================================
// Trigger: B32T
//===========================================================================
function Trig_B32TConditions takes nothing returns boolean
    return ( (GetSpellAbilityId() == 'A0XK'))
endfunction
function Trig_B32TActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    // -------------
    call UnitAddAbility( u1 , 'A0H0' )
    // -------------
    call YDWEPolledWaitNull(( 7.00 + ( 4.00 * I2R(GetUnitAbilityLevel(u1, 'A0XK')) ) ))
    // -------------
    call UnitRemoveAbility( u1, 'A0H0' )
    // -------------
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B32T takes nothing returns nothing
    set gg_trg_B32T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B32T, Condition(function Trig_B32TConditions))
    call TriggerAddAction(gg_trg_B32T, function Trig_B32TActions)
endfunction
//===========================================================================
// Trigger: B33
//===========================================================================
function Trig_B33Func021Func011A takes nothing returns nothing
    local unit u3 = GetEnumUnit()
    local real x1= GetUnitX(u3)
    local real y1= GetUnitY(u3)
    local real x2
    local real y2
    local real dx = (udg_X[233] - x1)
    local real dy = (udg_Y[233] - y1)
    if ((SquareRoot(( ( dx * dx ) + ( dy * dy ) )) > 1201.00)) then
        set x2 = (udg_X[233] + ( 175.00 * Cos( udg_real * bj_DEGTORAD )))
        set y2 = (udg_Y[233] + ( 175.00 * Sin( udg_real * bj_DEGTORAD )))
        call SetUnitPosition( u3, x2, y2 )
        call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\NightElf\\Blink\\BlinkTarget.mdl", x2, y2) )
    else
    endif
    set u3 = null
endfunction
function Trig_B33Func021T takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local integer i
    // -------------
    set udg_A_AHERO[233] = LoadUnitHandle(YDHT, GetHandleId(GetExpiredTimer()), 0xA1614B4D)
    set udg_X[233] = GetUnitX(udg_A_AHERO[233])
    set udg_Y[233] = GetUnitY(udg_A_AHERO[233])
    set udg_real = (GetUnitFacing(udg_A_AHERO[233]) + 180.00)
    // -------------
    set i = GetConvertedPlayerId(GetOwningPlayer(udg_A_AHERO[233]))
    // -------------
    call ForGroupBJ( udg_B33D_G[i], function Trig_B33Func021Func011A )
    // -------------
    set ydl_group = null
    set ydl_unit = null
endfunction
function Trig_B33Actions takes nothing returns nothing
    local timer ydl_timer
    local integer ydl_localvar_step = LoadInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76)
    set ydl_localvar_step = ydl_localvar_step + 3
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76, ydl_localvar_step)
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xECE825E7, ydl_localvar_step)
    call TriggerRegisterUnitEvent(gg_trg_B33_Hero_lv_up, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B33_D_Learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B33_D_add_to_group, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_SUMMON)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_B33_D_remove_from_group, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_DEATH)
    call TriggerRegisterUnitEvent(gg_trg_B33_D_reduce_damage, udg_A_common_HERO, EVENT_UNIT_DAMAGED)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B33_W, udg_A_common_HERO, EVENT_UNIT_SUMMON)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B33_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B33_R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B33_R_STOP, udg_A_common_HERO, EVENT_UNIT_SPELL_ENDCAST)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B33_T_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B33_T_end, udg_A_common_HERO, EVENT_UNIT_SPELL_ENDCAST)
    // -------------
    set udg_B33D_G[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
    // -------------
    set ydl_timer = CreateTimer()
    call SaveUnitHandle(YDHT, GetHandleId(ydl_timer), 0xA1614B4D, udg_A_common_HERO)
    call TimerStart(ydl_timer, 1.00, true, function Trig_B33Func021T)
    call FlushChildHashtable(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step)
    set ydl_timer = null
endfunction
//===========================================================================
function InitTrig_B33 takes nothing returns nothing
    set gg_trg_B33 = CreateTrigger()
    call TriggerAddAction(gg_trg_B33, function Trig_B33Actions)
endfunction
//===========================================================================
// Trigger: B33 Hero lv up
//===========================================================================
function Trig_B33_Hero_lv_upActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Resm', GetHeroLevel(GetTriggerUnit()), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_B33_Hero_lv_up takes nothing returns nothing
    set gg_trg_B33_Hero_lv_up = CreateTrigger()
    call TriggerAddAction(gg_trg_B33_Hero_lv_up, function Trig_B33_Hero_lv_upActions)
endfunction
//===========================================================================
// Trigger: B33 D Learn
//===========================================================================
function Trig_B33_D_LearnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0LP'))
endfunction
function Trig_B33_D_LearnActions takes nothing returns nothing
    call IncUnitAbilityLevelSwapped( 'A0H1', GetTriggerUnit() )
endfunction
//===========================================================================
function InitTrig_B33_D_Learn takes nothing returns nothing
    set gg_trg_B33_D_Learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_D_Learn, Condition(function Trig_B33_D_LearnConditions))
    call TriggerAddAction(gg_trg_B33_D_Learn, function Trig_B33_D_LearnActions)
endfunction
//===========================================================================
// Trigger: B33 D add to group
//===========================================================================
function Trig_B33_D_add_to_groupConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetSummonedUnit()) == 'ngh1') and (IsUnitIllusionBJ(GetSummonedUnit()) == false))
endfunction
function Trig_B33_D_add_to_groupActions takes nothing returns nothing
    // 召喚亡魂時 把他加到群組中
    call GroupAddUnitSimple( GetSummonedUnit(), udg_B33D_G[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] )
    call SelectUnitAddForPlayer( GetSummonedUnit(), GetOwningPlayer(GetSummoningUnit()) )
endfunction
//===========================================================================
function InitTrig_B33_D_add_to_group takes nothing returns nothing
    set gg_trg_B33_D_add_to_group = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_D_add_to_group, Condition(function Trig_B33_D_add_to_groupConditions))
    call TriggerAddAction(gg_trg_B33_D_add_to_group, function Trig_B33_D_add_to_groupActions)
endfunction
//===========================================================================
// Trigger: B33 D remove from group
//===========================================================================
function Trig_B33_D_remove_from_groupConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetTriggerUnit()) == 'ngh1') and (IsUnitIllusionBJ(GetTriggerUnit()) == false))
endfunction
function Trig_B33_D_remove_from_groupActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    // 亡魂死掉時 自群組中移除
    call GroupRemoveUnitSimple( u1, udg_B33D_G[i] )
    call SetUnitManaPercentBJ( udg_S01_hero_of_player[i], ( GetUnitManaPercent(udg_S01_hero_of_player[i]) - 15.00 ) )
    // -------------
    set u1= null
endfunction
//===========================================================================
function InitTrig_B33_D_remove_from_group takes nothing returns nothing
    set gg_trg_B33_D_remove_from_group = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_D_remove_from_group, Condition(function Trig_B33_D_remove_from_groupConditions))
    call TriggerAddAction(gg_trg_B33_D_remove_from_group, function Trig_B33_D_remove_from_groupActions)
endfunction
//===========================================================================
// Trigger: B33 D reduce damage
//
// I2R(CountUnitsInGroup(udg_B33D_G[i])) * 0.14
//===========================================================================
function Trig_B33_D_reduce_damageConditions takes nothing returns nothing
    local unit u1
    local integer i 
    	if GetEventDamage() > 0.00 then
	    	set u1=GetTriggerUnit()
	    	set i = GetConvertedPlayerId(GetOwningPlayer(u1))
    		call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1,UNIT_STATE_LIFE) + GetEventDamage()*I2R(CountUnitsInGroup(udg_B33D_G[i])) * 0.14 )
		endif
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B33_D_reduce_damage takes nothing returns nothing
    set gg_trg_B33_D_reduce_damage = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_D_reduce_damage, Condition(function Trig_B33_D_reduce_damageConditions))
endfunction//===========================================================================
// Trigger: B33 W
//===========================================================================
function Trig_B33_WConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetSummonedUnit()) == 'hhdl'))
endfunction
function Trig_B33_WFunc011A takes nothing returns nothing
    call SetUnitPosition( GetEnumUnit(), GetUnitX(GetSummonedUnit()), GetUnitY(GetSummonedUnit()) )
endfunction
function Trig_B33_WActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local unit u2=GetSummonedUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    local real i2 = I2R(CountUnitsInGroup(udg_B33D_G[i]))
    local real i3 = I2R(GetUnitAbilityLevelSwapped('A09D', u1)) 
    // -------------
    call SetUnitAbilityLevelSwapped( 'A0H3', u2, GetUnitAbilityLevelSwapped('A09D', u1) )
    // -------------
    call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl", GetUnitX(u2), GetUnitY(u2)) )
    // -------------
    call ForGroupBJ( udg_B33D_G[i], function Trig_B33_WFunc011A )
    // -------------
    set ydl_group = CreateGroup()
    call GroupEnumUnitsInRange(ydl_group, GetUnitX(u2), GetUnitY(u2), 200.00, null)
    loop
        set ydl_unit = FirstOfGroup(ydl_group)
        exitwhen ydl_unit == null
        call GroupRemoveUnit(ydl_group, ydl_unit)
        if ((IsUnitEnemy(ydl_unit, GetOwningPlayer(u1)) == true) and (IsUnitAliveBJ(ydl_unit) == true) and (IsUnitType(ydl_unit, UNIT_TYPE_MAGIC_IMMUNE) == false) and (GetUnitPointValue(ydl_unit) != 1) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) and (IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false)) then
            call UnitDamageTargetBJ( u1, ydl_unit, ( i2 * ( 30.00 + ( 25.00 * i3 ))), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNIVERSAL )
            call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl", ydl_unit, "chest") )
        else
        endif
    endloop
    call DestroyGroup(ydl_group)
    // -------------
    set u1 = null
    set u2 = null
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B33_W takes nothing returns nothing
    set gg_trg_B33_W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_W, Condition(function Trig_B33_WConditions))
    call TriggerAddAction(gg_trg_B33_W, function Trig_B33_WActions)
endfunction
//===========================================================================
// Trigger: B33 E
//===========================================================================
function Trig_B33_EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0H4'))
endfunction
function Trig_B33_EFunc013A takes nothing returns nothing
    local unit u1=GetEnumUnit()
    local unit u2=GetSpellTargetUnit()
    // -------------
    local unit u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
    call ShowUnit( u3, false )
    call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
    call UnitAddAbility( u3, 'A0H5' )
    call SetUnitAbilityLevel( u3, 'A0H5', GetUnitAbilityLevel(u1, 'A0H4') )
    call YDWESetUnitFacingToFaceUnitTimedNull( u3, u2, 0 )
    call IssueTargetOrder( u3, "shadowstrike", u2)
    // -------------
    set u1 = null
    set u2 = null
    set u3 = null
endfunction
function Trig_B33_EActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local unit u2=GetSpellTargetUnit()
    local unit u3
    // -------------
    set u3= CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
    call ShowUnit( u3, false )
    call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
    call UnitAddAbility( u3, 'A0H5' )
    call SetUnitAbilityLevel( u3, 'A0H5', GetUnitAbilityLevel(u1, 'A0H4') )
    call YDWESetUnitFacingToFaceUnitTimedNull( u3, u2, 0 )
    call IssueTargetOrder( u3, "shadowstrike", u2)
    // -------------
    call ForGroupBJ( udg_B33D_G[GetConvertedPlayerId(GetOwningPlayer(u1))], function Trig_B33_EFunc013A )
    // -------------
    set u1 = null
    set u2 = null
    set u3 = null
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B33_E takes nothing returns nothing
    set gg_trg_B33_E = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_E, Condition(function Trig_B33_EConditions))
    call TriggerAddAction(gg_trg_B33_E, function Trig_B33_EActions)
endfunction
//===========================================================================
// Trigger: B33 R
//===========================================================================
function Trig_B33_RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0H6'))
endfunction
function Trig_B33_RFunc007A takes nothing returns nothing
    call UnitAddAbilityBJ( 'A00W', GetEnumUnit() )
endfunction
function Trig_B33_RFunc012A takes nothing returns nothing
    call UnitRemoveAbilityBJ( 'A00W', GetEnumUnit() )
endfunction
function Trig_B33_RActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    // -------------
    set udg_B33R_E[i] = AddSpecialEffectTarget("war3mapImported\\tranquility_purple.mdx", u1, "origin")
    // -------------
    call UnitAddAbilityBJ( 'A00W', u1 )
    call ForGroupBJ( udg_B33D_G[i], function Trig_B33_RFunc007A )
    // -------------
    call YDWEPolledWaitNull(4.00)
    // -------------
    call UnitRemoveAbilityBJ( 'A00W', u1 )
    call ForGroupBJ( udg_B33D_G[i], function Trig_B33_RFunc012A )
    // -------------
    set u1 = null
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B33_R takes nothing returns nothing
    set gg_trg_B33_R = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_R, Condition(function Trig_B33_RConditions))
    call TriggerAddAction(gg_trg_B33_R, function Trig_B33_RActions)
endfunction
//===========================================================================
// Trigger: B33 R_STOP
//===========================================================================
function Trig_B33_R_STOPConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0H6'))
endfunction
function Trig_B33_R_STOPFunc007A takes nothing returns nothing
    call UnitRemoveAbilityBJ( 'A00W', GetEnumUnit() )
endfunction
function Trig_B33_R_STOPActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    // -------------
    call DestroyEffect( udg_B33R_E[i] )
    // -------------
    call UnitRemoveAbilityBJ( 'A00W', u1 )
    call ForGroupBJ( udg_B33D_G[i], function Trig_B33_R_STOPFunc007A )
    // -------------
    set u1 = null
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B33_R_STOP takes nothing returns nothing
    set gg_trg_B33_R_STOP = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_R_STOP, Condition(function Trig_B33_R_STOPConditions))
    call TriggerAddAction(gg_trg_B33_R_STOP, function Trig_B33_R_STOPActions)
endfunction
//===========================================================================
// Trigger: B33 T start
//===========================================================================
function Trig_B33_T_startConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0LP'))
endfunction
function Trig_B33_T_startFunc005A takes nothing returns nothing
    call UnitAddAbilityBJ( 'A0G6', GetEnumUnit() )
endfunction
function Trig_B33_T_startActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    // -------------
    set udg_B33T_E[i] = AddSpecialEffectTarget("Abilities\\Spells\\Orc\\Voodoo\\VoodooAura.mdl", u1, "origin")
    call ForGroupBJ( udg_B33D_G[i], function Trig_B33_T_startFunc005A )
    // -------------
    set u1 = null
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B33_T_start takes nothing returns nothing
    set gg_trg_B33_T_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_T_start, Condition(function Trig_B33_T_startConditions))
    call TriggerAddAction(gg_trg_B33_T_start, function Trig_B33_T_startActions)
endfunction
//===========================================================================
// Trigger: B33 T end
//===========================================================================
function Trig_B33_T_endConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0LP'))
endfunction
function Trig_B33_T_endFunc005A takes nothing returns nothing
    call UnitRemoveAbilityBJ( 'A0G6', GetEnumUnit() )
endfunction
function Trig_B33_T_endActions takes nothing returns nothing
    local group ydl_group
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    // -------------
    call DestroyEffect( udg_B33T_E[i] )
    call ForGroupBJ( udg_B33D_G[i], function Trig_B33_T_endFunc005A )
    // -------------
    set u1 = null
    set ydl_group = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B33_T_end takes nothing returns nothing
    set gg_trg_B33_T_end = CreateTrigger()
    call TriggerAddCondition(gg_trg_B33_T_end, Condition(function Trig_B33_T_endConditions))
    call TriggerAddAction(gg_trg_B33_T_end, function Trig_B33_T_endActions)
endfunction
//===========================================================================
// Trigger: B34
//===========================================================================
function Trig_B34Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B34W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B34E_cast, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B34E_stop, udg_A_common_HERO, EVENT_UNIT_SPELL_ENDCAST)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B34T_damage, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    set udg_B34E_timer[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateTimer()
endfunction
//===========================================================================
function InitTrig_B34 takes nothing returns nothing
    set gg_trg_B34 = CreateTrigger()
    call TriggerAddAction(gg_trg_B34, function Trig_B34Actions)
endfunction
//===========================================================================
// Trigger: B34W
//
// call YDTriggerClearTable(YDTriggerH2I(GetExpiredTimer()))
//         call DestroyTimer(GetExpiredTimer())
//===========================================================================
globals
unit array B34W_U
real array udg_B34W_R
endglobals
function Trig_B34WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A033' ) )
endfunction
function Trig_B34W_timer_Func001Func001Func006003001 takes nothing returns boolean
return(IsUnitInvisible(GetTriggerUnit(),GetFilterPlayer())==true)
endfunction
function Trig_B34WFunc008T takes nothing returns nothing
    local integer i= LoadInteger(YDHT, GetHandleId(GetExpiredTimer()), 0xA1614B4D)
    local unit u2= B34W_U[i]
    local real dmg 
    set udg_B34_I[i]=( udg_B34_I[i] + 1 )
    set dmg = udg_B34_I[i]*udg_B34W_R[i]
	        if GetUnitState(u2, UNIT_STATE_LIFE) <= 0 or udg_B34_I[i] >= udg_B34_I2[i] then
	            call DestroyEffect(udg_B34W_E[i])
	            call FlushChildHashtable(YDHT,GetHandleId(GetExpiredTimer()))
	            call DestroyTimer(GetExpiredTimer())
	        else
	            call UnitDamageTargetBJ(udg_S01_hero_of_player[i], u2, dmg, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNIVERSAL)
	            call CreateTextTagUnitBJ( I2S(R2I(dmg) ), u2, 0, 8.00, 25.00, 60.00, 100.00, 0)
	            call SetTextTagVelocityBJ(GetLastCreatedTextTag(),64,90)
            	call SetTextTagPermanent(GetLastCreatedTextTag(), false)
	            call SetTextTagLifespan(GetLastCreatedTextTag(), 3.00)
	            call SetTextTagFadepoint(GetLastCreatedTextTag(), 2.00)
	            call ShowTextTagForceBJ(false,GetLastCreatedTextTag(),YDWEGetPlayersMatchingNull(Condition(function Trig_B34W_timer_Func001Func001Func006003001)))
	        endif
    set u2=null
endfunction
function Trig_B34W_castActions takes nothing returns nothing
    local integer i = LoadInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xA1614B4D)
	    if ((udg_B34_I2[i] >= 13)) then
	        set udg_B34_I2[i] = 13
	    else
	        set udg_B34_I2[i] = ( udg_B34_I2[i] + 1 )
	    endif
endfunction
function Trig_B34WActions takes nothing returns nothing
    local unit u1=GetTriggerUnit() 
	local unit u2=GetSpellTargetUnit()
    local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
    local timer t= CreateTimer()
    local integer h2i = GetHandleId(t)
    local trigger ltt
    //timer
    set udg_B34_I[i]=0
    set udg_B34_I2[i]=8
    set udg_B34W_R[i]=( ( 5.00 + ( 5.00 * I2R(GetUnitAbilityLevel(u1, 'A033')) ) ) )
    set udg_B34W_E[i]=AddSpecialEffectTarget("Abilities\\Spells\\Items\\ScrollOfRejuvenation\\ScrollManaHealth.mdl", GetSpellTargetUnit(), "chest")
    set B34W_U[i]=GetSpellTargetUnit()
	    call SaveInteger(YDHT, h2i, 0xA1614B4D, i)
	    call TimerStart(t, 1.00, true, function Trig_B34WFunc008T)
	//trigger    
    set ltt = CreateTrigger()
    set h2i = GetHandleId(ltt)
	    call SaveInteger(YDHT, h2i, 0xA1614B4D, i)
	    call TriggerAddCondition(ltt, function Trig_B34W_castActions)
	    call TriggerRegisterUnitEvent(ltt,u2,EVENT_UNIT_SPELL_EFFECT) 
	call YDWEPolledWaitNull(13.00)
	call DestroyTrigger(ltt) 
	call FlushChildHashtable(YDHT, h2i) 
    set t=null
    set u1=null
    set ltt = null
endfunction
//===========================================================================
function InitTrig_B34W takes nothing returns nothing
    set gg_trg_B34W=CreateTrigger()
    call TriggerAddCondition(gg_trg_B34W, Condition(function Trig_B34WConditions))
    call TriggerAddAction(gg_trg_B34W, function Trig_B34WActions)
endfunction//===========================================================================
// Trigger: B34E cast
//
// set udg_B34E_B[i] = true
//     set udg_B34E_target[i] = GetSpellTargetUnit()
//===========================================================================
globals
real array udg_B34E_DMG
endglobals	
function Trig_B34E_castConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A00U' ) )
endfunction
function Trig_B34E_castFunc006T takes nothing returns nothing
local unit ydl_unit
local timer t= GetExpiredTimer()
local integer h2i= GetHandleId(t)
local integer i= LoadInteger(YDHT, h2i, 0xA1614B4D)
local unit u1 = udg_S01_hero_of_player[i]
local unit u2= udg_B34E_target[i]
local player p = GetOwningPlayer(u1)
    call DestroyEffect(AddSpecialEffectTarget("Units\\NightElf\\Wisp\\WispExplode.mdl", u2, "origin"))
    call GroupEnumUnitsInRange(udg_Group[7], GetUnitX(u2), GetUnitY(u2), 350.00, null)
	    loop
	        set ydl_unit=FirstOfGroup(udg_Group[7])
	        exitwhen ydl_unit == null
	        call GroupRemoveUnit(udg_Group[7], ydl_unit)
		        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false then
		            call UnitDamageTargetBJ(u1, ydl_unit, udg_B34E_DMG[i], ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC)
		        endif
	    endloop
    set p = null
    set u1=null
    set u2=null
    set t=null
    set ydl_unit=null
endfunction
function Trig_B34E_castActions takes nothing returns nothing
local unit u1= GetTriggerUnit()	
local unit u2 = GetSpellTargetUnit()
local integer h2i
local integer i
////////////////////////////////////////////////////////////////
//Attention: timer start -> wait time ->check omamori
////////////////////////////////////////////////////////////////
		set i= GetConvertedPlayerId(GetOwningPlayer(u1))
		set h2i= GetHandleId(udg_B34E_timer[i])
	    set udg_B34E_target[i]=u2
	    set udg_B34E_DMG[i]=(55.00+GetUnitState(u1,UNIT_STATE_MAX_MANA)*(0.01+(0.03*I2R(GetUnitAbilityLevel(u1,'A00U')))))
	    call SaveInteger(YDHT, h2i, 0xA1614B4D, i)
	    //開始計時
	    call PauseTimer(udg_B34E_timer[i])
	    call TimerStart(udg_B34E_timer[i], 0.50, true, function Trig_B34E_castFunc006T)
	call TriggerSleepAction(0.00)
		if udg_omamori_Check[GetConvertedPlayerId(GetOwningPlayer(u2))]==true then
			call PauseTimer(udg_B34E_timer[i])
			call IssueImmediateOrder(u1,"stop")
		endif
set u1=null
set u2 = null
endfunction
//===========================================================================
function InitTrig_B34E_cast takes nothing returns nothing
    set gg_trg_B34E_cast=CreateTrigger()
    call TriggerAddCondition(gg_trg_B34E_cast, Condition(function Trig_B34E_castConditions))
    call TriggerAddAction(gg_trg_B34E_cast, function Trig_B34E_castActions)
endfunction//===========================================================================
// Trigger: B34E stop
//===========================================================================
function Trig_B34E_stopConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A00U' ) )
endfunction
function Trig_B34E_stopActions takes nothing returns nothing
local integer i = GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))
    call FlushChildHashtable(YDHT, GetHandleId(udg_B34E_timer[i]))
    call PauseTimer(udg_B34E_timer[i])
endfunction
//===========================================================================
function InitTrig_B34E_stop takes nothing returns nothing
    set gg_trg_B34E_stop=CreateTrigger()
    call TriggerAddCondition(gg_trg_B34E_stop, Condition(function Trig_B34E_stopConditions))
    call TriggerAddAction(gg_trg_B34E_stop, function Trig_B34E_stopActions)
endfunction//===========================================================================
// Trigger: B34T damage
//
// local trigger tr=GetTriggeringTrigger()
//     local unit u1=GetTriggerUnit()
//     local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
//     local timer ydl_timer = CreateTimer()
//===========================================================================
function Trig_B34T_damageConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0HU' ) )
endfunction
function Trig_B34T_damageActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local real x1
    local real y1
    local real x2 = GetSpellTargetX()
    local real y2 = GetSpellTargetY()
    local integer i= 1
    local player p = GetOwningPlayer(u1)
    local real dmg = ( 250.00 + ( 150.00 * I2R(GetUnitAbilityLevel(u1, 'A0HU')) ) )
        loop
            exitwhen i > 45
                set x1=( x2 + 900.00 * Cos(( 8.00 * ( I2R(i) ) ) * bj_DEGTORAD) )
      		    set y1=( y2 + 900.00 * Sin(( 8.00 * ( I2R(i) ) ) * bj_DEGTORAD) )
                call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\DarkRitual\\DarkRitualTarget.mdl", x1, y1))
          		set i=i + 1
        endloop
            call GroupEnumUnitsInRange(udg_Group[7], x2, y2, 925.00, null)
        loop
            set ydl_unit=FirstOfGroup(udg_Group[7])
            exitwhen ydl_unit == null
                call GroupRemoveUnit(udg_Group[7], ydl_unit)
		            if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false then
		                call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DarkRitual\\DarkRitualTarget.mdl", ydl_unit, "origin"))
		                call UnitDamageTargetBJ(u1, ydl_unit, dmg, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC)
		                call SetUnitManaBJ(ydl_unit,(GetUnitState(ydl_unit,UNIT_STATE_MANA)*0.40))
		            endif
        endloop
    set ydl_unit=null
    set u1=null
    set p = null
endfunction
//===========================================================================
function InitTrig_B34T_damage takes nothing returns nothing
    set gg_trg_B34T_damage=CreateTrigger()
    call TriggerAddCondition(gg_trg_B34T_damage, Condition(function Trig_B34T_damageConditions))
    call TriggerAddAction(gg_trg_B34T_damage, function Trig_B34T_damageActions)
endfunction//===========================================================================
// Trigger: B35
//===========================================================================
function Trig_B35Actions takes nothing returns nothing
local	player	p	= GetOwningPlayer(udg_A_common_HERO)
    call TriggerRegisterUnitEvent(gg_trg_B35W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B35E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B35R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B35T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    //禁止"救援"技能
	call SetPlayerAbilityAvailable( p, 'A0OD', false )
set p	=	null	
endfunction
//===========================================================================
function InitTrig_B35 takes nothing returns nothing
    set gg_trg_B35 = CreateTrigger()
    call TriggerAddAction(gg_trg_B35, function Trig_B35Actions)
endfunction//===========================================================================
// Trigger: B35W
//
// // 信長之野望-anti mpahack deprotected by 螺絲 綿羊
// // Objects used:
// // 'A0JM' = B35W
//===========================================================================
function Trig_B35WActions2 takes nothing returns nothing
	local timer t =	GetExpiredTimer()
	local integer	h2i =	GetHandleId(t)
    local unit u =	LoadUnitHandle(YDHT,h2i,1)
    local real x = LoadReal(YDHT,h2i,2)
    local real y = LoadReal(YDHT,h2i,3)
    local player p = GetOwningPlayer(u)
    local integer	id =	GetPlayerId(p)	+	1
    local real dmg = ( 100.00 + ( 100.00 * I2R(GetUnitAbilityLevel(u, 'A0JM')) ) ) 
	local real angle =	GetUnitFacing(u) 
    local real x1
    local real y1
    local integer i
    local real x2 =	GetUnitX(gg_unit_nfoh_0022)
    local real y2 =	GetUnitY(gg_unit_nfoh_0022)
    local real x3 =	GetUnitX(gg_unit_nfoh_0366)
    local real y3 =	GetUnitY(gg_unit_nfoh_0366)
	
	local real caster_x	=	GetUnitX(u)
	local real caster_y	=	GetUnitY(u)
	local real dt =	138.00
	local real dt_x 
	local real dt_y 
	local real check_dt1	
	local real check_dt2
	local unit ydl_unit
	
	local boolean	b =	false
		//最好清除一開始就清，這樣不會忘記。
		call FlushChildHashtable(YDHT,h2i)
		call DestroyTimer(t)
		//禁止"救援"技能
		call SetPlayerAbilityAvailable( p, 'A0OD', false )
		//避免兩個W位移
		if	udg_B35W_B[id]	==	false then	
			//確定是不是在溫泉的範圍內
			set dt_x =	caster_x	-	x2
			set dt_y =	caster_y	-	y2
			set check_dt1	=	SquareRoot(Pow(dt_x,2)+Pow(dt_y,2))
			//call		BJDebugMsg(R2S(check_dt1))
			set dt_x =	caster_x	-	x3
			set dt_y =	caster_y	-	y3
			set check_dt2	=	SquareRoot(Pow(dt_x,2)+Pow(dt_y,2))
			//call		BJDebugMsg(R2S(check_dt2))
			set b =	(check_dt1	>	800.00)	and (check_dt2	>	800.00)
			
			//光環特效
		    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\OrbOfDeath\\OrbOfDeathMissile.mdl",x,y))
	    	//環繞特效
		    set i = 1
		    loop
		        exitwhen i > 16
		   			set x1 = ( x + 225.00 * Cos((22.50*(I2R(i)))* bj_DEGTORAD))
		    		set y1 = ( y + 225.00 * Sin((22.50*(I2R(i)))* bj_DEGTORAD))
		   			 call DestroyEffect( AddSpecialEffect("Doodads\\Cinematic\\GlowingRunes\\GlowingRunes7.mdl", x1, y1) )
		        set i = i + 1
		    endloop
			//取得英雄正前方的座標
			set x1 =	caster_x	+	dt	*	Cos(	angle	* bj_DEGTORAD	)
			set y1 =	caster_y	+	dt	*	Sin(	angle	* bj_DEGTORAD	)	
			
	  		  	call GroupEnumUnitsInRange(udg_Group[4], x, y, 230.00, null)
	  			loop
	  				set ydl_unit = FirstOfGroup(udg_Group[4])
	  				exitwhen ydl_unit == null
	   				call GroupRemoveUnit(udg_Group[4], ydl_unit)
						if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and GetUnitPointValue(ydl_unit) != 1 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false and IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false then
							if GetOwningPlayer(ydl_unit) != Player(PLAYER_NEUTRAL_AGGRESSIVE) and	b	then
								call SetUnitPosition(ydl_unit,x1,y1)
									//如果是英雄單位 才移轉玩家畫面到指定點
									if	IsUnitType(ydl_unit,UNIT_TYPE_HERO) then	
									    if (GetLocalPlayer() == GetOwningPlayer(ydl_unit)) then
									        // Use only local code (no net traffic) within this block to avoid desyncs.
									        call PanCameraToTimed(	x1	,	y1	, 0	)
									    endif
									endif
	    					endif
	    					//傷害
	    					if IsUnitEnemy(ydl_unit, p) then
	        					call UnitDamageTarget(u, ydl_unit, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
	    					endif 
											
						endif 
	    		endloop 
		endif
		
		//避免BUG
		set	udg_B35W_B[id]	=	false
		
    set ydl_unit = null
    set u = null
	set t =	null
    set p = null
endfunction
function Trig_B35WActions takes nothing returns nothing
    local unit u =	GetTriggerUnit()
    local player	p =	GetTriggerPlayer()
    local integer	id =	GetPlayerId(p)	+	1
    local real x = GetSpellTargetX()
    local real y = GetSpellTargetY() 
    local real dmg = ( 100.00 + ( 100.00 * I2R(GetUnitAbilityLevel(u, 'A0JM')) ) ) 
    //============FOR TIMER====================
	local real time =	1.90
	local timer t = CreateTimer()
	local integer h2i =	GetHandleId(t)
	//=========================================
    local unit ydl_unit	=	null	
    	//准許"救援"技能
		call SetPlayerAbilityAvailable( p, 'A0OD', true )
    	//SAVE FILE
		call SaveUnitHandle(YDHT,h2i,1,u)
		call SaveReal(YDHT,h2i,2,x)
		call SaveReal(YDHT,h2i,3,y)
		call TimerStart(t,time,false,function Trig_B35WActions2 )
		//Save Spell's Location For Alliance's move
		set udg_B35W_X[id]	=	x
		set udg_B35W_Y[id]	=	y	
    	//EFFECT
    	call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Other\\BlackArrow\\BlackArrowMissile.mdl", x, y) )
    set p = null
    set u = null
	set t = null
endfunction
//===========================================================================
// Move alliance unit to hero's location
//
function Trig_B35WActions2432432 takes nothing returns nothing
local	unit	u =	GetTriggerUnit()
local	player	p =	GetTriggerPlayer()
local	integer	id =	GetPlayerId(p)	+	1 
local real	x =	GetUnitX(u)
local	real	y =	GetUnitY(u)
local	real	sx =	udg_B35W_X[id]
local	real	sy =	udg_B35W_Y[id] 
local real angle =	GetUnitFacing(u)
local real dt =	138.00
local unit ydl_unit	=	null
local integer	i	
local	real	tx
local	real	ty	
		//禁止"救援"技能
		call SetPlayerAbilityAvailable( p, 'A0OD', false )
		//避免兩個W位移
		set	udg_B35W_B[id]	=	true
		//光環特效
	    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\OrbOfDeath\\OrbOfDeathMissile.mdl",sx,sy))
    	//環繞特效
	    set i = 1
	    loop
	        exitwhen i > 16
	   			set tx = ( sx + 50.00 * Cos((22.50*(I2R(i)))* bj_DEGTORAD))
	    		set ty = ( sy + 50.00 * Sin((22.50*(I2R(i)))* bj_DEGTORAD))
	   			call DestroyEffect( AddSpecialEffect("Doodads\\Cinematic\\GlowingRunes\\GlowingRunes7.mdl", tx, ty) )
	        set i = i + 1
	    endloop
	    //SET The (x,y) behind hero's location 
		set tx =	x	+	dt	*	Cos(	angle	* bj_DEGTORAD	)
		set ty =	y	+	dt	*	Sin(	angle	* bj_DEGTORAD	)
			
	    //Move
	    call GroupEnumUnitsInRange(udg_Group[4], sx, sy, 50.00, null)
  			loop
  				set ydl_unit = FirstOfGroup(udg_Group[4])
  				exitwhen ydl_unit == null
   				call GroupRemoveUnit(udg_Group[4], ydl_unit)
					if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and GetUnitPointValue(ydl_unit) != 1 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false and IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false and IsUnitAlly(ydl_unit, p) then
						if GetOwningPlayer(ydl_unit) != Player(PLAYER_NEUTRAL_AGGRESSIVE) then
							//MOVE TO HERO's Location
							call SetUnitPosition(ydl_unit,tx,ty)
								//如果是英雄單位 才移轉玩家畫面到指定點
								if	IsUnitType(ydl_unit,UNIT_TYPE_HERO) then	
								    if (GetLocalPlayer() == GetOwningPlayer(ydl_unit)) then
								        // Use only local code (no net traffic) within this block to avoid desyncs.
								        call PanCameraToTimed(	tx	,	ty	, 0	)
								    endif
								endif
    					endif
    				endif	
    		endloop
set u =	null
set p =	null
set ydl_unit	=	null
endfunction
function Trig_B35WConditions takes nothing returns boolean
local integer id = GetSpellAbilityId()
    if id == 'A0JM'	then
	    call Trig_B35WActions()
	elseif id	==	'A0OD' then
		call Trig_B35WActions2432432() 
    endif
    return false
endfunction
function InitTrig_B35W takes nothing returns nothing
    set gg_trg_B35W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B35W, Condition(function Trig_B35WConditions))
endfunction
globals
real array udg_B35W_X
real array udg_B35W_Y	
boolean array udg_B35W_B
endglobals//===========================================================================
// Trigger: B35E
//===========================================================================
function Trig_B35Eadditions takes nothing returns nothing
    local unit u1 =	GetTriggerUnit()
    local real x =	GetUnitX(u1)
    local real y =	GetUnitY(u1)
    local real heal = (	100.00 * I2R(	GetUnitAbilityLevel(u1, 'A0K2') ) )
    local player p = GetOwningPlayer(u1)
    local real x1
    local real y1
    local integer i
    local unit ydl_unit 
    
    	//////////////////
    	// effect
    	//////////////////
		call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\BlackArrow\\BlackArrowMissile.mdl", x, y))
			set i=1
			loop
    			exitwhen i > 45
					set x1= x + 500.00 * Cos( 8.00 * I2R(i) * bj_DEGTORAD )
					set y1= y + 500.00 * Sin( 8.00 * I2R(i) * bj_DEGTORAD )
					call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\DeathandDecay\\DeathandDecayTarget.mdl", x1, y1))
    			set i = i + 1
			endloop
		//////////////////
		// recover hp
		//////////////////	
		call GroupEnumUnitsInRange(udg_Group[4], x, y, 500.00, null)
		loop
			set ydl_unit=FirstOfGroup(udg_Group[4])
			exitwhen ydl_unit == null
			call GroupRemoveUnit(udg_Group[4], ydl_unit)
			 
				if IsUnitAlly(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true then
					call SetUnitState(ydl_unit, UNIT_STATE_LIFE, GetUnitState(ydl_unit, UNIT_STATE_LIFE) + heal )
				endif
				
		endloop
		//call	BJDebugMsg(R2S(heal))
		
    set ydl_unit	=	null
    set u1 =	null
    set p = null
endfunction
function Trig_B35EConditions takes nothing returns boolean
	if GetSpellAbilityId() == 'A0K2'	then
		call Trig_B35Eadditions()
	endif 
	return	false
endfunction
function InitTrig_B35E takes nothing returns nothing
    set gg_trg_B35E=CreateTrigger()
    call TriggerAddCondition(gg_trg_B35E, Condition(function Trig_B35EConditions))
endfunction//===========================================================================
// Trigger: B35R learn 
//===========================================================================
function Trig_B35R_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0LH' and GetUnitAbilityLevel(GetTriggerUnit(), 'A0LH') == 1 and IsUnitIllusion(GetTriggerUnit()) != true then
    	call TriggerRegisterUnitEvent(gg_trg_B35R_attack, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
    endif
    return false	
endfunction
function InitTrig_B35R_learn takes nothing returns nothing
    set gg_trg_B35R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B35R_learn, Condition(function Trig_B35R_learnConditions))
endfunction//===========================================================================
// Trigger: B35R attack
//===========================================================================
function Trig_B35R_attack_startFunc003Conditions takes nothing returns nothing
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local real dmg = I2R(GetHeroInt(u1, true)) * 0.01 * ( 10.00 + ( 25.00 * I2R(GetUnitAbilityLevel(u1, 'A0LH')) ) ) 
		//Avoid crash
		////////////////////////////////
		//會不會 剛清完 就被使用h2i?
		//因為這時候 都刪除 ltt 的HANDLE了
		////////////////////////////////
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)
		set udg_B12R_B[i]=false
		//////////////
		//傷害
		//////////////
	    call UnitDamageTarget(u1, u2, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)
		//call BJDebugMsg(R2S(dmg))
	    
	set ltt = null
	set u1 = null
    set u2 = null
endfunction
function Trig_B35R_attack_startConditions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit() 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local trigger ltt
    local integer h2i
    local triggercondition ltc
    
    	if udg_B12R_B[i]==false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false then
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
	    		///////////
	    		//參數設定
	    		//////////
		    	set udg_B12R_B[i]=true
		    	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    	set ltc = TriggerAddCondition(ltt, Condition(function Trig_B35R_attack_startFunc003Conditions))
			    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
		    	/////////////////////////////////////////////////////////////
			    //timer check + 觸發器登記
			    /////////////////////////////////////////////////////////////
			    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
			    call Normal_Attack_Timer_for_Trigger(ltt,0.40 , ltc , i)
		endif 
		
    set ltt = null
    set ltc = null
    set u1 = null
    set u2 = null
endfunction
function InitTrig_B35R_attack takes nothing returns nothing
    set gg_trg_B35R_attack=CreateTrigger()
    call TriggerAddCondition(gg_trg_B35R_attack, Condition(function Trig_B35R_attack_startConditions))
endfunction//===========================================================================
// Trigger: B35T 
//===========================================================================
function Trig_B35TActions2 takes nothing returns nothing
	local timer t =	GetExpiredTimer()
	local integer	h2i =	GetHandleId(t)
	local unit u =	LoadUnitHandle(YDHT,h2i,1)
		call FlushChildHashtable(YDHT,h2i)
		call DestroyTimer(t)
	
		call UnitRemoveAbility(u, 'A0KG')
	set t =	null
	set u =	null
endfunction
function Trig_B35TActions takes nothing returns nothing
    local unit u = GetTriggerUnit()
    local integer level	= GetUnitAbilityLevel(u, 'A0KD') 
	local timer t =	CreateTimer()
	local integer	h2i =	GetHandleId(t)
	local real time	=	(	4.00 + 6.00 * I2R(level)	)
	
		call	SaveUnitHandle(YDHT,h2i,1,u)
		call	TimerStart(t,time,false,function Trig_B35TActions2 )
		//call	BJDebugMsg(R2S(time))
		
    	//英雄得到 +400% 攻速技能
        call UnitAddAbility(u, 'A0KG')
        call SetUnitAbilityLevel(u, 'A0KG', level)
	set t =	null
    set u =	null
endfunction
function Trig_B35TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0KD'	then
	    call Trig_B35TActions()
	endif
	return	false 
endfunction
function InitTrig_B35T takes nothing returns nothing
    set gg_trg_B35T=CreateTrigger()
    call TriggerAddCondition(gg_trg_B35T, Condition(function Trig_B35TConditions))
endfunction//===========================================================================
// Trigger: B36
//===========================================================================
function Trig_B36Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B36_W_start, udg_A_common_HERO, EVENT_UNIT_SUMMON)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B36E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B36R_effect, udg_A_common_HERO, EVENT_UNIT_ATTACKED)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B36T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
endfunction
//===========================================================================
function InitTrig_B36 takes nothing returns nothing
    set gg_trg_B36 = CreateTrigger()
    call TriggerAddAction(gg_trg_B36, function Trig_B36Actions)
endfunction
//===========================================================================
// Trigger: B36 W start
//
//     call YDTriggerClearTable(YDTriggerH2I(GetExpiredTimer()))
//     call DestroyTimer(GetExpiredTimer())
//===========================================================================
globals
integer array B36W_I
group array B36W_G
endglobals
function Trig_B36_W_startFunc002T takes nothing returns nothing
local unit ydl_unit	
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local player p = GetOwningPlayer(u1)
local integer i= GetPlayerId(p) + 1
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
	if B36W_I[i] <= 0 or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 then
		call KillUnit(u1)
    	call FlushChildHashtable(YDHT, h2i)
    	call DestroyTimer(t)
	else 
	
    	call GroupEnumUnitsInRange(udg_Group[4], x, y, 400.00, null)
    	loop
       		set ydl_unit=FirstOfGroup(udg_Group[4])
        	exitwhen ydl_unit == null
        	call GroupRemoveUnit(udg_Group[4], ydl_unit)
        		if IsUnitType(ydl_unit,UNIT_TYPE_HERO) and IsUnitInGroup(ydl_unit, B36W_G[i]) != true and IsUnitEnemy(ydl_unit, p) and GetUnitPointValue(ydl_unit) != 1 and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_MAGIC_IMMUNE) != true then
            		call GroupAddUnit(B36W_G[i], ydl_unit) 
            		set udg_KnockBack_Angle=bj_RADTODEG * Atan2(GetUnitY(ydl_unit) - y, GetUnitX(ydl_unit) - x)
            		set udg_KnockBack_Boolean1=false
            		set udg_KnockBack_Dist=20.00
            		set udg_KnockBack_Rate=0.95
            		set udg_KnockBack_Time=1.50
            		set udg_KnockBack_Unit=ydl_unit 
            		set udg_KnockBack_Interval=( 0.15 / 10.00 )
            		set udg_KnockBack_Trigger=gg_trg_B36W_end
            		set udg_KnockBack_I2=i
            		call TriggerExecute(gg_trg_KnockBack) 
            		set B36W_I[i]=B36W_I[i]-1
            		call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl", ydl_unit, "overhead"))
            		call UnitDamageTarget(u1, ydl_unit, 100.00, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS) 
        		endif
    	endloop
    	
    endif 
    
set t=null
set u1=null
set ydl_unit=null
set p = null
endfunction
function Trig_B36W_First_Time takes nothing returns nothing
	call Trig_B36_W_startFunc002T()
	call TimerStart(GetExpiredTimer(), 0.30, true, function Trig_B36_W_startFunc002T)
endfunction
function Trig_B36_W_startActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local integer i= GetPlayerId(GetOwningPlayer(u1)) + 1
	call DestroyGroup(B36W_G[i])
	//基本設定	
	set B36W_G[i]=CreateGroup()
	set B36W_I[i] = 4 + 2 * GetUnitAbilityLevel(u1, 'A0JC') 
	call SaveUnitHandle(YDHT, h2i, 1, GetSummonedUnit())
	//很重要 因為原版是用中心計時器 馬上放 就會馬上彈
	call TimerStart(t, 0.00, false, function Trig_B36W_First_Time)
  
 
set t=null
set u1=null
endfunction
function Trig_B36_W_startConditions takes nothing returns boolean
    if GetUnitTypeId(GetSummonedUnit()) == 'osp2' then
	    call Trig_B36_W_startActions()
    endif
    return false
endfunction
function InitTrig_B36_W_start takes nothing returns nothing
    set gg_trg_B36_W_start=CreateTrigger()
    call TriggerAddCondition(gg_trg_B36_W_start, Condition(function Trig_B36_W_startConditions))
endfunction//===========================================================================
// Trigger: B36W end
//===========================================================================
function Trig_B36W_endActions takes nothing returns nothing
    call GroupRemoveUnit(B36W_G[udg_KnockBack_I2],udg_KnockBack_Unit) 
endfunction
//===========================================================================
function InitTrig_B36W_end takes nothing returns nothing
    set gg_trg_B36W_end = CreateTrigger()
    call TriggerAddAction(gg_trg_B36W_end, function Trig_B36W_endActions)
endfunction//===========================================================================
// Trigger: B36E
//===========================================================================
globals
integer array B36E_I
group array B36E_G
endglobals
function Trig_B36EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0JD' ) )
endfunction
function Trig_B36EFunc009Func002Func003A takes nothing returns nothing
    call IssueTargetOrder(GetEnumUnit(), "attack", udg_A_common_HERO)
    call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\QuillSprayMissile\\QuillSprayMissile.mdl", GetEnumUnit(), "overhead"))
endfunction
function Trig_B36EFunc009T takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
	local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
	set udg_A_common_HERO = u1
		if(B36E_I[i]<=0)then
			call FlushChildHashtable(YDHT, h2i)
	        call DestroyTimer(t)
		else
			set B36E_I[i]=(B36E_I[i]-1)
			call ForGroup(B36E_G[i],function Trig_B36EFunc009Func002Func003A)
		endif
	set u1 = null
	set t=null
endfunction
function Trig_B36EActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local player p = GetOwningPlayer(u1)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
local unit ydl_unit
	call UnitAddAbility(u1, 'A05X')
	call SetUnitAbilityLevel(u1, 'A05X', GetUnitAbilityLevel(u1, 'A0JD'))
		call DestroyGroup(B36E_G[i])
		set B36E_G[i] = CreateGroup()
			call GroupEnumUnitsInRange(udg_Group[4], GetSpellTargetX(), GetSpellTargetY(), 290.00, null)
				loop
			    	set ydl_unit=FirstOfGroup(udg_Group[4])
			        exitwhen ydl_unit == null
			        call GroupRemoveUnit(udg_Group[4], ydl_unit)
			        	if ( IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and ( GetUnitPointValue(ydl_unit) != 1 ) and ( IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false ) and ( IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false ) ) then
			            	call GroupAddUnit(B36E_G[i],ydl_unit)
			        	endif
			    endloop
    	set B36E_I[i]=( 6 + ( 6 * GetUnitAbilityLevel(u1, 'A0JD') ) )
    	call SaveUnitHandle(YDHT, h2i, 1, u1)
    	call TimerStart(t, 0.10, true, function Trig_B36EFunc009T)
    		call YDWEPolledWaitNull(10.00)
	call UnitRemoveAbility(u1, 'A05X')
	set p = null
    set ydl_unit=null
    set t=null
    set u1=null
endfunction
//===========================================================================
function InitTrig_B36E takes nothing returns nothing
    set gg_trg_B36E=CreateTrigger()
    call TriggerAddCondition(gg_trg_B36E, Condition(function Trig_B36EConditions))
    call TriggerAddAction(gg_trg_B36E, function Trig_B36EActions)
endfunction//===========================================================================
// Trigger: B36R effect
//
// Varibale u1 used without having been initialized
//===========================================================================
function Trig_B36R_effectConditions takes nothing returns boolean
    return GetRandomInt(1, 100) <= 18 and GetUnitAbilityLevel(GetTriggerUnit(),'A0JE' ) != 0 and udg_B36R_B[GetPlayerId(GetTriggerPlayer()) + 1] == false
endfunction
function Trig_B36R_effectActions takes nothing returns nothing
    local unit u1	=	GetTriggerUnit()
    local unit u2	=	GetAttacker()
    local player	p	=	GetOwningPlayer(u1)
    local unit u3
    local integer i = GetPlayerId(p) + 1
    
	    // ☆製造馬甲
	    set u3= CreateUnit(p, 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
	    call UnitApplyTimedLife( u3, 'BHwe', 4.00 )
	    call UnitAddAbility( u3, 'A0JF' )
	    call SetUnitAbilityLevel( u3, 'A0JF', GetUnitAbilityLevel(u1, 'A0JE') )
	    
	    // ☆馬甲:動作
	    call IssuePointOrder( u3, "clusterrockets", GetUnitX(u2), GetUnitY(u2) )
	    
	    // ☆觸發:時間控制
	    set udg_B36R_B[i] = true
	    call YDWEPolledWaitNull(0.30)
	    set udg_B36R_B[i] = false
	    
    set u1 = null
    set u2 = null
    set u3 = null
endfunction
//===========================================================================
function InitTrig_B36R_effect takes nothing returns nothing
    set gg_trg_B36R_effect = CreateTrigger()
    call TriggerAddCondition(gg_trg_B36R_effect, Condition(function Trig_B36R_effectConditions))
    call TriggerAddAction(gg_trg_B36R_effect, function Trig_B36R_effectActions)
endfunction//===========================================================================
// Trigger: B36T
//===========================================================================
function Trig_B36TActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local real x = GetUnitX(u1)
    local real y = GetUnitY(u1)
    local player p = GetOwningPlayer(u1)
    local real x1
    local real y1
    local real a
    local unit ydl_unit
    local integer i 
	// ☆禁錮英雄單位    
	local unit u3 = CreateUnit(p, 'h01E', x, y, 0)
	    call UnitAddAbility( u3, 'A0L9' )
	    call UnitApplyTimedLife( u3, 'BHwe', 2.00 )
	    
	    call GroupEnumUnitsInRange(udg_Group[4], x, y, 600.00, null)
	    	loop
	    		set ydl_unit = FirstOfGroup(udg_Group[4])
	    		exitwhen ydl_unit == null
	    		call GroupRemoveUnit(udg_Group[4], ydl_unit)
	    		
	    			if IsUnitType(ydl_unit, UNIT_TYPE_HERO) and IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 then
	    				call IssueTargetOrderById( u3, 852583, ydl_unit )
	    			endif
	    			
	    	endloop
	    	
		// ☆製造石圈
		set i = 1
			loop
				exitwhen i > 16
				//init
				set a	=	(	22.50	*	I2R(i)	)* bj_DEGTORAD
				set x1 = x + 420.00 * Cos(a)
				set y1 = y + 420.00 *	Sin(a)
				//effect
    			call DestroyEffect( AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl", x1, y1) )
				//create unit
				set u3= CreateUnit(p, 'hrtt', x1, y1, 0)
				call UnitApplyTimedLife( u3, 'BHwe', 4.00 )
				set i = i + 1
			endloop
	    			
    // ☆排泄
    set p = null
    set ydl_unit = null
    set u1 = null
    set u3 = null
endfunction
function Trig_B36TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0L8' then
	    call	Trig_B36TActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_B36T takes nothing returns nothing
    set gg_trg_B36T = CreateTrigger()
    call TriggerAddCondition(gg_trg_B36T, Condition(function Trig_B36TConditions))
endfunction//===========================================================================
// Trigger: B37
//===========================================================================
function Trig_B37Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_B37W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_B37W_move, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B37E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B37R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_B37R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_B37T_start, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    // -------------
    call SetPlayerAbilityAvailableBJ( false, 'A0RJ', GetOwningPlayer(udg_A_common_HERO) )
    call SetPlayerAbilityAvailableBJ( false, 'A0XW', GetOwningPlayer(udg_A_common_HERO) )
endfunction
//===========================================================================
function InitTrig_B37 takes nothing returns nothing
    set gg_trg_B37 = CreateTrigger()
    call TriggerAddAction(gg_trg_B37, function Trig_B37Actions)
endfunction
//===========================================================================
// Trigger: B37W
//
// GetSpellTargetX(), GetSpellTargetY()
//===========================================================================
function Trig_B37WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0O7'))
endfunction
function Trig_B37WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local player p = GetOwningPlayer(u1)
    local integer i = GetConvertedPlayerId(p)
    local real x = GetSpellTargetX()
    local real y = GetSpellTargetY() 
    local real dmg = ( 100.00 + ( 100.00 * I2R(GetUnitAbilityLevel(u1, 'A0O7')) ) )
    local unit u3 = CreateUnit(p, 'n00F', x, y, 0)
	    call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
	    call SetUnitAnimation(u3,"Birth") 
    	set udg_B37W_U[i] = u3
        if (IsTerrainPathable(x,y,PATHING_TYPE_WALKABILITY) != true )then 
			call SetPlayerAbilityAvailable(p,'A0XW',true) 
	    		call YDWEPolledWaitNull(1.00)
					set u3 = CreateUnit(p, 'h01E', x, y, 0)
					call UnitApplyTimedLife( u3, 'BHwe', 2.00 )
					call UnitAddAbility( u3, 'A0OC' )
		    		call GroupEnumUnitsInRange(udg_Group[7], x, y, 340.00, null)
		    			loop
		        			set ydl_unit = FirstOfGroup(udg_Group[7])
		       				exitwhen ydl_unit == null
		        			call GroupRemoveUnit(udg_Group[7], ydl_unit)
		        				if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true then
		            				call IssueTargetOrderById( u3, 852075, ydl_unit )
		            				call UnitDamageTargetBJ( u1, ydl_unit, dmg, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
		        				endif
		    			endloop
 				call YDWEPolledWaitNull(4.00)
		call SetPlayerAbilityAvailable(p,'A0XW',false)
		endif
	set p = null	
    set u1 = null
    set u3 = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_B37W takes nothing returns nothing
    set gg_trg_B37W = CreateTrigger()
    call TriggerAddCondition(gg_trg_B37W, Condition(function Trig_B37WConditions))
    call TriggerAddAction(gg_trg_B37W, function Trig_B37WActions)
endfunction//===========================================================================
// Trigger: B37W move
//
// GetSpellAbilityId() == 'A0OB'
//===========================================================================
function Trig_B37W_MoveConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0XW') and GetUnitState(udg_B37W_U[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))], UNIT_STATE_LIFE) > 0 )
endfunction
function Trig_B37W_MoveActions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    // ---------------------------------
    call SetUnitX(u1,GetUnitX(udg_B37W_U[i]))
    call SetUnitY(u1,GetUnitY(udg_B37W_U[i]))
    // ---------------------------------
    call SetPlayerAbilityAvailable(GetOwningPlayer(u1),'A0XW',false)
    // ---------------------------------
    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTarget.mdl", u1, "origin") )
    // ---------------------------------
    set u1 = null
endfunction
//===========================================================================
function InitTrig_B37W_move takes nothing returns nothing
    set gg_trg_B37W_move = CreateTrigger()
    call TriggerAddCondition(gg_trg_B37W_move, Condition(function Trig_B37W_MoveConditions))
    call TriggerAddAction(gg_trg_B37W_move, function Trig_B37W_MoveActions)
endfunction//===========================================================================
// Trigger: B37E
//===========================================================================
function Trig_B37E_resist_dmg takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
local integer h2i = GetHandleId(ltt)
local real r = GetEventDamage()
local unit u1 = GetTriggerUnit()
	if LoadReal(YDHT,h2i,1) < r or u1 == null then
		call SetUnitState(u1,UNIT_STATE_LIFE,GetUnitState(u1,UNIT_STATE_LIFE)+ LoadReal(YDHT,h2i,1) )
		///////////////////////////////////
		//排泄 TC + effect + trigger + Hash
		///////////////////////////////////
		call DestroyTimer( LoadTimerHandle(YDHT,h2i,33333) )
		call DestroyEffect(	LoadEffectHandle(YDHT,h2i,2)	)
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)	
	else
		if r > 0 then
		    call SetUnitState(u1,UNIT_STATE_LIFE,GetUnitState(u1,UNIT_STATE_LIFE)+ r )
		    call SaveReal(YDHT,h2i,1,LoadReal(YDHT,h2i,1)-r)
		    call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\WingedSerpentMissile\\WingedSerpentMissile.mdl",u1,"chest"))
		endif 
    endif
set ltt = null
set u1 = null
endfunction
function Trig_B37_shied takes trigger ltt , unit u , real r , effect e , integer h2i , triggercondition ltc , timer t returns nothing	
		//////////
		//參數設定
		//////////  
		/////////////////
		// shied & effect
		/////////////////	
		call SaveReal(YDHT,h2i,1,r) 
	    call SaveEffectHandle(YDHT,h2i,2,e)
        ////////
        //TC + timer
        ////////
        call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
        call TimerStart(t, 4.00, false, null)
	    call SaveTimerHandle(YDHT,h2i,33333,t)
		/////////////////////////////////////////////////////////////
	    //timer check + 觸發器登記
	    /////////////////////////////////////////////////////////////		
	    call TriggerRegisterUnitEvent(ltt,u,EVENT_UNIT_DAMAGED)
	    call TriggerRegisterTimerExpireEvent(ltt, t)
endfunction
//=====================================================
//				刪除B37防禦技能
//=====================================================
function Trig_B37_Remove_Ability takes nothing returns nothing	
local	timer	t	=	GetExpiredTimer()
local	integer	h2i	=	GetHandleId(t)
local	unit	u1	=	LoadUnitHandle(YDHT,h2i,1)
	//排泄
	call	FlushChildHashtable(YDHT,h2i)
	call	DestroyTimer(t)
	
	//刪除技能
	call	UnitRemoveAbility(u1,'A0XM')
	
set t	=	null
set u1	=	null
endfunction
//=====================================================
//				B37註冊動作
//=====================================================
function Trig_B37EActions takes nothing returns nothing	
	///////////
	//參數設定
	///////////
    local unit ydl_unit
    local unit u1 =	GetTriggerUnit()
    local integer i = 0
    local integer level =	GetUnitAbilityLevel(u1,'A0SF')
    local real r = 120.00 + 130.00*I2R(level) + GetUnitState(u1,UNIT_STATE_MAX_MANA)*0.23
    local trigger ltt = CreateTrigger()
    local integer h2i = GetHandleId(ltt)
    local triggercondition ltc 
    local timer t = CreateTimer()
    local effect e = AddSpecialEffectTarget("war3mapImported\\HeroKanetsuguNaoeShieldTarget.mdx",u1,"origin")
    ///////////////
    //給自己防盾
    ///////////////////////////////
    //沒有 TC = CreatTC 所以要這樣寫
    ///////////////////////////////
    set ltc = TriggerAddCondition(ltt, Condition(function Trig_B37E_resist_dmg))
    call Trig_B37_shied(ltt,u1,r,e,h2i,ltc,t)
    ///////////////
    //給隊友防盾
    /////////////// 
    	call GroupEnumUnitsInRange(udg_Group[7], GetUnitX(u1), GetUnitY(u1), 512, null)
    	loop
			set ydl_unit=FirstOfGroup(udg_Group[7])
        	exitwhen ydl_unit == null or i ==1
        	call GroupRemoveUnit(udg_Group[7], ydl_unit)
        		if IsUnitType(ydl_unit,UNIT_TYPE_HERO) and ydl_unit != u1 and GetUnitPointValue(ydl_unit) != 1 and IsUnitAlly(ydl_unit, GetOwningPlayer(u1)) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 then	
        			//////////
        			//參數設定
        			//////////        			
					set i = 1
					set t = CreateTimer()
					set ltt = CreateTrigger()
					set h2i = GetHandleId(ltt)
					set e = AddSpecialEffectTarget("war3mapImported\\HeroKanetsuguNaoeShieldTarget.mdx",ydl_unit,"origin")
					set ltc = TriggerAddCondition(ltt, Condition(function Trig_B37E_resist_dmg))
            		call Trig_B37_shied(ltt,ydl_unit,r,e,h2i,ltc,t)
                endif 
    	endloop
    	call GroupClear( udg_Group[7] )
		//如果沒有友軍英雄 自己增加防禦 2 4 6 8
		if	i==0	then
			set t = CreateTimer()
			set h2i = GetHandleId(t)
			call	UnitAddAbility(u1,'A0XM')
			call	SetUnitAbilityLevel(u1,'A0XM',level)
			call	SaveUnitHandle(YDHT,h2i,1,u1)
			call	TimerStart(t,6.00,false,function Trig_B37_Remove_Ability)
		endif
    	
	set ltt = null
	set u1 = null
	set ydl_unit = null 
	set ltc = null
	set t = null
endfunction
function Trig_B37EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0SF'	then
	    call	Trig_B37EActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_B37E takes nothing returns nothing
    set gg_trg_B37E=CreateTrigger()
    call TriggerAddCondition(gg_trg_B37E, Condition(function Trig_B37EConditions))
endfunction//===========================================================================
// Trigger: B37R learn
//===========================================================================
function Trig_B37R_LearnConditions takes nothing returns boolean
	if GetLearnedSkill() == 'A0OG' then
		call SetPlayerAbilityAvailable( GetOwningPlayer(GetTriggerUnit()) , 'A0RJ', true)
	    call SetUnitAbilityLevel( GetTriggerUnit(), 'A0RJ', GetUnitAbilityLevel(GetTriggerUnit(), 'A0OG') )
	endif
	return false
endfunction
function InitTrig_B37R_learn takes nothing returns nothing
    set gg_trg_B37R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_B37R_learn, Condition(function Trig_B37R_LearnConditions))
endfunction
//===========================================================================
// Trigger: B37R
//===========================================================================
globals
integer array B37R_I
unit array B37R_U
endglobals
function Trig_B37RConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0OG' 
endfunction
function Trig_B37RFunc008T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i= GetPlayerId(GetOwningPlayer(u1)) + 1
local unit u2 = B37R_U[i]
local real dmg
	//int for timer
	set B37R_I[i] = B37R_I[i] + 1
	//Height
	call SetUnitFlyHeight(u2, 486.00 - 1.50 * Pow( I2R(B37R_I[i]) - 18.00 , 2.00) , 0.00)
	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl",u2, "origin"))
		if B37R_I[i] >= 36 then
			//effect
			call SetUnitTimeScale(u2, 100.00 * 0.01)
		    call SetUnitPathing(u2, true)
		    //damage
		    set dmg = 0.16 * ( GetUnitState(u2,UNIT_STATE_MAX_LIFE)-GetUnitState(u2,UNIT_STATE_LIFE) )
		    call UnitDamageTarget(u1, u2,dmg, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS) 
		    //clean    		
		    call FlushChildHashtable(YDHT, GetHandleId(t))
		    call DestroyTimer(t)
		endif
set t=null
set u1=null
set u2=null
endfunction
function Trig_B37RActions takes nothing returns nothing
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	local unit u1 =GetTriggerUnit()
	local unit u2 =GetSpellTargetUnit()
	local integer i= GetPlayerId(GetOwningPlayer(u1)) + 1
	local real dmg = 3.00 * I2R(GetHeroInt(u1, true))
		////////////////////
		//effect
		////////////////////
	    call SetUnitPathing(u2, false)
	    call SetUnitTimeScale(u2, 40.00 * 0.01)
	    call SetUnitAnimation(u2, "attack slam") 
	    call UnitAddAbility(u2, 'Amrf')
	    call UnitRemoveAbility(u2, 'Amrf')
		//////////////////
		//damage
		/////////////////
	    call UnitDamageTarget(u1, u2,dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
	    ////////////
	    //參數設定
	    ////////////
	    call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl", u2, "origin"))
		call SaveUnitHandle(YDHT, h2i, 1, u1)
		set B37R_I[i]=0
		set B37R_U[i]=u2
	    call TimerStart(t, 0.07 / 2.00 , true, function Trig_B37RFunc008T) 
    set t=null
    set u1=null
    set u2=null
endfunction
function InitTrig_B37R takes nothing returns nothing
    set gg_trg_B37R=CreateTrigger()
    call TriggerAddCondition(gg_trg_B37R, Condition(function Trig_B37RConditions))
    call TriggerAddAction(gg_trg_B37R, function Trig_B37RActions)
endfunction//===========================================================================
// Trigger: B37T start
//===========================================================================
function Trig_B37T_startActionsFunc003Conditions takes nothing returns nothing
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local real dmg = GetUnitState(u2,UNIT_STATE_MAX_LIFE)*0.05
		//Avoid crash
		////////////////////////////////
		//會不會 剛清完 就被使用h2i?
		//因為這時候 都刪除 ltt 的HANDLE了
		////////////////////////////////
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)
		set udg_B12R_B[i]=false
		//////////////
		//傷害
		//////////////
	    call UnitDamageTarget(u1, u2, dmg, true, false, ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
	set ltt = null
	set u1 = null
    set u2 = null
endfunction
function Trig_B37T_startConditions takes nothing returns boolean
    return GetUnitTypeId(GetTriggerUnit()) == 'E00H' 
endfunction
function Trig_B37T_startActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit()
    local trigger ltt
    local integer h2i 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local triggercondition ltc
    	if udg_B12R_B[i]==false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false and IsUnitType(u2, UNIT_TYPE_MECHANICAL) == false then
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
	    		///////////
	    		//參數設定
	    		//////////
		    	set udg_B12R_B[i]=true
		    	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    	set ltc = TriggerAddCondition(ltt, Condition(function Trig_B37T_startActionsFunc003Conditions))
			    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
		    	/////////////////////////////////////////////////////////////
			    //timer check + 觸發器登記
			    /////////////////////////////////////////////////////////////
			    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
			    call Normal_Attack_Timer_for_Trigger(ltt,0.40 , ltc , i)
		endif 
    set ltt = null
    set ltc = null
    set u1 = null
    set u2 = null
endfunction
function InitTrig_B37T_start takes nothing returns nothing
    set gg_trg_B37T_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_B37T_start, Condition(function Trig_B37T_startConditions))
    call TriggerAddAction(gg_trg_B37T_start, function Trig_B37T_startActions)
endfunction//===========================================================================
// Trigger: A01
//===========================================================================
function Trig_A01Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A01_D_reduce_damage, udg_A_common_HERO, EVENT_UNIT_DAMAGED)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A01_W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A01_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A01_R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A01_T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call SetPlayerAbilityAvailableBJ( false, 'A0J1', GetOwningPlayer(udg_A_common_HERO) )
    // -------------
endfunction
//===========================================================================
function InitTrig_A01 takes nothing returns nothing
    set gg_trg_A01 = CreateTrigger()
    call TriggerAddAction(gg_trg_A01, function Trig_A01Actions)
endfunction
//===========================================================================
// Trigger: A01 D reduce damage 
//===========================================================================
function Trig_A01_D_reduce_damageConditions takes nothing returns nothing
local unit u1 
	if (GetEventDamage() > 1.00) then
		set u1 = GetTriggerUnit()
		call SetUnitState(u1, UNIT_STATE_LIFE, (GetUnitState(u1,UNIT_STATE_LIFE)+(GetEventDamage()*0.10)))
		call SetUnitState(u1, UNIT_STATE_MANA, (GetUnitState(u1,UNIT_STATE_MANA)+(GetEventDamage()*0.20)))
	endif
set u1 = null	
endfunction
//===========================================================================
function InitTrig_A01_D_reduce_damage takes nothing returns nothing
    set gg_trg_A01_D_reduce_damage = CreateTrigger()
    call TriggerAddCondition(gg_trg_A01_D_reduce_damage, Condition(function Trig_A01_D_reduce_damageConditions))
endfunction//===========================================================================
// Trigger: A01 W
//
// if ((IsUnitAliveBJ(ydl_unit) == true) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) and (IsUnitAlly(ydl_unit, GetOwningPlayer(u1)) == true) and (GetUnitPointValue(ydl_unit) != 1)) then
//         
//===========================================================================
function Trig_A01_WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0M3'))
endfunction
function Trig_A01_WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local real r = 30.00 + ( I2R(GetUnitAbilityLevel(u1, 'A0M3')) * 45.00 )
    local player p = GetOwningPlayer(u1)
    // 創造馬甲
	    local unit u3 = CreateUnit(p, 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
	    call UnitApplyTimedLife( u3, 'BTLF', 3.00 )
	    call UnitAddAbility( u3 , 'A0MD' )
    // 動作
    call GroupEnumUnitsInRange(udg_Group[8], GetUnitX(u1), GetUnitY(u1), 650.00, null)
    	loop
       		set ydl_unit = FirstOfGroup(udg_Group[8])
        	exitwhen ydl_unit == null
        	call GroupRemoveUnit(udg_Group[8], ydl_unit)
        		if ((GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0) and IsUnitAlly(ydl_unit, p) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) and (GetUnitPointValue(ydl_unit) != 1)) then
            		// 美術
            		call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishHealth\\ReplenishHealthCaster.mdl", ydl_unit, "origin") )
            		// 使用技能
            		call IssueTargetOrderById( u3, 852101, ydl_unit )
            		call SetUnitState(ydl_unit, UNIT_STATE_LIFE, GetUnitState(ydl_unit, UNIT_STATE_LIFE) + r)
        		endif
    	endloop
    		set p = null
    		set u1 = null
    		set u3 = null
    		set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_A01_W takes nothing returns nothing
    set gg_trg_A01_W = CreateTrigger()
    call TriggerAddCondition(gg_trg_A01_W, Condition(function Trig_A01_WConditions))
    call TriggerAddAction(gg_trg_A01_W, function Trig_A01_WActions)
endfunction
//===========================================================================
// Trigger: A01 E
//===========================================================================
globals
integer array A01E_I
unit array A01E_U
endglobals
function Trig_A01_EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0IE' ) )
endfunction
function Trig_A01_EFunc014T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u2 = A01E_U[i]
local real x = GetUnitX(u2)
local real y = GetUnitY(u2)
local real x1 
local real y1 
local unit u3
		if A01E_I[i] >=18 then
	        call FlushChildHashtable(YDHT, h2i)
	        call DestroyTimer(t)
		else
			set A01E_I[i]=A01E_I[i]+1
			set x1 = x + 420.00*Cos(20.00*I2R(A01E_I[i])*3.14159/180)
			set y1 = y + 420.00*Sin(20.00*I2R(A01E_I[i])*3.14159/180)
			set u3 = CreateUnit(GetOwningPlayer(u1), 'h02G', x1, y1, 0)
			call UnitApplyTimedLife(u3, 'BTLF', 1.00)
			call ShowUnit( u3, false )
			call UnitAddAbility(u3, 'A0IQ')
			call SetUnitAbilityLevel(u3, 'A0IQ', GetUnitAbilityLevel(u1, 'A0IE'))
			call IssueTargetOrder(u3, "thunderbolt", u2)
		endif 
    set t=null
    set u1=null
    set u2=null
    set u3=null
endfunction
function Trig_A01_EActions takes nothing returns nothing
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	local unit u1 =GetTriggerUnit()
	local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))	
	    set A01E_I[i]=0
	    set A01E_U[i]=GetSpellTargetUnit()
	    call SaveUnitHandle(YDHT, h2i, 1, u1)
	    call TimerStart(t, 0.06, true, function Trig_A01_EFunc014T)
	set t = null
	set u1 = null
endfunction
function InitTrig_A01_E takes nothing returns nothing
    set gg_trg_A01_E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A01_E, Condition(function Trig_A01_EConditions))
    call TriggerAddAction(gg_trg_A01_E, function Trig_A01_EActions)
endfunction//===========================================================================
// Trigger: A01 R
//===========================================================================
function Trig_A01_R2 takes nothing returns nothing
    local	timer t =	GetExpiredTimer()
    local	integer h2i =	GetHandleId(t)
    local unit u1 =	LoadUnitHandle(YDHT,h2i,1)
    	call DestroyTimer(t)
    	call FlushChildHashtable(YDHT,h2i)
		call UnitRemoveAbility( u1, 'A002' )
	set u1 =	null
	set t =	null	
endfunction
function Trig_A01_RActions takes nothing returns nothing
    local unit u1 =	GetTriggerUnit()
    local integer level	=	GetUnitAbilityLevel(u1,'A0ME')
    local	timer t =	CreateTimer()
    local	integer h2i =	GetHandleId(t)
    local	real time	=	4.90
       
	    call UnitAddAbility( u1, 'A002' )
	    call SetUnitAbilityLevel(u1,'A002',level)
		call SaveUnitHandle(YDHT,h2i,1,u1)
		call TimerStart(t,time,false,function Trig_A01_R2)
    set u1 = null
    set t =	null
endfunction
function Trig_A01_RConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0ME'then
	    call Trig_A01_RActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_A01_R takes nothing returns nothing
    set gg_trg_A01_R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A01_R, Condition(function Trig_A01_RConditions))
endfunction
//===========================================================================
// Trigger: A01 T
//===========================================================================
function Trig_A01_TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A003'))
endfunction
function Trig_A01_TActions takes nothing returns nothing
   local unit u1 = GetTriggerUnit()
   local integer i = GetUnitAbilityLevel(u1, 'A003')
	    call UnitAddAbility( u1, 'A0J1' )
	    call SetUnitAbilityLevel( u1, 'A0J0', i )
	    call SetUnitAbilityLevel( u1, 'A004', i )
	    call TriggerSleepAction(7.00)
	    call UnitRemoveAbility( u1, 'A0J1' )
    set u1 = null
endfunction
//===========================================================================
function InitTrig_A01_T takes nothing returns nothing
    set gg_trg_A01_T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A01_T, Condition(function Trig_A01_TConditions))
    call TriggerAddAction(gg_trg_A01_T, function Trig_A01_TActions)
endfunction
//===========================================================================
// Trigger: A02E
//===========================================================================
function Trig_A02EActions takes nothing returns nothing
local unit u =	GetTriggerUnit()
local integer level =	GetUnitAbilityLevel(u, 'A006')	
local real hp =	GetUnitState(u, UNIT_STATE_LIFE)
	//RE-HERO's-HP
    call SetUnitState(u, UNIT_STATE_LIFE, hp + 100.00 * I2R(level))
    //EFFECT
    call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Invisibility\\InvisibilityTarget.mdl",u,"hand right"))
    call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Invisibility\\InvisibilityTarget.mdl",u,"hand left"))
set u =	null 
endfunction
function Trig_A02EConditions takes nothing returns boolean
    if ( ( GetSpellAbilityId() == 'A006' ) ) then
	    call Trig_A02EActions()
	endif
	return	false
endfunction
//===========================================================================
function InitTrig_A02E takes nothing returns nothing
    set gg_trg_A02E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A02E, Condition(function Trig_A02EConditions))
endfunction//===========================================================================
// Trigger: A03W
//===========================================================================
globals
unit array A03W_U
real array A03W_R
real array A03W_X
real array A03W_Y
endglobals
function Trig_A03WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A009' ) )
endfunction
function Trig_A03WFunc003T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
local real x = A03W_X[i]
local real y = A03W_Y[i]
local unit u2 = A03W_U[i]
local real x1=GetUnitX(u2)
local real y1=GetUnitY(u2)
local real dt = SquareRoot( ( Pow((x1-x),2)) + Pow((y1-y),2)) 
local real r = (700.00-(100.00*I2R(GetUnitAbilityLevel(u1,'A009'))))
	set A03W_R[i] = A03W_R[i] + dt 
	set A03W_X[i]=x1
	set A03W_Y[i]=y1
    	if(A03W_R[i] >=r) and GetUnitAbilityLevel(u2, 'BNpa') > 0 and GetUnitState(u2, UNIT_STATE_LIFE) > 0 then
			set A03W_R[i] = A03W_R[i] - r 
    		call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\ChimaeraAcidMissile\\ChimaeraAcidMissile.mdl",u2,"head"))
    		call UnitDamageTargetBJ(u1, u2, 115.00, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID) 
    	endif 
set u1 = null
set t = null
set u2 = null
endfunction
function Trig_A03WActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
    set A03W_U[i]=u2
    set A03W_R[i]=0.00
    set A03W_X[i]=GetUnitX(u2)
    set A03W_Y[i]=GetUnitY(u2) 
	    call SaveUnitHandle(YDHT, h2i, 1, u1) 
	    call TimerStart(t, 0.10, true, function Trig_A03WFunc003T)
		call YDWEPolledWaitNull(10.00)
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)	
set t=null
set u1 =null
set u2 =null
endfunction
//===========================================================================
function InitTrig_A03W takes nothing returns nothing
    set gg_trg_A03W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A03W, Condition(function Trig_A03WConditions))
    call TriggerAddAction(gg_trg_A03W, function Trig_A03WActions)
endfunction//===========================================================================
// Trigger: A03R Learn
//===========================================================================
function Trig_A30R_LearnConditions takes nothing returns boolean
local	unit	u1 =	GetTriggerUnit()	
local	integer	level =	GetUnitAbilityLevel(u1,'A0XO')
local	integer	hero_of_human_name =	'O00I'
local	integer	Ability_of_Run_Speed_Name =	'A0XN'
local	integer	Ability_of_Attack_Speed_Name	=	'A00C'
	if	GetLearnedSkill()=='A0XO' then
		call SetPlayerAbilityAvailable( GetOwningPlayer(u1), Ability_of_Run_Speed_Name, true )
		call SetPlayerAbilityAvailable( GetOwningPlayer(u1), Ability_of_Attack_Speed_Name, true )
		call SetPlayerTechResearchedSwap( 'R00G', level, GetOwningPlayer(u1) )
	endif
set u1 =	null
    return false
endfunction
//===========================================================================
function InitTrig_A03R_Learn takes nothing returns nothing
    set gg_trg_A03R_Learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A03R_Learn, Condition(function Trig_A30R_LearnConditions))
endfunction
//===========================================================================
// Trigger: A04
//===========================================================================
function Trig_A04Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A04W, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    call TriggerRegisterUnitEvent(gg_trg_A04W_summend, udg_A_common_HERO, EVENT_UNIT_SUMMON)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A04R_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A04T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A04T_end, udg_A_common_HERO, EVENT_UNIT_SPELL_ENDCAST)
    // -------------
endfunction
//===========================================================================
function InitTrig_A04 takes nothing returns nothing
    set gg_trg_A04 = CreateTrigger()
    call TriggerAddAction(gg_trg_A04, function Trig_A04Actions)
endfunction
//===========================================================================
// Trigger: A04W
//===========================================================================
//===========================================================================
// Calculate the modulus/remainder of (dividend) divided by (divisor).
// Examples:  18 mod 5 = 3.  15 mod 5 = 0.  -8 mod 5 = 2.
//
function ROSE_ModuloInteger takes integer dividend, integer divisor returns integer
    local integer modulus = dividend - (dividend / divisor) * divisor
    // If the dividend was negative, the above modulus calculation will
    // be negative, but within (-divisor..0).  We can add (divisor) to
    // shift this result into the desired range of (0..divisor).
    if (modulus < 0) then
        set modulus = modulus + divisor
    endif
    return modulus
endfunction
function Trig_A04WConditions takes nothing returns boolean
	
	//這邊的 (1/2) 是實數 ， WE 會自動轉回 整數，所以0.5=0
    if ROSE_ModuloInteger(GetHeroLevel(GetTriggerUnit()), 2) == 0 then
	    call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()), 'Rora', GetHeroLevel(GetTriggerUnit()) / 2)
    endif
    
    return false
endfunction
function InitTrig_A04W takes nothing returns nothing
    set gg_trg_A04W = CreateTrigger()
    call TriggerAddCondition(gg_trg_A04W, Condition(function Trig_A04WConditions))
endfunction//===========================================================================
// Trigger: A04W summend
//===========================================================================
function Trig_A04W_2Conditions takes nothing returns boolean
local integer id =	GetUnitTypeId(GetSummonedUnit())
    if id == 'hwat' or id == 'hwt2' or id == 'hwt3' or id == 'h00Z' then
	    
	    if (GetLocalPlayer() == GetOwningPlayer(GetSummoningUnit())) then
		    
        	// Use only local code (no net traffic) within this block to avoid desyncs.
        	call SelectUnit(GetSummonedUnit(), true)
        	
    	endif
    	
    endif
    
    return false
endfunction
function InitTrig_A04W_summend takes nothing returns nothing
    set gg_trg_A04W_summend = CreateTrigger()
    call TriggerAddCondition(gg_trg_A04W_summend, Condition(function Trig_A04W_2Conditions))
endfunction//===========================================================================
// Trigger: A04R start
//===========================================================================
function Trig_A04R_dmg takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
local integer h2i = GetHandleId(ltt)
local real r = GetEventDamage()
local unit u1 = LoadUnitHandle(YDHT, h2i, 104104)
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
local unit u3 
	//用事件特性 來做計時器效果 
	//如果傷害單位為null 那麼事件就是計時事件
    if GetTriggerUnit() == null then
	    call DestroyEffect(A04R_E[i])
        call FlushChildHashtable(YDHT,h2i)
		call DestroyTrigger(ltt)
    else
    	//確認護甲值
 		if (r >= A04R_R[i])	then
	 		
	 		call FlushChildHashtable(YDHT,h2i)
	 		call DestroyTrigger(ltt)
	 			///////////
	 			//hide caster
	 			///////////
		 		set u3 = CreateUnit(GetOwningPlayer(A04R_U[i]), 'h01E', GetUnitX(A04R_U[i]), GetUnitY(A04R_U[i]), 0)
	        	call UnitApplyTimedLife( u3, 'BHwe', 5.00 )
	        	call UnitAddAbility( u3, 'A0GN' )
	        	call SetUnitAbilityLevel( u3, 'A0GN', GetUnitAbilityLevel(u1, 'A0GM') )
	        	call IssueImmediateOrder(u3,"stomp")
	        	///////////
	        	//effect
	        	///////////
				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\FrostNova\\FrostNovaTarget.mdl",A04R_U[i],"origin"))
	    	    call DestroyEffect(A04R_E[i])
	    	    ////////
	    	    //reHP
	    	    ////////
		        call SetUnitState(A04R_U[i],UNIT_STATE_LIFE,GetUnitState(A04R_U[i],UNIT_STATE_LIFE)+ A04R_R[i] ) 
		else
		
       	    set A04R_R[i]=A04R_R[i]-r
        	call SetUnitState(A04R_U[i],UNIT_STATE_LIFE,GetUnitState(A04R_U[i],UNIT_STATE_LIFE)+ r )
        	
    	endif
    	
	endif 
	
set ltt = null
set u1 = null
set u3 = null
endfunction
function Trig_A04R_startActions takes nothing returns nothing
local unit u1 =	GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
local trigger ltt = CreateTrigger()
local integer h2i = GetHandleId(ltt)
	//護甲值+目標單位+特效
	set A04R_R[i] =	(125.00+(125.00*I2R(GetUnitAbilityLevel(u1,'A0GM'))))
	set A04R_U[i] =	u2
	set A04R_E[i] =	AddSpecialEffectTarget("Abilities\\Spells\\Undead\\FrostArmor\\FrostArmorTarget.mdl",u2,"chest")
	
    call SaveUnitHandle(YDHT,h2i,104104,u1) 
    call TriggerAddCondition(ltt, function Trig_A04R_dmg)
    call TriggerRegisterTimerEvent(ltt, 10.00, false)
    call TriggerRegisterUnitEvent(ltt,u2,EVENT_UNIT_DAMAGED)
	    
set ltt =	null
set u1 =	null
set u2 =	null 
endfunction
function Trig_A04R_startConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0GM' then
	    
	    call Trig_A04R_startActions()
	    
	endif
	return false 
endfunction
function InitTrig_A04R_start takes nothing returns nothing
    set gg_trg_A04R_start=CreateTrigger()
    call TriggerAddCondition(gg_trg_A04R_start, Condition(function Trig_A04R_startConditions))
endfunction
globals
real array A04R_R
unit array A04R_U
effect array A04R_E
endglobals//===========================================================================
// Trigger: A04T
//===========================================================================
function Trig_A04_TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer h2i = GetHandleId(u1)
local player p = GetOwningPlayer(u1)
local integer i = GetPlayerId(p) + 1
local real x =	GetSpellTargetX()
local real y =	GetSpellTargetY()
	set A04T_U[i] = CreateUnit(p, 'n02W', x, y, 0)
	call UnitApplyTimedLife( A04T_U[i], 'BHwe', 7.00 )
	call UnitAddAbility( A04T_U[i], 'A0GT' )
		
set u1 = null
endfunction
function Trig_A04_TConditions takes nothing returns boolean
	
    if GetSpellAbilityId() == 'A00I' then
	    
	    call Trig_A04_TActions()
	    
	endif
	return false
endfunction
function InitTrig_A04T takes nothing returns nothing
    set gg_trg_A04T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A04T, Condition(function Trig_A04_TConditions))
endfunction
globals
unit array A04T_U
endglobals//===========================================================================
// Trigger: A04T end
//===========================================================================
function Trig_A04_T_endActions takes nothing returns nothing
	local unit u1	=	GetTriggerUnit()
	local player p =	GetOwningPlayer(u1)
	local integer i =	GetPlayerId(p) + 1
		call KillUnit(A04T_U[i])
		
	set u1 =	null
	set p = null
endfunction
function Trig_A04_T_endConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A00I' then 
	    call Trig_A04_T_endActions() 
    endif
    return false
endfunction
function InitTrig_A04T_end takes nothing returns nothing
    set gg_trg_A04T_end = CreateTrigger()
    call TriggerAddCondition(gg_trg_A04T_end, function Trig_A04_T_endConditions)
endfunction//===========================================================================
// Trigger: A05
//===========================================================================
function Trig_A05Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A05W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A05_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A05_R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A05_R_2, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A05_T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // 多人設定用
    call SetPlayerAbilityAvailableBJ( false, 'A0N2', GetOwningPlayer(udg_A_common_HERO) )
endfunction
//===========================================================================
function InitTrig_A05 takes nothing returns nothing
    set gg_trg_A05 = CreateTrigger()
    call TriggerAddAction(gg_trg_A05, function Trig_A05Actions)
endfunction
//===========================================================================
// Trigger: A05W
//===========================================================================
function Trig_A05W_dmg_Conditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A00L' ) )
endfunction
function Trig_A05WActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local effect e= AddSpecialEffectTarget("Abilities\\Spells\\Human\\HolyBolt\\\\HolyBoltMissile.mdl", u1, "weapon")
		call UnitAddAbility(u1, 'A00M')
		call SetUnitAbilityLevel(u1, 'A00M', GetUnitAbilityLevel(u1, 'A00L'))
	 call TriggerSleepAction( 4.00 )
		call UnitRemoveAbility(u1, 'A00M')
		call DestroyEffect(e)
set u1=null
set e=null
endfunction
function InitTrig_A05W takes nothing returns nothing
    set gg_trg_A05W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A05W, Condition(function Trig_A05W_dmg_Conditions))
    call TriggerAddAction(gg_trg_A05W, function Trig_A05WActions)
endfunction//===========================================================================
// Trigger: A05 E
//===========================================================================
function Trig_A05_EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0LJ' ) )
endfunction
function A05E_reduce_damage takes nothing returns nothing
local unit lfo
	if(GetEventDamage()>0)then
		set lfo=GetTriggerUnit()
		call SetUnitState(lfo,UNIT_STATE_LIFE,GetUnitState(lfo,UNIT_STATE_LIFE)+GetEventDamage()*0.5)
	endif
set lfo=null
endfunction
function Trig_A05_EActions takes nothing returns nothing
local trigger ltt=CreateTrigger()
local unit u1 = GetTriggerUnit()
		call TriggerAddCondition(ltt,Condition(function A05E_reduce_damage))
		call TriggerRegisterUnitEvent(ltt,u1,EVENT_UNIT_DAMAGED)
	call YDWEPolledWaitNull(( 2.00 + I2R(GetUnitAbilityLevel(u1, 'A0LJ')) ))
		call DestroyTrigger(ltt)
set ltt = null
set u1 = null
endfunction
function InitTrig_A05_E takes nothing returns nothing
    set gg_trg_A05_E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A05_E, Condition(function Trig_A05_EConditions))
    call TriggerAddAction(gg_trg_A05_E, function Trig_A05_EActions)
endfunction//===========================================================================
// Trigger: A05 R learn
//===========================================================================
function Trig_A05_R_LearnConditions takes nothing returns boolean
    return ((GetLearnedSkill() == 'A0GU') )
endfunction
function Trig_A05_R_LearnActions takes nothing returns nothing
local integer lv =GetUnitAbilityLevel(GetTriggerUnit(), 'A0GU')
    if (lv == 1) then
		set udg_A05R_B[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]	= true
    	call TriggerRegisterUnitEvent(gg_trg_A05_R, GetTriggerUnit(), EVENT_UNIT_DAMAGED)
    else
    	call SetUnitAbilityLevel(GetTriggerUnit(),'A0N2',lv)
    endif 
endfunction
function InitTrig_A05_R_learn takes nothing returns nothing
    set gg_trg_A05_R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A05_R_learn, Condition(function Trig_A05_R_LearnConditions))
    call TriggerAddAction(gg_trg_A05_R_learn, function Trig_A05_R_LearnActions)
endfunction//===========================================================================
// Trigger: A05 R
//
// 
//===========================================================================
function Trig_A05_RConditions takes nothing returns nothing
local unit u1 
local integer i
local real dmg = GetEventDamage()
	if dmg > 0 then
		set u1 = GetTriggerUnit()
		set i =GetConvertedPlayerId(GetOwningPlayer(u1))
			if udg_A05R_B[i] then
				set udg_A05R_R[i] = udg_A05R_R[i] + dmg
					if (udg_A05R_R[i] >=250.00) then
						set udg_A05R_R[i]=(udg_A05R_R[i]-250.00)
						call DestroyEffect(udg_A05R_SE[i])
						call SetPlayerAbilityAvailable(GetOwningPlayer(u1),'A0N2',true)
				   		call SetPlayerAbilityAvailable(GetOwningPlayer(u1),'A0GU',false)
				    	set udg_A05R_SE[i]=AddSpecialEffectTarget("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkTarget.mdl",u1,"weapon")
				    	set udg_A05R_B[i]=false
					endif
			endif 
	endif
set u1= null
endfunction
function InitTrig_A05_R takes nothing returns nothing
    set gg_trg_A05_R=CreateTrigger()
    call TriggerAddCondition(gg_trg_A05_R, Condition(function Trig_A05_RConditions))
endfunction//===========================================================================
// Trigger: A05 R 2
//===========================================================================
function Trig_A05_R_2Conditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0N2' ) )
endfunction
function Trig_A05_R_2Actions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
set udg_A05R_B[i]=true
call SetPlayerAbilityAvailable(GetOwningPlayer(u1), 'A0N2', false)
call SetPlayerAbilityAvailable(GetOwningPlayer(u1), 'A0GU', true)
call DestroyEffect(udg_A05R_SE[i])
set u1 = null
endfunction
function InitTrig_A05_R_2 takes nothing returns nothing
    set gg_trg_A05_R_2=CreateTrigger()
    call TriggerAddCondition(gg_trg_A05_R_2, Condition(function Trig_A05_R_2Conditions))
    call TriggerAddAction(gg_trg_A05_R_2, function Trig_A05_R_2Actions)
endfunction
//===========================================================================
// Trigger: A05 T
//===========================================================================
function Trig_A05_TConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A05Z' ) )
endfunction
function A05T_reduce_damage takes nothing returns nothing
local unit lfo
	if(GetEventDamage()>0)then
		set lfo=GetTriggerUnit()
			if GetEventDamageSource() == LoadUnitHandle(YDHT, GetHandleId(GetTriggeringTrigger()), 1) then
				call SetUnitState(lfo,UNIT_STATE_LIFE,GetUnitState(lfo,UNIT_STATE_LIFE)+GetEventDamage()*0.5)
			else	
				call SetUnitState(lfo,UNIT_STATE_LIFE,GetUnitState(lfo,UNIT_STATE_LIFE)+GetEventDamage())
			endif 
	endif
set lfo=null
endfunction
function Trig_A05_TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local trigger ltt=CreateTrigger()
		call SaveUnitHandle(YDHT, GetHandleId(ltt), 1, GetSpellTargetUnit() )
		call TriggerAddCondition(ltt,Condition(function A05T_reduce_damage))
		call TriggerRegisterUnitEvent(ltt,u1,EVENT_UNIT_DAMAGED)
	call YDWEPolledWaitNull(( 4.00 + 3.00*I2R(GetUnitAbilityLevel(u1, 'A05Z')) ))
		call FlushChildHashtable(YDHT,GetHandleId(ltt))
		call DestroyTrigger(ltt)
set ltt = null
set u1 = null
endfunction
function InitTrig_A05_T takes nothing returns nothing
    set gg_trg_A05_T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A05_T, Condition(function Trig_A05_TConditions))
    call TriggerAddAction(gg_trg_A05_T, function Trig_A05_TActions)
endfunction//===========================================================================
// Trigger: A06
//===========================================================================
//T 獲取目標
function A06T_Attack_TA takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i = GetPlayerId(GetOwningPlayer(u1))+1
	set udg_A06T_I[i]=udg_A06T_I[i]+1
		if udg_A06T_I[i]>=7 then
			//刪除擴散攻擊 、 增加攻擊力
	    	call UnitRemoveAbility(u1, 'A0KP')
    	    call UnitRemoveAbility(u1, 'A0IH')
    	    set udg_A06T_B[i]=false
		endif
set u1 = null
endfunction
function A06T_Attack_TC takes nothing returns boolean
	if udg_A06T_B[GetPlayerId(GetTriggerPlayer())+1] then
		call A06T_Attack_TA()
	endif
return false 
endfunction
//T 使用
function A06T_Remove_Ability takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(YDHT,h2i,5566)
	set udg_A06T_B[GetPlayerId(GetOwningPlayer(u1))+1]=true
	//刪除技能
	//【NEW】刪除沒有的技能，不會造成崩潰。
    call UnitRemoveAbility(u1, 'A0KP')
    call UnitRemoveAbility(u1, 'A0IH')
    //clean
    call FlushChildHashtable(YDHT,h2i)
    call DestroyTimer(t)
    //call BJDebugMsg(I2S('A0KP'))
set u1 = null
set t = null
endfunction
function A06T_Spell takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i = GetPlayerId(GetOwningPlayer(u1))+1
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call UnitAddAbility(u1, 'A0KP')
    call UnitAddAbility(u1, 'A0IH')
    call SetUnitAbilityLevel(u1, 'A0IH', GetUnitAbilityLevel(u1, 'A0NZ'))
    set udg_A06T_B[i]=true
    set	udg_A06T_I[i]=0
    //hash
    call SaveUnitHandle(YDHT,h2i,5566,u1)
    call TimerStart(t,20.00,false,function A06T_Remove_Ability)
set u1 = null 
set t = null 
endfunction
function A06T_TC takes nothing returns boolean
    if GetSpellAbilityId() == 'A0NZ' then
	call A06T_Spell()
	endif
    return false
endfunction
//D 使用
function Trig_A06D_USEActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i = GetPlayerId(GetOwningPlayer(u1))+1
	set udg_A06D_I[i]=0
	call SetPlayerAbilityAvailable(GetOwningPlayer(u1),'A0DN',false)
set u1 = null
endfunction
function Trig_A06D_USEConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0DN' then
	    call Trig_A06D_USEActions()
    endif
    return false
endfunction
//D累積
function Trig_A06DConditions takes nothing returns boolean
local integer i= GetPlayerId(GetTriggerPlayer())+1
	set udg_A06D_I[i]=udg_A06D_I[i] + 1
		if udg_A06D_I[i] == 5 then
		    call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()), 'A0DN', true)
		endif
	//call BJDebugMsg(GetPlayerName(GetTriggerPlayer()))	
return false
endfunction
//D學習
function Trig_A06D_LearnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A00Q' then
	    if GetUnitAbilityLevel(GetTriggerUnit(), 'A00Q') == 1 then 
		    call TriggerRegisterUnitEvent(gg_trg_A06D, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE) 
	    endif
		//科技禁止 還是可以提升隱藏單位的技能等級
	    call SetUnitAbilityLevel(GetTriggerUnit(),'A0DN',GetUnitAbilityLevel(GetTriggerUnit(), 'A00Q'))	
    endif
    return false
endfunction
//註冊
function Trig_A06Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A06D_Learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A06D_USE, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A06T_START, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A06T_time, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    // 初始化設定
    call SetPlayerAbilityAvailable( GetOwningPlayer(udg_A_common_HERO), 'A0DN', false )
endfunction
//===========================================================================
function InitTrig_A06 takes nothing returns nothing
    set gg_trg_A06 = CreateTrigger()
    call TriggerAddAction(gg_trg_A06, function Trig_A06Actions)
    set gg_trg_A06D_Learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A06D_Learn, Condition(function Trig_A06D_LearnConditions))
    set gg_trg_A06D=CreateTrigger()
    call TriggerAddCondition(gg_trg_A06D, Condition(function Trig_A06DConditions))
    set gg_trg_A06D_USE=CreateTrigger()
    call TriggerAddCondition(gg_trg_A06D_USE, Condition(function Trig_A06D_USEConditions))
    set gg_trg_A06T_START=CreateTrigger()
    call TriggerAddCondition(gg_trg_A06T_START, Condition(function A06T_TC))
    set gg_trg_A06T_time=CreateTrigger()
    call TriggerAddCondition(gg_trg_A06T_time, Condition(function A06T_Attack_TC))
endfunction
globals
trigger gg_trg_A06D_Learn = null
trigger gg_trg_A06D = null	
trigger gg_trg_A06D_USE = null
trigger gg_trg_A06T_START = null
trigger gg_trg_A06T_time = null
endglobals//===========================================================================
// Trigger: A07
//===========================================================================
function Trig_A07Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A07D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A07R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
//===========================================================================
function InitTrig_A07 takes nothing returns nothing
    set gg_trg_A07 = CreateTrigger()
    call TriggerAddAction(gg_trg_A07, function Trig_A07Actions)
endfunction
//===========================================================================
// Trigger: A07D
//===========================================================================
function Trig_A07DConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0IY'))
endfunction
function Trig_A07DActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real r
    if ((GetUnitTypeId(u1) == 'O001')) then
        set r = ( GetUnitState(u1, UNIT_STATE_LIFE) + ( 0.08 * GetUnitState(u1, UNIT_STATE_MAX_LIFE) ) )
	    call SetUnitState(u1,UNIT_STATE_LIFE,r)
	    call UnitAddAbility( u1, 'A0IP' )
		call SetUnitAbilityLevel(u1,'A0IP',2)
	    call UnitMakeAbilityPermanent(u1,true,'A0IP') 
    else
        set r = ( GetUnitState(u1, UNIT_STATE_LIFE) + ( 0.04 * GetUnitState(u1, UNIT_STATE_MAX_LIFE) ) )
        call SetUnitState(u1,UNIT_STATE_LIFE,r)
		call UnitAddAbility( u1, 'A0IP' )	
 		call UnitMakeAbilityPermanent(u1,true,'A0IP') 
    endif
    	call TriggerSleepAction(3.00)
    	call UnitMakeAbilityPermanent(u1,false,'A0IP')
    	call UnitRemoveAbility( u1, 'A0IP' ) 
    	set u1 = null
endfunction
//===========================================================================
function InitTrig_A07D takes nothing returns nothing
    set gg_trg_A07D = CreateTrigger()
    call TriggerAddCondition(gg_trg_A07D, Condition(function Trig_A07DConditions))
    call TriggerAddAction(gg_trg_A07D, function Trig_A07DActions)
endfunction//===========================================================================
// Trigger: A07R learn
//===========================================================================
function Trig_A07R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0I8'))
endfunction
function Trig_A07R_learnActions takes nothing returns nothing
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A0IY', ( GetUnitAbilityLevel(GetTriggerUnit(), 'A0I8') + 1 ) )
endfunction
//===========================================================================
function InitTrig_A07R_learn takes nothing returns nothing
    set gg_trg_A07R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A07R_learn, Condition(function Trig_A07R_learnConditions))
    call TriggerAddAction(gg_trg_A07R_learn, function Trig_A07R_learnActions)
endfunction
//===========================================================================
// Trigger: A08
//===========================================================================
//A08W
function Trig_A08WConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0N9' 
endfunction
function Trig_A08WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real dmg = 50.00+ 100.00*I2R(GetUnitAbilityLevel(u1,'A0N9'))
    call UnitAddAbility(u1, 'A0NA')
    call SetUnitAbilityLevel(u1, 'A0NA', GetUnitAbilityLevel(u1, 'A0N9')) 
    call UnitMakeAbilityPermanent( u1, true, 'A0NA' )
    call UnitDamageTarget(u1,GetSpellTargetUnit(),dmg, true, false, ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
    call YDWEPolledWaitNull(8.00)
    call UnitMakeAbilityPermanent( u1, false, 'A0NA' )
    call UnitRemoveAbility(u1, 'A0NA')
set u1 = null
endfunction
//A08E
function Trig_A08EConditions takes nothing returns boolean
local unit u1	
local real hp
    if GetSpellAbilityId() == 'A0N4' then
	    set u1 = GetTriggerUnit()
	    set hp = GetUnitState(u1,UNIT_STATE_LIFE) + 0.20 * ( GetUnitState(u1,UNIT_STATE_MAX_LIFE)- GetUnitState(u1,UNIT_STATE_LIFE) )
	    call SetUnitState(u1, UNIT_STATE_LIFE, hp)
	endif
set u1 = null
return false 
endfunction
//A08R
function Trig_A08R_LearnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A010' and GetUnitAbilityLevel(GetTriggerUnit(), 'A010') == 1 then
		call TriggerRegisterUnitEvent(gg_trg_A08R, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
	endif 
	return false 
endfunction
function InitTrig_A08R_Learn takes nothing returns nothing
local trigger ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_A08R_LearnConditions))
    call SaveTriggerHandle(udg_Trigger_H,GetHandleId(GetTriggeringTrigger()),3,ltt) 
set ltt = null 
endfunction
//A08T
function Trig_A08T_StartConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0N3' and IsUnitIllusion(GetTriggerUnit()) != true then
		call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()), 'Rorb', GetUnitAbilityLevel(GetTriggerUnit(), 'A0N3') + 1 )
	endif 
	return false
endfunction
function InitTrig_A08_INIT takes trigger ltt_init returns nothing
///////////////////////////////////////////////////////
//【注意】a.一定要 h2i = ltt_init 要不然會沒有重複 h2i
// ////////////////////////////////////////////////////
local trigger ltt
local integer h2i = GetHandleId(ltt_init)
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_A08WConditions))
    call TriggerAddAction(ltt, function Trig_A08WActions) 
	call SaveTriggerHandle(udg_Trigger_H,h2i,1,ltt) 
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_A08EConditions))
	call SaveTriggerHandle(udg_Trigger_H,h2i,2,ltt)
	set ltt = CreateTrigger() 
	call TriggerAddCondition(ltt, Condition(function Trig_A08R_LearnConditions))
    call SaveTriggerHandle(udg_Trigger_H,h2i,3,ltt) 
    set ltt = CreateTrigger() 
    call TriggerAddCondition(ltt, Condition(function Trig_A08T_StartConditions))
    call SaveTriggerHandle(udg_Trigger_H,h2i,4,ltt) 
set ltt = null 
endfunction
function Trig_A08Actions takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
local integer h2i = GetHandleId(ltt)
local unit u = udg_A_common_HERO
	/////////////////////
	//第一次註冊 TC , TA
	////////////////////
	if GetTriggerExecCount(ltt) == 1 then
		call InitTrig_A08_INIT(ltt)
	endif 
	/////////////
	//註冊 TE
	//////////// 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,1)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,2)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
    // -------------
	set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,3)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_HERO_SKILL) 
    // -------------
	set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,4)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_HERO_SKILL) 
set u = null
set ltt = null 
endfunction
//===========================================================================
function InitTrig_A08 takes nothing returns nothing
    set gg_trg_A08 = CreateTrigger()
    call TriggerAddAction(gg_trg_A08, function Trig_A08Actions)
endfunction
//===========================================================================
// Trigger: A08R
//===========================================================================
function Trig_A08RActionsFunc003Conditions takes nothing returns nothing
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local real value = GetUnitState(u1, UNIT_STATE_LIFE)
	local real maxValue = GetUnitState(u1, UNIT_STATE_MAX_LIFE)	
	local real lifepercent = value / maxValue * 100.0
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local real dmg =10.00 * I2R(GetUnitAbilityLevel(u1,'A010')) + I2R( 1 + 2 * GetUnitAbilityLevel(u1,'A010') ) * R2I( (100.00-lifepercent) / 10.00 )
		//Avoid crash
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)
		set udg_B12R_B[i]=false
		//////////////
		//傷害
		//////////////
	    call UnitDamageTarget(u1, u2, dmg, true, false, ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
	set ltt = null
	set u1 = null
    set u2 = null
endfunction
function Trig_A08RActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit()
    local trigger ltt
    local integer h2i 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local triggercondition ltc
    	if udg_B12R_B[i]==false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false then
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
	    		///////////
	    		//參數設定
	    		//////////
		    	set udg_B12R_B[i]=true
		    	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    	set ltc = TriggerAddCondition(ltt, Condition(function Trig_A08RActionsFunc003Conditions))
			    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
		    	/////////////////////////////////////////////////////////////
			    //timer check + 觸發器登記
			    /////////////////////////////////////////////////////////////
			    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
			    call Normal_Attack_Timer_for_Trigger(ltt,0.30 , ltc , i)
		endif 
    set ltt = null
    set ltc = null
    set u1 = null
    set u2 = null
endfunction
function InitTrig_A08R takes nothing returns nothing
    set gg_trg_A08R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A08R, Condition(function Trig_A08RActions))
endfunction
//===========================================================================
// Trigger: A09
//===========================================================================
function Trig_A09Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A09D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A09D_stop, udg_A_common_HERO, EVENT_UNIT_SPELL_CHANNEL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A09W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A09E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A09E_effect, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A09R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A09T_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
//===========================================================================
function InitTrig_A09 takes nothing returns nothing
    set gg_trg_A09 = CreateTrigger()
    call TriggerAddAction(gg_trg_A09, function Trig_A09Actions)
endfunction
//===========================================================================
// Trigger: A09D
//===========================================================================
function Trig_A09DActions2 takes nothing returns nothing
local timer	t	=	GetExpiredTimer()
local	integer	h2i	=	GetHandleId(t)
local	unit	u1	=	LoadUnitHandle(YDHT,h2i,3)
local	real	x	=	LoadReal(YDHT,h2i,1)
local	real	y	=	LoadReal(YDHT,h2i,2)
	call DestroyTimer(t)
	call FlushChildHashtable(YDHT,h2i)
	//EFFECT & MOVE
	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathPact\\DeathPactTarget.mdl",u1,"chest"))
	call SetUnitX(u1,x)
	call SetUnitY(u1,y)
	
set u1	=	null
set t	=	null
endfunction
function Trig_A09DActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local timer t	= CreateTimer()
local integer	h2i = GetHandleId(t)
	//MOVE
	call SetUnitX(u1,x1)
	call SetUnitY(u1,y1)
	//SAVE THE CODE
	call SaveReal(YDHT,h2i,1,x)
	call SaveReal(YDHT,h2i,2,y)
	call SaveUnitHandle(YDHT,h2i,3,u1)
	call TimerStart(t,3.00,false,function Trig_A09DActions2)
set u1 = null
set t	=	null
endfunction
function Trig_A09DConditions takes nothing returns boolean
    if ( ( GetSpellAbilityId() == 'A017' ) ) then
	    call Trig_A09DActions()
	endif
    return false
endfunction
function InitTrig_A09D takes nothing returns nothing
    set gg_trg_A09D=CreateTrigger()
    call TriggerAddCondition(gg_trg_A09D, Condition(function Trig_A09DConditions))
endfunction//===========================================================================
// Trigger: A09D stop
//===========================================================================
function Trig_A09D_stopConditions takes nothing returns boolean	
	local	unit	u	=	GetTriggerUnit()
    if GetSpellAbilityId() == 'A017' and IsTerrainPathable(GetSpellTargetX(), GetSpellTargetY(), PATHING_TYPE_WALKABILITY) then
		call DisplayTimedTextToPlayer( GetOwningPlayer(u), 0, 0, 3.00, "TRIGSTR_12387" )
		call PauseUnit(u,true)
		call PauseUnit(u,false)
		call IssueImmediateOrder(u,"stop")
    endif
    set u	=	null
    return false
endfunction
function InitTrig_A09D_stop takes nothing returns nothing
    set gg_trg_A09D_stop = CreateTrigger()
    call TriggerAddCondition(gg_trg_A09D_stop, Condition(function Trig_A09D_stopConditions))
endfunction//===========================================================================
// Trigger: A09W
//===========================================================================
function Trig_A09WFunc001T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1091091)
local unit u2 =LoadUnitHandle(YDHT, h2i, 1091092)
	if(IsPlayerAlly(GetOwningPlayer(u2), GetOwningPlayer(u1)) == true)then
		call SetUnitState(u2,UNIT_STATE_LIFE,(GetUnitState(u2,UNIT_STATE_LIFE)+(100.00+(100.00*I2R(GetUnitAbilityLevel(u1,'A016'))))))
	else
		call UnitDamageTargetBJ(u1,u2,(100.00+(100.00*I2R(GetUnitAbilityLevel(u1,'A016')))),ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
	endif
set t = null
set u1= null
set u2= null
endfunction
function Trig_A09WActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call SaveUnitHandle(YDHT, h2i, 1091091, GetTriggerUnit())
    call SaveUnitHandle(YDHT, h2i, 1091092, GetSpellTargetUnit())
	call TimerStart(t, 2.60, false, function Trig_A09WFunc001T)
set t = null
endfunction
function Trig_A09WConditions takes nothing returns boolean
    if ((GetSpellAbilityId() == 'A016')) then
	    call Trig_A09WActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_A09W takes nothing returns nothing
    set gg_trg_A09W = CreateTrigger()
    call TriggerAddCondition(gg_trg_A09W, Condition(function Trig_A09WConditions))
endfunction//===========================================================================
// Trigger: A09E
//===========================================================================
function Trig_A09EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
local real x2 = x + 10*Cos(a)
local real y2 = y + 10*Sin(a)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife( u3, 'BHwe', 10.00 )
	call UnitAddAbility( u3, 'A015' )
	call SetUnitAbilityLevel( u3, 'A015', GetUnitAbilityLevel(u1, 'A014') )
	call IssuePointOrder(u3,"stampede",x2,y2)
set u1 = null
set u3 = null
endfunction
function Trig_A09EConditions takes nothing returns boolean
    if ((GetSpellAbilityId() == 'A014')) then
		call	Trig_A09EActions()
	endif
    return	false
endfunction
//===========================================================================
function InitTrig_A09E takes nothing returns nothing
    set gg_trg_A09E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A09E, Condition(function Trig_A09EConditions))
endfunction//===========================================================================
// Trigger: A09E effect
//
// n007
//===========================================================================
function Trig_A09E_effectActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 
local real y1 
local unit u2 
local real a 
local unit u3
	    if ((GetSpellAbilityId() == 'A016') and (GetSpellAbilityId() == 'A012')) then
		    set u2 = GetSpellTargetUnit()
		    set x1 = GetUnitX(u2)
		    set y1 = GetUnitY(u2)
		else
			set x1 = GetSpellTargetX()
		    set y1 = GetSpellTargetY() 
	    endif
	//for sign
	set u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x1,y1,0)
	call UnitApplyTimedLife( u3, 'BHwe', 1.00 )
	call ShowUnit(u3, false)
	//for spell    
	set u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x1,y1,0)
	call UnitApplyTimedLife( u3, 'BHwe', 10.00 )
	call UnitAddAbility( u3, 'A0LN' )
	call SetUnitAbilityLevel( u3, 'A0LN', GetUnitAbilityLevel(u1, 'A014') ) 
	call IssuePointOrder(u3,"stampede",x,y)
set u1 = null
set u2 = null
set u3 = null
endfunction
function Trig_A09E_effectConditions takes nothing returns boolean
local integer id = GetSpellAbilityId()
    if ((((id == 'A017') or (id == 'A016') or (id == 'A012') or (id == 'A0I1'))) and GetUnitAbilityLevel(GetTriggerUnit(), 'A014') > 0) then
    	call Trig_A09E_effectActions()
	endif
	return	false
endfunction
//===========================================================================
function InitTrig_A09E_effect takes nothing returns nothing
    set gg_trg_A09E_effect = CreateTrigger()
    call TriggerAddCondition(gg_trg_A09E_effect, Condition(function Trig_A09E_effectConditions))
endfunction//===========================================================================
// Trigger: A09R
//===========================================================================
function Trig_A09RActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local real x1=GetUnitX(u1)
local real y1=GetUnitY(u1)
local unit u2=GetSpellTargetUnit()
local real x2=GetUnitX(u2)
local real y2=GetUnitY(u2 )
	call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Charm\\CharmTarget.mdl",x1,y1))
	call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Charm\\CharmTarget.mdl",x2,y2))
	call SetUnitX(u1,x2)
	call SetUnitY(u1,y2)
	call SetUnitX(u2,x1)
	call SetUnitY(u2,y1)
		if(IsUnitEnemy(u2,GetOwningPlayer(u1)))then
			call UnitDamageTargetBJ(u1,u2,(140.00+(65.00*I2R(GetUnitAbilityLevel(u1,GetSpellAbilityId())))),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		endif
set u1=null
set u2=null
endfunction
function Trig_A09RConditions takes nothing returns boolean
    if ((GetSpellAbilityId() == 'A012')) then
	    call Trig_A09RActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_A09R takes nothing returns nothing
    set gg_trg_A09R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A09R, Condition(function Trig_A09RConditions))
endfunction//===========================================================================
// Trigger: A09T learn
//===========================================================================
function Trig_A09T_learnConditions takes nothing returns boolean
    return ((GetLearnedSkill() == 'A0I1') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_A09T_learnActions takes nothing returns nothing
    call SetUnitAbilityLevelSwapped( 'A017', GetTriggerUnit(), ( GetUnitAbilityLevel(GetTriggerUnit(), 'A0I1') + 1 ) )
endfunction
//===========================================================================
function InitTrig_A09T_learn takes nothing returns nothing
    set gg_trg_A09T_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A09T_learn, Condition(function Trig_A09T_learnConditions))
    call TriggerAddAction(gg_trg_A09T_learn, function Trig_A09T_learnActions)
endfunction
//===========================================================================
// Trigger: A10
//===========================================================================
function Trig_A10Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A10W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A10R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A10T_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A10 takes nothing returns nothing
    set gg_trg_A10 = CreateTrigger()
    call TriggerAddAction(gg_trg_A10, function Trig_A10Actions)
endfunction
//===========================================================================
// Trigger: A10W
//===========================================================================
function Trig_A10WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A018'))
endfunction
function Trig_A10WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local unit u3 = CreateUnit(GetOwningPlayer(u1),'osp1',x1,y1,0)
	call UnitApplyTimedLife(u3,'BHwe',8.00)
	call UnitAddAbility( u3, 'A019' )
	call SetUnitAbilityLevel( u3, 'A019', GetUnitAbilityLevel(u1, 'A018') )
	call IssuePointOrder(u3,"blizzard",x1,y1)
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_A10W takes nothing returns nothing
    set gg_trg_A10W = CreateTrigger()
    call TriggerAddCondition(gg_trg_A10W, Condition(function Trig_A10WConditions))
    call TriggerAddAction(gg_trg_A10W, function Trig_A10WActions)
endfunction//===========================================================================
// Trigger: A10R learn
//===========================================================================
function Trig_A10R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A01B') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_A10R_learnActions takes nothing returns nothing
    if ((GetUnitAbilityLevel(GetTriggerUnit(), 'A01B') == 1)) then
        call UnitAddAbility( GetTriggerUnit(), 'A09M' )
        call UnitMakeAbilityPermanent( GetTriggerUnit(), true, 'A09M' )
        call EnableTrigger( gg_trg_A10R )
    else
        call SetUnitAbilityLevel( GetTriggerUnit(), 'A09M', ( GetUnitAbilityLevel(GetTriggerUnit(), 'A01B') + 0 ) )
    endif
endfunction
//===========================================================================
function InitTrig_A10R_learn takes nothing returns nothing
    set gg_trg_A10R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A10R_learn, Condition(function Trig_A10R_learnConditions))
    call TriggerAddAction(gg_trg_A10R_learn, function Trig_A10R_learnActions)
endfunction
//===========================================================================
// Trigger: A10R
//
// A09M
//===========================================================================
globals
boolean array A10R_B
endglobals
function Trig_A10RConditions takes nothing returns boolean
    return (GetUnitAbilityLevel(GetTriggerUnit(),'B09B') > 0)
endfunction
function Trig_A10R_GetExpiredTimer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
	call FlushChildHashtable(YDHT, h2i)
	call DestroyTimer(t) 
	/////////////////////////////////////////////////
	//Think : Disposable timer needed be Destroy
	//        and Flusj the HashTable
	/////////////////////////////////////////////////
	set A10R_B[i] = false
set t=null
set u1=null
endfunction
function Trig_A10RActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
    local unit ydl_unit
    local integer i
    local timer t 
    call GroupEnumUnitsInRange(udg_Group[0], GetUnitX(u1), GetUnitY(u1), 700.00, null)
	    loop
	        set ydl_unit=FirstOfGroup(udg_Group[0])
	        exitwhen ydl_unit == null
	        call GroupRemoveUnit(udg_Group[0], ydl_unit)
		        if GetUnitPointValue(ydl_unit) == 110 and IsUnitEnemy(u1, GetOwningPlayer(ydl_unit)) and IsUnitIllusion(ydl_unit) != true and GetUnitAbilityLevel(ydl_unit, 'A01B') > 0 and A10R_B[GetConvertedPlayerId(GetOwningPlayer(ydl_unit))]==false then 
		        	////////////////////////
		        	//limit spell Interval
		        	////////////////////////
		            set A10R_B[GetConvertedPlayerId(GetOwningPlayer(ydl_unit))] = true
		            /////////////////////
		            //spell DAMAGE + Effect
		            /////////////////////
		            call UnitDamageTargetBJ(ydl_unit, u1, ( ( 1.00 + ( 0.20 * I2R(GetUnitAbilityLevel(ydl_unit, 'A01B')) ) ) * I2R(GetHeroInt(ydl_unit, true)) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNKNOWN)
		            call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl", u1, "chest"))
		            ////////////////////////////////////////////////////////////////////     
		            ////attention Polledwait can't put in loop
		            ////////////////////////////////////////////////////////////////////     
		            set t = CreateTimer()
					call SaveUnitHandle(YDHT, GetHandleId(t), 1, ydl_unit)
					call TimerStart(t, 0.25, false, function Trig_A10R_GetExpiredTimer)
		        endif
	    endloop
    set ydl_unit=null
    set t=null
	set u1=null
endfunction
function InitTrig_A10R takes nothing returns nothing
    set gg_trg_A10R=CreateTrigger()
    call DisableTrigger(gg_trg_A10R)
    call TriggerRegisterAnyUnitEventBJ(gg_trg_A10R, EVENT_PLAYER_UNIT_SPELL_EFFECT)
    call TriggerAddCondition(gg_trg_A10R, Condition(function Trig_A10RConditions))
    call TriggerAddAction(gg_trg_A10R, function Trig_A10RActions)
endfunction//===========================================================================
// Trigger: A10T_start
//
// 1.5 * 9 = 1.35
// 1.5* 11
//===========================================================================
function Trig_A10T_startConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0L7'))
endfunction
function Trig_A10T_Group_Spell_TO_3Target takes nothing returns nothing
local unit u1 = rose_unit[0]
	///////////////////////////////////////////////////////////////////////
	//Think : File to other function , can use "GetExpiredTimer"
	///////////////////////////////////////////////////////////////////////
	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl",GetEnumUnit(),"origin"))
	call SetUnitState(u1,UNIT_STATE_LIFE,(GetUnitState(u1,UNIT_STATE_LIFE)+(I2R(GetHeroInt(u1,true))*0.50)))
	call UnitDamageTargetBJ(u1,GetEnumUnit(),I2R(GetHeroInt(u1,true)),ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
set u1 = null
endfunction
function Trig_A10T_startFunc003T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local unit ydl_unit
local real x1 = GetUnitX(u1)
local real y1 = GetUnitY(u1)
local player p = GetOwningPlayer(u1)
	call GroupClear(udg_Group[1])
	    if ((GetUnitTypeId(u1) != 'O017') or GetUnitState(u1, UNIT_STATE_LIFE) <= 1 )then
		    call FlushChildHashtable(YDHT, h2i)
		    call DestroyTimer(t)
	    else
	    	call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 800.00, null)
	    	loop
	    		set ydl_unit = FirstOfGroup(udg_Group[0])
	    		exitwhen ydl_unit == null 
	    		call GroupRemoveUnit(udg_Group[0], ydl_unit)
	        		if GetUnitAbilityLevel(ydl_unit,'B00N')>0 and IsUnitEnemy(ydl_unit,p) then
		        		call GroupAddUnit(udg_Group[1],ydl_unit)
	        		endif
	    	endloop
	    endif
	set rose_unit[0] = u1 
	call ForGroup(YDWEGetRandomSubGroupNull(3,udg_Group[1]),function Trig_A10T_Group_Spell_TO_3Target)
	call GroupClear(udg_Group[1])
set p = null	
set t = null
set u1 = null
set ydl_unit = null
endfunction
function Trig_A10T_startActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, GetTriggerUnit()) 
    call TimerStart(t, 1.50, true, function Trig_A10T_startFunc003T)
set t = null
endfunction
//===========================================================================
function InitTrig_A10T_start takes nothing returns nothing
    set gg_trg_A10T_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_A10T_start, Condition(function Trig_A10T_startConditions))
    call TriggerAddAction(gg_trg_A10T_start, function Trig_A10T_startActions)
endfunction//===========================================================================
// Trigger: A11
//===========================================================================
function Trig_A11Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A11D, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A11W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A11E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A11T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A11 takes nothing returns nothing
    set gg_trg_A11 = CreateTrigger()
    call TriggerAddAction(gg_trg_A11, function Trig_A11Actions)
endfunction
//===========================================================================
// Trigger: A11D
//===========================================================================
function Trig_A11DConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A01H') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_A11DActions takes nothing returns nothing
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A01E', ( GetUnitAbilityLevel(GetTriggerUnit(), 'A01H') + 1 ) )
endfunction
//===========================================================================
function InitTrig_A11D takes nothing returns nothing
    set gg_trg_A11D = CreateTrigger()
    call TriggerAddCondition(gg_trg_A11D, Condition(function Trig_A11DConditions))
    call TriggerAddAction(gg_trg_A11D, function Trig_A11DActions)
endfunction
//===========================================================================
// Trigger: A11W
//===========================================================================
function Trig_A11WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A01H'))
endfunction
function Trig_A11WActions takes nothing returns nothing
    call TriggerSleepAction(0.79)
    if (GetLocalPlayer() == GetOwningPlayer(GetTriggerUnit())) then
        // Use only local code (no net traffic) within this block to avoid desyncs.
        call PanCameraToTimed(GetUnitX(GetTriggerUnit()), GetUnitY(GetTriggerUnit()), 0.50)
    endif
endfunction
//===========================================================================
function InitTrig_A11W takes nothing returns nothing
    set gg_trg_A11W = CreateTrigger()
    call TriggerAddCondition(gg_trg_A11W, Condition(function Trig_A11WConditions))
    call TriggerAddAction(gg_trg_A11W, function Trig_A11WActions)
endfunction//===========================================================================
// Trigger: A11E
//===========================================================================
function Trig_A11EFunc004T takes nothing returns nothing
local unit ydl_unit
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local unit u2 =LoadUnitHandle(YDHT, h2i, 0x9CD60476)
local integer i =LoadInteger(YDHT, h2i, 0x9C0F555E)
local boolean b =LoadBoolean(YDHT, h2i, 0xA3098AE2)
local integer h2i2 = GetHandleId(u1)
local integer Index_total
local integer reach
local real x
local real y
local real x1
local real y1
local real a
local unit u3
if ( b==false ) then
    set i = i + 1
    call SaveInteger(YDHT, h2i, 0x9C0F555E, i)
    set x = GetUnitX(u1)
	set y = GetUnitY(u1)
	set a = GetUnitFacing(u1) *bj_DEGTORAD
    set x1 = x + 40.00*I2R(i)*Cos(a)
    set y1 = y + 40.00*I2R(i)*Sin(a)
    call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 150.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null) 
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( (IsUnitType(ydl_unit,UNIT_TYPE_GROUND)==true) and (GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1) and (IsUnitType(ydl_unit,UNIT_TYPE_MECHANICAL)==false) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) and (GetOwningPlayer(ydl_unit)!=GetOwningPlayer(u1))) then
        			set b = true
            			if IsUnitEnemy(ydl_unit,GetOwningPlayer(u1))then
                			call UnitDamageTargetBJ(u1,ydl_unit,(I2R(GetUnitAbilityLevel(u1,'A01G'))*100.00),ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
            			endif
					call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\TalkToMe\\TalkToMe.mdl",ydl_unit,"overhead")) 
        			call SaveUnitHandle(YDHT, h2i, 0x9CD60476, ydl_unit)
        		endif
    	endloop
    call SaveUnitHandle(YDHT, h2i2, i, CreateUnit(GetOwningPlayer(u1), 'u000', x1, y1, a*bj_RADTODEG))
        if (( i > ( 5 + GetUnitAbilityLevel( u1, 'A01G') * 5 ) ) or (b ==true)) then
        	set b = true
        endif
    call SaveBoolean(YDHT, h2i, 0xA3098AE2, b)
else
	if ( u2 != null)then
    	set u3 = LoadUnitHandle(YDHT, h2i2,i)
    	set x1 = GetUnitX(u3)
    	set y1 = GetUnitY(u3)
    	call SetUnitX(u2,x1)
    	call SetUnitY(u2,y1)
    	call RemoveUnit(u3)
		set i = i - 1
    	call SaveInteger(YDHT, h2i, 0x9C0F555E, i)
    else
    	set u3 = LoadUnitHandle(YDHT, h2i2,i)
    	call RemoveUnit(u3)
    	set i = i - 1
    	call SaveInteger(YDHT, h2i, 0x9C0F555E, i)
    endif
    
    if ( i == 0 ) then
			call FlushChildHashtable(YDHT, h2i)
			call FlushChildHashtable(YDHT, h2i2)
			call DestroyTimer(t)
    endif
endif
set u1 = null
set u2 = null
set u3 = null
set ydl_unit = null
set t = null
endfunction
function Trig_A11EActions takes nothing returns nothing
    local timer t=CreateTimer()
    local integer h2i = GetHandleId(t)
	    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, GetTriggerUnit())
	    call SaveInteger(YDHT, h2i, 0x9C0F555E, 0)
	    call SaveBoolean(YDHT, h2i, 0xA3098AE2, false)
	    call SaveUnitHandle(YDHT, h2i, 0x9CD60476, null)
	    call TimerStart(t, 0.03, true, function Trig_A11EFunc004T)
    set t=null
endfunction
function Trig_A11EConditions takes nothing returns boolean
    if ((GetSpellAbilityId() == 'A01G')) then
	    call Trig_A11EActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_A11E takes nothing returns nothing
    set gg_trg_A11E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A11E, Condition(function Trig_A11EConditions))
endfunction//===========================================================================
// Trigger: A11T
//===========================================================================
function Trig_A11TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0E5'))
endfunction
function Trig_A11TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
local real x2 = x + 10*Cos(a)
local real y2 = y + 10*Sin(a)
local unit u3
call ShowUnit(u1, false)
	set u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',5.00)
	call UnitAddAbility( u3, 'A0E4' )
	call SetUnitAbilityLevel( u3, 'A0E4', GetUnitAbilityLevel(u1, 'A0E5') )
	call IssuePointOrder(u3,"stampede",x2,y2)
call TriggerSleepAction(3.50)
call ShowUnit(u1, true)
    if (GetLocalPlayer() == GetOwningPlayer(u1)) then
        // Use only local code (no net traffic) within this block to avoid desyncs.
        call ClearSelection()
        call SelectUnit(u1, true)
    endif
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_A11T takes nothing returns nothing
    set gg_trg_A11T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A11T, Condition(function Trig_A11TConditions))
    call TriggerAddAction(gg_trg_A11T, function Trig_A11TActions)
endfunction//===========================================================================
// Trigger: A12
//===========================================================================
function Trig_A12Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A12W_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A12E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A12R_Learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A12T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A12 takes nothing returns nothing
    set gg_trg_A12 = CreateTrigger()
    call TriggerAddAction(gg_trg_A12, function Trig_A12Actions)
endfunction
//===========================================================================
// Trigger: A12W start
//===========================================================================
function Trig_A12_W_startActions takes nothing returns nothing
local unit u1	= GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real x	= GetUnitX(u1)
local real y	= GetUnitY(u1)
local real x2	=	GetUnitX(u2)
local real y2	=	GetUnitY(u2)
local player	p	=	GetOwningPlayer(u1)
local integer i	=	GetPlayerId(p) + 1
    set udg_KnockBack_Angle = Atan2(y2 - y, x2 - x) * bj_RADTODEG
    set udg_KnockBack_Boolean1 = false
    set udg_KnockBack_Dist = 40.00
    set udg_KnockBack_Rate = 0.95
    set udg_KnockBack_Time = 1.50
    set udg_KnockBack_Unit = u2
    set udg_KnockBack_Interval = ( 0.25 / 10.00 )
    set udg_KnockBack_Trigger = gg_trg_A12W_end
    set udg_KnockBack_I2 =	i
    
    call TriggerExecute(gg_trg_KnockBack)
    
set u1 = null
set u2 = null
endfunction
function Trig_A12_W_startConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A01I' then
	    call Trig_A12_W_startActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_A12W_start takes nothing returns nothing
    set gg_trg_A12W_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_A12W_start, Condition(function Trig_A12_W_startConditions))
endfunction
//===========================================================================
// Trigger: A12W end
//===========================================================================
function Trig_A12W_endActions takes nothing returns nothing
local real x = GetUnitX(udg_KnockBack_Unit)
local real y = GetUnitY(udg_KnockBack_Unit)
local unit u1 = udg_S01_hero_of_player[udg_KnockBack_I2]
local player	p	= Player(udg_KnockBack_I2 - 1)	
local unit u3 = CreateUnit(p,'h02G',x,y,0)
	call ShowUnit( u3, false )
	call UnitApplyTimedLife(u3,'BHwe',1.00)
	call UnitAddAbility( u3, 'A01K' )
	call SetUnitAbilityLevel( u3, 'A01K', GetUnitAbilityLevel(u1, 'A01I') )
	call IssueImmediateOrder(u3,"thunderclap")
	call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Thunderclap\\ThunderClapCaster.mdl",x,y)) 
	
set u1 = null
set u3 = null
endfunction
function InitTrig_A12W_end takes nothing returns nothing
    set gg_trg_A12W_end=CreateTrigger()
    call TriggerAddAction(gg_trg_A12W_end, function Trig_A12W_endActions)
endfunction//===========================================================================
// Trigger: A12E
//===========================================================================
function Trig_A12EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A01M' ) )
endfunction
function Trig_A12EActions takes nothing returns nothing
local integer i = 1
local unit u1=GetTriggerUnit()
local unit u2=GetSpellTargetUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetUnitX(u2)
local real y1 = GetUnitY(u2)
local real a = Atan2(y1-y,x1-x)
local real x2 = x + 720.00*Cos(a)
local real y2 = y + 720.00*Sin(a)
local real x3
local real y3
local real x4
local real y4
call TriggerSleepAction(0.00)
call SetUnitPathing(u1,false)
	loop
		exitwhen i>(720/60)
		set x3 = x + 60.00*I2R(i)*Cos(a)
		set y3 = y + 60.00*I2R(i)*Sin(a)
		set x4 = x3 + 100.00*Cos(a)
		set y4 = y3 + 100.00*Sin(a)
			if(IsTerrainPathable(x4,y4,PATHING_TYPE_WALKABILITY))then
				set i = 100
			else
				call SetUnitPosition(u1,x3,y3)
				call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\MirrorImage\\MirrorImageCaster.mdl",x3,y3))
			endif
		
		set i=i+1
	endloop
call SetUnitPathing(u1,true)
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_A12E takes nothing returns nothing
    set gg_trg_A12E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A12E, Condition(function Trig_A12EConditions))
    call TriggerAddAction(gg_trg_A12E, function Trig_A12EActions)
endfunction//===========================================================================
// Trigger: A12R Learn
//===========================================================================
function Trig_A12R_LearnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A01N') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A01N') == 1) and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_A12R_LearnActions takes nothing returns nothing
    call UnitAddAbility( GetTriggerUnit(), 'A01O' )
    call TriggerRegisterUnitEvent(gg_trg_A12R, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
endfunction
//===========================================================================
function InitTrig_A12R_Learn takes nothing returns nothing
    set gg_trg_A12R_Learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A12R_Learn, Condition(function Trig_A12R_LearnConditions))
    call TriggerAddAction(gg_trg_A12R_Learn, function Trig_A12R_LearnActions)
endfunction
//===========================================================================
// Trigger: A12R
//===========================================================================
function Trig_A12RConditions takes nothing returns boolean
local unit u1 = GetTriggerUnit()
local unit u2 = GetEventTargetUnit()
local integer i =GetPlayerId(GetOwningPlayer(u1)) + 1
		if ((u2 != udg_A12R_U[i]) and (udg_A12R_U[i] != null ))then
			set udg_A12R_I[i]=1
		else
	    	if udg_A12R_I[i] < 1+5*GetUnitAbilityLevel(u1, 'A01N') then
	    		set udg_A12R_I[i]=udg_A12R_I[i]+1
	    	endif
		endif
	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\GryphonRiderMissile\\GryphonRiderMissile.mdl",u1,"weapon"))
	set udg_A12R_U[i]=u2
	call SetUnitAbilityLevel(u1,'A01O',udg_A12R_I[i])
set u1 = null
set u2 = null
return false
endfunction
function InitTrig_A12R takes nothing returns nothing
    set gg_trg_A12R=CreateTrigger()
    call TriggerAddCondition(gg_trg_A12R, Condition(function Trig_A12RConditions))
endfunction//===========================================================================
// Trigger: A12T
//===========================================================================
function Trig_A12TConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A01P' ) )
endfunction
function Trig_A12TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
	set udg_A12R_I[i]=(udg_A12R_I[i]+(2+(3*GetUnitAbilityLevel(u1,'A01P'))))
	set udg_A12R_U[i]=null
	call SetUnitAbilityLevel(u1,'A01O',udg_A12R_I[i])
	call UnitAddAbility(u1,'A01Q')
	call SetUnitPathing(u1, false)
	call TriggerSleepAction((9.00+(3.00*I2R(GetUnitAbilityLevel(u1,'A01P')))))
	call UnitRemoveAbility(u1,'A01Q')
	call SetUnitPathing(u1,true)
set u1 = null
endfunction
//===========================================================================
function InitTrig_A12T takes nothing returns nothing
    set gg_trg_A12T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A12T, Condition(function Trig_A12TConditions))
    call TriggerAddAction(gg_trg_A12T, function Trig_A12TActions)
endfunction//===========================================================================
// Trigger: A13
//===========================================================================
function Trig_A13Actions takes nothing returns nothing
    set udg_A13T_table[1] = 'I04F'
    set udg_A13T_table[2] = 'I04G'
    set udg_A13T_table[3] = 'I04H'
    call TriggerRegisterUnitEvent(gg_trg_A13R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A13T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A13 takes nothing returns nothing
    set gg_trg_A13 = CreateTrigger()
    call TriggerAddAction(gg_trg_A13, function Trig_A13Actions)
endfunction
//===========================================================================
// Trigger: A13R
//===========================================================================
function Trig_A13RConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A01V'))
endfunction
function Trig_A13RActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Remg', GetUnitAbilityLevelSwapped('A01V', GetTriggerUnit()), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_A13R takes nothing returns nothing
    set gg_trg_A13R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A13R, Condition(function Trig_A13RConditions))
    call TriggerAddAction(gg_trg_A13R, function Trig_A13RActions)
endfunction
//===========================================================================
// Trigger: A13T
//===========================================================================
function Trig_A13TConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A01W' ) )
endfunction
function Trig_A13T_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1131)
local integer i = GetUnitAbilityLevel(u1,'A01W')
	if(LoadInteger(YDHT, h2i, 1132) >=(12+(8*i))) or GetUnitState(u1, UNIT_STATE_LIFE) <= 1 then
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		call SaveInteger(YDHT, h2i, 1132, LoadInteger(YDHT, h2i, 1132) + 1)
		call UnitRemoveAbility(u1,'B01L')
		call RemoveItem(UnitAddItemById(u1,udg_A13T_table[i]))
	endif
set t =null
set u1 = null
endfunction
function Trig_A13TActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call SaveUnitHandle(YDHT, h2i, 1131, GetTriggerUnit())
    call SaveInteger(YDHT, h2i, 1132, 0)
    call TimerStart(t, 0.50, true, function Trig_A13T_timer)
set t = null
endfunction
//===========================================================================
function InitTrig_A13T takes nothing returns nothing
    set gg_trg_A13T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A13T, Condition(function Trig_A13TConditions))
    call TriggerAddAction(gg_trg_A13T, function Trig_A13TActions)
endfunction//===========================================================================
// Trigger: A14W
//===========================================================================
function Trig_A14WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
	local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',5.00)
	call UnitAddAbility( u3, 'A01Y' )
	call SetUnitAbilityLevel( u3, 'A01Y', GetUnitAbilityLevel(u1, 'A022') )
	call IssuePointOrder(u3,"clusterrockets",x1,y1)
set u1 = null
set u3 = null
endfunction
function Trig_A14WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A022' then
	    call Trig_A14WActions()
    endif
    return false
endfunction
function InitTrig_A14W takes nothing returns nothing
    set gg_trg_A14W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A14W, Condition(function Trig_A14WConditions))
endfunction//===========================================================================
// Trigger: A15
//===========================================================================
function Trig_A15Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A15R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A15T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A15 takes nothing returns nothing
    set gg_trg_A15 = CreateTrigger()
    call TriggerAddAction(gg_trg_A15, function Trig_A15Actions)
endfunction
//===========================================================================
// Trigger: A15R
//===========================================================================
function Trig_A15RConditions takes nothing returns boolean
    return ( ( GetUnitAbilityLevel(GetTriggerUnit(), 'A025') != 0 ) and ( ( GetSpellAbilityId() == 'A023' ) or ( GetSpellAbilityId() == 'A024' ) or ( GetSpellAbilityId() == 'A02Y' ) ) )
endfunction
function Trig_A15RActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 
local real y1
local unit ydl_unit
local real dmg = I2R(GetHeroInt(u1, true))*1.70
local player p = GetOwningPlayer(u1)
	    if ( ( ( GetSpellAbilityId() == 'A023' ) or ( GetSpellAbilityId() == 'A02Y' ) ) ) then
			set x1 = GetSpellTargetX()
			set y1 = GetSpellTargetY()
		    
	    else
	    	set x1 = GetUnitX(GetSpellTargetUnit())
	   	    set y1 = GetUnitY(GetSpellTargetUnit())
	    endif
    call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 400.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null) 
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
        			call UnitDamageTargetBJ(u1,ydl_unit,dmg,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL)
        			call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\DeathPactTarget.mdx",ydl_unit,"chest"))
        		endif
    	endloop
set p = null
set u1 = null
set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_A15R takes nothing returns nothing
    set gg_trg_A15R=CreateTrigger()
    call TriggerAddCondition(gg_trg_A15R, Condition(function Trig_A15RConditions))
    call TriggerAddAction(gg_trg_A15R, function Trig_A15RActions)
endfunction//===========================================================================
// Trigger: A15T
//===========================================================================
globals
real array A15T_X
real array A15T_Y	
endglobals	
function Trig_A15TConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A02Y' ) )
endfunction
function Trig_A15T_timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i2 = GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u3
local real x = A15T_X[i2]
local real y = A15T_Y[i2]	
local real a =LoadReal(YDHT, h2i, 3)*bj_RADTODEG
local real x2
local real y2
local integer i =1 
local integer index = LoadInteger(YDHT, h2i, 2)
local player user = GetOwningPlayer(u1)
local integer level = GetUnitAbilityLevel(u1, 'A02Y')
	if(index>=25)then
    	call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		call SaveInteger(YDHT, h2i, 2, index+1)
    	loop
    		exitwhen i>3
    		set x2 = x+100.00*I2R(index)*Cos(((a-36.00)+(18.00*I2R(i)))*bj_DEGTORAD)
    		set y2 = y+100.00*I2R(index)*Sin(((a-36.00)+(18.00*I2R(i)))*bj_DEGTORAD)
    		set u3 = CreateUnit(user,'h037',x2,y2,0)
    		call UnitApplyTimedLife(u3,'BHwe',12.00)
    		call SetUnitAbilityLevel(u3, 'A02V', level)
    		set i=i+1
    	endloop
	endif
set u1 = null
set u3 = null
set t =null
set user = null
endfunction
function Trig_A15TActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1=GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    call SaveUnitHandle(YDHT, h2i, 1, GetTriggerUnit())
    call SaveInteger(YDHT, h2i, 2, 0)
    call SaveReal(YDHT, h2i, 3, a) 
    set A15T_X[i]=x
    set A15T_Y[i]=y
    call TimerStart(t, 0.02, true, function Trig_A15T_timer)
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_A15T takes nothing returns nothing
    set gg_trg_A15T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A15T, Condition(function Trig_A15TConditions))
    call TriggerAddAction(gg_trg_A15T, function Trig_A15TActions)
endfunction//===========================================================================
// Trigger: A16
//===========================================================================
function Trig_A16Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A16D, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A16E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A16R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A16R_summon, udg_A_common_HERO, EVENT_UNIT_SUMMON)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A16T_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A16 takes nothing returns nothing
    set gg_trg_A16 = CreateTrigger()
    call TriggerAddAction(gg_trg_A16, function Trig_A16Actions)
endfunction
//===========================================================================
// Trigger: A16D
//===========================================================================
function Trig_A16DConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A02R' and IsUnitIllusion(GetTriggerUnit()) != true then
   		call SetUnitAbilityLevel( GetTriggerUnit(), 'A027', GetUnitAbilityLevel(GetTriggerUnit(), 'A02R') + 1 ) 
    endif
    return false
endfunction
//===========================================================================
function InitTrig_A16D takes nothing returns nothing
    set gg_trg_A16D = CreateTrigger()
    call TriggerAddCondition(gg_trg_A16D, Condition(function Trig_A16DConditions))
endfunction
//===========================================================================
// Trigger: A16E 
//===========================================================================
function Trig_A16EActions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local unit u2=GetSpellTargetUnit()
local real x1 = GetUnitX(u2)
local real y1 = GetUnitY(u2)
local unit ydl_unit
local integer level = GetUnitAbilityLevel(u1,'A0GY')
local real r=GetUnitState(u2,UNIT_STATE_MANA)* (0.10+(0.05*I2R(level)))
local player p = GetOwningPlayer(u1)
local real dmg = 100.00 + r
local texttag tt
local string s = I2S(R2I(dmg))
local integer green = ROSE_PercentTo255(30.00)
local integer red = ROSE_PercentTo255(30.00)
local integer blue = ROSE_PercentTo255(100.00)
local integer transparency = ROSE_PercentTo255(100.0)
local real vel = 64 * 0.071 / 128
local real xvel = vel * Cos(90 * bj_DEGTORAD)
local real yvel = vel * Sin(90 * bj_DEGTORAD)
	//減少魔法
	call SetUnitState(u2, UNIT_STATE_MANA, GetUnitState(u2,UNIT_STATE_MANA)-r )
	//製造漂浮文字
    set tt = CreateTextTag()
    call SetTextTagText(tt, s , 10.00 * 0.023 / 10)
    call SetTextTagPosUnit(tt, u2, 0)
	call SetTextTagColor(tt, green, red, blue, transparency )
	call SetTextTagPermanent(tt,false)
	call SetTextTagLifespan(tt,2.00)
	call SetTextTagFadepoint(tt,2.00)
	call SetTextTagVelocity(tt, xvel, yvel)
		//是否顯示漂浮文字
		//Q1.一開始建造 就大家都看得到?
		// 測試結果 是的。
	    if IsUnitInvisible(u1,GetLocalPlayer()) then
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call SetTextTagVisibility(tt, false)
	    endif
	//range dmg
    call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 600.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null) 
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false then
        			call UnitDamageTarget(u1,ydl_unit,dmg, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
        			call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\GreenDragonMissile\\GreenDragonMissile.mdl",ydl_unit,"chest"))
        		endif
    	endloop
	set p = null
    set u1 = null
    set u2 = null
    set ydl_unit=null
    set tt = null
    set s = null
endfunction
function Trig_A16EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0GY' then
	    call Trig_A16EActions()
    endif
    return false
endfunction
function InitTrig_A16E takes nothing returns nothing
    set gg_trg_A16E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A16E, Condition(function Trig_A16EConditions))
endfunction//===========================================================================
// Trigger: A16R learn
//===========================================================================
function Trig_A16R_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A02S' and IsUnitIllusion(GetTriggerUnit()) != true then
	    call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()), 'Robs', GetUnitAbilityLevel(GetTriggerUnit(), 'A02S'))
    endif
    return false
endfunction
//===========================================================================
function InitTrig_A16R_learn takes nothing returns nothing
    set gg_trg_A16R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A16R_learn, Condition(function Trig_A16R_learnConditions))
endfunction
//===========================================================================
// Trigger: A16R summon
//===========================================================================
function Trig_A16R_summonConditions takes nothing returns boolean
    if GetUnitTypeId(GetSummonedUnit()) == 'n02I' then
	    call SetUnitAbilityLevel( GetSummonedUnit(), 'A02U', GetUnitAbilityLevel(GetTriggerUnit(), 'A02S') )
    endif
    return false
endfunction
function InitTrig_A16R_summon takes nothing returns nothing
    set gg_trg_A16R_summon = CreateTrigger()
    call TriggerAddCondition(gg_trg_A16R_summon, Condition(function Trig_A16R_summonConditions))
endfunction
//===========================================================================
// Trigger: A16T start
//===========================================================================
function Trig_A16T_startFunc006T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u2 =LoadUnitHandle(YDHT, h2i, 1)
local player p = GetOwningPlayer(u2)
	if LoadInteger(YDHT, h2i, 2) >= 24 then
		call DestroyEffect(LoadEffectHandle(YDHT, h2i, 3))
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		call SaveInteger(YDHT, h2i, 2, LoadInteger(YDHT, h2i, 2) + 1 ) 
			//Move
		    if GetPlayerId(p) + 1 <= 5 then 
				call IssuePointOrder(u2,"move",7000,-7000)
		    else 
				call IssuePointOrder(u2,"move",-7000,7000)
		    endif
		    //不能操控
	    	if GetLocalPlayer() == p then
	        	// Use only local code (no net traffic) within this block to avoid desyncs.
	        	call SelectUnit(u2, false)
	    	endif 
	endif
set p = null
set t = null
set u2 = null
endfunction
function Trig_A16T_startActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call SaveUnitHandle(YDHT, h2i, 1, GetSpellTargetUnit())
    call SaveInteger(YDHT, h2i, 2, 0)
    call SaveEffectHandle(YDHT, h2i, 3,AddSpecialEffectTarget("Abilities\\Spells\\Other\\TalkToMe\\TalkToMe.mdl",GetSpellTargetUnit(),"overhead")) 
    call TimerStart(t, 0.25, true, function Trig_A16T_startFunc006T)
set t = null
endfunction
function Trig_A16T_startConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A09B' then
	    call Trig_A16T_startActions()
    endif
    return false
endfunction
function InitTrig_A16T_start takes nothing returns nothing
    set gg_trg_A16T_start=CreateTrigger()
    call TriggerAddCondition(gg_trg_A16T_start, Condition(function Trig_A16T_startConditions))
endfunction//===========================================================================
// Trigger: A17
//===========================================================================
function Trig_A17Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A17E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A17R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A17T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
endfunction
//===========================================================================
function InitTrig_A17 takes nothing returns nothing
    set gg_trg_A17 = CreateTrigger()
    call TriggerAddAction(gg_trg_A17, function Trig_A17Actions)
endfunction
//===========================================================================
// Trigger: A17E 
//===========================================================================
function Trig_A17EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A02M' ) )
endfunction
function Trig_A17EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x1,y1,0)
call ShowUnit( u3, false )
call UnitApplyTimedLife(u3,'BHwe',2.00)
call UnitAddAbility( u3, 'A02N' )
call SetUnitAbilityLevel( u3, 'A02N', GetUnitAbilityLevel(u1, 'A02M') )
call IssueImmediateOrder(u3, "stomp")
    call UnitAddAbility(u1, 'A02O')
    call SetUnitAbilityLevel(u1, 'A02O', GetUnitAbilityLevel(u1, 'A02M'))
    call TriggerSleepAction(8.00)
    call UnitRemoveAbility(u1, 'A02O')
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_A17E takes nothing returns nothing
    set gg_trg_A17E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A17E, Condition(function Trig_A17EConditions))
    call TriggerAddAction(gg_trg_A17E, function Trig_A17EActions)
endfunction//===========================================================================
// Trigger: A17R 
//===========================================================================
function Trig_A17RConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A02P'))
endfunction
function Trig_A17RActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rolf', GetUnitAbilityLevel(GetTriggerUnit(), 'A02P'), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_A17R takes nothing returns nothing
    set gg_trg_A17R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A17R, Condition(function Trig_A17RConditions))
    call TriggerAddAction(gg_trg_A17R, function Trig_A17RActions)
endfunction
//===========================================================================
// Trigger: A17T
//===========================================================================
function A17T_1_2 takes nothing returns nothing
	local trigger	ltt =	GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 =	LoadUnitHandle(YDHT, h2i, 1)
	local real x = GetUnitX(u1)
	local real y = GetUnitY(u1)
	local integer	i =	LoadInteger(YDHT, h2i, 2)
	local player p = GetOwningPlayer(u1)
	local boolean	b =	LoadBoolean(YDHT, h2i, 3)
	local real dmg =	LoadReal(YDHT, h2i, 4)
	local unit u3
	local unit ydl_unit
    
		if i	>=	70 then
	
    		
    		call UnitRemoveAbility( u1, 'A00W' )
    		call UnitRemoveAbility( u1, 'A0XR' )
			//准許攻擊力
    		call UnitRemoveAbility( u1, 'Abun' )
    		//准許技能
			call SetPlayerAbilityAvailable( p,'A0XX', true )
				//一定要這樣、不然會創造兩隻
				if	b	==	false	then
					//技能准許
			    	set udg_AbilityAvailable[GetPlayerId(p)	+	1] = CreateUnit(p, 'h006', 3108.00, 8659.00, 0)
				endif
    		//停止播放旋轉動畫
			call AddUnitAnimationProperties( u1, "spin", false )
			call FlushChildHashtable(YDHT, h2i)
			call DestroyTrigger(ltt) 
			  
		else
			//DEMAGE
			if	b	==	false	and GetUnitState(u1, UNIT_STATE_LIFE) > 0 then
				call GroupEnumUnitsInRange(udg_Group[3], x, y, 400.00, null)
			    loop
			        set ydl_unit = FirstOfGroup(udg_Group[3])
			        exitwhen ydl_unit == null
			        call GroupRemoveUnit(udg_Group[3], ydl_unit)
			        if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 then
			            call UnitDamageTarget( u1, ydl_unit, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_ENHANCED, WEAPON_TYPE_WHOKNOWS )
			        endif
			    endloop
			endif
			if	ModuloInteger(i,3)==0	then
				set u3 = CreateUnit(p,'hmpr',x,y,0)
				call UnitApplyTimedLife(u3,'BHwe',3.00)
			endif
			
		endif
		call SaveInteger(YDHT, h2i, 2, i	+	1)
	set ltt = null
	set u1 = null
	set u3 = null
	set ydl_unit = null
	set p =	null
endfunction
function A17T_1_1 takes nothing returns nothing
	local trigger	ltt =	GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 =	LoadUnitHandle(YDHT, h2i, 1)
	local player p = GetOwningPlayer(u1)
	local integer	i =	GetPlayerId(p)	+	1
	
		call SaveBoolean(YDHT, h2i, 3, true)
		//停止播放旋轉動畫
		call AddUnitAnimationProperties( u1, "spin", false )
		call UnitRemoveAbility( u1, 'A0XR' )
		//准許攻擊力
    	call UnitRemoveAbility( u1, 'Abun' )
		//准許技能
		call SetPlayerAbilityAvailable( p,'A0XX', true )
		//技能准許
	    set udg_AbilityAvailable[i] = CreateUnit(p, 'h006', 3108.00, 8659.00, 0)
 
			
	set ltt = null
	set u1 =	null
	set p =	null
endfunction
function A17T_1 takes nothing returns nothing
	//TIME
	if	GetTriggerUnit()==null then	
		call A17T_1_2 ()
	//ORDER
	//ABILITY FOR STOP
	elseif	GetSpellAbilityId() == 'A0XR'	then
		call A17T_1_1 ()
	endif
endfunction
function Trig_A17T_startActions takes nothing returns nothing
	local unit u	=	GetTriggerUnit()
	local player	p	=	GetOwningPlayer(u)
	local integer	id	=	'Abun'
	local integer	id2	=	'A00W'
	local integer	id3	=	'A0XR'
	local integer	id4	=	GetSpellAbilityId()
	local integer	level	=	GetUnitAbilityLevel(u,id4)
	local real dmg =	29	+	11	*	level
	local integer	i =	GetPlayerId(p)	+	1
	
	//註冊觸發	
	local trigger	ltt =	CreateTrigger()
	local integer h2i = GetHandleId(ltt)
		
		call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT)
		call TriggerRegisterTimerEvent(ltt, 0.10, true)
		call TriggerAddCondition(ltt, Condition(function A17T_1))
	    call SaveUnitHandle(YDHT, h2i, 1, u)
	    call SaveInteger(YDHT, h2i, 2, 0)
	    call SaveBoolean(YDHT, h2i, 3, false)
	    call SaveReal(YDHT, h2i, 4, dmg)
	    //技能禁止 - W,E
	    call RemoveUnit(udg_AbilityAvailable[i])
		//等待_身完
		//call TriggerSleepAction(0.2)	
		//播放旋轉動畫
		call AddUnitAnimationProperties( u, "spin", true )
		//給予技能 - 魔免、攻擊為0、停止
		call UnitAddAbility( u, id )
    	call UnitAddAbility( u, id2)
    	call UnitAddAbility( u, id3)
    	//靜止技能
    	call SetPlayerAbilityAvailable( p, id4, false )
	    
	set	p	=	null
	set	u	=	null 
	set	ltt	=	null
endfunction
function Trig_A17T_startConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0XX'	then
	    call Trig_A17T_startActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_A17T takes nothing returns nothing
    set gg_trg_A17T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A17T, Condition(function Trig_A17T_startConditions))
endfunction//===========================================================================
// Trigger: A18
//===========================================================================
function Trig_A18Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A18D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A18E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A18R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A18T_Time, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_A18T_Demage, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_DEATH)
endfunction
//===========================================================================
function InitTrig_A18 takes nothing returns nothing
    set gg_trg_A18 = CreateTrigger()
    call TriggerAddAction(gg_trg_A18, function Trig_A18Actions)
endfunction
//===========================================================================
// Trigger: A18D
//===========================================================================
function Trig_A18DConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0HS' ) )
endfunction
function Trig_A18DActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local unit u3
local real a 
local real x1 
local real y1 
local real life = (60.00+(30.00*I2R(GetUnitAbilityLevel(u1,'A0HS'))))
	set a = GetRandomReal(0, 360)*bj_DEGTORAD
	set x1 = x + 100.00*Cos(a)
	set y1 = y + 100.00*Sin(a) 
	set u3 = CreateUnit(GetOwningPlayer(u1),'nglm',x1,y1,GetRandomReal(0, 360))
	call UnitApplyTimedLife(u3,'BHwe',life)
	set a = GetRandomReal(0, 360)*bj_DEGTORAD
	set x1 = x + 100.00*Cos(a)
	set y1 = y + 100.00*Sin(a) 
	set u3 = CreateUnit(GetOwningPlayer(u1),'nglm',x1,y1,GetRandomReal(0, 360))
	call UnitApplyTimedLife(u3,'BHwe',life)
set u1 = null
set u3 = null
endfunction
function InitTrig_A18D takes nothing returns nothing
    set gg_trg_A18D=CreateTrigger()
    call TriggerAddCondition(gg_trg_A18D, Condition(function Trig_A18DConditions))
    call TriggerAddAction(gg_trg_A18D, function Trig_A18DActions)
endfunction//===========================================================================
// Trigger: A18E
//===========================================================================
function Trig_A18_E_startActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local player p = GetOwningPlayer(u1)
local real level = ( 0.50 + ( 0.30 * I2R(GetUnitAbilityLevel(u1, GetSpellAbilityId())) ) )
local real x2
local real y2
local real a
local unit ydl_unit
    	call GroupEnumUnitsInRange(udg_Group[7], x, y, 350.00, null)
    		loop
    			set ydl_unit=FirstOfGroup(udg_Group[7])
    			exitwhen ( ydl_unit == null )
        		call GroupRemoveUnit(udg_Group[7], ydl_unit)
        			if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) and ( IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false ) and ( IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false ) and ( GetUnitPointValue(ydl_unit) != 1 ) ) then
        				set x2=GetUnitX(ydl_unit)
        				set y2=GetUnitY(ydl_unit)
        				set a=Atan2(y2 - y, x2 - x) * bj_RADTODEG
        				set udg_KnockBack_Angle=a
       	 				set udg_KnockBack_Boolean1=false
        				set udg_KnockBack_Dist=20.00
        				set udg_KnockBack_Rate=0.95
        				set udg_KnockBack_Time=level
        				set udg_KnockBack_Unit=ydl_unit
        				set udg_KnockBack_Interval=( 0.20 / 10.00 )
        				set udg_KnockBack_I2=1
            			set udg_KnockBack_Trigger=udg_Trigger_null
            			call UnitDamageTarget(u1, ydl_unit, 200.00, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC , WEAPON_TYPE_WHOKNOWS)	
        				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Incinerate\\FireLordDeathExplode.mdl" , ydl_unit, "chest"))
        				call TriggerExecute(gg_trg_KnockBack)
        			endif
        	endloop 
        		
set p = null 
set u1 =	null
set ydl_unit	=	null
endfunction
function Trig_A18_E_startConditions takes nothing returns boolean
    if ((GetSpellAbilityId() == 'A05H'))	then
		call	Trig_A18_E_startActions()
	endif
    return	false
endfunction
//===========================================================================
function InitTrig_A18E takes nothing returns nothing
    set gg_trg_A18E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A18E, Condition(function Trig_A18_E_startConditions))
endfunction
//===========================================================================
// Trigger: A18R
//===========================================================================
function Trig_A18RConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A02C') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_A18RActions takes nothing returns nothing
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A0HS', ( GetUnitAbilityLevelSwapped('A02C', GetTriggerUnit()) + 1 ) )
endfunction
//===========================================================================
function InitTrig_A18R takes nothing returns nothing
    set gg_trg_A18R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A18R, Condition(function Trig_A18RConditions))
    call TriggerAddAction(gg_trg_A18R, function Trig_A18RActions)
endfunction
//===========================================================================
// Trigger: A18T_Time
//===========================================================================
function Trig_A18T_TimeConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0NB' ) )
endfunction
function Trig_A18T_TimeActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
	set udg_A18T_I[i]=udg_A18T_I[i]+1
		if udg_A18T_I[i] ==2 then
			set udg_A18T_E[i]=AddSpecialEffectTarget("Abilities\\Weapons\\BatTrollMissile\\BatTrollMissile.mdl", u1, "overhead")
	    else
	    	if udg_A18T_I[i] ==3 then 
		    	call DestroyEffect(udg_A18T_E[i])
			endif
		endif	
set u1 = null
endfunction
function InitTrig_A18T_Time takes nothing returns nothing
    set gg_trg_A18T_Time=CreateTrigger()
    call TriggerAddCondition(gg_trg_A18T_Time, Condition(function Trig_A18T_TimeConditions))
    call TriggerAddAction(gg_trg_A18T_Time, function Trig_A18T_TimeActions)
endfunction//===========================================================================
// Trigger: A18T_Demage
//===========================================================================
function Trig_A18T_DemageConditions takes nothing returns boolean
    return ( ( GetUnitTypeId(GetTriggerUnit()) == 'n009' ) )
endfunction
function Trig_A18T_DemageActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local player p = GetOwningPlayer(u1)
local integer i =GetConvertedPlayerId(p)
local unit ydl_unit
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real r = ((100.00+(60.00*I2R(GetUnitAbilityLevel(udg_S01_hero_of_player[i],'A0NB'))))+(10.00*I2R(GetHeroLevel(udg_S01_hero_of_player[i]))))
local unit u3 
local boolean b =false
	if udg_A18T_I[i] ==3 then
		set b = true
		set udg_A18T_I[i]=0
		set u3 = CreateUnit(p,'h02G',x,y,0)
		call UnitApplyTimedLife(u3,'BHwe',2.00) 
		call UnitAddAbility( u3, 'A0HP' )	
	endif
	    call GroupEnumUnitsInRange(udg_Group[0], x, y, 350.00, null)
	    	loop
	    		set ydl_unit = FirstOfGroup(udg_Group[0])
	    		exitwhen (ydl_unit == null) 
	        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
	        		if (GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_MECHANICAL)==false) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) and (GetUnitPointValue(ydl_unit) != 1) ) then
	       				call UnitDamageTargetBJ(udg_S01_hero_of_player[i],ydl_unit,r,ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
		       				if b then
		        				call IssueTargetOrder(u3,"thunderbolt",ydl_unit)
		        			endif	
	        		endif
	    	endloop
set p = null
set u1 = null
set u3 = null
set ydl_unit=null
endfunction
function InitTrig_A18T_Demage takes nothing returns nothing
    set gg_trg_A18T_Demage=CreateTrigger()
    call TriggerAddCondition(gg_trg_A18T_Demage, Condition(function Trig_A18T_DemageConditions))
    call TriggerAddAction(gg_trg_A18T_Demage, function Trig_A18T_DemageActions)
endfunction//===========================================================================
// Trigger: A19
//===========================================================================
function Trig_A19Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A19W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A19E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A19R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    set udg_A19_Item[0] = 'I02X'
    set udg_A19_Item[1] = 'I02M'
    set udg_A19_Item[2] = 'I02K'
    set udg_A19_Item[3] = 'I02B'
endfunction
//===========================================================================
function InitTrig_A19 takes nothing returns nothing
    set gg_trg_A19 = CreateTrigger()
    call TriggerAddAction(gg_trg_A19, function Trig_A19Actions)
endfunction
//===========================================================================
// Trigger: A19W
//===========================================================================
function Trig_A19WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A02D'))
endfunction
function Trig_A19WActions takes nothing returns nothing
    call UnitAddItemByIdSwapped( udg_A19_Item[( GetUnitAbilityLevelSwapped('A02D', GetTriggerUnit()) - 1 )], GetTriggerUnit() )
    call RemoveItem( GetLastCreatedItem() )
endfunction
//===========================================================================
function InitTrig_A19W takes nothing returns nothing
    set gg_trg_A19W = CreateTrigger()
    call TriggerAddCondition(gg_trg_A19W, Condition(function Trig_A19WConditions))
    call TriggerAddAction(gg_trg_A19W, function Trig_A19WActions)
endfunction
//===========================================================================
// Trigger: A19E
//===========================================================================
function Trig_A19EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A02E' ) )
endfunction
function Trig_A19EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local unit u3 = CreateUnit(GetOwningPlayer(u1),'o00E',x,y,0)
call UnitApplyTimedLife(u3,'BTLF',16.00)
call SetUnitAbilityLevel( u3, 'A02F', GetUnitAbilityLevel(u1, 'A02E') )
call SetUnitAbilityLevel( u3, 'A0KR', GetUnitAbilityLevel(u1, 'A02E') )
call IssueTargetOrder(u3, "bloodlust", u1)
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_A19E takes nothing returns nothing
    set gg_trg_A19E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A19E, Condition(function Trig_A19EConditions))
    call TriggerAddAction(gg_trg_A19E, function Trig_A19EActions)
endfunction//===========================================================================
// Trigger: A19R
//===========================================================================
function Trig_A19RConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A00J') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_A19RActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rosp', GetUnitAbilityLevelSwapped('A00J', GetTriggerUnit()), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_A19R takes nothing returns nothing
    set gg_trg_A19R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A19R, Condition(function Trig_A19RConditions))
    call TriggerAddAction(gg_trg_A19R, function Trig_A19RActions)
endfunction
//===========================================================================
// Trigger: A20
//===========================================================================
function Trig_A20Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A20W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A20E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A20R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A20T, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    call TriggerRegisterUnitEvent(gg_trg_A20T_creat, udg_A_common_HERO, EVENT_UNIT_SUMMON)
endfunction
//===========================================================================
function InitTrig_A20 takes nothing returns nothing
    set gg_trg_A20 = CreateTrigger()
    call TriggerAddAction(gg_trg_A20, function Trig_A20Actions)
endfunction
//===========================================================================
// Trigger: A20W
//===========================================================================
function Trig_A20WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A02G' ) )
endfunction
function Trig_A20WActions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit() 
local unit u2 = GetSpellTargetUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetUnitX(u2)
local real y1 = GetUnitY(u2)
local real x2 
local real y2
local real a
local player p = GetOwningPlayer(u1)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
call UnitApplyTimedLife(u3,'BHwe',1.00)
call UnitAddAbility( u3, 'A0K1' )
call SetUnitAbilityLevel( u3, 'A0K1', GetUnitAbilityLevel(u1, 'A02G') )
    call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 500.00, null)
    loop
    	set ydl_unit = FirstOfGroup(udg_Group[0])
    	exitwhen (ydl_unit == null) 
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( IsUnitIllusion(ydl_unit)==false and IsUnitEnemy(ydl_unit,p)) then
        			call IssueTargetOrder(u3,"hex",ydl_unit)
        		endif
    endloop
    set p = null
    set u1 = null 
    set u3 = null
    set ydl_unit=null 
endfunction
function InitTrig_A20W takes nothing returns nothing
    set gg_trg_A20W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A20W, Condition(function Trig_A20WConditions))
    call TriggerAddAction(gg_trg_A20W, function Trig_A20WActions)
endfunction//===========================================================================
// Trigger: A20E
//
// 'A03H'
// 'A03I'
//===========================================================================
function Trig_A20E_STARTConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0JO' ) )
endfunction
function Trig_A20E_Spell_Target takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local unit u2 =LoadUnitHandle(YDHT, h2i, 2)
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
call UnitApplyTimedLife(u3,'BHwe',3.00)
	if LoadInteger(YDHT, h2i, 3)>=6 then
	  	call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t) 
	else
		call SaveInteger(YDHT, h2i,3,LoadInteger(YDHT, h2i, 3)+1)
	    if IsUnitAlly(u2,GetOwningPlayer(u1)) then
	    	call UnitAddAbility( u3, 'A02H' )
	    	call SetUnitAbilityLevel( u3, 'A02H', GetUnitAbilityLevel(u1, 'A0JO') )
	    	call IssueTargetOrder(u3, "healingwave", u2)
	    else
	    	call UnitAddAbility( u3, 'A0JU' )
	    	call SetUnitAbilityLevel( u3, 'A0JU', GetUnitAbilityLevel(u1, 'A0JO') )
	    	call IssueTargetOrder(u3, "chainlightning", u2)
	    endif
	endif	
set t = null
set u1 = null
set u2 = null
set u3 = null
endfunction
function Trig_A20E_STARTActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1=GetTriggerUnit()
local unit u2=GetSpellTargetUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
call UnitApplyTimedLife(u3,'BHwe',3.00)
    //first spell 
    	if IsUnitAlly(u2,GetOwningPlayer(u1)) then
	    	call UnitAddAbility( u3, 'A02H' )
	    	call SetUnitAbilityLevel( u3, 'A02H', GetUnitAbilityLevel(u1, 'A0JO') )
	    	call IssueTargetOrder(u3, "healingwave", u2)
	    else
	    	call UnitAddAbility( u3, 'A0JU' )
	    	call SetUnitAbilityLevel( u3, 'A0JU', GetUnitAbilityLevel(u1, 'A0JO') )
	    	call IssueTargetOrder(u3, "chainlightning", u2)
	    endif
	//for time    
	call SaveUnitHandle(YDHT, h2i, 1, u1)
    call SaveUnitHandle(YDHT, h2i, 2, u2)
    call SaveInteger(YDHT, h2i,3,0)
    call TimerStart(t, 1.00, true, function Trig_A20E_Spell_Target)
set t=null
set u1 = null
set u2 = null
endfunction
function InitTrig_A20E takes nothing returns nothing
    set gg_trg_A20E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A20E, Condition(function Trig_A20E_STARTConditions))
    call TriggerAddAction(gg_trg_A20E, function Trig_A20E_STARTActions)
endfunction//===========================================================================
// Trigger: A20R
//===========================================================================
function Trig_A20RConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A02K' ) )
endfunction
function Trig_A20RActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
	local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',4.00)
	call UnitAddAbility( u3, 'A02J' )
	call SetUnitAbilityLevel( u3, 'A02J', GetUnitAbilityLevel(u1, 'A02K') )
	call IssuePointOrder(u3,"blizzard",x,y) 
	call UnitAddAbility(u3, 'A02I')
set u1 = null
set u3 = null
endfunction
function InitTrig_A20R takes nothing returns nothing
    set gg_trg_A20R=CreateTrigger()
    call TriggerAddCondition(gg_trg_A20R, Condition(function Trig_A20RConditions))
    call TriggerAddAction(gg_trg_A20R, function Trig_A20RActions)
endfunction//===========================================================================
// Trigger: A20T 
//===========================================================================
function Trig_A20TConditions takes nothing returns boolean
    return ((GetHeroLevel(GetTriggerUnit()) > 6))
endfunction
function Trig_A20TActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rows', ( ( GetHeroLevel(GetTriggerUnit()) - 6 ) / 2 ), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_A20T takes nothing returns nothing
    set gg_trg_A20T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A20T, Condition(function Trig_A20TConditions))
    call TriggerAddAction(gg_trg_A20T, function Trig_A20TActions)
endfunction
//===========================================================================
// Trigger: A20T creat
//===========================================================================
function Trig_A20T_creatConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetSummonedUnit()) == 'hphx'))
endfunction
function Trig_A20T_creatActions takes nothing returns nothing
    call SetUnitAbilityLevelSwapped( 'Apxf', GetTriggerUnit(), GetUnitAbilityLevel(GetTriggerUnit(), 'A048') )
endfunction
//===========================================================================
function InitTrig_A20T_creat takes nothing returns nothing
    set gg_trg_A20T_creat = CreateTrigger()
    call TriggerAddCondition(gg_trg_A20T_creat, Condition(function Trig_A20T_creatConditions))
    call TriggerAddAction(gg_trg_A20T_creat, function Trig_A20T_creatActions)
endfunction
//===========================================================================
// Trigger: A21
//===========================================================================
function Trig_A21Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A21W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A21T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call EnableTrigger( gg_trg_A21R )
endfunction
//===========================================================================
function InitTrig_A21 takes nothing returns nothing
    set gg_trg_A21 = CreateTrigger()
    call TriggerAddAction(gg_trg_A21, function Trig_A21Actions)
endfunction
//===========================================================================
// Trigger: A21W
//===========================================================================
function Trig_A21WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A034' ) )
endfunction
function Trig_A21WActions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit()
local player p = GetOwningPlayer(u1)
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',10.00)
	call UnitAddAbility( u3, 'A035' )
	call SetUnitAbilityLevel( u3, 'A035', GetUnitAbilityLevel(u1, 'A034') )
    call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 410.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen (ydl_unit == null) 
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( IsUnitEnemy(ydl_unit,p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
        			call IssueTargetOrder(u3,"shadowstrike",ydl_unit)
       			endif
    	endloop
set p = null
set u1 = null 
set u3 = null
set ydl_unit=null 
endfunction
//===========================================================================
function InitTrig_A21W takes nothing returns nothing
    set gg_trg_A21W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A21W, Condition(function Trig_A21WConditions))
    call TriggerAddAction(gg_trg_A21W, function Trig_A21WActions)
endfunction//===========================================================================
// Trigger: A21R
//===========================================================================
function Trig_A21RConditions takes nothing returns boolean
    return (GetUnitAbilityLevel(GetTriggerUnit(), 'B016') > 0)
endfunction
function Trig_A21RActions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit() 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
////////////////////////////////////////////////////////////////////
//Special : when one player , hide caster AI will start
///////////////////////////////////////////////////////////////////
local unit u3 = CreateUnit(GetOwningPlayer(GetTriggerUnit()),'h02G',x,y,0)
call ShowUnit( u3, false )
call UnitApplyTimedLife(u3,'BHwe',4.00)
call UnitAddAbility( u3, 'A0I9' )
call IssueTargetOrderById( u3, 852075, u1 )
//effect
call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\FaerieDragonInvis\\FaerieDragon_Invis.mdl", u1, "overhead") )
//check
    call GroupEnumUnitsInRange(udg_Group[0], x, y, 700.00, null)
    loop
        set ydl_unit = FirstOfGroup(udg_Group[0])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[0], ydl_unit)
        	if ((GetUnitPointValue(ydl_unit) == 121) and (IsUnitIllusion(ydl_unit) != true) and (IsUnitEnemy(u1, GetOwningPlayer(ydl_unit)) == true) and (GetUnitAbilityLevel(ydl_unit, 'A037') != 0)) then
            	call SetUnitState(u1, UNIT_STATE_MANA,( ( GetUnitState(u1, UNIT_STATE_MANA) + 7.00 ) - ( 7.00 * I2R(GetUnitAbilityLevel(ydl_unit, 'A037')) ) ))
        	endif
    endloop
set u3 = null
set u1 = null
set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_A21R takes nothing returns nothing
    set gg_trg_A21R = CreateTrigger()
    call DisableTrigger(gg_trg_A21R)
    call TriggerRegisterAnyUnitEventBJ( gg_trg_A21R, EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition(gg_trg_A21R, Condition(function Trig_A21RConditions))
    call TriggerAddAction(gg_trg_A21R, function Trig_A21RActions)
endfunction//===========================================================================
// Trigger: A21T
//===========================================================================
function Trig_A21TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A04D'))
endfunction
function Trig_A21TActions takes nothing returns nothing
    call SetUnitLifeBJ( GetTriggerUnit(), ( GetUnitStateSwap(UNIT_STATE_LIFE, GetTriggerUnit()) + ( 150.00 + ( 200.00 * I2R(GetUnitAbilityLevelSwapped('A04D', GetTriggerUnit())) ) ) ) )
endfunction
//===========================================================================
function InitTrig_A21T takes nothing returns nothing
    set gg_trg_A21T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A21T, Condition(function Trig_A21TConditions))
    call TriggerAddAction(gg_trg_A21T, function Trig_A21TActions)
endfunction
//===========================================================================
// Trigger: A22
//===========================================================================
function Trig_A22Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A22W_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A22W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A22R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A22T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A22T_stop, udg_A_common_HERO, EVENT_UNIT_SPELL_CHANNEL)
endfunction
//===========================================================================
function InitTrig_A22 takes nothing returns nothing
    set gg_trg_A22 = CreateTrigger()
    call TriggerAddAction(gg_trg_A22, function Trig_A22Actions)
endfunction
//===========================================================================
// Trigger: A22W
//===========================================================================
function Trig_A22W_PLAYConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A04E' ) )
endfunction
function Trig_A22W_PLAYActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local unit u2 = GetSpellTargetUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local real life = (8.00+(2.00*I2R(GetUnitAbilityLevel(u1,'A04E'))))
local unit u3 
local integer i =1
	loop
		exitwhen i > 3	
    	set u3 = CreateUnit(GetOwningPlayer(u1),'osw1',x,y,0)
    	call UnitApplyTimedLife(u3,'BHwe',life)
    	call IssueTargetOrder(u3,"attack",u2)
    	set i = i + 1
	endloop
set u1 = null
set u2 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_A22W takes nothing returns nothing
    set gg_trg_A22W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A22W, Condition(function Trig_A22W_PLAYConditions))
    call TriggerAddAction(gg_trg_A22W, function Trig_A22W_PLAYActions)
endfunction//===========================================================================
// Trigger: A22W learn
//===========================================================================
function Trig_A22W_learnConditions takes nothing returns boolean
    return ((GetLearnedSkill() == 'A04E'))
endfunction
function Trig_A22W_learnActions takes nothing returns nothing
    call AddPlayerTechResearched( GetOwningPlayer(GetTriggerUnit()), 'Robf', 1 )
    if ((GetTriggerExecCount(GetTriggeringTrigger()) == 1)) then
        // 支持多人用
        call TriggerRegisterAnyUnitEventBJ(gg_trg_A22W_attack, EVENT_PLAYER_UNIT_ATTACKED)
    else
    endif
endfunction
//===========================================================================
function InitTrig_A22W_learn takes nothing returns nothing
    set gg_trg_A22W_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A22W_learn, Condition(function Trig_A22W_learnConditions))
    call TriggerAddAction(gg_trg_A22W_learn, function Trig_A22W_learnActions)
endfunction
//===========================================================================
// Trigger: A22W attack
//===========================================================================
function Trig_A22W_attackConditions takes nothing returns boolean
    return GetUnitTypeId(GetAttacker()) == 'osw1' and IsUnitType(GetTriggerUnit(), UNIT_TYPE_STRUCTURE) == false
endfunction
function Trig_A22W_attackActions takes nothing returns nothing
local unit u1 = GetAttacker()
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	call UnitDamageTarget(u1, GetTriggerUnit(), I2R(GetHeroInt(hero[i],true)) * 0.50 , true, false, ATTACK_TYPE_HERO,DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS)
set u1 = null	
endfunction
//===========================================================================
function InitTrig_A22W_attack takes nothing returns nothing
    set gg_trg_A22W_attack = CreateTrigger()
    call TriggerAddCondition(gg_trg_A22W_attack, Condition(function Trig_A22W_attackConditions))
    call TriggerAddAction(gg_trg_A22W_attack, function Trig_A22W_attackActions)
endfunction//===========================================================================
// Trigger: A22R
//===========================================================================
function Trig_A22RConditions takes nothing returns boolean
local	unit	u =	GetTriggerUnit()	
local	player	p =	GetOwningPlayer(u)
local	integer	level	=	GetUnitAbilityLevel(u, 'A039')
	
	if	GetLearnedSkill()=='A039'	then	
		call SetPlayerTechResearched(p, 'Roar', level)	
	endif
set u =	null
set p =	null	
return	false
endfunction
//===========================================================================
function InitTrig_A22R takes nothing returns nothing
    set gg_trg_A22R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A22R, Condition(function Trig_A22RConditions))
endfunction
//===========================================================================
// Trigger: A22T
//===========================================================================
function Trig_A22TConditions takes nothing returns boolean
local	unit	u	=	GetTriggerUnit()
local	player	p	=	GetOwningPlayer(u)
local	unit	u3	=	null
	if	GetSpellAbilityId() == 'A03A'	then
		set u3 = CreateUnit(p, 'h02G', GetSpellTargetX(), GetSpellTargetY(), 0)
	    call UnitApplyTimedLife( u3, 'BTLF', 12.00 )	
	endif
		
set u	=	null
set p	=	null
set u3	=	null
return	false
endfunction
//===========================================================================
function InitTrig_A22T takes nothing returns nothing
    set gg_trg_A22T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A22T, Condition(function Trig_A22TConditions))
endfunction
//===========================================================================
// Trigger: A22T stop
//===========================================================================
function Trig_A22T_STOPConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A03A' ) )
endfunction
function Trig_A22T_STOPActions takes nothing returns nothing
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local real x1 = GetUnitX(gg_unit_nfoh_0022)
local real y1 = GetUnitY(gg_unit_nfoh_0022)
local real x2 = GetUnitX(gg_unit_nfoh_0366)
local real y2 = GetUnitY(gg_unit_nfoh_0366)
local real dt1 =SquareRoot(Pow (x1-x,2) + Pow (y1-y,2)) 
local real dt2 =SquareRoot(Pow (x2-x,2) + Pow (y2-y,2)) 
    if dt1 <=950.00 or dt2 <=950.00 then
	    call IssueImmediateOrder(GetTriggerUnit(),"stop")
	endif
endfunction
function InitTrig_A22T_stop takes nothing returns nothing
    set gg_trg_A22T_stop=CreateTrigger()
    call TriggerAddCondition(gg_trg_A22T_stop, Condition(function Trig_A22T_STOPConditions))
    call TriggerAddAction(gg_trg_A22T_stop, function Trig_A22T_STOPActions)
endfunction//===========================================================================
// Trigger: A23
//===========================================================================
function Trig_A23Actions takes nothing returns nothing
    call SetPlayerAbilityAvailable( GetOwningPlayer(udg_A_common_HERO), 'A0WS', false )
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A23W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A23T_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A23T, udg_A_common_HERO, EVENT_UNIT_ISSUED_ORDER)
endfunction
//===========================================================================
function InitTrig_A23 takes nothing returns nothing
    set gg_trg_A23 = CreateTrigger()
    call TriggerAddAction(gg_trg_A23, function Trig_A23Actions)
endfunction
//===========================================================================
// Trigger: A23W
//
// A03E'
//===========================================================================
function Trig_A23WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A03F' ) )
endfunction
function Trig_A23WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local effect e = AddSpecialEffectTarget("Abilities\\Weapons\\DragonHawkMissile\\DragonHawkMissile.mdl",u1,"weapon")
	local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',10.00)
	call SetUnitFlyHeight(u3,1000.00,0.00)
	call UnitAddAbility( u3, 'A03E' )
	call SetUnitAbilityLevel( u3, 'A03E', GetUnitAbilityLevel(u1, 'A03F') )
	call IssuePointOrder(u3,"healingspray",x1,y1)
		call UnitAddAbility( u1, 'A0IA' )
		call SetUnitAbilityLevel( u1, 'A0IA', GetUnitAbilityLevel(u1, 'A03F') )
		call TriggerSleepAction(10.00)
		call UnitRemoveAbility(u1,'A0IA')
		call DestroyEffect(e)
set u1 = null
set u3 = null
set e = null
endfunction
//===========================================================================
function InitTrig_A23W takes nothing returns nothing
    set gg_trg_A23W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A23W, Condition(function Trig_A23WConditions))
    call TriggerAddAction(gg_trg_A23W, function Trig_A23WActions)
endfunction//===========================================================================
// Trigger: A23T learn
//===========================================================================
function Trig_A23T_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0VW'))
endfunction
function Trig_A23T_learnActions takes nothing returns nothing
    call IncUnitAbilityLevel( GetTriggerUnit(), 'A0WR' )
endfunction
//===========================================================================
function InitTrig_A23T_learn takes nothing returns nothing
    set gg_trg_A23T_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A23T_learn, Condition(function Trig_A23T_learnConditions))
    call TriggerAddAction(gg_trg_A23T_learn, function Trig_A23T_learnActions)
endfunction
//===========================================================================
// Trigger: A23T
//===========================================================================
function Trig_A23T_PlayConditions takes nothing returns nothing
    if GetIssuedOrderId() == 852178 then
        call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIem\\AIemTarget.mdl",GetTriggerUnit(),"origin") )
        call UnitRemoveAbility( GetTriggerUnit(), 'A03D' )
    else
        if GetIssuedOrderId() == 852177 then
			call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIem\\AIemTarget.mdl",GetTriggerUnit(),"origin") )
            call UnitAddAbility(GetTriggerUnit(),'A03D')
        endif
    endif
endfunction
//===========================================================================
function InitTrig_A23T takes nothing returns nothing
    set gg_trg_A23T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A23T, Condition(function Trig_A23T_PlayConditions))
endfunction
//===========================================================================
// Trigger: A24
//===========================================================================
function Trig_A24Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A24W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A24W_stop, udg_A_common_HERO, EVENT_UNIT_SPELL_CHANNEL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A24E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A24R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A24T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    set udg_A24T_G[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
    // -------------
    call SetPlayerAbilityAvailable( GetOwningPlayer(udg_A_common_HERO), 'A0Q1', false )
endfunction
//===========================================================================
function InitTrig_A24 takes nothing returns nothing
    set gg_trg_A24 = CreateTrigger()
    call TriggerAddAction(gg_trg_A24, function Trig_A24Actions)
endfunction
//===========================================================================
// Trigger: A24W
//===========================================================================
function Trig_A24W_Timer2 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)	
local unit	u	=	LoadUnitHandle(YDHT, h2i, 1)
local	player	p	=	GetOwningPlayer(u)
	call FlushChildHashtable(YDHT, h2i)
	call DestroyTimer(t)
	call SetPlayerAbilityAvailable(p,'A0Q1',false)
	
set t = null
set p	=	null
set u	=	null
endfunction
function Trig_A24W_Timer takes nothing returns nothing
local timer t =	GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =	LoadUnitHandle(YDHT, h2i, 1)
local real a = LoadReal(YDHT, h2i, 3)
local real dt =	LoadReal(YDHT, h2i, 4)
local real x = GetUnitX(u1)+dt*Cos(a)
local real y = GetUnitY(u1)+dt*Sin(a)
local integer i 
local boolean b
local unit u3
local real r
local unit ydl_unit
	//clock
	call SaveReal(YDHT, h2i,2,LoadReal(YDHT, h2i, 2)+1.00)
	set r = LoadReal(YDHT, h2i, 2)
	//Height
	call SetUnitX(u1,x)
	call SetUnitY(u1,y)
	call SetUnitFlyHeight(u1,((-1.50*Pow((r-18.00),2.00))+486.00),0.00)
		//
		if r	>=	36.00 then
			//回復動畫正常速度
			call SetUnitTimeScale(u1, 100.00 * 0.01)
			//刪除技能
		    call UnitRemoveAbility(u1,'A03H')
		    call UnitRemoveAbility(u1,'A03I')
		    //單位回覆可操作
		    call SetUnitPathing(u1,true)
		    call PauseUnit(u1,false)
		    //檢查有沒有單位
		    set i = 0
		    call GroupEnumUnitsInRange(udg_Group[0], x, y, 260.00, null)
		    	loop
		    		set ydl_unit = FirstOfGroup(udg_Group[0])
		    		exitwhen (ydl_unit == null) or (i==1)
		        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
		        		if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(ydl_unit,GetOwningPlayer(u1)) and GetUnitPointValue(ydl_unit) != 1 and GetUnitAbilityLevel(ydl_unit, 'Aloc') == 0 then
							set i = 1	
		        		endif
		    	endloop
		    	
		    call GroupClear(udg_Group[0])
		    //effect
		    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\ThunderClap\\ThunderClapCaster.mdl",x,y))
		    call DestroyEffect(LoadEffectHandle(YDHT, h2i,5))
		    
		    set b = LoadBoolean(YDHT, h2i,6)
		    //clean 
		    call FlushChildHashtable(YDHT, h2i)
			call DestroyTimer(t)
			
		        if i==1 and b then
			        
				    set u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
				    call UnitApplyTimedLife(u3,'BHwe',3.00)
				    call UnitAddAbility( u3, 'A03J' )
				    call SetUnitAbilityLevel( u3, 'A03J', GetUnitAbilityLevel(u1, 'A03G') )
				    call IssueImmediateOrderById(u3, 852127)
				    
				    	call SetPlayerAbilityAvailable(GetOwningPlayer(u1),'A0Q1',true)
				    	call SetUnitAbilityLevel(u1,'A0Q1',GetUnitAbilityLevel(u1,'A03G'))
				       	set t = CreateTimer()
				       	call SaveUnitHandle(YDHT, GetHandleId(t), 1, u1)
				       	call TimerStart(t, 4.00, false, function Trig_A24W_Timer2 )
				       	
				else
				
					set u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
				    call UnitApplyTimedLife(u3,'BHwe',3.00)
				    call UnitAddAbility( u3, 'A0PY' )
				    call SetUnitAbilityLevel( u3, 'A0PY', GetUnitAbilityLevel(u1, 'A03G') )
				    call IssueImmediateOrderById(u3, 852127) 
				         	
		        endif
		        
		endif
		
set t =	null
set ydl_unit =	null
set u1 =	null
set u3 =	null
endfunction
function Trig_A24WActions takes nothing returns nothing
local unit u1	= GetTriggerUnit()
local real x	=	GetUnitX(u1)
local real y	=	GetUnitY(u1)
local real x1	=	GetSpellTargetX()
local real y1	=	GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
local real dt = SquareRoot(Pow((x1-x),2)+Pow((y1-y),2))
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local player	p	=	GetOwningPlayer(u1)	
local real time=	(0.03/1.80)
    call SaveUnitHandle(YDHT, h2i, 1, u1)
    call SaveReal(YDHT, h2i,2,0.00)
    call SaveReal(YDHT, h2i,3,a)
    call SaveReal(YDHT, h2i,4,dt/41.00)
    call SaveEffectHandle(YDHT, h2i,5,AddSpecialEffectTarget("Abilities\\Weapons\\ZigguratMissile\\ZigguratMissile.mdl",u1,"weapon"))
    
        if GetSpellAbilityId() == 'A03G' then
	    	call SaveBoolean(YDHT, h2i,6,true)
	    else 
        	call SaveBoolean(YDHT, h2i,6,false)
        endif
	//單位暫停
	call PauseUnit(u1,true)
	//Init for fly
	call SetUnitPathing(u1,false)
	call UnitAddAbility(u1,'A03H')
	call UnitAddAbility(u1,'A03I')
	call SetUnitTimeScale(u1, 40.00 * 0.01)
	call SetUnitAnimation(u1,"attack slam")
	call TimerStart(t, time, true, function Trig_A24W_Timer )
    if(GetSpellAbilityId()=='A0Q1')then
    	call SetPlayerAbilityAvailable(p,'A0Q1',false)
    endif
set p	=	null
set t = null
set u1 = null
endfunction
function Trig_A24WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A03G' or GetSpellAbilityId() == 'A0Q1' then
	    call Trig_A24WActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_A24W takes nothing returns nothing
    set gg_trg_A24W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A24W, Condition(function Trig_A24WConditions))
endfunction
//===========================================================================
// Trigger: A24W stop
//===========================================================================
function Trig_A24W_stopConditions takes nothing returns boolean
local integer id = GetSpellAbilityId()	
    if id == 'A0Q1' or id == 'A03G' and IsTerrainPathable(GetSpellTargetX(), GetSpellTargetY(), PATHING_TYPE_WALKABILITY) then
	    call DisplayTimedTextToPlayer(GetOwningPlayer(GetTriggerUnit()), 0, 0, 3.00, "TRIGSTR_11422")
		call IssueNeutralImmediateOrderById(GetOwningPlayer(GetTriggerUnit()), GetTriggerUnit(), 851972)
    endif
    return false
endfunction
function InitTrig_A24W_stop takes nothing returns nothing
    set gg_trg_A24W_stop=CreateTrigger()
    call TriggerAddCondition(gg_trg_A24W_stop, Condition(function Trig_A24W_stopConditions))
endfunction//===========================================================================
// Trigger: A24E
//===========================================================================
function Trig_A24E_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u2 = udg_A24E_U[i]
local location p1 = udg_A24E_P1[i]
local location p2 = udg_A24E_P2[i]
	set udg_A24E_I[i]=(udg_A24E_I[i]+1)
	call MoveLocation(p1, GetUnitX(u1), GetUnitY(u1))
	call MoveLocation(p2, GetUnitX(u2), GetUnitY(u2))
	call MoveLightningLoc(udg_A24E_l[i],p1,p2)
		if(((DistanceBetweenPoints(p1,p2)>=851.00)) or ((IsUnitAliveBJ(u2)==false)) or ((udg_A24E_I[i]>=61)) or ((IsUnitAliveBJ(u1)==false)) )then
		call DestroyEffect(LoadEffectHandle(YDHT, h2i, 2))
		call DestroyEffect(LoadEffectHandle(YDHT, h2i, 3))
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t) 
		call DestroyLightning(udg_A24E_l[i])
		call RemoveLocation(p1)
		call RemoveLocation(p2)
		else
		    if((ModuloInteger(udg_A24E_I[i],10)==0))then
		    call UnitDamageTargetBJ(u1,u2,udg_A24E_R[i],ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		    call SetUnitLifeBJ(u1,(GetUnitState(u1,UNIT_STATE_LIFE)+((GetUnitState(u1,UNIT_STATE_MAX_LIFE)-GetUnitState(u1,UNIT_STATE_LIFE))*0.15)))
		    endif
		endif
set t= null
set u1= null
set u2= null
set p1= null
set p2= null
endfunction
function Trig_A24E_STARTActions2 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)	
local unit u1 = LoadUnitHandle(YDHT,h2i,1)
local unit u2 = LoadUnitHandle(YDHT,h2i,6)
local player	p =	GetOwningPlayer(u1) 
local integer i =	GetPlayerId(p) + 1
local player	p2 =	GetOwningPlayer(u2)
local integer	i2 =	GetPlayerId(p2) + 1
		if udg_omamori_Check[i2]==false then
			call SaveEffectHandle(YDHT, h2i,2, AddSpecialEffectTarget("Abilities\\Spells\\Other\\Drain\\DrainCaster.mdl",u1,"chest"))
			call SaveEffectHandle(YDHT, h2i,3, AddSpecialEffectTarget("Abilities\\Spells\\Other\\Drain\\DrainCaster.mdl",u2,"chest"))
			set udg_A24E_U[i]	=	u2
			set udg_A24E_R[i]	=	(25.00+(35.00*I2R(GetUnitAbilityLevel(u1,'A0PZ'))))
			set udg_A24E_I[i]	=	0
			set udg_A24E_P1[i]	=	GetUnitLoc(u1)
			set udg_A24E_P2[i]	=	GetUnitLoc(u2)
			set udg_A24E_l[i]	=	AddLightningLoc("DRAL",udg_A24E_P1[i],udg_A24E_P2[i])
			call TimerStart(t, 0.10, true, function Trig_A24E_Timer)
		endif
	//////////////////////////////////////////////////////////
	//aviod double no effect 
	//像是瞬間五個侍者 對一個御守的人放 將會沒有效果。
	//////////////////////////////////////////////////////////
	set udg_omamori_Check[i2]=false
	
set t = null
set u1 = null
set u2	= null
set p	=	null
set p2	=	null
endfunction
function Trig_A24E_STARTActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)	
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local player	p	=	GetOwningPlayer(u1) 
local integer i =	GetPlayerId(p) + 1
local real time=	(0.0001)
	//clock Init
	call SaveUnitHandle(YDHT, h2i,1,u1)
	call SaveUnitHandle(YDHT, h2i,6,u2)
	call TimerStart(t, time, false, function Trig_A24E_STARTActions2)
set t = null
set u1 = null
set u2	= null
set p	=	null
endfunction
function Trig_A24E_STARTConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0XI' then
	    call Trig_A24E_STARTActions()
    endif
    return	false
endfunction
function InitTrig_A24E takes nothing returns nothing
    set gg_trg_A24E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A24E, Condition(function Trig_A24E_STARTConditions))
endfunction
//===========================================================================
// Trigger: A24R
//===========================================================================
function Trig_A24RConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A03K' then
	    call UnitAddAbility( GetTriggerUnit(), 'A03L' )	
	    call SetUnitAbilityLevel( GetTriggerUnit(), 'A03L', GetUnitAbilityLevel(GetTriggerUnit(), 'A03K'))
    endif
    return false
endfunction
function InitTrig_A24R takes nothing returns nothing
    set gg_trg_A24R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A24R, Condition(function Trig_A24RConditions))
endfunction//===========================================================================
// Trigger: A24T
//===========================================================================
function Trig_A24_T_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =	LoadUnitHandle(YDHT, h2i, 1)
local player p = GetOwningPlayer(u1)
local integer i =	GetPlayerId(p) + 1
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a = udg_A24T_A[i]
local real x3 = GetUnitX(udg_S01_hero_of_player[i])
local real y3 = GetUnitY(udg_S01_hero_of_player[i])
local real x1
local real y1
local unit ydl_unit
local real x2
local real y2
local real r
local real a1
	if(udg_A24T_I[i]>=57)then
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t) 
		call KillUnit(u1)
		call GroupClear(udg_A24T_G[i])
	else
		//clock
		set udg_A24T_I[i]=(udg_A24T_I[i]+1)
		
		set x1 = x+ 23.00*Cos(a)
		set y1 = y+ 23.00*Sin(a)
		call SetUnitX(u1,x1)
		call SetUnitY(u1,y1)
    	call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 280.00, null)
    		loop
    			set ydl_unit = FirstOfGroup(udg_Group[0])
    			exitwhen ydl_unit == null 
        		call GroupRemoveUnit(udg_Group[0], ydl_unit)
        			if IsUnitInGroup(ydl_unit,udg_A24T_G[i])==false and IsUnitEnemy(ydl_unit,p) and GetUnitPointValue(ydl_unit) != 1 and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitType(ydl_unit,UNIT_TYPE_MECHANICAL)==false and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false then
        				call GroupAddUnit(udg_A24T_G[i],ydl_unit) 
        				set x2 = GetUnitX(ydl_unit)
        				set y2 = GetUnitY(ydl_unit)
        				set a1 = Atan2(y3-y2,x3-x2)*bj_RADTODEG
        				set r	=	(GetUnitState(ydl_unit,UNIT_STATE_LIFE)*(0.15+(0.05*I2R(GetUnitAbilityLevel(udg_S01_hero_of_player[i],'A0SC')))))
            				if r <=	400.00 then
	        					set r = 400.00
	        				endif
					
	        			call	UnitDamageTarget(udg_S01_hero_of_player[i],ydl_unit,r, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)	
	    				  
	        				if	GetOwningPlayer(ydl_unit)!=Player(12)	then
            						set udg_KnockBack_Angle = a1
            						set udg_KnockBack_Boolean1 = true
            						set udg_KnockBack_Dist = 30.00
            						set udg_KnockBack_Rate = 0.95
            						set udg_KnockBack_Time = 2.00
            						set udg_KnockBack_Unit = ydl_unit
            						set udg_KnockBack_Interval = (0.30/10.00)
									set	udg_KnockBack_Trigger	=	null
            						call TriggerExecute(gg_trg_KnockBack)
	        				endif 
        			endif
    		endloop
	endif
	
set p = null
set t = null
set u1 = null
set ydl_unit	= null 
endfunction
function Trig_A24_T_startActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local player	p	=	GetOwningPlayer(u1)
local integer i =	GetPlayerId(p) + 1
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
	set udg_A24T_A[i]	=	a
	set udg_A24T_I[i]	=	0
	
	call SaveUnitHandle(YDHT, h2i, 1, CreateUnit(p,'e00N',x,y,a*bj_RADTODEG) )
	call TimerStart(t, 0.02, true, function Trig_A24_T_Timer)
	
set t = null
set u1 = null
set p	=	null
endfunction
function Trig_A24_T_startConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0SC' then
	    call Trig_A24_T_startActions()
    endif
    return false
endfunction
function InitTrig_A24T takes nothing returns nothing
    set gg_trg_A24T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A24T, Condition(function Trig_A24_T_startConditions))
endfunction//===========================================================================
// Trigger: A25
//===========================================================================
function Trig_A25_E_resist_damageConditions takes nothing returns boolean
    return ( ( GetEventDamage() >= 35.00 ) and (GetUnitAbilityLevel(GetTriggerUnit(), 'B06W') > 0) and ( ( GetUnitPointValue(GetEventDamageSource()) == 1 ) or ( GetUnitPointValue(GetEventDamageSource()) == 3500 ) or ( IsUnitType(GetEventDamageSource(), UNIT_TYPE_HERO) == true ) ) )
endfunction
function Trig_A25_E_resist_damageActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
    if ( ( udg_A25_I[i] <= 0 ) ) then
	    call UnitRemoveAbility(u1, 'B06W')
        call DisableTrigger(udg_A25_Trigger[i])
    else
        set udg_A25_I[i]=( udg_A25_I[i] - 1 )
    	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\OrbOfDeath\\AnnihilationMissile.mdl",u1,"chest"))
    	call SetUnitState(u1,UNIT_STATE_LIFE,GetUnitState(u1,UNIT_STATE_LIFE)+GetEventDamage())
    endif
set u1 = null
endfunction
function Trig_A25Actions takes nothing returns nothing
local unit u1 = udg_A_common_HERO
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
	set udg_A25_Trigger[i]=CreateTrigger()
	call TriggerAddCondition(udg_A25_Trigger[i],function Trig_A25_E_resist_damageConditions)
	call TriggerAddAction(udg_A25_Trigger[i],function Trig_A25_E_resist_damageActions)
	call TriggerRegisterUnitEvent(udg_A25_Trigger[i],u1,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(gg_trg_A25_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
set u1 = null
endfunction
function InitTrig_A25 takes nothing returns nothing
    set gg_trg_A25 = CreateTrigger()
    call TriggerAddCondition(gg_trg_A25, function Trig_A25Actions)
endfunction
//===========================================================================
// Trigger: A25 E
//===========================================================================
function Trig_A25_EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0MM' ) )
endfunction
function Trig_A25_EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
	set udg_A25_I[i]=( GetUnitAbilityLevel(u1, 'A0MM') - 1 )
	call EnableTrigger(udg_A25_Trigger[i])
set u1 = null
endfunction
//===========================================================================
function InitTrig_A25_E takes nothing returns nothing
    set gg_trg_A25_E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A25_E, Condition(function Trig_A25_EConditions))
    call TriggerAddAction(gg_trg_A25_E, function Trig_A25_EActions)
endfunction//===========================================================================
// Trigger: A26
//===========================================================================
function Trig_A26Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A26_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A26_T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A26 takes nothing returns nothing
    set gg_trg_A26 = CreateTrigger()
    call TriggerAddAction(gg_trg_A26, function Trig_A26Actions)
endfunction
//===========================================================================
// Trigger: A26 E
//===========================================================================
function Trig_A26_EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A03R' ) )
endfunction
function Trig_A26_EActions takes nothing returns nothing
local unit u3 = CreateUnit(GetOwningPlayer(GetTriggerUnit()),'emtg',GetUnitX(GetSpellTargetUnit()),GetUnitY(GetSpellTargetUnit()),270.00)
set u3 = null	
endfunction
function InitTrig_A26_E takes nothing returns nothing
    set gg_trg_A26_E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A26_E, Condition(function Trig_A26_EConditions))
    call TriggerAddAction(gg_trg_A26_E, function Trig_A26_EActions)
endfunction//===========================================================================
// Trigger: A26 T
//===========================================================================
function Trig_A26_TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0D7'))
endfunction
function Trig_A26_TActions takes nothing returns nothing
    set bj_forLoopAIndex = 0
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ((GetItemTypeId(UnitItemInSlot(GetTriggerUnit(), GetForLoopIndexA())) == 'flag')) then
            set udg_A26T_Item[GetForLoopIndexA()] = GetItemTypeId(UnitItemInSlot(GetTriggerUnit(), GetForLoopIndexA()))
            call RemoveItem( UnitItemInSlot(GetTriggerUnit(), GetForLoopIndexA()) )
        else
            set udg_A26T_Item[GetForLoopIndexA()] = GetItemTypeId(null)
        endif
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    call UnitResetCooldown( GetTriggerUnit() )
    set bj_forLoopAIndex = 0
    set bj_forLoopAIndexEnd = 5
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        if ((udg_A26T_Item[GetForLoopIndexA()] != GetItemTypeId(null))) then
            call UnitAddItemToSlotById( GetTriggerUnit(), 'flag', GetForLoopIndexA() )
        else
        endif
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
endfunction
//===========================================================================
function InitTrig_A26_T takes nothing returns nothing
    set gg_trg_A26_T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A26_T, Condition(function Trig_A26_TConditions))
    call TriggerAddAction(gg_trg_A26_T, function Trig_A26_TActions)
endfunction
//===========================================================================
// Trigger: A27
//===========================================================================
function Trig_A27Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A27W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A27E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A27T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    set udg_A27W_G[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
endfunction
//===========================================================================
function InitTrig_A27 takes nothing returns nothing
    set gg_trg_A27 = CreateTrigger()
    call TriggerAddAction(gg_trg_A27, function Trig_A27Actions)
endfunction
//===========================================================================
// Trigger: A27W
//===========================================================================
function Trig_A27WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A03U' ) )
endfunction
function Trig_A27_W_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local player p = GetOwningPlayer(u1)
local integer i = GetPlayerId(p) + 1
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a = udg_A27W_A[i]
local real x1 
local real y1 
local unit ydl_unit
	set udg_A27W_R2[i]=udg_A27W_R2[i]+50
	set x1 = x+ 50*Cos(a)
	set y1 = y+ 50*Sin(a)
		if(udg_A27W_R2[i]>udg_A27W_R1[i])then
			call SetUnitPosition(u1,x1,y1)
			call GroupClear(udg_A27W_G[i])
			call FlushChildHashtable(YDHT, h2i)
	    	call DestroyTimer(t)
		else
		    call SetUnitX(u1,x1)
			call SetUnitY(u1,y1)
			call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl",x1,y1))
	    	call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 250.0, null)
	    		loop
	    			set ydl_unit = FirstOfGroup(udg_Group[0])
	   				exitwhen ydl_unit == null 
	        		call GroupRemoveUnit(udg_Group[0], ydl_unit)
	        			if ( (IsUnitInGroup(ydl_unit,udg_A27W_G[i])==false) and (IsUnitEnemy(ydl_unit,p)) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
	        				call GroupAddUnit(udg_A27W_G[i],ydl_unit) 
	        				call UnitDamageTargetBJ(u1,ydl_unit,(100.00+(100.00*I2R(udg_A27W_I[i]))),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC) 
	        			endif
	    		endloop
		endif
set p = null
set t= null
set u1= null
set ydl_unit= null 
endfunction
function Trig_A27WActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
	set udg_A27W_A[i]=a
	set udg_A27W_R1[i]= SquareRoot( ( Pow((x1-x),2)) + Pow((y1-y),2)) 
	set udg_A27W_R2[i]=0.00
	set udg_A27W_I[i]= GetUnitAbilityLevel(u1,'A03U')
		call SaveUnitHandle(YDHT, h2i, 1, u1 )
		call TimerStart(t, 0.02, true, function Trig_A27_W_Timer)
set t = null
set u1 = null
endfunction
function InitTrig_A27W takes nothing returns nothing
    set gg_trg_A27W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A27W, Condition(function Trig_A27WConditions))
    call TriggerAddAction(gg_trg_A27W, function Trig_A27WActions)
endfunction//===========================================================================
// Trigger: A27E 
//===========================================================================
function Trig_A27EActions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local player p = GetOwningPlayer(u1)
//local unit u3 
//【注意】 一定要 10 秒 要不然馬甲死掉 傷害來源 = null
//末日審判 為持續性施法技能?
local unit u3 
	set u3 = CreateUnit(p,'h02G',x,y,0)
	call UnitAddAbility( u3, 'A03W' )
	call UnitApplyTimedLife(u3,'BHwe',10.00)
	
	call GroupEnumUnitsInRange(udg_Group[0], x, y, 475.00, null)
	    loop
	    	set ydl_unit = FirstOfGroup(udg_Group[0])
	    	exitwhen (ydl_unit == null) 
	    	call GroupRemoveUnit(udg_Group[0], ydl_unit)
	        	if (GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) then
	        		call IssueTargetOrder(u3,"doom",ydl_unit)
	        	endif
	    endloop 
	    
set u1 = null 
set u3 = null
set ydl_unit=null 
endfunction
function Trig_A27EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A03V' then
	    call Trig_A27EActions()
    endif
    return false
endfunction
function InitTrig_A27E takes nothing returns nothing
    set gg_trg_A27E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A27E, Condition(function Trig_A27EConditions))
endfunction//===========================================================================
// Trigger: A27T
//===========================================================================
function Trig_A27TConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A03Y' ) )
endfunction
function Trig_A27TFunc001T takes nothing returns nothing
local unit ydl_unit
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local player p = GetOwningPlayer(u1)
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local integer i =GetConvertedPlayerId(p)
local real x2 
local real y2
local real level = udg_A27T_damage[GetUnitAbilityLevel(u1,'A03Y')]
	if(udg_A27T_I[i]>=6)then	
		call FlushChildHashtable(YDHT, h2i)
    	call DestroyTimer(t)
	else
		set udg_A27T_I[i]=(udg_A27T_I[i]+1)
    	call GroupEnumUnitsInRange(udg_Group[0], x, y, 675.00, null)
    		loop
    			set ydl_unit = FirstOfGroup(udg_Group[0])
    			exitwhen (ydl_unit == null) 
        		call GroupRemoveUnit(udg_Group[0], ydl_unit)
        			if ( (IsUnitType(ydl_unit,UNIT_TYPE_HERO)) and IsUnitEnemy(ydl_unit,p) and (GetUnitPointValue(ydl_unit) != 1) ) then
        				set x2 = GetUnitX(ydl_unit)
        				set y2 = GetUnitY(ydl_unit)
        				call UnitDamageTargetBJ(u1,ydl_unit,(GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)*level),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL)
        				call SetUnitState(ydl_unit, UNIT_STATE_MANA, (GetUnitState(ydl_unit,UNIT_STATE_MANA)-(GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)*level)))
        				call IssueImmediateOrder(ydl_unit,"stop")
        				call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Doom\\DoomDeath.mdl",x2,y2))
        			endif
    		endloop
	endif 
set u1 = null 
set ydl_unit=null 
set t = null
set p = null
endfunction
function Trig_A27TActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
	set udg_A27T_damage[1]=0.05
	set udg_A27T_damage[2]=0.06
	set udg_A27T_damage[3]=0.07
	set udg_A27T_I[i]=0
		call SaveUnitHandle(YDHT, h2i, 1, u1 )
		call TimerStart(t, 1.20, true, function Trig_A27TFunc001T)
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_A27T takes nothing returns nothing
    set gg_trg_A27T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A27T, Condition(function Trig_A27TConditions))
    call TriggerAddAction(gg_trg_A27T, function Trig_A27TActions)
endfunction//===========================================================================
// Trigger: A28
//===========================================================================
function Trig_A28Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A28W_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A28W_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A28E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A28R, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    call TriggerRegisterUnitEvent(gg_trg_A28R_attacked, udg_A_common_HERO, EVENT_UNIT_ATTACKED)
    // -------------
endfunction
//===========================================================================
function InitTrig_A28 takes nothing returns nothing
    set gg_trg_A28 = CreateTrigger()
    call TriggerAddAction(gg_trg_A28, function Trig_A28Actions)
endfunction
//===========================================================================
// Trigger: A28W learn
//===========================================================================
function Trig_A28W_learnConditions takes nothing returns boolean
    return ( ( GetLearnedSkill() == 'A0DW' ) )
endfunction
function Trig_A28W_learnFunc001Func002T takes nothing returns nothing
local unit u1= LoadUnitHandle(YDHT, GetHandleId(GetExpiredTimer()), 0xA1614B4D)
    if GetUnitAbilityLevel(u1, 'B04H') > 0 then
	    
	        if ( ( GetUnitAbilityLevel(u1, 'A0DY') == 0 ) ) then
	            call UnitAddAbility(u1, 'A0DY')
	        endif
        
        call SetUnitLifeBJ( u1, ( GetUnitState(u1, UNIT_STATE_LIFE) + ( 6.00 * I2R(GetUnitAbilityLevel(u1, 'A0DW')) ) ) )
    else
        call UnitRemoveAbility(u1, 'A0DY')
    endif
    
set u1=null
endfunction
function Trig_A28W_group_lv_Up takes nothing returns nothing
call SetUnitAbilityLevel(GetEnumUnit(), 'A0DX', GetUnitAbilityLevel(GetTriggerUnit(), 'A0DW'))
endfunction
function Trig_A28W_learnActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local integer i=GetConvertedPlayerId(GetOwningPlayer(u1))
local timer ydl_timer
local group g= YDWEGetUnitsOfPlayerAndTypeIdNull(GetOwningPlayer(u1) , 'nmpe')
    if ( ( GetUnitAbilityLevel(u1, 'A0DW') == 1 ) ) then
        set ydl_timer=CreateTimer()
        call SaveUnitHandle(YDHT, GetHandleId(ydl_timer), 0xA1614B4D, u1)
        call TimerStart(ydl_timer, 1.00, true, function Trig_A28W_learnFunc001Func002T)
    endif
    
call ForGroup(g, function Trig_A28W_group_lv_Up)
call DestroyGroup(g)
set u1=null
set g=null
set ydl_timer=null
endfunction
function InitTrig_A28W_learn takes nothing returns nothing
    set gg_trg_A28W_learn=CreateTrigger()
    call TriggerAddCondition(gg_trg_A28W_learn, Condition(function Trig_A28W_learnConditions))
    call TriggerAddAction(gg_trg_A28W_learn, function Trig_A28W_learnActions)
endfunction//===========================================================================
// Trigger: A28W start
//
// 要三個 數字變數 跟ㄧ個單位變數
//===========================================================================
function Trig_A28W_startConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0DW' ) )
endfunction
function Trig_A28W_startActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local integer h2i= GetHandleId(u1)
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local integer temp_int=( GetUnitAbilityLevel(u1, 'A0DW') + 1 )
local integer i= 1
local integer iend= temp_int
local integer i2
local integer i2end
local unit u3= CreateUnit(GetOwningPlayer(u1), 'nmpe', x, y, 0)
	call SetUnitAbilityLevel(u3, 'A0DX', GetUnitAbilityLevel(u1, 'A0DW'))
	
	loop
		exitwhen i > temp_int
			if ( LoadUnitHandle(udg_A28_H, h2i, i) == null ) then
				call SaveUnitHandle(udg_A28_H, h2i, i, u3)
				return
			else
    			if ( i == temp_int ) then
    				call KillUnit(LoadUnitHandle(udg_A28_H, h2i, 1))
    				call RemoveUnit(LoadUnitHandle(udg_A28_H, h2i, 1))
    				set i2=1
    				set i2end=( temp_int - 1 )
    					loop
    						exitwhen i2 > i2end
    						call SaveUnitHandle(udg_A28_H, h2i, i2, LoadUnitHandle(udg_A28_H, h2i, ( i2 + 1 )))
    						set i2=i2 + 1
    					endloop
    				call SaveUnitHandle(udg_A28_H, h2i, temp_int, u3)
    			endif
			endif
		set i=i + 1
	endloop
set u1=null
set u3=null
endfunction
function InitTrig_A28W_start takes nothing returns nothing
    set gg_trg_A28W_start=CreateTrigger()
    call TriggerAddCondition(gg_trg_A28W_start, Condition(function Trig_A28W_startConditions))
    call TriggerAddAction(gg_trg_A28W_start, function Trig_A28W_startActions)
endfunction//===========================================================================
// Trigger: A28E 
//===========================================================================
function Trig_A28EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0DZ' ) )
endfunction
function Trig_A28EGroup_Play takes nothing returns nothing
local unit u1 = GetEnumUnit()
//for sign
local unit u3 = CreateUnit(GetOwningPlayer(rose_unit[0]),'h02G',GetUnitX(u1),GetUnitY(u1),0) 
	call ShowUnit( u3, false )
	call UnitApplyTimedLife(u3,'BHwe',1.00)
	call UnitAddAbility( u3, 'A028' )
	call IssueTargetOrder(u3,"thunderbolt",u1)
set u1 = null
set u3 = null
endfunction
function Trig_A28E_Func005002003 takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(), 'B04I') > 0)
endfunction
function Trig_A28EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local group g = CreateGroup()
local location p = GetUnitLoc(u1)
	call TriggerSleepAction(0.00)
		call GroupEnumUnitsInRangeOfLoc(g, p, 600.00, Condition(function Trig_A28E_Func005002003))
		call RemoveLocation(p)
	call TriggerSleepAction(4.00)
/////////////////////////////////////////////////////////
//Hide Caster Spell
/////////////////////////////////////////////////////////
		set rose_unit[0] = u1
		call ForGroup(g, function Trig_A28EGroup_Play )
		call DestroyGroup(g)
set u1 = null 
set p = null
set g = null
endfunction
function InitTrig_A28E takes nothing returns nothing
    set gg_trg_A28E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A28E, Condition(function Trig_A28EConditions))
    call TriggerAddAction(gg_trg_A28E, function Trig_A28EActions)
endfunction//===========================================================================
// Trigger: A28R
//===========================================================================
function Trig_A28RConditions takes nothing returns boolean
    return ((GetRandomInt(1, 100) <= 13) and (GetUnitAbilityLevel(GetTriggerUnit(), 'A0E0') != 0) and IsUnitType(GetEventTargetUnit(), UNIT_TYPE_STRUCTURE) == false and (udg_A28R_B[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == false))
endfunction
function Trig_A28RActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a = GetUnitFacing(u1)*bj_DEGTORAD
local real x2 = x + 10.00*Cos(a)
local real y2 = y + 10.00*Sin(a)
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
	//for sign 0.1 sec
	local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',1.00)
	call ShowUnit(u3, false)
	//for spell
	set u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',5.00)
	call UnitAddAbility( u3, 'A0E1' )
	call SetUnitAbilityLevel(u3,'A0E1',GetUnitAbilityLevel(u1, 'A0E0'))
	call IssuePointOrder(u3, "stampede", x2,y2)
	//check
	set udg_A28R_B[i]=true
	call TriggerSleepAction(0.73)
	set udg_A28R_B[i]=false
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_A28R takes nothing returns nothing
    set gg_trg_A28R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A28R, Condition(function Trig_A28RConditions))
    call TriggerAddAction(gg_trg_A28R, function Trig_A28RActions)
endfunction//===========================================================================
// Trigger: A28R attacked
//===========================================================================
function Trig_A28R_attackedConditions takes nothing returns boolean
    return ( (GetRandomInt(1, 100) <= 13) and (GetUnitAbilityLevel(GetTriggerUnit(), 'A0E0') != 0) and IsUnitType(GetAttacker(), UNIT_TYPE_STRUCTURE) == false and (udg_A28R_B[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == false))
endfunction
function Trig_A28R_attackedActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetAttacker()
local real x = GetUnitX(u2)
local real y = GetUnitY(u2)
local real a = GetUnitFacing(u2)*bj_DEGTORAD
local real x2 = x + 10.00*Cos(a)
local real y2 = y + 10.00*Sin(a)
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
	local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',1.00)
	call ShowUnit(u3, false)
	//for spell
	set u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
	call UnitApplyTimedLife(u3,'BHwe',5.00)
	call UnitAddAbility( u3, 'A0E1' )
	call SetUnitAbilityLevel(u3,'A0E1',GetUnitAbilityLevel(u1, 'A0E0'))
	call IssuePointOrder(u3, "stampede", x2,y2)
	//for check
	set udg_A28R_B[i]=true
	call TriggerSleepAction(0.73)
	set udg_A28R_B[i]=false
set u1 = null
set u2 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_A28R_attacked takes nothing returns nothing
    set gg_trg_A28R_attacked = CreateTrigger()
    call TriggerAddCondition(gg_trg_A28R_attacked, Condition(function Trig_A28R_attackedConditions))
    call TriggerAddAction(gg_trg_A28R_attacked, function Trig_A28R_attackedActions)
endfunction//===========================================================================
// Trigger: A29
//===========================================================================
function Trig_A29Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A29W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A29E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A29R_START, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A29_T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    set udg_A29R_T[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateTimer()
endfunction
//===========================================================================
function InitTrig_A29 takes nothing returns nothing
    set gg_trg_A29 = CreateTrigger()
    call TriggerAddAction(gg_trg_A29, function Trig_A29Actions)
endfunction
//===========================================================================
// Trigger: A29W
//===========================================================================
function Trig_A29WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0BI' ) )
endfunction
function Trig_A29WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1=GetSpellTargetX()
local real y1=GetSpellTargetY()
local unit ydl_unit
local real dmg = (100.00*I2R(GetUnitAbilityLevel(u1,'A0BI')))
local real r = 27.00+13.00*GetUnitAbilityLevel(u1,'A0BI')
local player p = GetOwningPlayer(u1)
    call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 500.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[0])
    		exitwhen ydl_unit == null 
        	call GroupRemoveUnit(udg_Group[0], ydl_unit)
        		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) and (GetUnitPointValue(ydl_unit) != 1) ) then
					call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1,UNIT_STATE_LIFE)+r)
        			call UnitDamageTargetBJ(u1,ydl_unit,dmg,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC) 
        			call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl",ydl_unit,"chest"))
        		endif
    endloop
set p = null
set u1 = null
set ydl_unit=null
endfunction
function InitTrig_A29W takes nothing returns nothing
    set gg_trg_A29W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A29W, Condition(function Trig_A29WConditions))
    call TriggerAddAction(gg_trg_A29W, function Trig_A29WActions)
endfunction//===========================================================================
// Trigger: A29E
//===========================================================================
function Trig_A29EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0E8' ) )
endfunction
function Trig_A29EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
call UnitAddAbility(u1, 'A0E9')
call SetUnitAbilityLevel(u1, 'A0E9', GetUnitAbilityLevel(u1, 'A0E8'))
call UnitAddAbility(u2, 'A0EA')
call SetUnitAbilityLevel(u2, 'A0EA', GetUnitAbilityLevel(u1, 'A0E8'))
call UnitMakeAbilityPermanent(u2, true, 'A0EA')
call TriggerSleepAction(9.00)
call UnitRemoveAbility(u1, 'A0E9')
call UnitMakeAbilityPermanent(u2, false, 'A0EA')
call UnitRemoveAbility(u2, 'A0EA')
   
set u1 = null
set u2 = null
endfunction
function InitTrig_A29E takes nothing returns nothing
    set gg_trg_A29E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A29E, Condition(function Trig_A29EConditions))
    call TriggerAddAction(gg_trg_A29E, function Trig_A29EActions)
endfunction//===========================================================================
// Trigger: A29R_START 
//===========================================================================
function Trig_A29R_STARTConditions takes nothing returns boolean
    return ( ( GetLearnedSkill() == 'A0EB' ) and IsUnitIllusion(GetTriggerUnit())!=true )
endfunction
function Trig_A29R_STARTFunc002T takes nothing returns nothing
local integer h2i= GetHandleId(GetExpiredTimer())
local unit u1=LoadUnitHandle(YDHT, h2i, 1)
local unit u3= CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
	call UnitAddAbility(u3, 'A0EC')
	call IssueTargetOrder(u3, "antimagicshell", u1)
set u1=null
set u3=null
endfunction
function Trig_A29R_STARTActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local integer i=GetConvertedPlayerId(GetOwningPlayer(u1))
local timer t= udg_A29R_T[i]
call PauseTimer(udg_A29R_T[i])
call SaveUnitHandle(YDHT, GetHandleId(t), 1, u1)
call TimerStart(t, ( 23.00 - ( 3.00 * I2R(GetUnitAbilityLevel(u1, 'A0EB')) ) ), true, function Trig_A29R_STARTFunc002T)
set t=null
set u1=null
endfunction
function InitTrig_A29R_START takes nothing returns nothing
    set gg_trg_A29R_START=CreateTrigger()
    call TriggerAddCondition(gg_trg_A29R_START, Condition(function Trig_A29R_STARTConditions))
    call TriggerAddAction(gg_trg_A29R_START, function Trig_A29R_STARTActions)
endfunction//===========================================================================
// Trigger: A29 T
//===========================================================================
function Trig_A29_TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0ED'))
endfunction
function Trig_A29_TActions takes nothing returns nothing
    set udg_tmpP[0] = GetUnitLoc(GetTriggerUnit())
    call CreateNUnitsAtLoc( 1, 'n02W', GetOwningPlayer(GetTriggerUnit()), udg_tmpP[0], bj_UNIT_FACING )
    call UnitApplyTimedLifeBJ( 2.00, 'BTLF', GetLastCreatedUnit() )
    call UnitAddAbilityBJ( 'A0HJ', GetLastCreatedUnit() )
    call IssueTargetOrder( GetLastCreatedUnit(), "thunderbolt", GetTriggerUnit() )
    call RemoveLocation(udg_tmpP[0])
endfunction
//===========================================================================
function InitTrig_A29_T takes nothing returns nothing
    set gg_trg_A29_T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A29_T, Condition(function Trig_A29_TConditions))
    call TriggerAddAction(gg_trg_A29_T, function Trig_A29_TActions)
endfunction
//===========================================================================
// Trigger: A30
//===========================================================================
function Trig_A30Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A30R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A30T_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    set udg_A30R_T[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateTimer()
endfunction
//===========================================================================
function InitTrig_A30 takes nothing returns nothing
    set gg_trg_A30 = CreateTrigger()
    call TriggerAddAction(gg_trg_A30, function Trig_A30Actions)
endfunction
//===========================================================================
// Trigger: A30R
//===========================================================================
function Trig_A30RConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0P0' ) )
endfunction
///////////////
//結束疊加傷害
///////////////
function Trig_A30RFunc008A takes nothing returns nothing
    local integer i =LoadInteger(YDHT, GetHandleId(GetExpiredTimer()), 1)
	    set udg_A30R_I[i]=0
	    call DestroyEffect(udg_A30R_SE[i])
endfunction
function Trig_A30RActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1 = GetTriggerUnit()
    local real x1=GetSpellTargetX()
    local real y1=GetSpellTargetY()
    local player p = GetOwningPlayer(u1)
    local integer i =GetPlayerId(p) + 1	
    local timer t = udg_A30R_T[i]
    local integer h2i = GetHandleId(t)
    local real dmg = (50.00+ 90.00*I2R(GetUnitAbilityLevel(u1,'A0P0'))) * (1+(0.15*I2R(udg_A30R_I[i])))
    	///////////////
    	//參數設定
    	///////////////
	    call SaveInteger(YDHT, h2i, 1, i)
	    ///////////////
	    //疊加計時
	    ///////////////
	    call DestroyEffect(udg_A30R_SE[i])
	    set udg_A30R_SE[i] = AddSpecialEffectTarget("war3mapImported\\EvilMissileofShadowyDOOMV2.mdx",u1,"chest")
	    call PauseTimer( t )
	    call TimerStart(t, 8.00, false, function Trig_A30RFunc008A)
	    /////////////////
	    //範圍傷害
	    /////////////////
	    call GroupEnumUnitsInRange(udg_Group[0], x1, y1, 235.00, null)
		    loop
		    	set ydl_unit = FirstOfGroup(udg_Group[0])
		    	exitwhen ydl_unit == null 
		        call GroupRemoveUnit(udg_Group[0], ydl_unit)
			        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false then
			        	call UnitDamageTarget(u1,ydl_unit,dmg, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
			            call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\Earthshock.mdx",ydl_unit,"chest"))
			        endif
		    endloop
		////////////
		//疊加上限
		////////////
		set udg_A30R_I[i]=(udg_A30R_I[i]+1)
		    if(udg_A30R_I[i]>=6)then
				set udg_A30R_I[i]=5
		    endif
    set p = null
    set u1 = null
    set ydl_unit=null
    set t = null
endfunction
function InitTrig_A30R takes nothing returns nothing
    set gg_trg_A30R=CreateTrigger()
    call TriggerAddCondition(gg_trg_A30R, Condition(function Trig_A30RConditions))
    call TriggerAddAction(gg_trg_A30R, function Trig_A30RActions)
endfunction//===========================================================================
// Trigger: A30T_learn
//===========================================================================
function Trig_A30T_learnConditions takes nothing returns boolean
    return GetLearnedSkill() == 'A0EL' and IsUnitIllusion(GetTriggerUnit()) != true
endfunction
function Trig_A30T_learnActions takes nothing returns nothing
local unit u = GetTriggerUnit()
	//////////////////
	//設置技能等級-科技-A30T
	//////////////////
    call SetPlayerTechResearched(GetOwningPlayer(u), 'Roen', GetUnitAbilityLevel(u,'A0EL'))
	    if ((GetUnitAbilityLevel(u, 'A0EL') == 1)) then
	        call TriggerRegisterUnitEvent(gg_trg_A30T, u, EVENT_UNIT_SPELL_EFFECT)
	    endif
endfunction
//===========================================================================
function InitTrig_A30T_learn takes nothing returns nothing
    set gg_trg_A30T_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A30T_learn, Condition(function Trig_A30T_learnConditions))
    call TriggerAddAction(gg_trg_A30T_learn, function Trig_A30T_learnActions)
endfunction
//===========================================================================
// Trigger: A30T
//===========================================================================
function Trig_A30TConditions takes nothing returns boolean
local integer id = GetSpellAbilityId()
    return id == 'A0P0' or id == 'A0EL' or id == 'A0EG' or id == 'A0UX' 
endfunction
function Trig_A30TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local unit u3
local real x2
local real y2
local unit ydl_unit
local integer end = 0
local player p = GetOwningPlayer(u1)
local real life = 5.00 + 3.00 * I2R(GetUnitAbilityLevel(u1, 'A0EL'))
	/////////////////////////////////
	//判斷範圍有沒有敵軍單位+隨機系統
	/////////////////////////////////
	call GroupEnumUnitsInRange(udg_Group[0], x, y, 600.00, null)
	    loop
	    	set ydl_unit = FirstOfGroup(udg_Group[0])
	    	exitwhen ydl_unit == null or end == 7
	        call GroupRemoveUnit(udg_Group[0], ydl_unit)
	        	if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false and GetUnitPointValue(ydl_unit) != 1 then
	        		set end = end + 1
					set Random_U[end] = ydl_unit 
	        	endif
	    endloop
	/////////////////////
	//避免單位組沒有清乾淨
	/////////////////////    
	call GroupClear(udg_Group[0])
			////////////
			//召喚樹鬼
			////////////
			if end > 0 then
				set ydl_unit = Random_U[GetRandomInt(1,end)]
       			set x2 = GetUnitX(ydl_unit)
        		set y2 = GetUnitY(ydl_unit)
        		set u3 = CreateUnit(p,'nfgt',x2,y2,0)
        		call UnitApplyTimedLife(u3, 0x42544C46, life )
        		set u3 = CreateUnit(p,'nfgt',x2,y2,0)
        		call UnitApplyTimedLife(u3, 0x42544C46, life )
        	endif
set p = null 
set u1 = null
set u3 = null
set ydl_unit = null
endfunction
function InitTrig_A30T takes nothing returns nothing
    set gg_trg_A30T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A30T, Condition(function Trig_A30TConditions))
    call TriggerAddAction(gg_trg_A30T, function Trig_A30TActions)
endfunction//===========================================================================
// Trigger: A31
//===========================================================================
function Trig_A31Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A31E, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A31R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------
    call TriggerRegisterUnitEvent(gg_trg_A31_T_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A31 takes nothing returns nothing
    set gg_trg_A31 = CreateTrigger()
    call TriggerAddAction(gg_trg_A31, function Trig_A31Actions)
endfunction
//===========================================================================
// Trigger: A31E
//===========================================================================
function Trig_A31EConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0EI'))
endfunction
function Trig_A31EActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rost', GetUnitAbilityLevelSwapped('A0EI', GetTriggerUnit()), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_A31E takes nothing returns nothing
    set gg_trg_A31E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A31E, Condition(function Trig_A31EConditions))
    call TriggerAddAction(gg_trg_A31E, function Trig_A31EActions)
endfunction
//===========================================================================
// Trigger: A31R
//===========================================================================
function Trig_A31R_STARTConditions takes nothing returns boolean
    return GetLearnedSkill() == 'A0EJ' and GetUnitAbilityLevel(GetTriggerUnit(), 'A0EJ') == 1
endfunction
function Trig_A31R_STARTFunc001T takes nothing returns nothing
local integer h2i = GetHandleId(GetExpiredTimer())
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local unit ydl_unit
local real r = udg_A31R_damage[GetUnitAbilityLevel(u1,'A0EJ')]
local player p = GetOwningPlayer(u1)
	//////////////////////////////////
	//這邊跟敘述不一樣，是為了跟FN的相同
	//FN用 物編的範圍判斷 + 觸發的大範圍來抓 BUFF
	//目地 避免時間延遲?
	//////////////////////////////////
	call GroupEnumUnitsInRange(udg_Group[1], GetUnitX(u1), GetUnitY(u1), 930.00, null)
	    loop
	    	set ydl_unit = FirstOfGroup(udg_Group[1])
	    	exitwhen (ydl_unit == null) 
	        call GroupRemoveUnit(udg_Group[1], ydl_unit)
	        	////////////////////////
	        	//a.BUFF法 判斷
	        	//b.記得加單位是敵人
	        	///////////////////////
	        	if GetUnitAbilityLevel(ydl_unit, 'B04R') > 0 and IsUnitEnemy(ydl_unit,p) then
		        	call UnitDamageTarget(u1, ydl_unit, r * GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE), true, false, ATTACK_TYPE_CHAOS, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS) 
	        	endif
	    endloop
set p = null 
set u1 = null
set ydl_unit= null
endfunction
function Trig_A31R_STARTActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
	//////////
	//參數設定
	//////////
	set udg_A31R_damage[1]=(0.03/2.00)
	set udg_A31R_damage[2]=0.02
	set udg_A31R_damage[3]=(0.05/2.00)
	set udg_A31R_damage[4]=0.03
	call SaveUnitHandle(YDHT, h2i, 1, GetTriggerUnit() )
	//////////
	//啟動計時
	//////////
	call TimerStart(t, 1.00, true, function Trig_A31R_STARTFunc001T)
set t = null
endfunction
function InitTrig_A31R takes nothing returns nothing
    set gg_trg_A31R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A31R, Condition(function Trig_A31R_STARTConditions))
    call TriggerAddAction(gg_trg_A31R, function Trig_A31R_STARTActions)
endfunction//===========================================================================
// Trigger: A31 T start
//===========================================================================
function Trig_A31_T_startConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A01J'
endfunction
function Trig_A31_T_startFunc005Conditions takes nothing returns nothing
local unit u 
	if GetEventDamage() > 1 then
		set u = GetTriggerUnit()
		    if GetUnitAbilityLevel(u, 'B00O') > 0 then
			    ////////////////////////////////////
			    //傷害之前關閉觸發器，避免無限傷害閃退
			    ////////////////////////////////////
				call DisableTrigger( GetTriggeringTrigger() )
				call DestroyEffect( AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl", u, "chest") )
				call UnitDamageTarget(GetEventDamageSource(), u, 0.40 * GetEventDamage() , true, false, ATTACK_TYPE_CHAOS, DAMAGE_TYPE_UNKNOWN, WEAPON_TYPE_WHOKNOWS)
				call EnableTrigger( GetTriggeringTrigger() )
			endif
	endif	
set u = null	
endfunction
function Trig_A31_T_startActions takes nothing returns nothing
local trigger ltt =CreateTrigger()
local triggercondition ltc = TriggerAddCondition(ltt, Condition(function Trig_A31_T_startFunc005Conditions))
	///////////////////
	//傷害加深 持續時間
	///////////////////
	call TriggerRegisterUnitEvent( ltt, GetSpellTargetUnit(), EVENT_UNIT_DAMAGED )
	call Creat_Disposable_Timer_for_Trigger(ltt, 4.00 + 2.00 * I2R(GetUnitAbilityLevel(GetTriggerUnit(), 'A01J')) , ltc )
set ltt = null
set ltc = null
endfunction
//===========================================================================
function InitTrig_A31_T_start takes nothing returns nothing
    set gg_trg_A31_T_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_A31_T_start, Condition(function Trig_A31_T_startConditions))
    call TriggerAddAction(gg_trg_A31_T_start, function Trig_A31_T_startActions)
endfunction//===========================================================================
// Trigger: A32
//===========================================================================
function Trig_A32Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A32W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A32E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_A32 takes nothing returns nothing
    set gg_trg_A32 = CreateTrigger()
    call TriggerAddAction(gg_trg_A32, function Trig_A32Actions)
endfunction
//===========================================================================
// Trigger: A32W
//===========================================================================
function Trig_A32WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0G9'))
endfunction
function Trig_A32WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u2 = GetSpellTargetUnit()
local unit u3
local real x 
local real y 
    set u2 = GetSpellTargetUnit()
    // ----------------------------------------
    if ((u2 == udg_A32E_target[i])) then
        call TriggerSleepAction(2.00)
        set x = GetUnitX(u2)
        set y = GetUnitY(u2)
        
        set u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
        call UnitApplyTimedLife(u3,'BHwe',2.00)
        call UnitAddAbility( u3, 'A07N' )
        call SetUnitAbilityLevel( u3, 'A07N', GetUnitAbilityLevel(u1, 'A0G9') )
        call IssueImmediateOrder( u3, "stomp" )
        call DestroyEffect(AddSpecialEffectTarget("Units\\Undead\\Abomination\\AbominationExplosion.mdl",u2,"origin"))
    else
        call TriggerSleepAction(2.00)
        set x = GetUnitX(u2)
        set y = GetUnitY(u2)
        
        set u3 = CreateUnit(GetOwningPlayer(u1),'h02G',x,y,0)
        call UnitApplyTimedLife(u3,'BHwe',2.00)
        call UnitAddAbility( u3, 'A07K' )
        call SetUnitAbilityLevel( u3, 'A07K', GetUnitAbilityLevel(u1, 'A0G9') )
        call IssueImmediateOrder( u3, "stomp" )
        call DestroyEffect(AddSpecialEffectTarget("Units\\Undead\\Abomination\\AbominationExplosion.mdl",u2,"origin"))
    endif
set u3 = null
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_A32W takes nothing returns nothing
    set gg_trg_A32W = CreateTrigger()
    call TriggerAddCondition(gg_trg_A32W, Condition(function Trig_A32WConditions))
    call TriggerAddAction(gg_trg_A32W, function Trig_A32WActions)
endfunction//===========================================================================
// Trigger: A32E
//===========================================================================
function Trig_A32E_timer_Func004Func009Func004003001 takes nothing returns boolean
return(IsUnitInvisible(GetTriggerUnit(),GetFilterPlayer())==true)
endfunction
function Trig_A32E_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u2 = udg_A32E_target[i]
local location p1 = udg_A32E_P1[i]
local location p2 = udg_A32E_P2[i]
local real dmg
set udg_A32E_I[i]=(udg_A32E_I[i]+1)
call MoveLocation(p2, GetUnitX(u2), GetUnitY(u2))
call MoveLightningLoc(udg_A32E_l[i],p1,p2)
	if( udg_A32E_I[i]==udg_A32E_R[i] )then
		call DestroyEffect(udg_A32E_SE[i])
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t) 
		call DestroyLightning(udg_A32E_l[i])
		call RemoveLocation(p1)
		call RemoveLocation(p2)
		set udg_A32E_target[i] = null
	else
    	if((ModuloInteger(udg_A32E_I[i],10)==0))then
    		set dmg=((50.00+I2R(GetHeroInt(u1, true)))*(1+(0.05*(DistanceBetweenPoints(p1,p2)/(300.00-(50.00*I2R(GetUnitAbilityLevel(u1,'A0GB'))))))))
    		call UnitDamageTargetBJ(u1,u2,dmg,ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
    		call CreateTextTagUnitBJ(I2S(R2I(dmg)),u2,0,8.00,100,30.00,30.00,0)
    		call ShowTextTagForceBJ(false,GetLastCreatedTextTag(),YDWEGetPlayersMatchingNull(Condition(function Trig_A32E_timer_Func004Func009Func004003001)))
    		call SetTextTagPermanent(GetLastCreatedTextTag(),false)
    		call SetTextTagVelocityBJ(GetLastCreatedTextTag(),64,90)
    		call SetTextTagLifespan(GetLastCreatedTextTag(),2.00)
    		call SetTextTagFadepoint(GetLastCreatedTextTag(),2.00)
    	endif
	endif
set t= null
set u1= null
set u2= null
set p1= null
set p2= null
endfunction
function Trig_A32E_STARTActions2 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)	
local unit u1 = LoadUnitHandle(YDHT,h2i,1)
local unit u2 = LoadUnitHandle(YDHT,h2i,2)
local player	p =	GetOwningPlayer(u1) 
local integer i =	GetPlayerId(p) + 1
local player	p2 =	GetOwningPlayer(u2)
local integer	i2 =	GetPlayerId(p2) + 1
local integer	level	=	GetUnitAbilityLevel(u1,'A0GB')
	call	PauseTimer(t)
		if udg_omamori_Check[i2]==false then
			set udg_A32E_R[i]	=	(21+(level*10))
			set udg_A32E_I[i]	=	0
			set udg_A32E_P1[i]	=	GetUnitLoc(u1)
			set udg_A32E_P2[i]	=	GetUnitLoc(u2)
			set udg_A32E_l[i]	=	AddLightningLoc("HWSB",udg_A32E_P1[i],udg_A32E_P2[i])
			set udg_A32E_SE[i]	=	AddSpecialEffectLoc("units\\orc\\StasisTotem\\StasisTotem.mdl",udg_A32E_P1[i])
			call SetLightningColor(udg_A32E_l[i],1,0.00,0.00,1) 
			call TimerStart(t, 0.10, true, function Trig_A32E_Timer)
		endif
	//////////////////////////////////////////////////////////
	//aviod double no effect 
	//像是瞬間五個侍者 對一個御守的人放 將會沒有效果。
	//////////////////////////////////////////////////////////
	set udg_omamori_Check[i2] = false
	
set t = null
set u1 = null
set u2	= null
set p	=	null
set p2	=	null
endfunction
function Trig_A32E_STARTActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)	
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local player	p	=	GetOwningPlayer(u1) 
local integer i =	GetPlayerId(p) + 1
local real time=	(0.0001)
	//避免太早放W 沒效
	set udg_A32E_target[i]=u2
	//clock Init
	call SaveUnitHandle(YDHT, h2i,1,u1)
	call SaveUnitHandle(YDHT, h2i,2,u2)
	call TimerStart(t, time, false, function Trig_A32E_STARTActions2)
set t = null
set u1 = null
set u2	= null
set p	=	null
endfunction
function Trig_A32E_STARTConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0GB' then
	    call	Trig_A32E_STARTActions()
    endif
    return	false
endfunction
function InitTrig_A32E takes nothing returns nothing
    set gg_trg_A32E=CreateTrigger()
    call TriggerAddCondition(gg_trg_A32E, Condition(function Trig_A32E_STARTConditions))
endfunction//===========================================================================
// Trigger: A33
//===========================================================================
function Trig_A33Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A33W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A33E_Special, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A33_R_enable, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A33T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    set udg_A33T_G[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
endfunction
//===========================================================================
function InitTrig_A33 takes nothing returns nothing
    set gg_trg_A33 = CreateTrigger()
    call TriggerAddAction(gg_trg_A33, function Trig_A33Actions)
endfunction
//===========================================================================
// Trigger: A33W
//===========================================================================
function Trig_A33WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0HB' ) )
endfunction
function Trig_A33WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local unit u3 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
call UnitAddAbility(u1,'A0HD')
call SetUnitAbilityLevel(u1,'A0HD',GetUnitAbilityLevel(u1,'A0HB'))
call UnitAddAbility(u2,'A0HC')
call SetUnitAbilityLevel(u2,'A0HC',GetUnitAbilityLevel(u1,'A0HB'))
set u3 = CreateUnit(GetOwningPlayer(u1),'h01E',x,y,0)
call UnitApplyTimedLife(u3,'BHwe',2.00)
call UnitAddAbility( u3, 'A0HE' )
call SetUnitAbilityLevel( u3, 'A0HE', GetUnitAbilityLevel(u1, 'A0HB') )
call IssueTargetOrderById(u3, 852101, u1)
call YDWEPolledWaitNull(6.00)
call UnitRemoveAbility(u1, 'A0HD')
call UnitRemoveAbility(u2, 'A0HC')
set u1 = null
set u2 = null
set u3 = null
endfunction
function InitTrig_A33W takes nothing returns nothing
    set gg_trg_A33W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A33W, Condition(function Trig_A33WConditions))
    call TriggerAddAction(gg_trg_A33W, function Trig_A33WActions)
endfunction//===========================================================================
// Trigger: A33E_Special
//===========================================================================
function Trig_A33E_SpecialConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0HF'))
endfunction
function Trig_A33E_dmg1 takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real r =(GetEventDamage()*(0.00+(0.05*I2R(GetUnitAbilityLevel(u1,'A0HF')))))
call SetUnitState(u1,UNIT_STATE_LIFE,(GetUnitState(u1,UNIT_STATE_LIFE)+r))
set u1 = null
endfunction
function Trig_A33E_dmg2 takes nothing returns nothing
local trigger t = GetTriggeringTrigger()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local real r = (GetEventDamage()*(0.05+(0.15*I2R(GetUnitAbilityLevel(u1,'A0HF')))))
call SetUnitState(u1,UNIT_STATE_LIFE,(GetUnitState(u1,UNIT_STATE_LIFE)+r))
set t = null
set u1 = null
endfunction
function Trig_A33E_SpecialActions takes nothing returns nothing
local trigger ltt1 =CreateTrigger()
local trigger ltt2 =CreateTrigger()
local integer h2i = GetHandleId(ltt2)
local effect e1 = AddSpecialEffectTarget("war3mapImported\\Demonfilth.mdx",GetTriggerUnit(),"overhead")
local effect e2 = AddSpecialEffectTarget("war3mapImported\\Demonfilth.mdx",GetSpellTargetUnit(),"overhead")
call TriggerAddCondition(ltt1, Condition(function Trig_A33E_dmg1))
call TriggerRegisterUnitEvent( ltt1, GetTriggerUnit(), EVENT_UNIT_DAMAGED )
call SaveUnitHandle(YDHT, h2i, 1,GetTriggerUnit())
call TriggerAddCondition(ltt2, Condition(function Trig_A33E_dmg2))
call TriggerRegisterUnitEvent( ltt2, GetSpellTargetUnit(), EVENT_UNIT_DAMAGED )
call YDWEPolledWaitNull(6.00)
call DestroyEffect(e1)
call DestroyEffect(e2)
call DestroyTrigger(ltt1)
call DestroyTrigger(ltt2)
call FlushChildHashtable(YDHT, h2i)
set e1 = null
set e2 = null
set ltt1 = null
set ltt2 = null
endfunction
//===========================================================================
function InitTrig_A33E_Special takes nothing returns nothing
    set gg_trg_A33E_Special = CreateTrigger()
    call TriggerAddCondition(gg_trg_A33E_Special, Condition(function Trig_A33E_SpecialConditions))
    call TriggerAddAction(gg_trg_A33E_Special, function Trig_A33E_SpecialActions)
endfunction
//===========================================================================
// Trigger: A33 R enable
//===========================================================================
function Trig_A33_R_enableConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0LF') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A0LF') == 1))
endfunction
function Trig_A33_R_enableActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A33_R__reduce_damage, GetTriggerUnit(), EVENT_UNIT_DAMAGED)
endfunction
//===========================================================================
function InitTrig_A33_R_enable takes nothing returns nothing
    set gg_trg_A33_R_enable = CreateTrigger()
    call TriggerAddCondition(gg_trg_A33_R_enable, Condition(function Trig_A33_R_enableConditions))
    call TriggerAddAction(gg_trg_A33_R_enable, function Trig_A33_R_enableActions)
endfunction
//===========================================================================
// Trigger: A33 R  reduce damage
//===========================================================================
function Trig_A33_R__reduce_damageConditions takes nothing returns boolean
    return ((GetEventDamage() >= 2.00))
endfunction
function Trig_A33_R__reduce_damageActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit ydl_unit
local real r = (GetEventDamage()*(0.05+(0.10*I2R(GetUnitAbilityLevel(u1,'A0LF')))))
local player p = GetOwningPlayer(u1)
    call GroupEnumUnitsInRange(udg_Group[9], GetUnitX(u1), GetUnitY(u1), 300.00, null)
    	loop
    		set ydl_unit = FirstOfGroup(udg_Group[9])
    		exitwhen (ydl_unit == null) 
        	call GroupRemoveUnit(udg_Group[9], ydl_unit)
        		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and (IsUnitEnemy(ydl_unit,p)) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
        			call UnitDamageTargetBJ(u1,ydl_unit,r,ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
        			call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\HumanBloodRifleman.mdl",ydl_unit,"head")) 
        		endif
    	endloop
set p = null
set u1 = null
set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_A33_R__reduce_damage takes nothing returns nothing
    set gg_trg_A33_R__reduce_damage = CreateTrigger()
    call TriggerAddCondition(gg_trg_A33_R__reduce_damage, Condition(function Trig_A33_R__reduce_damageConditions))
    call TriggerAddAction(gg_trg_A33_R__reduce_damage, function Trig_A33_R__reduce_damageActions)
endfunction//===========================================================================
// Trigger: A33T
//===========================================================================
globals
real array udg_A33T_A
integer array udg_A33T_I
real array udg_A33T_X
real array udg_A33T_Y
endglobals
function Trig_A33TConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0LQ' ) )
endfunction
function Trig_A33T_Timer takes nothing returns nothing
local unit ydl_unit
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local player p =GetOwningPlayer(u1)
local integer i =GetConvertedPlayerId(p)
local real x = udg_A33T_X[i]
local real y = udg_A33T_Y[i]
local real a = udg_A33T_A[i]
local real x1
local real y1
local unit u3
local real dmg
 
set udg_A33T_I[i] = udg_A33T_I[i] +1
	if udg_A33T_I[i]<=7 then
		set x1 = x + 300.00*I2R(udg_A33T_I[i])*Cos(a)
		set y1 = y + 300.00*I2R(udg_A33T_I[i])*Sin(a)
		call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\FeralSpirit\\feralspirittarget.mdl",x1,y1))
	else
    	if (udg_A33T_I[i]>7) and (udg_A33T_I[i]<=14) then
	    	set dmg = (200.00+(200.00*I2R(GetUnitAbilityLevel(u1,'A0LQ'))))
        	set x1 = x + 300.00*I2R(udg_A33T_I[i]-7)*Cos(a)
        	set y1 = y + 300.00*I2R(udg_A33T_I[i]-7)*Sin(a)
	        	set u3 = CreateUnit(p,'h02G',x1,y1,0)
	        	call UnitApplyTimedLife(u3,'BHwe',2.00)
	        	call UnitAddAbility( u3, 'A0HH' )
	        	call SetUnitAbilityLevel( u3, 'A0HH', GetUnitAbilityLevel(u1, 'A0LQ') )
	        	call IssueImmediateOrderById(u3, 852127) 
        	call DestroyEffect(AddSpecialEffect("war3mapImported\\Desecrate.mdx",x1,y1))
        	call GroupEnumUnitsInRange(udg_Group[1], x1, y1, 300.00, null)
        		loop
        			set ydl_unit = FirstOfGroup(udg_Group[1])
        			exitwhen ydl_unit == null 
        			call GroupRemoveUnit(udg_Group[1], ydl_unit)
            			if ( (IsUnitInGroup(ydl_unit,udg_A33T_G[i])==false) and (IsUnitEnemy(ydl_unit,p)) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
            				call UnitDamageTargetBJ(u1,ydl_unit,dmg,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
            				call GroupAddUnit(udg_A33T_G[i],ydl_unit)
            			endif
        		endloop 
    endif
endif
    if udg_A33T_I[i]>14 then
		call FlushChildHashtable(YDHT, h2i)
    	call DestroyTimer(t) 
    endif
set t= null
set u1= null
set ydl_unit= null 
set p = null
endfunction
function Trig_A33TActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local real x=GetUnitX(u1)
local real y=GetUnitY(u1)
local real x1=GetSpellTargetX()
local real y1=GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
	call SaveUnitHandle(YDHT, h2i, 1, GetTriggerUnit())
	set udg_A33T_A[i]=a
	set udg_A33T_I[i]=0
	set udg_A33T_X[i]=x
	set udg_A33T_Y[i]=y
	call GroupClear(udg_A33T_G[i])
	call TimerStart(t, 0.18, true, function Trig_A33T_Timer)
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_A33T takes nothing returns nothing
    set gg_trg_A33T=CreateTrigger()
    call TriggerAddCondition(gg_trg_A33T, Condition(function Trig_A33TConditions))
    call TriggerAddAction(gg_trg_A33T, function Trig_A33TActions)
endfunction//===========================================================================
// Trigger: A34
//===========================================================================
globals
boolean array udg_A34T_B
real array udg_A34D_shied
real array udg_A34D_shield_MAX
effect array udg_A34_E
endglobals
function Trig_A34_D_Timer takes nothing returns nothing
local integer h2i = GetHandleId(GetExpiredTimer())
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    if udg_A34D_shied[i] <= 16.00 then
        set udg_A34D_shied[i] = 0.00
        call UnitRemoveAbility(u1,'A0X9')
    else
        call UnitAddAbility(u1,'A0X9') 
        	if udg_A34D_shied[i] > udg_A34D_shield_MAX[i] then
            	set udg_A34D_shied[i] = udg_A34D_shield_MAX[i]
            	set udg_A34D_shied[i] = ( udg_A34D_shied[i] - 16.00 )
        	else
            	set udg_A34D_shied[i] = ( udg_A34D_shied[i] - 16.00 )
        	endif
    endif
    //call BJDebugMsg(R2S(udg_A34D_shied[i]))
    //call BJDebugMsg(R2S(udg_A34D_shield_MAX[i]))
set u1 = null
endfunction
function Trig_A34Actions takes nothing returns nothing
local integer i =GetPlayerId(GetOwningPlayer(udg_A_common_HERO)) + 1
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)	
    call TriggerRegisterUnitEvent(gg_trg_A34HERO_D, udg_A_common_HERO, EVENT_UNIT_DAMAGED)
    call TriggerRegisterUnitEvent(gg_trg_A34Hero_cast, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A34_W_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A34_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A34_R_enable, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A34T_Learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_A34_T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
	//初始化 最大防禦盾 血量
    set udg_A34D_shield_MAX[i] = 400.00
call SaveUnitHandle(YDHT, h2i, 1, udg_A_common_HERO)
call TimerStart(t, 1.30, true, function Trig_A34_D_Timer)
set t = null 
endfunction
//===========================================================================
function InitTrig_A34 takes nothing returns nothing
    set gg_trg_A34 = CreateTrigger()
    call TriggerAddAction(gg_trg_A34, function Trig_A34Actions)
endfunction
//===========================================================================
// Trigger: A34HERO D
//
// 'A0X9'
//===========================================================================
globals
boolean array udg_A34_B
endglobals
function Trig_A34HERO_DConditions takes nothing returns nothing
local unit u1 
local real r = GetEventDamage()
local integer i
	if r > 2.00 then
		set u1 = GetTriggerUnit()
		set i =GetPlayerId(GetOwningPlayer(u1)) + 1
			    if (udg_A34D_shied[i] >= r) then
			        set udg_A34D_shied[i] = ( udg_A34D_shied[i] - r )
			        call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) + r ) )
			    else
			    	call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) + udg_A34D_shied[i] ) )
			        set udg_A34D_shied[i] = 0.00
			        call UnitRemoveAbility(u1,'A0X9')
			    endif 
	endif
set u1 = null
endfunction
//===========================================================================
function InitTrig_A34HERO_D takes nothing returns nothing
    set gg_trg_A34HERO_D = CreateTrigger()
    call TriggerAddCondition(gg_trg_A34HERO_D, Condition(function Trig_A34HERO_DConditions))
endfunction//===========================================================================
// Trigger: A34Hero cast
//===========================================================================
function Trig_A34Hero_castConditions takes nothing returns boolean
local integer id = GetSpellAbilityId()
return id == 'A0IX' or id == 'A0KF' or id == 'A0M7' or id == 'A0HZ' and GetUnitLifePercent(GetTriggerUnit()) > 15.00
endfunction
function Trig_A34Hero_castActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
local integer i2 = 0
local integer id = GetSpellAbilityId()
	//A34W
    if id == 'A0IX' then
	    set i2 = 1
        set udg_A34D_shied[i] = ( udg_A34D_shied[i] + ( GetUnitState(u1, UNIT_STATE_MAX_LIFE) * 0.16 ) )
        	if udg_A34_B[i] == false then
	        	call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) * 0.92 ) )
        	endif
    //A34E   	
    elseif id == 'A0KF' then
        set i2 = 1 
        set udg_A34D_shied[i] = ( udg_A34D_shied[i] + ( GetUnitState(u1, UNIT_STATE_MAX_LIFE) * 0.20 ) )
        	if udg_A34_B[i] == false then
            	call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) * 0.92 ) )
        	endif
    //A34T
    elseif id == 'A0HZ' then
        set i2 = 1 
        set udg_A34D_shied[i] = ( udg_A34D_shied[i] + ( GetUnitState(u1, UNIT_STATE_MAX_LIFE) * 0.34 ) )
        	if udg_A34_B[i] == false then
           		call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) * 0.83 ) )
  			endif
    //A34R      			
    elseif id == 'A0M7' then
        set i2 = 1
        set udg_A34D_shied[i] = ( udg_A34D_shied[i] + ( GetUnitState(u1, UNIT_STATE_MAX_LIFE) * 0.12 ) )
        	if udg_A34_B[i] == false then
            	call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) * 0.94 ) )
        	endif
    endif
    	//製造特效 確認
    	if udg_A34D_shied[i] > 0.00 and i2 == 1 then 
    		call UnitAddAbility(u1,'A0X9') 
    	endif 
set u1 = null
endfunction
//===========================================================================
function InitTrig_A34Hero_cast takes nothing returns nothing
    set gg_trg_A34Hero_cast = CreateTrigger()
    call TriggerAddCondition(gg_trg_A34Hero_cast, Condition(function Trig_A34Hero_castConditions))
    call TriggerAddAction(gg_trg_A34Hero_cast, function Trig_A34Hero_castActions)
endfunction//===========================================================================
// Trigger: A34 W start
//===========================================================================
globals
real array udg_A34W_A
integer array udg_A34W_I
endglobals
function Trig_A34_W_startConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0IX'))
endfunction
function Trig_A34_W_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
local player p = GetOwningPlayer(u1)
local integer i =GetPlayerId(p) + 1
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a = udg_A34W_A[i]
local real x1 
local real y1 
local unit ydl_unit
local integer i2 = 0
local real dmg
local unit u3
	if(udg_A34W_I[i]>=40)then
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
		call KillUnit(u1)
	else
    	set udg_A34W_I[i]=(udg_A34W_I[i]+1)
    	set x1 = x + 25.00*Cos(a)
    	set y1 = y + 25.00*Sin(a)
    	call SetUnitX(u1,x1)
    	call SetUnitY(u1,y1)
    	call GroupEnumUnitsInRange(udg_Group[1], x1, y1, 150.00, null)
    		loop
    			set ydl_unit = FirstOfGroup(udg_Group[1])
    			exitwhen ydl_unit == null or i2 == 1
        		call GroupRemoveUnit(udg_Group[1], ydl_unit)
        			if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false and GetUnitPointValue(ydl_unit) != 1 then
        				set i2 = 1
        			endif
    		endloop
    		call GroupClear(udg_Group[1])
	       		if(i2==1)then
		    		set u3 = CreateUnit(p,'h02G',x,y,0) 
	        		call UnitApplyTimedLife(u3,'BHwe',2.00)
	        		call UnitAddAbility( u3, 'A0K7' ) 
		    		set dmg = (10.00+(90.00*I2R(GetUnitAbilityLevel(udg_S01_hero_of_player[i],'A0IX'))))
	        		call FlushChildHashtable(YDHT, h2i)
	        		call DestroyTimer(t)
	        		call KillUnit(u1)
	        		call GroupEnumUnitsInRange(udg_Group[1], x1, y1, 225.00, null)
	        			loop
	        				set ydl_unit = FirstOfGroup(udg_Group[1])
	        				exitwhen ydl_unit == null 
	        				call GroupRemoveUnit(udg_Group[1], ydl_unit)
	            				if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false then
	            					call UnitDamageTargetBJ(udg_S01_hero_of_player[i],ydl_unit,(dmg+(GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)*0.11)),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
	            					call IssueTargetOrder(u3,"slow",ydl_unit)
	            				endif
	        			endloop
	        	endif
	endif
set t= null
set u1= null
set ydl_unit= null 
set u3 = null
endfunction
function Trig_A34_W_startActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local real a = Atan2(y1-y,x1-x)
local integer i =GetPlayerId(GetOwningPlayer(u1)) + 1
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u3 = CreateUnit(GetOwningPlayer(u1),'e001',x,y,a*bj_RADTODEG) 
	set udg_A34W_A[i]=a
	set udg_A34W_I[i]=0
	call SaveUnitHandle(YDHT, h2i, 1, u3 )
	call TimerStart(t, 0.03, true, function Trig_A34_W_Timer)
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_A34_W_start takes nothing returns nothing
    set gg_trg_A34_W_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_A34_W_start, Condition(function Trig_A34_W_startConditions))
    call TriggerAddAction(gg_trg_A34_W_start, function Trig_A34_W_startActions)
endfunction
//===========================================================================
// Trigger: A34 E
//===========================================================================
function Trig_A34_EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0KF'))
endfunction
function Trig_A34E_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 1)
		call UnitRemoveAbility(u1, 'B06I')
	call FlushChildHashtable(YDHT, h2i)
	call DestroyTimer(t)
set u1 = null
set t = null
endfunction
function Trig_A34_EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetUnitX(u2)
local real y1 = GetUnitY(u2)
local real dt = SquareRoot( ( Pow((x1-x),2)) + Pow((y1-y),2)) 
local real r1
local real r2
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
	if dt <=148.00 then
		set r2=1.80
	else
		set r1=(dt/100.00)
		set r2=(1.80/I2R(R2I(r1)))
	endif
call UnitAddAbility(u1,'A02O')
call SetUnitAbilityLevel(u1,'A02O',GetUnitAbilityLevel(u1,'A0KF'))
call TriggerSleepAction(0.00)
	call SaveUnitHandle(YDHT, h2i, 1, u2 )
	call TimerStart(t, r2, false, function Trig_A34E_Timer)
set x1 = GetUnitX(u2)
set y1 = GetUnitY(u2)
call SetUnitX(u1,x1)
call SetUnitY(u1,y1)
call IssueTargetOrder(u1,"attack",u2)
	call TriggerSleepAction(6.00)
	call UnitRemoveAbility(u1,'A02O')
set t = null
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_A34_E takes nothing returns nothing
    set gg_trg_A34_E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A34_E, Condition(function Trig_A34_EConditions))
    call TriggerAddAction(gg_trg_A34_E, function Trig_A34_EActions)
endfunction//===========================================================================
// Trigger: A34 R enable
//===========================================================================
function Trig_A34_R_enableConditions takes nothing returns boolean
    return ((GetLearnedSkill() == 'A0M7') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A0M7') == 1))
endfunction
function Trig_A34_R_enableFunc001T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1=LoadUnitHandle(YDHT, h2i, 1)
local integer i =GetPlayerId(GetOwningPlayer(u1)) + 1
local integer i2
local real x = GetUnitX(u1)
local real x1 
local real y = GetUnitY(u1)
local real y1
local real dt
/////////////////////////////////////////////////////
//if player 1~5 then check 6~10 player
//   player 6~10 then check 1~5 player
/////////////////////////////////////////////////////
if i > 5 then
	set i2 = 1 
    loop
	    exitwhen i2 > 5
        set x1 = GetUnitX(udg_S01_hero_of_player[i2])
        set y1 = GetUnitY(udg_S01_hero_of_player[i2])
        set dt = SquareRoot( ( Pow((x1-x),2)) + Pow((y1-y),2)) 
	        if dt<=2500.00 and GetUnitLifePercent(udg_S01_hero_of_player[i2])<= 5.00 + 10.00*I2R(GetUnitAbilityLevel(u1,'A0M7')) then
            	call UnitShareVision( udg_S01_hero_of_player[i2], GetOwningPlayer(u1), true )
            	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\Bloodlust\\BloodlustTarget.mdl",u1,"overhead"))
	        else
	        	call UnitShareVision( udg_S01_hero_of_player[i2], GetOwningPlayer(u1), false )
            endif
        set i2 = i2 + 1
    endloop 
else
    set i2 = 6
    loop
	    exitwhen i2 > 10
        set x1 = GetUnitX(udg_S01_hero_of_player[i2])
        set y1 = GetUnitY(udg_S01_hero_of_player[i2])
        set dt = SquareRoot( ( Pow((x1-x),2)) + Pow((y1-y),2)) 
	        if dt<=2500.00 and GetUnitLifePercent(udg_S01_hero_of_player[i2])<= 5.00 + 10.00*I2R(GetUnitAbilityLevel(u1,'A0M7')) then
            	call UnitShareVision( udg_S01_hero_of_player[i2], GetOwningPlayer(u1), true )
            	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\Bloodlust\\BloodlustTarget.mdl",u1,"overhead"))
	        else
	        	call UnitShareVision( udg_S01_hero_of_player[i2], GetOwningPlayer(u1), false )
            endif
        set i2 = i2 + 1 
    endloop 
endif
set u1 = null
set t = null 
endfunction
function Trig_A34_R_enableActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
call SaveUnitHandle(YDHT, h2i, 1, GetTriggerUnit() )
call TimerStart(t, 2.00, true, function Trig_A34_R_enableFunc001T)
set t = null
endfunction
//===========================================================================
function InitTrig_A34_R_enable takes nothing returns nothing
    set gg_trg_A34_R_enable = CreateTrigger()
    call TriggerAddCondition(gg_trg_A34_R_enable, Condition(function Trig_A34_R_enableConditions))
    call TriggerAddAction(gg_trg_A34_R_enable, function Trig_A34_R_enableActions)
endfunction
//===========================================================================
// Trigger: A34T_Learn
//===========================================================================
function Trig_A34T_LearnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0HZ' and IsUnitIllusion(GetTriggerUnit()) != true then
	    call IncUnitAbilityLevel( GetTriggerUnit(), 'A0I2' )
	    set rose_integer = GetPlayerId(GetTriggerPlayer()) + 1
	    set udg_A34D_shield_MAX[rose_integer] = udg_A34D_shield_MAX[rose_integer] + 100.00 
    endif
	return false
endfunction
function InitTrig_A34T_Learn takes nothing returns nothing
    set gg_trg_A34T_Learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_A34T_Learn, Condition(function Trig_A34T_LearnConditions))
endfunction//===========================================================================
// Trigger: A34 T
//===========================================================================
function Trig_A34_TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0HZ'))
endfunction
function Trig_A34_TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	
set udg_A34_B[i] = true
call YDWEPolledWaitNull(17.00)
set udg_A34_B[i] = false
    if(IsUnitAliveBJ(u1))then
        call SetUnitLifeBJ(u1,(GetUnitState(u1,UNIT_STATE_LIFE)+(GetUnitState(u1,UNIT_STATE_MAX_LIFE)*0.50)))
    endif
    
set u1 = null
endfunction
//===========================================================================
function InitTrig_A34_T takes nothing returns nothing
    set gg_trg_A34_T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A34_T, Condition(function Trig_A34_TConditions))
    call TriggerAddAction(gg_trg_A34_T, function Trig_A34_TActions)
endfunction
//===========================================================================
// Trigger: A35
//
// A0XA
//===========================================================================
function Trig_A35Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A35_D_count, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A35D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_A35W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_A35E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_A35E_PLAY, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_A35R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_A35T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call SetPlayerAbilityAvailable( GetOwningPlayer(udg_A_common_HERO), 'A0M0', false )
    // ---------------------------------
    call EnableTrigger( gg_trg_A35T_damage_DD )
    // 註冊普通攻擊捕捉
    call TriggerRegisterUnitEvent(gg_trg_AUD_UP, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    call GroupAddUnitSimple( udg_A_common_HERO, udg_AUD_Group2 )
endfunction
//===========================================================================
function InitTrig_A35 takes nothing returns nothing
    set gg_trg_A35 = CreateTrigger()
    call TriggerAddAction(gg_trg_A35, function Trig_A35Actions)
endfunction
//===========================================================================
// Trigger: A35 D count
//===========================================================================
globals
integer array udg_A35_I
endglobals
function Trig_A35_D_countActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
    set udg_A35_I[i] = ( udg_A35_I[i] + 1 )
    	if ((udg_A35_I[i] == 4)) then
        	call SetPlayerAbilityAvailable( GetOwningPlayer(u1), 'A0FX', false )
        	call SetPlayerAbilityAvailable( GetOwningPlayer(u1), 'A0M0', true )
    	endif 
set u1 = null 
endfunction
//===========================================================================
function InitTrig_A35_D_count takes nothing returns nothing
    set gg_trg_A35_D_count = CreateTrigger()
    call TriggerAddCondition(gg_trg_A35_D_count, function Trig_A35_D_countActions)
endfunction//===========================================================================
// Trigger: A35D
//===========================================================================
globals
boolean array A35_B
endglobals
function Trig_A35DConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0M0'))
endfunction
function Trig_A35DActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
    call SetPlayerAbilityAvailable( GetOwningPlayer(GetTriggerUnit()), 'A0FX', true )
    call SetPlayerAbilityAvailable( GetOwningPlayer(GetTriggerUnit()), 'A0M0', false )
    set A35_B[i] = true
    set udg_A35_I[i] = 0
set u1 = null 
endfunction
//===========================================================================
function InitTrig_A35D takes nothing returns nothing
    set gg_trg_A35D = CreateTrigger()
    call TriggerAddCondition(gg_trg_A35D, Condition(function Trig_A35DConditions))
    call TriggerAddAction(gg_trg_A35D, function Trig_A35DActions)
endfunction//===========================================================================
// Trigger: A35W
//===========================================================================
function Trig_A35WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0IW' ) )
endfunction
function Trig_A35WActions takes nothing returns nothing
local unit ydl_unit
local unit u1= GetTriggerUnit()
local real x= GetUnitX(u1)
local real y= GetUnitY(u1)
local real x2
local real y2
local real a
local player p = GetOwningPlayer(u1)
local integer i=GetConvertedPlayerId(p)
call TriggerSleepAction(0.10)
    	call GroupEnumUnitsInRange(udg_Group[7], x, y, 485.00, null)
    		loop
    			set ydl_unit=FirstOfGroup(udg_Group[7])
    			exitwhen ( ydl_unit == null )
        		call GroupRemoveUnit(udg_Group[7], ydl_unit)
        			if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) and ( IsUnitType(ydl_unit, UNIT_TYPE_MAGIC_IMMUNE) == false ) and ( IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false ) and ( IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false ) and ( GetUnitPointValue(ydl_unit) != 1 ) ) then
        				set x2=GetUnitX(ydl_unit)
        				set y2=GetUnitY(ydl_unit)
        				set a=Atan2(y2 - y, x2 - x) * bj_RADTODEG
        				set udg_KnockBack_Angle=a
       	 				set udg_KnockBack_Boolean1=false
        				set udg_KnockBack_Dist=20.00
        				set udg_KnockBack_Rate=0.95
        				set udg_KnockBack_Time=1.50
        				set udg_KnockBack_Unit=ydl_unit
        				set udg_KnockBack_Interval=( 0.20 / 10.00 )
        				set udg_KnockBack_I2=i
            				if ( A35_B[i] ) then
            					set udg_KnockBack_Trigger=gg_trg_A35W_knock
            				else
            					set udg_KnockBack_Trigger=udg_Trigger_null
            				endif
        				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl", ydl_unit, "overhead"))
        				call TriggerExecute(gg_trg_KnockBack)
        				endif
    		endloop
set p = null 
set u1=null
set ydl_unit=null
endfunction
//===========================================================================
function InitTrig_A35W takes nothing returns nothing
    set gg_trg_A35W=CreateTrigger()
    call TriggerAddCondition(gg_trg_A35W, Condition(function Trig_A35WConditions))
    call TriggerAddAction(gg_trg_A35W, function Trig_A35WActions)
endfunction//===========================================================================
// Trigger: A35W knock
//===========================================================================
function Trig_A35W_knockActions takes nothing returns nothing
	local unit u3
	    set u3 = CreateUnit(GetOwningPlayer(udg_KnockBack_Unit), 'h02G', GetUnitX(udg_KnockBack_Unit),GetUnitY(udg_KnockBack_Unit),0)
	    call ShowUnit(u3, false)
	    call UnitApplyTimedLife(u3, 'BHwe', 1.00)
	    call UnitAddAbility(u3, 'A09F')
	    call SetUnitAbilityLevel(u3, 'A09F', GetUnitAbilityLevel(udg_S01_hero_of_player[udg_KnockBack_I2], 'A0IW') )
	    call IssueTargetOrder(u3, "ensnare", udg_KnockBack_Unit) 
	set u3 = null 
endfunction
//===========================================================================
function InitTrig_A35W_knock takes nothing returns nothing
    set gg_trg_A35W_knock = CreateTrigger()
    call TriggerAddAction(gg_trg_A35W_knock, function Trig_A35W_knockActions)
endfunction//===========================================================================
// Trigger: A35E 
//===========================================================================
function Trig_A35EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0I5'))
endfunction
function Trig_A35EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))	
/////////////////////////////////////////////////
// avoid the boolean cavert
//////////////////////////////////////////////////
    if (A35_B[i]) then
	set A35_B[i]= false
	set udg_A35E_B[i]=true
        call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",u1,"origin") )
        call TriggerSleepAction(14.80) 
        set udg_A35E_B[i]= false
    endif
set u1 = null
endfunction
//===========================================================================
function InitTrig_A35E takes nothing returns nothing
    set gg_trg_A35E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A35E, Condition(function Trig_A35EConditions))
    call TriggerAddAction(gg_trg_A35E, function Trig_A35EActions)
endfunction
//===========================================================================
// Trigger: A35E_PLAY
//===========================================================================
function Trig_A35E_PLAYConditions takes nothing returns boolean
    return ( GetUnitAbilityLevel(GetTriggerUnit(),'B07H') > 0 and (GetRandomInt(1, 4) == 1))
endfunction
function Trig_A35E_PLAYActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local real r = (GetUnitState(u1,UNIT_STATE_MAX_MANA)*(0.02*I2R(GetUnitAbilityLevel(u1,'A0I5'))))
call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIma\\AImaTarget.mdl", u1, "origin") )
call SetUnitState(u1, UNIT_STATE_MANA, (GetUnitState(u1,UNIT_STATE_MANA)+r))
	if udg_A35E_B[i] then
		call SetUnitState(u1, UNIT_STATE_LIFE, (GetUnitState(u1,UNIT_STATE_LIFE)+r))
	endif
set u1 = null
endfunction
//===========================================================================
function InitTrig_A35E_PLAY takes nothing returns nothing
    set gg_trg_A35E_PLAY = CreateTrigger()
    call TriggerAddCondition(gg_trg_A35E_PLAY, Condition(function Trig_A35E_PLAYConditions))
    call TriggerAddAction(gg_trg_A35E_PLAY, function Trig_A35E_PLAYActions)
endfunction//===========================================================================
// Trigger: A35R
//===========================================================================
function Trig_A35RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A087'))
endfunction
function Trig_A35RActions takes nothing returns nothing
local unit ydl_unit
local unit u1 = GetTriggerUnit() 
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local real x2 
local real y2
local player p = GetOwningPlayer(u1)
local integer i3 =GetConvertedPlayerId(p)
local real dmg = (50.00+(100.00*I2R(GetUnitAbilityLevel(u1,'A087'))))
local integer i = 1
////////////////////////////////////////////
//wait for the spell effect 
call TriggerSleepAction(0.00)
///////////////////////////////////////////
    loop
        exitwhen i>60
        
        set x2 = x + 325.00*Cos(I2R(i*6))
        set y2 = y + 325.00*Sin(I2R(i*6))
        call AddSpecialEffect("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",x2,y2)
    	set i = i + 1
    endloop
		//damage
		if A35_B[i3] then
			set A35_B[i3]=false 
   	 		call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",u1,"origin")) 
        	call GroupEnumUnitsInRange(udg_Group[1], x, y, 395.00, null)
           	 	loop
            		set ydl_unit = FirstOfGroup(udg_Group[1])
                	exitwhen ydl_unit == null 
                	call GroupRemoveUnit(udg_Group[1], ydl_unit)
                		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitEnemy(ydl_unit,p)) and (GetUnitAbilityLevel(ydl_unit, 'B07Z') > 0) ) then
	                		call UnitDamageTargetBJ(u1,ydl_unit,dmg,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
                    		call UnitDamageTargetBJ(u1,ydl_unit,(0.12*GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
                		endif 
            	endloop
    else
        call GroupEnumUnitsInRange(udg_Group[1], x, y, 395.00, null)
            loop
            	set ydl_unit = FirstOfGroup(udg_Group[1])
                exitwhen ydl_unit == null 
                call GroupRemoveUnit(udg_Group[1], ydl_unit)
                	if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitEnemy(ydl_unit,p)) and (GetUnitAbilityLevel(ydl_unit, 'B07Z') > 0) ) then
                    	call UnitDamageTargetBJ(u1,ydl_unit,dmg,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
                	endif
                   
            endloop
    endif
set p = null
set u1 = null
set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_A35R takes nothing returns nothing
    set gg_trg_A35R = CreateTrigger()
    call TriggerAddCondition(gg_trg_A35R, Condition(function Trig_A35RConditions))
    call TriggerAddAction(gg_trg_A35R, function Trig_A35RActions)
endfunction
//===========================================================================
// Trigger: A35T
//===========================================================================
function Trig_A35TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0NJ') and (GetUnitAbilityLevel(GetSpellTargetUnit(), 'A0XA') == 0) and (IsUnitInGroup(GetSpellTargetUnit(), udg_AUD_Group) != true))
endfunction
function Trig_A35TActions takes nothing returns nothing
    call GroupAddUnitSimple( GetSpellTargetUnit(), udg_AUD_Group )
    call UnitAddAbility( GetSpellTargetUnit(), 'A0XA' )
    call UnitMakeAbilityPermanent( GetSpellTargetUnit(), true, 'A0XA' )
    call TriggerRegisterUnitEvent(udg_AUD_Trigger[udg_AUD_time], GetSpellTargetUnit(), EVENT_UNIT_DAMAGED)
endfunction
//===========================================================================
function InitTrig_A35T takes nothing returns nothing
    set gg_trg_A35T = CreateTrigger()
    call TriggerAddCondition(gg_trg_A35T, Condition(function Trig_A35TConditions))
    call TriggerAddAction(gg_trg_A35T, function Trig_A35TActions)
endfunction
//===========================================================================
// Trigger: A35T damage DD 
//===========================================================================
function Trig_A35T_damage_DDConditions takes nothing returns boolean
    return (IsTriggerEnabled(GetTriggeringTrigger()) == true) and (GetUnitPointValue(GetEventDamageSource()) == 135) and (GetUnitAbilityLevel(GetTriggerUnit(), 'B07G') > 0) or (GetUnitAbilityLevel(GetTriggerUnit(), 'B07J') > 0)
endfunction
function Trig_A35T_damage_DDActions takes nothing returns nothing
local unit u2 = GetTriggerUnit()
local unit u1 = GetEventDamageSource()
local real r = GetUnitState(u1,UNIT_STATE_MANA)*(0.15+(0.04*I2R(GetUnitAbilityLevel(u1,'A0NJ'))))
local force f = YDWEGetPlayersEnemiesNull(GetOwningPlayer(u1))
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
call UnitRemoveAbility(u2, 'B07G')
call UnitRemoveAbility(u2, 'B07J')
	call UnitDamageTargetBJ(u1,u2,r,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL)
	call CreateTextTagUnitBJ(("+"+I2S(R2I(r))),u2,0,10.00,50.00,50.00,100.00,0)
	call ShowTextTagForceBJ(false,GetLastCreatedTextTag(),f)
	call SetTextTagPermanent(GetLastCreatedTextTag(),false)
	call SetTextTagVelocityBJ(GetLastCreatedTextTag(),64,90)
	call SetTextTagLifespan(GetLastCreatedTextTag(),3.00)
	call SetTextTagFadepoint(GetLastCreatedTextTag(),2.00)
	call DestroyForce(f)
		if(A35_B[i])then
			set A35_B[i]=false
			call SetUnitManaBJ(u1,(GetUnitState(u1,UNIT_STATE_MANA)+((35.00+(50.00*I2R(GetUnitAbilityLevel(u1,'A0NJ'))))*3.00)))
			call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",u1,"origin"))
		endif
set u1 = null
set u2 = null
set f = null
endfunction
//===========================================================================
function InitTrig_A35T_damage_DD takes nothing returns nothing
    set gg_trg_A35T_damage_DD = CreateTrigger()
    call DisableTrigger(gg_trg_A35T_damage_DD)
    call TriggerAddCondition(gg_trg_A35T_damage_DD, Condition(function Trig_A35T_damage_DDConditions))
    call TriggerAddAction(gg_trg_A35T_damage_DD, function Trig_A35T_damage_DDActions)
endfunction
//===========================================================================
// Trigger: A36
//===========================================================================
function Trig_A36Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_A36E_init, udg_A_common_HERO, EVENT_UNIT_SUMMON)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_A36E, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_A36_R_resist_damage, udg_A_common_HERO, EVENT_UNIT_DAMAGED)
    // ---------------------------------
    call EnableTrigger( gg_trg_A36_R_resist_damage )
endfunction
//===========================================================================
function InitTrig_A36 takes nothing returns nothing
    set gg_trg_A36 = CreateTrigger()
    call TriggerAddAction(gg_trg_A36, function Trig_A36Actions)
endfunction
//===========================================================================
// Trigger: A36E init
//===========================================================================
function Trig_A36E_initConditions takes nothing returns boolean
    return ((GetUnitTypeId(GetSummonedUnit()) == 'osp3'))
endfunction
function Trig_A36E_initActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local integer h2i = GetHandleId(u1)
local integer loopstart
local integer loopend
	call SetUnitAbilityLevel( GetSummonedUnit(), 'A0L6', GetUnitAbilityLevel(u1, 'A0L3') )
	call SetUnitPathing(GetSummonedUnit(),false)
		set loopstart = 1
		set loopend	= 2 * GetUnitAbilityLevel(u1, 'A0L3') 
			loop
				exitwhen loopstart>loopend
					if LoadUnitHandle(udg_A36_H,h2i,loopstart) ==null then 
						call SaveUnitHandle(udg_A36_H,h2i,loopstart,GetSummonedUnit())
						return
					else
						if(loopstart==loopend)then 
							call KillUnit(LoadUnitHandle(udg_A36_H,h2i,1)) 
							call RemoveUnit(LoadUnitHandle(udg_A36_H,h2i,1))
							set bj_forLoopBIndex=1
							set bj_forLoopBIndexEnd=(loopend-1)
								loop
									exitwhen bj_forLoopBIndex>bj_forLoopBIndexEnd
									call SaveUnitHandle(udg_A36_H,h2i,GetForLoopIndexB(),LoadUnitHandle(udg_A36_H,h2i,(GetForLoopIndexB()+1)))
									set bj_forLoopBIndex=bj_forLoopBIndex+1
								endloop
							call SaveUnitHandle(udg_A36_H,h2i,loopend,GetSummonedUnit())
						endif 
					endif
				set loopstart=loopstart+1
			endloop
set u1 = null
endfunction
//===========================================================================
function InitTrig_A36E_init takes nothing returns nothing
    set gg_trg_A36E_init = CreateTrigger()
    call TriggerAddCondition(gg_trg_A36E_init, Condition(function Trig_A36E_initConditions))
    call TriggerAddAction(gg_trg_A36E_init, function Trig_A36E_initActions)
endfunction
//===========================================================================
// Trigger: A36E
//===========================================================================
function Trig_A36E_PLAYConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0L6'))
endfunction
function Trig_A36E_PLAYActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer i =GetConvertedPlayerId(GetOwningPlayer(u1))
local integer is = 1
local integer iend = GetUnitAbilityLevel(udg_S01_hero_of_player[i],'A0L3')*2
call TriggerSleepAction( 0.00 )
	loop
	    exitwhen is > iend
		if( LoadUnitHandle(udg_A36_H,GetHandleId(udg_S01_hero_of_player[i]),is) == u1 )then
		    call KillUnit(u1)
		    call SaveUnitHandle(udg_A36_H,GetHandleId(udg_S01_hero_of_player[i]),is,null)
		    return
		endif	
	    set is=is+1
	endloop	
set u1 = null
endfunction
//===========================================================================
function InitTrig_A36E takes nothing returns nothing
    set gg_trg_A36E = CreateTrigger()
    call TriggerAddCondition(gg_trg_A36E, Condition(function Trig_A36E_PLAYConditions))
    call TriggerAddAction(gg_trg_A36E, function Trig_A36E_PLAYActions)
endfunction//===========================================================================
// Trigger: A36 R resist damage
//===========================================================================
function Trig_A36_R_resist_damageConditions takes nothing returns nothing
local unit u1 
local real r
local real dmg=GetEventDamage()
 	if dmg>1.00 then
	 	set u1 = GetTriggerUnit()
	 		if GetUnitAbilityLevel(u1, 'B05R') > 0 then
		 		if ( ( GetUnitState(u1, UNIT_STATE_LIFE) - dmg ) < ( GetUnitState(u1, UNIT_STATE_MAX_LIFE) * ( 0.06 * I2R(GetUnitAbilityLevel(u1, 'A0L4')) ) ) ) then
			        set r = ( GetUnitState(u1, UNIT_STATE_LIFE) - ( GetUnitState(u1, UNIT_STATE_MAX_LIFE) * ( 0.06 * I2R(GetUnitAbilityLevel(u1, 'A0L4')) ) ) )
				        if ( r > 0.00 ) then
				            set r = ( dmg - r )
				            call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + r)
				        else
				        	call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + dmg)
						endif	
				endif 
			endif	
	endif
set u1 = null
endfunction
//===========================================================================
function InitTrig_A36_R_resist_damage takes nothing returns nothing
    set gg_trg_A36_R_resist_damage = CreateTrigger()
    call DisableTrigger(gg_trg_A36_R_resist_damage)
    call TriggerAddCondition(gg_trg_A36_R_resist_damage, Condition(function Trig_A36_R_resist_damageConditions))
endfunction
//===========================================================================
// Trigger: C01
//===========================================================================
function Trig_C01T1Func005T takes nothing returns nothing
    local unit ydl_unit
    local timer t= GetExpiredTimer()
    local unit u1=LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D)
    local integer i2= GetPlayerId(GetOwningPlayer(u1)) + 1
    local real a
    local real dmg= LoadReal(YDHT, GetHandleId(t), 0xA3098AE2)
    local player p = GetOwningPlayer(u1)
    
    call GroupEnumUnitsInRange(udg_Group[1], GetUnitX(u1), GetUnitY(u1), 550.00, null)
    	loop
        	set ydl_unit=FirstOfGroup(udg_Group[1])
        	exitwhen ydl_unit == null
        	call GroupRemoveUnit(udg_Group[1], ydl_unit)
        		if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false and GetUnitPointValue(ydl_unit) != 1 then
	            		if not IsUnitInGroup(ydl_unit, udg_C01T_G[i2]) then
		            		call GroupAddUnit(udg_C01T_G[i2], ydl_unit)
	                		call SetUnitPathing(ydl_unit, false)
	            		endif
            		
	            		if IsUnitType(ydl_unit, UNIT_TYPE_HERO) then
	            			call IssueImmediateOrder(ydl_unit, "stop")
	            		else
	            			call PauseUnit(ydl_unit, true)
	            		endif
	            		
        			set a=Atan2(GetUnitY(u1) - GetUnitY(ydl_unit), GetUnitX(u1) - GetUnitX(ydl_unit))+80*bj_DEGTORAD
        			call SetUnitX(ydl_unit, GetUnitX(ydl_unit) + 20 * Cos(a))
        			call SetUnitY(ydl_unit, GetUnitY(ydl_unit) + 20 * Sin(a))
        			call UnitDamageTarget(u1, ydl_unit, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, null)
        		endif
    	endloop
    	//call BJDebugMsg(R2S(dmg))
    set p = null	
    set u1=null
    set t=null
    set ydl_unit=null
endfunction
//stop
function Trig_C01T_PLAY_2Func019A takes nothing returns nothing
    call SetUnitPathing(GetEnumUnit(), true)
    call PauseUnit(GetEnumUnit(), false)
endfunction
//start
function Trig_C01T1Actions takes nothing returns nothing
    local unit u1=GetTriggerUnit()
    local integer i= GetPlayerId(GetOwningPlayer(u1)) + 1
	    if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
		    call SaveUnitHandle(YDHT, GetHandleId(udg_C01T_T[i]), 0xA1614B4D, GetTriggerUnit())
		    call SaveReal(YDHT, GetHandleId(udg_C01T_T[i]), 0xA3098AE2, I2R( 8 + 6 * GetUnitAbilityLevel(GetTriggerUnit(), 'A05T') ))
		    call TimerStart(udg_C01T_T[i], 0.05, true, function Trig_C01T1Func005T)
		else
		    call FlushChildHashtable(YDHT, GetHandleId(udg_C01T_T[i]))
		    call ForGroup(udg_C01T_G[i], function Trig_C01T_PLAY_2Func019A) 
		    call GroupClear(udg_C01T_G[i])
			call PauseTimer(udg_C01T_T[i])
		endif 
    set u1=null
endfunction
function Trig_C01T1Conditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A05T' then
	    call Trig_C01T1Actions()
    endif
    return false
endfunction
function Trig_C01Actions takes nothing returns nothing
local unit u1=GetTriggerUnit()
local integer i= GetPlayerId(GetOwningPlayer(udg_A_common_HERO)) + 1	
    call TriggerRegisterUnitEvent(gg_trg_C01_Hero_LV_UP, udg_A_common_HERO, EVENT_UNIT_HERO_LEVEL)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C01W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C01R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C01T1, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C01T1, udg_A_common_HERO, EVENT_UNIT_SPELL_ENDCAST)
    // 這是為了多人用， 假如沒有的話會造成變數錯誤
    set udg_C01T_G[i] = CreateGroup()
    set udg_C01T_T[i]=CreateTimer()
set u1 = null 
endfunction
function InitTrig_C01 takes nothing returns nothing
    set gg_trg_C01 = CreateTrigger()
    call TriggerAddAction(gg_trg_C01, function Trig_C01Actions)
    set gg_trg_C01T1=CreateTrigger()
    call TriggerAddCondition(gg_trg_C01T1, Condition(function Trig_C01T1Conditions))
endfunction
globals
trigger	gg_trg_C01T1 = null
endglobals//===========================================================================
// Trigger: C01 Hero LV UP
//===========================================================================
function Trig_C01_Hero_LV_UPActions takes nothing returns nothing
    // ----------------------------------------
    call SetPlayerTechResearchedSwap( 'Rura', GetHeroLevel(GetTriggerUnit()), GetOwningPlayer(GetTriggerUnit()) )
    // ----------------------------------------
endfunction
//===========================================================================
function InitTrig_C01_Hero_LV_UP takes nothing returns nothing
    set gg_trg_C01_Hero_LV_UP = CreateTrigger()
    call TriggerAddAction(gg_trg_C01_Hero_LV_UP, function Trig_C01_Hero_LV_UPActions)
endfunction
//===========================================================================
// Trigger: C01W
//===========================================================================
function Trig_C01WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A08Y' ) )
endfunction
function Trig_C01WFunc002T takes nothing returns nothing
	local real Angle
	local real x
    local real y
    local timer t= GetExpiredTimer()
    local unit u1= LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D)
    local unit u2= LoadUnitHandle(YDHT, GetHandleId(t), 0x9C0F555E)
    local integer i= LoadInteger(YDHT, GetHandleId(t), 0xA3098AE2)
    	if ( ( i >= ( 1 + ( 1 * GetUnitAbilityLevel(u1, 'A08Y') ) ) ) ) then
			call FlushChildHashtable(YDHT, GetHandleId(t))
    		call DestroyTimer(t)
    	else
    		set Angle=bj_RADTODEG * Atan2(GetUnitY(u1) - GetUnitY(u2), GetUnitX(u1) - GetUnitX(u2))
    		set x=GetUnitX(u2) + 129 * Cos(Angle * bj_DEGTORAD)
    		set y=GetUnitY(u2) + 129 * Sin(Angle * bj_DEGTORAD)
    		call SetUnitX(u2, x)
    		call SetUnitY(u2, y)
    		call UnitDamageTargetBJ(u1, u2, 100.00, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID)
    		call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathCoil\\DeathCoilSpecialArt.mdl", u2, "foot"))
    		call SaveInteger(YDHT, GetHandleId(t), 0xA3098AE2, ( i + 1 ))
    	endif
    set u1=null
    set u2=null
endfunction
function Trig_C01WActions takes nothing returns nothing
    local timer ydl_timer= CreateTimer()
	    call SaveUnitHandle(YDHT, GetHandleId(ydl_timer), 0xA1614B4D, GetTriggerUnit())
	    call SaveUnitHandle(YDHT, GetHandleId(ydl_timer), 0x9C0F555E, GetSpellTargetUnit())
	    call SaveInteger(YDHT, GetHandleId(ydl_timer), 0xA3098AE2, 0)
	    call TimerStart(ydl_timer, 0.50, true, function Trig_C01WFunc002T)
    set ydl_timer=null
endfunction
//===========================================================================
function InitTrig_C01W takes nothing returns nothing
    set gg_trg_C01W=CreateTrigger()
    call TriggerAddCondition(gg_trg_C01W, Condition(function Trig_C01WConditions))
    call TriggerAddAction(gg_trg_C01W, function Trig_C01WActions)
endfunction//===========================================================================
// Trigger: C01R learn
//===========================================================================
function Trig_C01R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0C2') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_C01R_learnActions takes nothing returns nothing
    // ----------------------------------------
    call SetPlayerTechResearchedSwap( 'Rugf', GetUnitAbilityLevel(GetTriggerUnit(), 'A0C2'), GetOwningPlayer(GetTriggerUnit()) )
    // ----------------------------------------
    if ((GetTriggerExecCount(GetTriggeringTrigger()) == 1)) then
        call TriggerRegisterAnyUnitEventBJ(gg_trg_C01R, EVENT_PLAYER_UNIT_DEATH)
    else
    endif
endfunction
//===========================================================================
function InitTrig_C01R_learn takes nothing returns nothing
    set gg_trg_C01R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_C01R_learn, Condition(function Trig_C01R_learnConditions))
    call TriggerAddAction(gg_trg_C01R_learn, function Trig_C01R_learnActions)
endfunction
//===========================================================================
// Trigger: C01R
//===========================================================================
function Trig_C01RConditions takes nothing returns boolean
return((GetUnitAbilityLevel(udg_S01_hero_of_player[GetConvertedPlayerId(GetOwningPlayer(GetKillingUnit()))],'A0C2')!=0)and(GetUnitTypeId(GetKillingUnit())!='ucs1'))
endfunction
function Trig_C01RActions takes nothing returns nothing
local unit u1=GetKillingUnit()
local integer i=GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u3=CreateUnit(GetOwningPlayer(u1),'ucs1',GetUnitX(udg_S01_hero_of_player[i]),GetUnitY(udg_S01_hero_of_player[i]),0)
set u1=null
set u3=null
endfunction
function InitTrig_C01R takes nothing returns nothing
set gg_trg_C01R=CreateTrigger()
call TriggerAddCondition(gg_trg_C01R,Condition(function Trig_C01RConditions))
call TriggerAddAction(gg_trg_C01R,function Trig_C01RActions)
endfunction//===========================================================================
// Trigger: C03
//===========================================================================
function Trig_C03Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C03W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C03E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C03R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C03T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
endfunction
//===========================================================================
function InitTrig_C03 takes nothing returns nothing
    set gg_trg_C03 = CreateTrigger()
    call TriggerAddAction(gg_trg_C03, function Trig_C03Actions)
endfunction
//===========================================================================
// Trigger: C03W
//===========================================================================
function Trig_C03WConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0BL' ) )
endfunction
function Trig_C03WActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local player p = GetOwningPlayer(u1)
    local unit u3=CreateUnit(p, 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
    call UnitApplyTimedLife(u3, 'BHwe', 3.00)
    call UnitAddAbility(u3, 'A098')
    call SetUnitAbilityLevel(u3, 'A098', GetUnitAbilityLevel(u1, 'A0BL'))
    call GroupEnumUnitsInRange(udg_Group[1], GetSpellTargetX(), GetSpellTargetY(), 230.00, null)
    	loop
        	set ydl_unit=FirstOfGroup(udg_Group[1])
        	exitwhen ydl_unit == null
        	call GroupRemoveUnit(udg_Group[1], ydl_unit)
        		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) ) then
            		call IssueTargetOrder(u3, "thunderbolt", ydl_unit)
        		endif
    	endloop
    set p = null	
    set u1=null
    set u3=null
    set ydl_unit=null
endfunction
//===========================================================================
function InitTrig_C03W takes nothing returns nothing
    set gg_trg_C03W=CreateTrigger()
    call TriggerAddCondition(gg_trg_C03W, Condition(function Trig_C03WConditions))
    call TriggerAddAction(gg_trg_C03W, function Trig_C03WActions)
endfunction//===========================================================================
// Trigger: C03E
//
// AngleBtwCoords(y, y1, x, x1)
//===========================================================================
globals
integer array C03_I
real array C03_A
integer array C03_level
endglobals
function Trig_C03EConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0D5' ) )
endfunction
function Trig_C03EFunc007T takes nothing returns nothing
local timer t= GetExpiredTimer()
local unit u1=LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u3
local real x= GetUnitX(u1)
local real y= GetUnitY(u1)
local real x1= x + 50.00 * Cos(C03_A[i]) 
local real y1= y + 50.00 * Sin(C03_A[i])
	if C03_I[i]>=60 or IsTerrainPathable(x,y,PATHING_TYPE_FLYABILITY)then
		call FlushChildHashtable(YDHT, GetHandleId(t))
        call DestroyTimer(t)
        call KillUnit(u1)
    else
        set C03_I[i]=C03_I[i]+1
        call SetUnitX(u1, x1) 
		call SetUnitY(u1, y1)
		call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Volcano\\VolcanoMissile.mdl", x, y))
		set u3=CreateUnit(GetOwningPlayer(u1), 'h001', x, y, 0)
		call UnitApplyTimedLife(u3, 'BHwe', 12.00)
		call SetUnitAbilityLevel(u3, 'A01L', C03_level[i])
	endif 
set u1 = null
set u3 = null
set t = null 
endfunction
function Trig_C03EActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1=GetTriggerUnit()
local unit u3 = CreateUnit(GetOwningPlayer(u1), 'e002', GetUnitX(u1), GetUnitY(u1), bj_RADTODEG * Atan2(GetSpellTargetY() - GetUnitY(u1), GetSpellTargetX() - GetUnitX(u1)))
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u3)
    set C03_I[i]=0
    set C03_A[i]=Atan2(GetSpellTargetY() - GetUnitY(u1), GetSpellTargetX() - GetUnitX(u1))
    set C03_level[i] = GetUnitAbilityLevel(u1, 'A0D5')
    call TimerStart(t, 0.03, true, function Trig_C03EFunc007T)
set t = null
set u1=null
set u3=null
endfunction
function InitTrig_C03E takes nothing returns nothing
    set gg_trg_C03E=CreateTrigger()
    call TriggerAddCondition(gg_trg_C03E, Condition(function Trig_C03EConditions))
    call TriggerAddAction(gg_trg_C03E, function Trig_C03EActions)
endfunction//===========================================================================
// Trigger: C03R  
//===========================================================================
function Trig_C03RConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A09A') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_C03RActions takes nothing returns nothing
    // ----------------------------------------
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A0IN', ( R2I(I2R(GetUnitAbilityLevel(GetTriggerUnit(), 'A09A'))) + 1 ) )
    // ----------------------------------------
endfunction
//===========================================================================
function InitTrig_C03R takes nothing returns nothing
    set gg_trg_C03R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C03R, Condition(function Trig_C03RConditions))
    call TriggerAddAction(gg_trg_C03R, function Trig_C03RActions)
endfunction
//===========================================================================
// Trigger: C03T
//===========================================================================
function Trig_C03TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0DH'))
endfunction
function Trig_C03TActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local unit u2 = GetSpellTargetUnit()
    local unit u3
    local real x = GetUnitX(u2)
    local real y = GetUnitY(u2)
    local real x1
    local real y1
    local integer i = 1
	    loop
	        exitwhen i > 10
	        set x1 = (x + 300.00*Cos((I2R(i)*36.00)*bj_DEGTORAD))
	        set y1 = (y + 300.00*Sin((I2R(i)*36.00)*bj_DEGTORAD))
	        set u3 = CreateUnit(GetOwningPlayer(u1),'n026',x1,y1,(bj_RADTODEG * Atan2(y-y1, x-x1)))
	        call UnitApplyTimedLife( u3 ,'BHwe', 10.00)
	        call IssueTargetOrder( u3, "attack", u2 )
	        set i = i + 1
	    endloop
    set u1 = null
    set u2 = null
    set u3 = null
endfunction
//===========================================================================
function InitTrig_C03T takes nothing returns nothing
    set gg_trg_C03T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C03T, Condition(function Trig_C03TConditions))
    call TriggerAddAction(gg_trg_C03T, function Trig_C03TActions)
endfunction
//===========================================================================
// Trigger: C04W 
//===========================================================================
function Trig_C04WActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local unit u2 = GetSpellTargetUnit()
    local real r 
    local integer level = GetUnitAbilityLevel(u1,'A0IU')
    local real dmg	= 0
    		//dmg + reHP		
		    if GetUnitState(u2,UNIT_STATE_LIFE) <= 30.00 + 120.00*I2R(level)then
			    set r = GetUnitState(u1,UNIT_STATE_LIFE)+GetUnitState(u2,UNIT_STATE_LIFE)
			    call SetUnitState(u1, UNIT_STATE_LIFE, r)
			    call SetUnitState(u2, UNIT_STATE_LIFE, 1.00)
			    call UnitDamageTarget(u1,u2,500, true, false, ATTACK_TYPE_CHAOS,DAMAGE_TYPE_NORMAL, WEAPON_TYPE_WHOKNOWS)
		    else
		    	set r = GetUnitState(u1,UNIT_STATE_LIFE) + 30.00 + 120.00*I2R(level)
		    	set dmg = 30.00 + 120.00 * I2R(level)
		    	call SetUnitState(u1, UNIT_STATE_LIFE, r)
		    	call UnitDamageTarget(u1,u2,dmg, true, false, ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
		    endif
    	//effect
    	call DestroyEffect( AddSpecialEffectTarget("units\\creeps\\VoidWalker\\VoidWalker.mdl", u2, "chest") )
    set u1 = null
    set u2 = null
endfunction
function Trig_C04WWConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0IU' then
	    call Trig_C04WActions()
    endif
    return false
endfunction
function InitTrig_C04W takes nothing returns nothing
    set gg_trg_C04W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C04W, Condition(function Trig_C04WWConditions))
endfunction
//===========================================================================
// Trigger: C05
//===========================================================================
function Trig_C05Actions takes nothing returns nothing
    set udg_C05W_stun[1] = 0.30
    set udg_C05W_stun[2] = 0.50
    set udg_C05W_stun[3] = 0.70
    set udg_C05W_stun[4] = 0.90
    call TriggerRegisterUnitEvent(gg_trg_C05D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C05W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C05R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C05T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_C05 takes nothing returns nothing
    set gg_trg_C05 = CreateTrigger()
    call TriggerAddAction(gg_trg_C05, function Trig_C05Actions)
endfunction
//===========================================================================
// Trigger: C05D
//===========================================================================
function Trig_C05DConditions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local unit ydl_unit
    local player p = GetOwningPlayer(u1)
    call GroupEnumUnitsInRange(udg_Group[1], GetUnitX(u1), GetUnitY(u1), 650.00, null)
    	loop
        	set ydl_unit = FirstOfGroup(udg_Group[1])
        	exitwhen ydl_unit == null
        	call GroupRemoveUnit(udg_Group[1], ydl_unit)
        		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and IsUnitAlly(ydl_unit, p) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) ) then
        			call SetUnitState(ydl_unit, UNIT_STATE_LIFE, ( GetUnitState(ydl_unit,UNIT_STATE_LIFE) + ( GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE) * 0.05 ) ) )
        			call SetUnitState(ydl_unit, UNIT_STATE_MANA, ( GetUnitState(ydl_unit,UNIT_STATE_MANA) + ( GetUnitState(ydl_unit,UNIT_STATE_MAX_MANA) * 0.04 ) ))
        		endif
    	endloop
   	set p = null
    set u1 = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_C05D takes nothing returns nothing
    set gg_trg_C05D = CreateTrigger()
    call TriggerAddCondition(gg_trg_C05D, Condition(function Trig_C05DConditions))
endfunction//===========================================================================
// Trigger: C05W
//===========================================================================
globals
lightning array C05W_L
integer array C05W_I
unit array C05W_U
location array C05W_P1
location array C05W_P2
endglobals	
function Trig_C05WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0HG'))
endfunction
function Trig_C05WTimer_end takes nothing returns nothing
local timer t= GetExpiredTimer()
call UnitRemoveAbility(LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D),'B086')
call FlushChildHashtable(YDHT, GetHandleId(t))
call DestroyTimer(t)
set t = null
endfunction
function Trig_C05WTimer takes nothing returns nothing
local timer t= GetExpiredTimer()
local unit u1=LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D)
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
local real r 
local real r2
local unit u2 = C05W_U[i]
local unit u3
	if(C05W_I[i]>=25 or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 or GetUnitState(u2, UNIT_STATE_LIFE) <= 0 )then
		call FlushChildHashtable(YDHT, GetHandleId(t))
		call DestroyTimer(t)
		call DestroyLightning(C05W_L[i])
			if C05W_I[i]>=25 then
				if(DistanceBetweenPoints(C05W_P1[i],C05W_P2[i])>=1001.00)then
					set r=1000.00
				else
					set r=DistanceBetweenPoints(C05W_P1[i],C05W_P2[i])
				endif
					set r2=(1000.00-r)
					set r=(r*(0.18+(0.17*I2R(GetUnitAbilityLevel(u1,'A0HG')))))
					
					
					call UnitDamageTargetBJ(u1,u2,r,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
					// this hide caster for sign
					set u3= CreateUnit(GetOwningPlayer(u1), 'h02G', GetUnitX(u2), GetUnitY(u2), 0)
					call UnitApplyTimedLife( u3, 'BHwe', 0.01 ) 
					call ShowUnit(u3, false) 
					
                    set u3= CreateUnit(GetOwningPlayer(u2), 'h01E', GetUnitX(u2), GetUnitY(u2), 0)
                    call UnitApplyTimedLife( u3, 'BHwe', 3.00 ) 
					call UnitAddAbility( u3, 'A0HN' )
					call IssueTargetOrder( u3, "ensnare", u2 )
					set r2=((r2/200.00)+1.00)
					set t = CreateTimer()
					call SaveUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D, u2)
					//沒有觸發器 一定要用計時器
					call TimerStart(t, (I2R(R2I(r2))*udg_C05W_stun[GetUnitAbilityLevel(u1,'A0HG')]), false, function Trig_C05WTimer_end)	
		    endif
		call RemoveLocation(C05W_P1[i])
		call RemoveLocation(C05W_P2[i]) 
    else
		set C05W_I[i]=C05W_I[i]+1
       	call MoveLocation(C05W_P1[i], GetUnitX(u1), GetUnitY(u1))
		call MoveLocation(C05W_P2[i], GetUnitX(u2), GetUnitY(u2))
		call MoveLightningLoc(C05W_L[i],C05W_P1[i],C05W_P2[i])
	endif	
set t = null
set u1 = null
set u2 = null
endfunction
function Trig_C05WActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1=GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local integer i= GetConvertedPlayerId(GetOwningPlayer(u1))
		set C05W_P1[i] = GetUnitLoc(u1)
		set C05W_P2[i] = GetUnitLoc(u2)
		set C05W_L[i]= AddLightningLoc("LEAS",C05W_P1[i],C05W_P2[i])
		set C05W_U[i]=u2
		set C05W_I[i]=0
	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
	call TimerStart(t, 0.10, true, function Trig_C05WTimer)
set t = null
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_C05W takes nothing returns nothing
    set gg_trg_C05W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C05W, Condition(function Trig_C05WConditions))
    call TriggerAddAction(gg_trg_C05W, function Trig_C05WActions)
endfunction
//===========================================================================
// Trigger: C05R 
//
// ((40.00+(60.00*I2R(GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId()))))+(I2R(GetHeroInt(GetTriggerUnit(),true))*2.00))
//===========================================================================
function Trig_C05RConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0GL' ) )
endfunction
function Trig_C05RActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1= GetTriggerUnit()
    local player p = GetOwningPlayer(u1)
    local real r= ( ( 40.00 + ( 60.00 * I2R(GetUnitAbilityLevel(u1, GetSpellAbilityId())) ) ) + ( I2R(GetHeroInt(u1, true)) * 2.00 ) )
    call GroupEnumUnitsInRange(udg_Group[1], GetSpellTargetX(), GetSpellTargetY(), 210.00, null)
    	loop
        	set ydl_unit=FirstOfGroup(udg_Group[1])
        	exitwhen ydl_unit == null
        	call GroupRemoveUnit(udg_Group[1], ydl_unit)
        		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) and ( IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false ) ) then
            		call UnitDamageTargetBJ(u1, ydl_unit, r, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC)
        		endif
    	endloop
    set p = null	
    set ydl_unit=null
    set u1=null
endfunction
//===========================================================================
function InitTrig_C05R takes nothing returns nothing
    set gg_trg_C05R=CreateTrigger()
    call TriggerAddCondition(gg_trg_C05R, Condition(function Trig_C05RConditions))
    call TriggerAddAction(gg_trg_C05R, function Trig_C05RActions)
endfunction//===========================================================================
// Trigger: C05T
//===========================================================================
function Trig_C05TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A09P'))
endfunction
function Trig_C05TActions takes nothing returns nothing
    local unit ydl_unit
    local unit u1=GetTriggerUnit()
    local real r = (350.00+(150.00*I2R(GetUnitAbilityLevel(u1,'A09P'))))
    local real r2 = (0.20+(0.10*I2R(GetUnitAbilityLevel(u1,'A09P'))))
    local player p = GetOwningPlayer(u1)
    //======================================================================
    call GroupEnumUnitsInRange(udg_Group[1], GetSpellTargetX(), GetSpellTargetY(), 610.00, null)
    loop
        set ydl_unit = FirstOfGroup(udg_Group[1])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[1], ydl_unit)
        	if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) != true)) then
            	if IsUnitEnemy(ydl_unit, p) then
	            	if((GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)*0.25)<= (r) )then
		             	call UnitDamageTargetBJ(u1,ydl_unit,r,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
	           		else
	            		call UnitDamageTargetBJ(u1,ydl_unit,(GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)*0.25),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
                	endif
            	else
            		call SetUnitState(ydl_unit, UNIT_STATE_LIFE, (GetUnitState(ydl_unit,UNIT_STATE_LIFE)+(GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)*r2)))
            	endif
        	endif
    endloop
    //===========================================================================
    set p = null
    set u1 = null
    set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_C05T takes nothing returns nothing
    set gg_trg_C05T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C05T, Condition(function Trig_C05TConditions))
    call TriggerAddAction(gg_trg_C05T, function Trig_C05TActions)
endfunction
//===========================================================================
// Trigger: C06
//===========================================================================
function Trig_C06Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C06W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C06E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C06T, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
//===========================================================================
function InitTrig_C06 takes nothing returns nothing
    set gg_trg_C06 = CreateTrigger()
    call TriggerAddAction(gg_trg_C06, function Trig_C06Actions)
endfunction
//===========================================================================
// Trigger: C06W
//===========================================================================
function Trig_C06WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A05M'))
endfunction
function Trig_C06WActions takes nothing returns nothing
    local unit u2 = GetSpellTargetUnit()
    local real r= GetUnitState(u2,UNIT_STATE_MANA)
    // ----------------------------------------
    call SetUnitState(u2, UNIT_STATE_MANA, 0.00)
    // ----------------------------------------
    call TriggerSleepAction((4.50+I2R(GetUnitAbilityLevel(GetTriggerUnit(),'A05M'))))
    // ----------------------------------------
    call SetUnitState(u2, UNIT_STATE_MANA, (GetUnitState(u2,UNIT_STATE_MANA)+r))
    // ----------------------------------------
    set u2 = null
endfunction
//===========================================================================
function InitTrig_C06W takes nothing returns nothing
    set gg_trg_C06W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C06W, Condition(function Trig_C06WConditions))
    call TriggerAddAction(gg_trg_C06W, function Trig_C06WActions)
endfunction
//===========================================================================
// Trigger: C06E
//===========================================================================
function Trig_C06EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0E7'))
endfunction
function Trig_C06EActions takes nothing returns nothing
    if ((GetTriggerUnit() == GetSpellTargetUnit())) then
        call SetUnitLifeBJ( GetTriggerUnit(), ( GetUnitStateSwap(UNIT_STATE_LIFE, GetSpellTargetUnit()) + ( 200.00 + ( 100.00 * I2R(GetUnitAbilityLevel(GetTriggerUnit(), 'A0E7')) ) ) ) )
    else
        call SetUnitLifeBJ( GetTriggerUnit(), ( GetUnitStateSwap(UNIT_STATE_LIFE, GetTriggerUnit()) + ( 100.00 + ( 50.00 * I2R(GetUnitAbilityLevel(GetTriggerUnit(), 'A0E7')) ) ) ) )
        call SetUnitLifeBJ( GetSpellTargetUnit(), ( GetUnitStateSwap(UNIT_STATE_LIFE, GetSpellTargetUnit()) + ( 200.00 + ( 100.00 * I2R(GetUnitAbilityLevel(GetTriggerUnit(), 'A0E7')) ) ) ) )
    endif
endfunction
//===========================================================================
function InitTrig_C06E takes nothing returns nothing
    set gg_trg_C06E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C06E, Condition(function Trig_C06EConditions))
    call TriggerAddAction(gg_trg_C06E, function Trig_C06EActions)
endfunction
//===========================================================================
// Trigger: C06T
//===========================================================================
function Trig_C06TConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A09T'))
endfunction
function Trig_C06TActions takes nothing returns nothing
    if ((GetUnitAbilityLevel(GetTriggerUnit(), 'A09T') == 1)) then
        call UnitAddAbilityBJ( 'A0E2', GetTriggerUnit() )
    else
        call SetUnitAbilityLevel( GetTriggerUnit(), 'A0E2', R2I(I2R(GetUnitAbilityLevel(GetTriggerUnit(), 'A09T'))) )
    endif
endfunction
//===========================================================================
function InitTrig_C06T takes nothing returns nothing
    set gg_trg_C06T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C06T, Condition(function Trig_C06TConditions))
    call TriggerAddAction(gg_trg_C06T, function Trig_C06TActions)
endfunction
//===========================================================================
// Trigger: C07
//===========================================================================
function Trig_C07Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C07W_PLAY, udg_A_common_HERO, EVENT_UNIT_ATTACKED)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C07E_START, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C07R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    set udg_C07W_Damage[1] = 50.00
    set udg_C07W_Damage[2] = 70.00
    set udg_C07W_Damage[3] = 90.00
    set udg_C07W_Damage[4] = 110.00
endfunction
//===========================================================================
function InitTrig_C07 takes nothing returns nothing
    set gg_trg_C07 = CreateTrigger()
    call TriggerAddAction(gg_trg_C07, function Trig_C07Actions)
endfunction
//===========================================================================
// Trigger: C07W_PLAY
//===========================================================================
function Trig_C07W_PLAYConditions takes nothing returns boolean
    return GetUnitAbilityLevel(GetTriggerUnit(), 'B02Z') > 0 and udg_C07W_B[GetPlayerId(GetTriggerPlayer()) + 1] == false
endfunction
function Trig_C07W_PLAYActions takes nothing returns nothing
    local unit ydl_unit 
    local unit u1 = GetTriggerUnit()
    local integer i = GetPlayerId(GetTriggerPlayer()) + 1
    local integer level = GetUnitAbilityLevel(u1,'A09U')
    local player p = GetOwningPlayer(u1)
	    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\DemolisherFireMissile\\DemolisherFireMissile.mdl", u1, "chest") )
		    call GroupEnumUnitsInRange(udg_Group[1], GetUnitX(u1), GetUnitY(u1), 300.00, null)
		    	loop
		        	set ydl_unit = FirstOfGroup(udg_Group[1])
		        	exitwhen ydl_unit == null
		        	call GroupRemoveUnit(udg_Group[1], ydl_unit)
		        		if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit, p) and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false then
		        			call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\LordofFlameMissile\\LordofFlameMissile.mdl", ydl_unit, "chest") )
		        			call UnitDamageTarget(u1,ydl_unit,udg_C07W_Damage[level], true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
		    			endif
		   	 	endloop
		    // for the wait time
		    set udg_C07W_B[i] = true
		    call TriggerSleepAction(0.29)
		    set udg_C07W_B[i] = false
    set p = null
    set ydl_unit = null
    set u1 = null
endfunction
//===========================================================================
function InitTrig_C07W_PLAY takes nothing returns nothing
    set gg_trg_C07W_PLAY = CreateTrigger()
    call TriggerAddCondition(gg_trg_C07W_PLAY, Condition(function Trig_C07W_PLAYConditions))
    call TriggerAddAction(gg_trg_C07W_PLAY, function Trig_C07W_PLAYActions)
endfunction
//===========================================================================
// Trigger: C07E_START
//
// 	local unit u1 = GetTriggerUnit()
// 	local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
// local real r1 = R2I(YDTriggerGetEx(integer, YDTriggerH2I(t), 0xA3098AE2))
//===========================================================================
function Trig_C07E_STARTConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A09V' ) )
endfunction
function Trig_C07E_STARTFunc003T takes nothing returns nothing
local timer t= GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1= LoadUnitHandle(YDHT, h2i, 0x9C0F555E)
call SaveInteger(YDHT, h2i, 0xA1614B4D, ( LoadInteger(YDHT, h2i, 0xA1614B4D) + 1 ))
    if ( ( ( LoadInteger(YDHT, h2i, 0xA1614B4D) >= 8 ) ) or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 ) then
        call FlushChildHashtable(YDHT, h2i)
        call DestroyTimer(t)
    else
    	call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) + ( GetUnitState(u1, UNIT_STATE_MAX_LIFE) * ( 0.03 / 2.00 ) ) ))
    endif
set t = null
set u1 = null 
endfunction
function Trig_C07E_STARTActions takes nothing returns nothing
local timer t= CreateTimer()
local unit u1 = GetTriggerUnit()
call SetUnitState(u1, UNIT_STATE_LIFE, ( GetUnitState(u1, UNIT_STATE_LIFE) + ( 100.00 + ( 100.00 * I2R(GetUnitAbilityLevel(u1, GetSpellAbilityId())) ) ) ))
    call SaveInteger(YDHT, GetHandleId(t), 0xA1614B4D, 0)
    call SaveUnitHandle(YDHT, GetHandleId(t), 0x9C0F555E, u1)
    call TimerStart(t, 1.00, true, function Trig_C07E_STARTFunc003T)
set t=null
set u1 = null
endfunction
//===========================================================================
function InitTrig_C07E_START takes nothing returns nothing
    set gg_trg_C07E_START=CreateTrigger()
    call TriggerAddCondition(gg_trg_C07E_START, Condition(function Trig_C07E_STARTConditions))
    call TriggerAddAction(gg_trg_C07E_START, function Trig_C07E_STARTActions)
endfunction//===========================================================================
// Trigger: C07R
//===========================================================================
function Trig_C07RConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A09W' ) )
endfunction
function Trig_C07RActions takes nothing returns nothing
local unit u1= GetTriggerUnit()
local real x= GetUnitX(u1)
local real y= GetUnitY(u1)
local real x1
local real y1
local integer i= 1
	loop
		exitwhen i > 12
		set x1=( x + 256.00 * Cos(( 30.00 * ( I2R(i) ) ) * bj_DEGTORAD) )
	    set y1=( y + 256.00 * Sin(( 30.00 * ( I2R(i) ) ) * bj_DEGTORAD) )
	    call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl", x1, y1))
	    set i=i + 1
	endloop
set u1=null
endfunction
function InitTrig_C07R takes nothing returns nothing
    set gg_trg_C07R=CreateTrigger()
    call TriggerAddCondition(gg_trg_C07R, Condition(function Trig_C07RConditions))
    call TriggerAddAction(gg_trg_C07R, function Trig_C07RActions)
endfunction//===========================================================================
// Trigger: C09
//
// local unit u1 = YDTriggerGetEx(unit, YDTriggerH2I(GetExpiredTimer()), 0xA1614B4D)
//===========================================================================
function Trig_C09Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C09W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C09E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C09R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
endfunction
//===========================================================================
function InitTrig_C09 takes nothing returns nothing
    set gg_trg_C09 = CreateTrigger()
    call TriggerAddAction(gg_trg_C09, function Trig_C09Actions)
endfunction
//===========================================================================
// Trigger: C09W
//===========================================================================
function Trig_C09WActions2 takes nothing returns nothing
	local timer t	=	GetExpiredTimer()
	local integer h2i	=	GetHandleId(t)
	local	unit u	=	LoadUnitHandle(YDHT,h2i,1)
	    //call 	BJDebugMsg(R2S(TimerGetElapsed(t)))
	    
		//clean	
		call	FlushChildHashtable(YDHT,h2i)
		call	DestroyTimer(t)
		
	    call UnitRemoveAbility( u, 'A09Z' )	
	    call UnitRemoveAbility( u, 'A0H8' )
	set t	=	null
	set u	=	null 
endfunction
function Trig_C09WActions takes nothing returns nothing
    local unit u = GetTriggerUnit()
    local integer i = GetUnitAbilityLevel(u, 'A064')
    local timer t	= CreateTimer()
    local integer	h2i	=	GetHandleId(t)
	local real time=	12.00
    	
	    if GetUnitAbilityLevel(u, 'A0A4') != 0 and GetUnitAbilityLevel(u, 'A0VV') != 0 then
		    //刪除 R 特殊效果
	        call UnitRemoveAbility( u, 'A0VV' )
	        
	        call UnitAddAbility( u, 'A0H8' )
	        call SetUnitAbilityLevel( u, 'A0H8', i )
	        call UnitAddAbility( u, 'A09Z' )
	        call SetUnitAbilityLevel( u, 'A09Z', i )
	    else
	    	call UnitAddAbility( u, 'A09Z' )
	    	call SetUnitAbilityLevel( u, 'A09Z', i )
	    endif
    	//clock
		call	SaveUnitHandle(YDHT,h2i,1,u)
		call	TimerStart(t,time,false,function Trig_C09WActions2)
    set u = null
    set t	=	null
endfunction
function Trig_C09WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A064'	then
	    call Trig_C09WActions()	
    endif
    return	false
endfunction
function InitTrig_C09W takes nothing returns nothing
    set gg_trg_C09W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C09W, Condition(function Trig_C09WConditions))
endfunction
//===========================================================================
// Trigger: C09E
//===========================================================================
function C09E_Spell takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(YDHT,h2i,1)
local location p = LoadLocationHandle(YDHT,h2i,2)
local real x = GetLocationX(p)
local real y = GetLocationY(p)
local integer level = GetUnitAbilityLevel(u1, 'A08D')
local unit u3 
	if LoadInteger(YDHT,h2i,3) >= 3 then
		
		//clean
	    call FlushChildHashtable(YDHT,h2i)
	    call DestroyTimer(t)
		call RemoveLocation(p)	
		
	else
		//擊暈
		call DestroyEffect(AddSpecialEffect("war3mapImported\\firaga.mdx", x, y))
		set u3=CreateUnit(GetOwningPlayer(u1), 'h02G', x, y, 0)
		call ShowUnit(u3, false)
		call UnitApplyTimedLife(u3, 'BHwe', 0.10)
		call UnitAddAbility(u3, 'A0W5')
		call SetUnitAbilityLevel(u3, 'A0W5', level)
		call IssueImmediateOrder(u3, "stomp")
			//不管如何 都會擊暈第二次
			if GetRandomInt(1, 100) <= 15 + 10 * level then 
				
				call SaveInteger(YDHT,h2i,3,LoadInteger(YDHT,h2i,3)+ 1 )
			else
				//clean
			    call FlushChildHashtable(YDHT,h2i)
			    call PauseTimer(t)	
			    call DestroyTimer(t)
				call RemoveLocation(p) 
				
			endif
		
	endif
	
set p = null
set u1 = null
set u3 = null
set t = null
endfunction
function Trig_C09EConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A08D' 
endfunction
function Trig_C09EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local boolean b = false
local real x =	GetSpellTargetX()
local real y =	GetSpellTargetY()
local location p =	GetSpellTargetLoc()
local timer t =	CreateTimer()
local integer h2i = GetHandleId(t)
local real time	= 1.40 
local unit u3 
    	// 判斷有沒有 血刃
    	if GetUnitAbilityLevel(u1, 'A0VV') != 0 then
    		call UnitRemoveAbility(u1, 'A0VV')
    		set b=true
    	else
    		set b=false
    	endif
    	
    //第一波 震暈	
	call TriggerSleepAction(time)
	
    call DestroyEffect(AddSpecialEffect("war3mapImported\\firaga.mdx", x, y))
    
    set u3=CreateUnit(GetOwningPlayer(u1), 'h02G', x, y, 0)
    call ShowUnit(u3, false)
    call UnitApplyTimedLife(u3, 'BHwe', 0.05)
    call UnitAddAbility(u3, 'A08J')
    call SetUnitAbilityLevel(u3, 'A08J', GetUnitAbilityLevel(u1, 'A08D'))
    call IssueImmediateOrder(u3, "stomp")
    
	//變數設定
	if b then 
		call SaveUnitHandle(YDHT,h2i,1,u1)
		call SaveLocationHandle(YDHT,h2i,2,p)
		call SaveInteger(YDHT,h2i,3,0)
		call TimerStart(t,0.70,true,function C09E_Spell)
	else
		call RemoveLocation(p)
	endif	
	
set u1	=	null
set u3	=	null
set t =	null
set p =	null
endfunction
function InitTrig_C09E takes nothing returns nothing
    set gg_trg_C09E=CreateTrigger()
    call TriggerAddCondition(gg_trg_C09E, Condition(function Trig_C09EConditions))
    call TriggerAddAction(gg_trg_C09E, function Trig_C09EActions)
endfunction//===========================================================================
// Trigger: C09R learn
//===========================================================================
function Trig_C09R_learnFunc004T takes nothing returns nothing
    local unit u	= LoadUnitHandle(YDHT, GetHandleId(GetExpiredTimer()), 0xA1614B4D)
    	//獲得 R 特殊效果
	    if GetUnitAbilityLevel(u, 'A0VV') == 0 then
	        call UnitAddAbility(u, 'A0VV')
	    endif
    set u	=	null
endfunction
function Trig_C09R_learnActions takes nothing returns nothing
    local timer t	=	CreateTimer()
    	//Init for clock
	    call SaveUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D, GetTriggerUnit())
	    call TimerStart(t, 10.00, true, function Trig_C09R_learnFunc004T)
	    
    set t	=	null
endfunction
function Trig_C09R_learnConditions takes nothing returns boolean
	//skill and check-unit-illusion and level 
    if GetLearnedSkill() == 'A0A4' and IsUnitIllusion(GetTriggerUnit()) != true and GetUnitAbilityLevel(GetTriggerUnit(), 'A0A4') == 1 then
    	call Trig_C09R_learnActions()
	endif
    return false
endfunction
function InitTrig_C09R_learn takes nothing returns nothing
    set gg_trg_C09R_learn=CreateTrigger()
    call TriggerAddCondition(gg_trg_C09R_learn, Condition(function Trig_C09R_learnConditions))
endfunction//===========================================================================
// Trigger: C10
//===========================================================================
//C10T
function Trig_C10TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local integer level = GetUnitAbilityLevel(u1, 'A0A7')
local real dmg = 450.00 + 150.00 * I2R(level)
    //kill-dmg
	    if GetUnitState(u2, UNIT_STATE_LIFE) < dmg then
		    call UnitDamageTarget(u1, u2, 1200.00, true, false, ATTACK_TYPE_CHAOS, DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)
	    endif
	//ability
	call Creat_Disposable_Timer_for_Ability(u1,'A0DG',level,30.00,false)
set u1 = null
set u2 = null 
endfunction
function Trig_C10TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0A7' then
	    call Trig_C10TActions()
	endif 
    return false
endfunction
//C10R
function Trig_C10R_STARTConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0A6' then
		    if GetUnitAbilityLevel(GetTriggerUnit(), 'A0A6') == 1 then
	        	call TriggerRegisterUnitEvent(gg_trg_C10R_Attack_Unit, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE)
		    endif
	    call UnitAddAbility( GetTriggerUnit(), 'A0UH' )
	endif 
    return false
endfunction
//C10E
function Trig_C10EActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local real a = (GetUnitFacing(u1)* bj_DEGTORAD)
	local real x 
	local real y
	local real x1 
	local real y1 
	local item itt = CreateItem('I01T', 0, 0)
		    set x = GetUnitX(u1)
		    set y = GetUnitY(u1)
		    set x1 = x + 650.00*Cos(a)
		    set y1 = y + 650.00*Sin(a)
		    //create illusion
		    call UnitAddItem(u1, itt)
		    call RemoveItem( itt )
		    //unit move
		    call Short_time_move_Start(u1,x1,y1,0.005,false)
    set u1 = null
    set itt = null
endfunction
function Trig_C10EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0J2' then
	    call Trig_C10EActions()
	endif 
    return false
endfunction
//C10W
function Trig_C10WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u3 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	//for demage Hide_caster
	set u3 = CreateUnit(GetOwningPlayer(u1), 'h02E', x, y, 0)
	call UnitApplyTimedLife(u3,'BHwe',6.00)
	call UnitAddAbility(u3,'A04A')
	call SetUnitAbilityLevel(u3,'A04A',GetUnitAbilityLevel(u1,'A0A5'))
	call IssuePointOrder(u3,"breathoffire",x1,y1)
set u1 = null
set u3 = null
endfunction
function Trig_C10WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0A5' then
	    call Trig_C10WActions()
	endif 
    return false
endfunction
function InitTrig_C10_INIT takes trigger ltt_init returns nothing
///////////////////////////////////////////////////////
//【注意】a.一定要 h2i = ltt_init 要不然會沒有重複 h2i
// ////////////////////////////////////////////////////
local trigger ltt
local integer h2i = GetHandleId(ltt_init)
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_C10WConditions))
	call SaveTriggerHandle(udg_Trigger_H,h2i,1,ltt) 
	set ltt = CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_C10EConditions))
	call SaveTriggerHandle(udg_Trigger_H,h2i,2,ltt)
	set ltt = CreateTrigger() 
	call TriggerAddCondition(ltt, Condition(function Trig_C10R_STARTConditions))
    call SaveTriggerHandle(udg_Trigger_H,h2i,3,ltt) 
    set ltt = CreateTrigger() 
    call TriggerAddCondition(ltt, Condition(function Trig_C10TConditions))
    call SaveTriggerHandle(udg_Trigger_H,h2i,4,ltt) 
set ltt = null 
endfunction
function Trig_C10Actions takes nothing returns nothing
local trigger ltt = GetTriggeringTrigger()
local integer h2i = GetHandleId(ltt)
local unit u = udg_A_common_HERO
	/////////////////////
	//第一次註冊 TC , TA
	////////////////////
	if GetTriggerExecCount(ltt) == 1 then
		call InitTrig_C10_INIT(ltt)
		//開啟W分身
		call EnableTrigger( gg_trg_C10W_Spell_for_target )
	endif 
	/////////////
	//註冊 TE
	//////////// 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,1)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
    // -------------
    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,2)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
    // -------------
	set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,3)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_HERO_SKILL) 
    // -------------
	set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,4)
    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
set u = null
set ltt = null 
endfunction
//===========================================================================
function InitTrig_C10 takes nothing returns nothing
    set gg_trg_C10 = CreateTrigger()
    call TriggerAddAction(gg_trg_C10, function Trig_C10Actions)
endfunction
//===========================================================================
// Trigger: C10W Spell for target
//
// gg_trg_C10W_Damage
//===========================================================================
function Trig_C10W_DamageActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local	real	x	=	GetUnitX(u1)
local real y	=	GetUnitY(u1)
local unit u3 = CreateUnit(GetOwningPlayer(GetEventDamageSource()), 'h02G', x, y, 0)
	call ShowUnit(u3, false)
	call UnitApplyTimedLife(u3,'BHwe',0.10)
	call UnitAddAbility(u3,'A0JZ')
	call IssueTargetOrderById(u3, 852274, u1)
	
set u1 = null
set u3 = null
endfunction
function Trig_C10W_DamageConditions takes nothing returns boolean
    if IsTriggerEnabled(gg_trg_C10W_Spell_for_target) and GetUnitTypeId(GetEventDamageSource()) == 'h02E' then
	    call Trig_C10W_DamageActions()
	endif 
    return false
endfunction
function InitTrig_C10W_Spell_for_target takes nothing returns nothing
    set gg_trg_C10W_Spell_for_target = CreateTrigger()
    call DisableTrigger(gg_trg_C10W_Spell_for_target)
    call TriggerAddCondition(gg_trg_C10W_Spell_for_target, Condition(function Trig_C10W_DamageConditions))
endfunction//===========================================================================
// Trigger: C10R Attack Unit
//===========================================================================
function Trig_C10R_PLAYActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local unit u2 = GetEventTargetUnit()
    local real	x =	GetUnitX(u2)
    local	real	y =	GetUnitY(u2)
    local	player	p =	GetOwningPlayer(u1)
    local unit u3 = CreateUnit(p, 'h01E' , x , y, 0)
    local	integer	level	=	GetUnitAbilityLevel(u1,'A0A6')
    
    local real time = (23.50 - 4.00 * I2R(level))
		//call	BJDebugMsg(R2S(time))
    
	    call UnitApplyTimedLife( u3, 'BHwe', 0.01 )
	    call ShowUnit(u3, false)
	    call UnitAddAbility( u3, 'A0J3' )
	    call IssueTargetOrderById( u3, 852274, u2 )
	    
	    	//ability for effect
		    call Creat_Disposable_Timer_for_GetAbility(u1,'A0UH',1,time)
		    call UnitRemoveAbility( u1, 'A0UH' )
		    
    set u1 = null
    set u2 = null
    set u3 = null
    set p =	null
endfunction
function Trig_C10R_PLAYConditions takes nothing returns boolean
	local	unit	u	=	GetTriggerUnit()
	local	unit	u2	=	GetEventTargetUnit()
		
	    if GetUnitAbilityLevel(u, 'A0UH') != 0 and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false and IsUnitType(u2, UNIT_TYPE_ANCIENT) == false and IsUnitEnemy(u2, GetOwningPlayer(u)) then
			call Trig_C10R_PLAYActions()
		endif
		
	set u	=	null
	set u2	=	null	
    return false
endfunction
function InitTrig_C10R_Attack_Unit takes nothing returns nothing
    set gg_trg_C10R_Attack_Unit = CreateTrigger()
    call TriggerAddCondition(gg_trg_C10R_Attack_Unit, Condition(function Trig_C10R_PLAYConditions))
endfunction
//===========================================================================
// Trigger: C11T
//===========================================================================
function Trig_C11TFunc018T takes nothing returns nothing
local timer t= GetExpiredTimer()
local unit u1= LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D)
local unit u3= LoadUnitHandle(YDHT, GetHandleId(t), 0x9C0F555E)
	if IsUnitType(u1, UNIT_TYPE_DEAD) then
		call FlushChildHashtable(YDHT, GetHandleId(t))
		call DestroyTimer(t)
	else
		call SetUnitX(u3, GetUnitX(u1))
		call SetUnitY(u3, GetUnitY(u1))
		call IssueImmediateOrder(u3, "stomp")
	endif
set t=null
set u1=null
set u3=null
endfunction
function Trig_C11TActions takes nothing returns nothing
    local timer t= CreateTimer()
    local unit u1= GetTriggerUnit()
    local real x= GetUnitX(u1)
    local real y= GetUnitY(u1)
    local real x2= GetSpellTargetX()
    local real y2= GetSpellTargetY()
    local real a= Atan2(y2 - y, x2 - x)
    local real x3= x + 1500.00 * Cos(a)
    local real y3= y + 1500.00 * Sin(a)
    local unit u3= CreateUnit(GetOwningPlayer(u1), 'e00F', x, y, a * bj_RADTODEG)
    local unit u4= CreateUnit(GetOwningPlayer(u1), 'h01E', x, y, 0)
    local integer i= GetUnitAbilityLevel(u1, 'A0AA')
	    //======================================================
	    call SetUnitAbilityLevel(u3, 'A0AB', i)
	    //======================================================
	    call IssuePointOrderById(u3, 851986, x3, y3)
	    //======================================================
	    call UnitApplyTimedLife(u4, 'BHwe', 10.00)
	    call UnitAddAbility(u4, 'A0AB')
	    call SetUnitAbilityLevel(u4, 'A0AB', i)
	    //======================================================
	    call SaveUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D, u3)
	    call SaveUnitHandle(YDHT, GetHandleId(t), 0x9C0F555E, u4)
	    call TimerStart(t, 0.57, true, function Trig_C11TFunc018T)
	    //======================================================
    set t=null
    set u1=null
    set u3=null
    set u4=null
endfunction
function Trig_C11TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0AA' then
	    call Trig_C11TActions()
	endif
	return false 
endfunction
function InitTrig_C11T takes nothing returns nothing
    set gg_trg_C11T=CreateTrigger()
    call TriggerAddCondition(gg_trg_C11T, Condition(function Trig_C11TConditions))
endfunction//===========================================================================
// Trigger: C12
//===========================================================================
function Trig_C12Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C12W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C12E_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C12E_stop, udg_A_common_HERO, EVENT_UNIT_ISSUED_ORDER)
    call TriggerRegisterUnitEvent(gg_trg_C12R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C12R_stop, udg_A_common_HERO, EVENT_UNIT_SPELL_CHANNEL)
    set udg_C12R_area[1] = 350.00
    set udg_C12R_area[2] = 450.00
    set udg_C12R_area[3] = 550.00
    set udg_C12R_area[4] = 650.00
    set udg_C12E_T[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateTimer()
endfunction
//===========================================================================
function InitTrig_C12 takes nothing returns nothing
    set gg_trg_C12 = CreateTrigger()
    call TriggerAddAction(gg_trg_C12, function Trig_C12Actions)
endfunction
//===========================================================================
// Trigger: C12W
//===========================================================================
function Trig_C12WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit() 
local	real x =	GetUnitX(u1)
local	real y =	GetUnitY(u1)
local	player p =	GetOwningPlayer(u1)
local unit u3 = CreateUnit(p, 'h01E', x, y, 0)
local	integer level	=	GetUnitAbilityLevel(u1,'A0ML')
local real time	=	(1.20+(1.00*I2R(level)))
    call UnitApplyTimedLife( u3, 'BHwe', time )
    call UnitAddAbility( u3, 'A0AD' )
    call SetUnitAbilityLevel( u3, 'A0AD', level )
set p =	null 
set u1 = null
set u3 = null 
endfunction
function Trig_C12WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0ML' then
	    call Trig_C12WActions()
    endif
    return false
endfunction
function InitTrig_C12W takes nothing returns nothing
    set gg_trg_C12W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C12W, Condition(function Trig_C12WConditions))
endfunction//===========================================================================
// Trigger: C12E start
//===========================================================================
function Trig_C12E_startFunc005T takes nothing returns nothing
local timer t = GetExpiredTimer()
local unit u1 = LoadUnitHandle(YDHT, GetHandleId(t), 0xA1614B4D)
local real r =((0.01+(0.01*I2R(GetUnitAbilityLevel(u1,'A0AE'))))+(0.01*I2R(R2I((I2R(GetHeroInt(u1,true))/50.00)))))
local player p = GetOwningPlayer(u1)
local unit ydl_unit
    if GetUnitAbilityLevel(u1, 'B034') <= 0 then
	    call FlushChildHashtable(YDHT, GetHandleId(t))
	    call UnitRemoveAbility(u1, 'A0AH')
	    call PauseTimer(udg_C12E_T[GetPlayerId(p) + 1])
	else
	   	call GroupEnumUnitsInRange(udg_Group[2], GetUnitX(u1), GetUnitY(u1), 540.00, null)
    		loop
        		set ydl_unit = FirstOfGroup(udg_Group[2])
        		exitwhen ydl_unit == null
        		call GroupRemoveUnit(udg_Group[2], ydl_unit)
        			if (GetUnitAbilityLevel(ydl_unit, 'B036') > 0 and IsUnitEnemy(ydl_unit,p) ) then
	        			call UnitDamageTarget(u1,ydl_unit,GetUnitState(ydl_unit,UNIT_STATE_MAX_LIFE)*r, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
        			endif
    		endloop
    endif
    
set p = null 
set t = null
set u1 = null
set ydl_unit = null
endfunction
function Trig_C12E_startActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    
		//緩速
	    call UnitAddAbility( u1, 'A0AH' )
	    //傷害/sec
	    call SaveUnitHandle(YDHT, GetHandleId(udg_C12E_T[i]), 0xA1614B4D, u1)
	    call PauseTimer(udg_C12E_T[i])
	    call TimerStart(udg_C12E_T[i], 1.00, true, function Trig_C12E_startFunc005T)
    set u1 = null 
endfunction
function Trig_C12E_startConditions takes nothing returns boolean
    if ((GetSpellAbilityId() == 'A0AE')) then
	    call Trig_C12E_startActions()
    endif
    return false
endfunction
function InitTrig_C12E_start takes nothing returns nothing
    set gg_trg_C12E_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_C12E_start, Condition(function Trig_C12E_startConditions))
endfunction
//===========================================================================
// Trigger: C12E stop
//===========================================================================
function Trig_C12E_stopActions takes nothing returns nothing
    local unit u1= GetTriggerUnit()
    local integer i= GetPlayerId(GetOwningPlayer(u1)) + 1
	    call FlushChildHashtable(YDHT, GetHandleId(udg_C12E_T[i]))
		call PauseTimer(udg_C12E_T[i])
	    call UnitRemoveAbility(u1, 'A0AH')
    set u1=null
endfunction
function Trig_C12E_stopConditions takes nothing returns boolean
    if GetIssuedOrderId() == String2OrderIdBJ("unimmolation") then
	    call Trig_C12E_stopActions()
	endif
    return false
endfunction
function InitTrig_C12E_stop takes nothing returns nothing
    set gg_trg_C12E_stop=CreateTrigger()
    call TriggerAddCondition(gg_trg_C12E_stop, Condition(function Trig_C12E_stopConditions))
endfunction//===========================================================================
// Trigger: C12R 
//===========================================================================
function Trig_C12RActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local integer level = GetUnitAbilityLevel(u1,'A0AF')
local real dmg = 100.00+ 100.00*I2R(level)
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local unit ydl_unit
local player p = GetOwningPlayer(u1)
	call GroupEnumUnitsInRange(udg_Group[2], x, y, udg_C12R_area[level], null)
    loop
        set ydl_unit = FirstOfGroup(udg_Group[2])
        exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[2], ydl_unit)
        	if IsUnitType(ydl_unit,UNIT_TYPE_DEAD)==false and IsUnitEnemy(ydl_unit, p) and IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false and GetUnitPointValue(ydl_unit) != 1 then
				call UnitDamageTarget(u1,ydl_unit,dmg, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
        		call SetUnitPosition(ydl_unit, x, y)
        	endif
    endloop
    
set p = null
set u1 = null
set ydl_unit = null
endfunction
function Trig_C12RConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0AF' then
	    call Trig_C12RActions()
    endif
    return false
endfunction
function InitTrig_C12R takes nothing returns nothing
    set gg_trg_C12R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C12R, Condition(function Trig_C12RConditions))
endfunction//===========================================================================
// Trigger: C12R stop
//===========================================================================
function Trig_C12R_stopConditions takes nothing returns boolean	
	local	unit	u	=	GetTriggerUnit()
    if GetSpellAbilityId() == 'A0AF' and	(IsTerrainPathable(GetSpellTargetX(), GetSpellTargetY(), PATHING_TYPE_WALKABILITY)) then
		call DisplayTimedTextToPlayer( GetOwningPlayer(u), 0, 0, 3.00, "TRIGSTR_9789" )
		call PauseUnit(u,true)
		call PauseUnit(u,false)
		call IssueImmediateOrder(u,"stop")
    endif
    set u	=	null
    return false
endfunction
function InitTrig_C12R_stop takes nothing returns nothing
    set gg_trg_C12R_stop = CreateTrigger()
    call TriggerAddCondition(gg_trg_C12R_stop, Condition(function Trig_C12R_stopConditions))
endfunction//===========================================================================
// Trigger: C13R  
//===========================================================================
function Trig_C13RConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0AK' then
	    call SetPlayerTechResearched( GetOwningPlayer(GetTriggerUnit()) , 'R009', GetUnitAbilityLevel(GetTriggerUnit(), 'A0AK') )
	endif
	return false
endfunction
function InitTrig_C13R takes nothing returns nothing
    set gg_trg_C13R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C13R, Condition(function Trig_C13RConditions))
endfunction
//===========================================================================
// Trigger: C13T 
//===========================================================================
function C13T_Spell_2 takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer h2i = GetHandleId(t)
	local unit u1 = LoadUnitHandle(YDHT,h2i,1)
	local location p = LoadLocationHandle(YDHT,h2i,2)
	local integer i = 1	
	local real x = GetLocationX(p)
	local	real y = GetLocationY(p)
	local player ppl	=	GetOwningPlayer(u1)
	local real x1
	local real y1
	local unit u3 
	local real a
		//clean
	    call FlushChildHashtable(YDHT,h2i)
	    call DestroyTimer(t)
		call RemoveLocation(p)
	
		
			//effect
		    loop
			    exitwhen i > 16
			    set a = 22.50 * I2R(i)
			    set x1 = x + 400.00*Cos(a)
			    set y1 = y + 400.00*Sin(a)
			    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Monsoon\\MonsoonBoltTarget.mdl", x1, y1))
		        set i = i+1
		    endloop
		    
		//暈眩
		set u3 = CreateUnit(ppl,'h02G', x , y ,0)
	    call UnitApplyTimedLife(u3,'BHwe',0.50)
	    call UnitAddAbility(u3,'A0H7')
	    call SetUnitAbilityLevel(u3,'A0H7',GetUnitAbilityLevel(u1,'A05R'))
	    call IssueImmediateOrder(u3, "stomp")
	    
	    //回覆可以原本跑速
		call SetUnitMoveSpeed( u1, GetUnitDefaultMoveSpeed(u1) )
		
	    call SetUnitTimeScale( u1, 1.00 )
	    call SetUnitPosition(u1,x,y)
	    
		    if (GetLocalPlayer() == ppl) then
		        // Use only local code (no net traffic) within this block to avoid desyncs.
		        call PanCameraToTimed(x, y, 0)
		    endif
		    
		
	set p = null
	set u1	= null
	set u3	= null
	set t = null
	set ppl	=	null
endfunction
function C13T_Spell_1 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 = LoadUnitHandle(YDHT,h2i,1)
    call SetUnitTimeScale( u1, 4.00 )
    call SetUnitAnimation( u1, "attack" )
	call TimerStart(t,0.2,false,function C13T_Spell_2)
	
set t	=	null
set u1	=	null	
endfunction
function C13T_TA takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local real x = GetSpellTargetX()
	local real y = GetSpellTargetY()
	local location p = GetSpellTargetLoc()
	local integer i = 1
	local timer t = CreateTimer()
	local	integer h2i = GetHandleId(t)
	local unit u3
	
		//預警雷
	    call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Monsoon\\MonsoonBoltTarget.mdl", x, y))
	    //禁止前田可以跑
		call SetUnitMoveSpeed( u1, 0 )
		
		//開啟計時器
		call SaveUnitHandle(YDHT,h2i,1,u1)
		call SaveLocationHandle(YDHT,h2i,2,p)
		call TimerStart(t,0.60,false,function C13T_Spell_1)
		//call TimerStart(t,0.40,false,function C13T_Spell_1)
		
	set p = null
	set u1	= null
	set u3	= null
endfunction
function C13T_TC takes nothing returns boolean
    if GetSpellAbilityId() == 'A05R' then
		call C13T_TA()
    endif
    return false
endfunction
function InitTrig_C13T takes nothing returns nothing
    set gg_trg_C13T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C13T, Condition(function C13T_TC))
endfunction
//===========================================================================
// Trigger: C14
//===========================================================================
function Trig_C14_E_2Actions takes nothing returns nothing
local item tool	= GetManipulatedItem()
local unit u1 = GetTriggerUnit()
local unit u3
local integer h2i = GetHandleId(tool)
local integer i = LoadInteger(YDHT, h2i, 55555)
local integer i2 = LoadInteger(YDHT, h2i, 0xA1614B4D)
local integer level	= GetUnitAbilityLevel(udg_S01_hero_of_player[i2], 'A0TI')
local real dmg = 100.00 * I2R(level)
local real x = GetUnitX(u1)
local real y = GetUnitY(u1) 
	call FlushChildHashtable(YDHT, h2i)
	call RemoveItem(tool)
	//////////////////////問題點在這個//////////////////////////	
	set tool = CreateItem(i, x, y)
	call UnitAddItem(u1,tool) 
	
		//for sign
	  	set u3=CreateUnit(GetOwningPlayer(udg_S01_hero_of_player[i2]), 'h02G', x, y, 0)
	  	call UnitApplyTimedLife(u3, 'BHwe', 0.01)
	  	
	  	/////////////////////////////////////////////
		//【注意】
		//這邊是馬甲單位歸對面，這樣可以對影行單位有效果
		/////////////////////////////////////////////	
		set u3=CreateUnit(GetOwningPlayer(u1), 'h02G', x, y, 0)
        call UnitApplyTimedLife(u3, 'BHwe', 0.01)
        call UnitAddAbility(u3, 'A08N')
        call SetUnitAbilityLevel(u3, 'A08N',level)
        call IssueTargetOrder(u3, "ensnare", u1)
        
        //damage
        call UnitDamageTarget(udg_S01_hero_of_player[i2], u1, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS) 
  
set u1 =	null
set tool	=	null
set u3 =	null
endfunction
function Trig_C14_E_2Conditions takes nothing returns boolean
	if GetItemTypeId(GetManipulatedItem()) == 'I01V' then
		call Trig_C14_E_2Actions()
	endif	
    return false
endfunction
///////////////////////////////////////////////////////////
//				C14E 施法 : 大盜掉換
///////////////////////////////////////////////////////////
function Trig_C14_EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local integer i = 1
local integer i2 = 0
local integer i3 = GetPlayerId(GetOwningPlayer(u1)) + 1
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local item itm
local integer money
local player p
local integer h2i
local item tool
		///////////////////////////////////////
		//【替換物品】 
		//先記錄目標身上 六個物品
		//如果大於1 那麼才替換物品
		///////////////////////////////////////
		//檢查
	    set i2 = 0
	    set i = 1
	    loop
	        exitwhen i > 6
	        set itm = UnitItemInSlot(u2, i-1) 
		        if itm != null and GetItemTypeId(itm) != 'I01V' then
		            set i2 = i2 + 1 
		            set udg_C14E_ItemCheck[i2] = UnitItemInSlot(u2, i-1)
		        endif
	        set i = i + 1
	        //一個物品 i2 = 0 + 1
	        //set udg_C14E_ItemCheck[i2] = UnitItemInSlot(u2, 1-1)
	    endloop
	    
    if i2 >= 1 then
	    if IsUnitPaused(u2) == true then
			call DisplayTimedTextToPlayer(GetOwningPlayer(u1),0,0,5,"目標處於異常狀態 無法掉換物品")
		else 
		 
	        set i2 = GetRandomInt(1, i2)
	        set udg_C14E_TargetHeroItem[udg_C14E_Int] = GetItemTypeId(udg_C14E_ItemCheck[i2])
	        
	        //避免重複
	        set udg_C14E_Int = ( udg_C14E_Int + 1 )
	        set i = GetItemTypeId(udg_C14E_ItemCheck[i2])
	        call RemoveItem( udg_C14E_ItemCheck[i2] )
        
		    //給予 物品
		    // Create the item at the hero's feet first, and then give it to him.
		    // This is to ensure that the item will be left at the hero's feet if
		    // his inventory is full. 
		 
	    	set tool = CreateItem('I01V', x, y)
	    	call UnitAddItem(u2,tool) 
	    	     		    
		    //有什麼原因 他會沒辦法 給漁呢??????????????
		    //A.物品欄滿 
		    //  1.情況會發生在 瞬間判斷的時候 目標單位 有物品的。
		    //  2.原版也會有這個情形
		    //  3.多人同一個觸發器 造成的情況 (解決方法 每一個石川 註冊一個觸發器)
		    //  4.這邊綁定的物品 假設是 
		    //  5.u2 單位跑掉
		    //  END.物編 睡眠的問題。
		    ///////////////////////////////////////////////////////////
		    
	    	//設定自訂值 + HASH
	    	set h2i = GetHandleId(tool)
		    call SaveInteger(YDHT, h2i, 55555, i)
		    call SaveInteger(YDHT, h2i, 0xA1614B4D, i3)
		    
		endif
	    
    endif
    
	//扣目標錢 增加自身錢
	set money = 14 + 9 * GetUnitAbilityLevel(u1,'A0TI')
	set p = GetOwningPlayer(u1)
	call SetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) + money)
	
	set p = GetOwningPlayer(u2)
	call SetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) - money)
	//傷害要放在後面 ， 要不然會掉落物品
	call UnitDamageTarget(u1, u2, udg_C14T_I4[i3], true, false, ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
	
set p = null
set u1 =	null
set u2 =	null
set tool	=	null
endfunction
function Trig_C14_EConditions takes nothing returns boolean 
    if GetSpellAbilityId() == 'A0TI' then
	    call Trig_C14_EActions()
    endif
    return false
endfunction
function Trig_C14Actions takes nothing returns nothing
local trigger ltt
    call TriggerRegisterUnitEvent(gg_trg_C14W_start, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C14W, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    // -------------------------------------------
    set ltt	= CreateTrigger()
    call TriggerAddCondition(ltt, Condition(function Trig_C14_EConditions))
    call TriggerRegisterUnitEvent(ltt ,udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C14R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // -------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C14T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------------------------------------
    set udg_C14R_damage[1] = 60.00
    set udg_C14R_damage[2] = 90.00
    set udg_C14R_damage[3] = 120.00
    set udg_C14R_damage[4] = 150.00
    // -----------------------------------------
    if GetTriggerExecCount(GetTriggeringTrigger()) == 1 then
        call TriggerRegisterAnyUnitEventBJ(gg_trg_C14D, EVENT_PLAYER_UNIT_DEATH)
        set ltt	= CreateTrigger()
        call TriggerAddCondition(ltt, Condition(function Trig_C14_E_2Conditions))
        call TriggerRegisterAnyUnitEventBJ(ltt, EVENT_PLAYER_UNIT_USE_ITEM)
    endif
set ltt = null 
endfunction
//===========================================================================
function InitTrig_C14 takes nothing returns nothing
    set gg_trg_C14 = CreateTrigger()
    call TriggerAddAction(gg_trg_C14, function Trig_C14Actions)
endfunction
//===========================================================================
// Trigger: C14D
//===========================================================================
function Trig_C14_DActions takes nothing returns nothing
local player p = GetOwningPlayer(GetKillingUnit())
	if IsUnitType(GetTriggerUnit(), UNIT_TYPE_HERO) then
		call SetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) + 100)
	else
		call SetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) + 4)
	endif
set p = null 
endfunction
function Trig_C14_DConditions takes nothing returns boolean
	if GetUnitTypeId(GetKillingUnit()) == 'Hapm' then
		call Trig_C14_DActions()
	endif	
    return false
endfunction
function InitTrig_C14D takes nothing returns nothing
    set gg_trg_C14D = CreateTrigger()
    call TriggerAddCondition(gg_trg_C14D, Condition(function Trig_C14_DConditions))
endfunction
//===========================================================================
// Trigger: C14W start
//===========================================================================
function Trig_C14_W_startConditions takes nothing returns boolean
	if GetSpellAbilityId() == 'A0VM' then
		set udg_C14W_I[GetPlayerId(GetTriggerPlayer()) + 1] = GetUnitAbilityLevel(GetTriggerUnit(),'A0VM') + 3
	endif	
    return false
endfunction
function InitTrig_C14W_start takes nothing returns nothing
    set gg_trg_C14W_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_C14W_start, Condition(function Trig_C14_W_startConditions))
endfunction
//===========================================================================
// Trigger: C14W
//===========================================================================
function Trig_C14_WConditions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local integer i
		if GetUnitAbilityLevel(u1, 'B03B') > 0 then	
			set i = GetPlayerId(GetTriggerPlayer()) + 1 
	    	if udg_C14W_I[i]<=0 then
	        	call UnitRemoveAbility(u1, 'B03B') 
	    	else
	    		set udg_C14W_I[i] = ( udg_C14W_I[i] - 1 )
	    	endif
	    endif	
    set u1 = null
endfunction
//===========================================================================
function InitTrig_C14W takes nothing returns nothing
    set gg_trg_C14W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C14W, Condition(function Trig_C14_WConditions))
endfunction
//===========================================================================
// Trigger: C14R learn
//===========================================================================
function Trig_C14R_LearnConditions takes nothing returns boolean
local unit u = GetTriggerUnit()
    if GetLearnedSkill() == 'A0VN' and IsUnitIllusion(u) != true and GetUnitAbilityLevel(u, 'A0VN') == 1 then
    	call TriggerRegisterUnitEvent(gg_trg_C14R_attack, u, EVENT_UNIT_TARGET_IN_RANGE)
    	call TriggerRegisterUnitEvent(gg_trg_C14R, u, EVENT_UNIT_SPELL_EFFECT)
	endif
set u = null	
return false
endfunction
function InitTrig_C14R_learn takes nothing returns nothing
    set gg_trg_C14R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_C14R_learn, Condition(function Trig_C14R_LearnConditions))
endfunction
//===========================================================================
// Trigger: C14R attack
//===========================================================================
function Trig_C14R_startConditionsConditions takes nothing returns nothing
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local real r = 0.05 * I2R(GetPlayerState(GetOwningPlayer(u1),PLAYER_STATE_RESOURCE_GOLD))
	local real dmg 
	local integer level = GetUnitAbilityLevel(u1,'A0VN')
			//damage check
			if r >= udg_C14R_damage[level] then
				set dmg = udg_C14R_damage[level] + udg_C14T_I3[i]
			else
				set dmg = r + udg_C14T_I3[i]
			endif
		//Avoid crash
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)
		set udg_B12R_B[i]=false
		//////////////
		//傷害
		//////////////
	    call UnitDamageTarget(u1, u2, dmg, true, false, ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID, WEAPON_TYPE_WHOKNOWS)
	set ltt = null
	set u1 = null
    set u2 = null
endfunction
function Trig_C14R_startConditions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit()
    local trigger ltt
    local integer h2i 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local triggercondition ltc
    	if udg_B12R_B[i]==false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false then
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
	    		///////////
	    		//參數設定
	    		//////////
		    	set udg_B12R_B[i]=true
		    	call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    	set ltc = TriggerAddCondition(ltt, Condition(function Trig_C14R_startConditionsConditions))
			    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
		    	/////////////////////////////////////////////////////////////
			    //timer check + 觸發器登記
			    /////////////////////////////////////////////////////////////
			    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
			    call Normal_Attack_Timer_for_Trigger(ltt,0.30 , ltc , i)
		endif 
    set ltt = null
    set ltc = null
    set u1 = null
    set u2 = null
endfunction
function InitTrig_C14R_attack takes nothing returns nothing
    set gg_trg_C14R_attack = CreateTrigger()
    call TriggerAddCondition(gg_trg_C14R_attack, Condition(function Trig_C14R_startConditions))
endfunction
//===========================================================================
// Trigger: C14R
//
// (I2R(GetPlayerState(GetOwningPlayer(u1),PLAYER_STATE_RESOURCE_GOLD))*0.05))
//===========================================================================
function Trig_C14_RConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0VN'
endfunction
function Trig_C14_R_dmg takes nothing returns nothing
local trigger ltt
local integer h2i
local unit u1 
local integer i
local real dmg = GetEventDamage()
    if dmg > 1 then
	    set u1 = GetTriggerUnit()
	    set i = GetPlayerId(GetTriggerPlayer()) + 1
	    	if udg_C14_R[i] <= dmg then
		    	//Variable
		    	set ltt = GetTriggeringTrigger()
		    	set h2i = GetHandleId(ltt)
		    	//effect
		    	call UnitRemoveAbility( u1, 'A0X8' )
		    	//resist dmg
		    	call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + udg_C14_R[i])
		    	//clean
				call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
				call DestroyTrigger(ltt)
				call FlushChildHashtable(YDHT, h2i)
			else
				call SetUnitState(u1, UNIT_STATE_LIFE,GetUnitState(u1, UNIT_STATE_LIFE) + dmg)
				set udg_C14_R[i] = udg_C14_R[i] - dmg 
			endif
	endif 
set u1 = null
set ltt = null
endfunction
function Trig_C14_RActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local integer i = GetPlayerId(GetTriggerPlayer()) + 1 
	local trigger ltt =CreateTrigger()
	local triggercondition ltc 
		//effect
		call UnitAddAbility( u1, 'A0X8' )
		//shied init 
		set udg_C14_R[i] = 100.00 + 100.00 * I2R(GetUnitAbilityLevel(u1, 'A0VN')) 
		set udg_C14_R[i] = udg_C14_R[i] + 0.05 * I2R(GetPlayerState(GetOwningPlayer(u1),PLAYER_STATE_RESOURCE_GOLD)) 
		set udg_C14_R[i] = udg_C14_R[i] + udg_C14T_I2[i] 
		set ltc = TriggerAddCondition(ltt, Condition(function Trig_C14_R_dmg))
		call SaveTriggerConditionHandle(YDHT,GetHandleId(ltt),44444,ltc)
		///////////////////
		//傷害減免
		///////////////////
		call TriggerRegisterUnitEvent( ltt, u1, EVENT_UNIT_DAMAGED )
		call YDWEPolledWaitNull(10.00) 
		set udg_C14_R[i] = 0.00
			if ltt != null then
				call UnitRemoveAbility( u1, 'A0X8' )
				call TriggerRemoveCondition(ltt , ltc)
				call DestroyTrigger(ltt)
			endif	
    set u1 = null
    set ltt = null
    set ltc = null
endfunction
//===========================================================================
function InitTrig_C14R takes nothing returns nothing
    set gg_trg_C14R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C14R, Condition(function Trig_C14_RConditions))
    call TriggerAddAction(gg_trg_C14R, function Trig_C14_RActions)
endfunction
//===========================================================================
// Trigger: C14T
//
// if(GetPlayerState(GetOwningPlayer(u2),PLAYER_STATE_RESOURCE_GOLD)<=300)then
// local integer i = GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))
//===========================================================================
function Trig_C14_TConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0AS'
endfunction
function Trig_C14_TActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local unit u2 = GetSpellTargetUnit()
    local player p = GetOwningPlayer(u1)
    local player p2 = GetOwningPlayer(u2)
    local integer i = GetPlayerId(p) + 1
    local integer money
    	//扣錢/加錢
	    if(GetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD)<=300)then
		    set money = GetPlayerState(p2, PLAYER_STATE_RESOURCE_GOLD)
		    call SetPlayerState(p , PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p, PLAYER_STATE_RESOURCE_GOLD) + money)
		    call SetPlayerState(p2, PLAYER_STATE_RESOURCE_GOLD, 0)
	    else
	    	set money = 300
	    	call SetPlayerState(p , PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p , PLAYER_STATE_RESOURCE_GOLD) + money)
	    	call SetPlayerState(p2, PLAYER_STATE_RESOURCE_GOLD, GetPlayerState(p2, PLAYER_STATE_RESOURCE_GOLD) - money)
	    endif
	    // R-DEF
	    set udg_C14T_I2[i] = 300.00
	    // R-dmg
	    set udg_C14T_I3[i] = 50.00
	    // E
	    set udg_C14T_I4[i] = 400.00
		// W
	    set udg_C14W_I[i]=udg_C14W_I[i]+2
	    call YDWEPolledWaitNull(30.00)
	    set udg_C14T_I2[i] = 0.00
	    set udg_C14T_I3[i] = 0.00
	    set udg_C14T_I4[i] = 0.00
    set u1 = null
    set u2 = null
    set p = null
    set p2 = null
endfunction
//===========================================================================
function InitTrig_C14T takes nothing returns nothing
    set gg_trg_C14T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C14T, Condition(function Trig_C14_TConditions))
    call TriggerAddAction(gg_trg_C14T, function Trig_C14_TActions)
endfunction
//===========================================================================
// Trigger: C15
//===========================================================================
function Trig_C15Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C15D_check, udg_A_common_HERO, EVENT_UNIT_ISSUED_ORDER)
    call TriggerRegisterUnitEvent(gg_trg_C15D_effect, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C15W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // -------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C15R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_C15 takes nothing returns nothing
    set gg_trg_C15 = CreateTrigger()
    call TriggerAddAction(gg_trg_C15, function Trig_C15Actions)
endfunction
//===========================================================================
// Trigger: C15D check
//
// 放下盾
//===========================================================================
function Trig_C15D_checkConditions takes nothing returns boolean
	set udg_C15D_check[GetPlayerId(GetTriggerPlayer()) + 1]=GetIssuedOrderId()==852478	
	return false	
endfunction
function InitTrig_C15D_check takes nothing returns nothing
    set gg_trg_C15D_check = CreateTrigger()
    call TriggerAddCondition(gg_trg_C15D_check, Condition(function Trig_C15D_checkConditions))
endfunction
//===========================================================================
// Trigger: C15D effect
//===========================================================================
function Trig_C15D_effectConditions takes nothing returns nothing
	local integer id = GetSpellAbilityId()
	local unit u1 
	    if id == 'A0AV' or id == 'A0IS' or id == 'A0AY' or id == 'A0AZ' and udg_C15D_check[ GetPlayerId(GetTriggerPlayer()) + 1 ] then
		    set u1 = GetTriggerUnit()
			call SetUnitState(u1, UNIT_STATE_MANA, GetUnitState(u1, UNIT_STATE_MANA) - 0.06 * GetUnitState(u1, UNIT_STATE_MAX_MANA) )
			//call BJDebugMsg(R2S(GetUnitState(u1, UNIT_STATE_MANA) -  0.06 * GetUnitState(u1, UNIT_STATE_MAX_MANA)))
			//call BJDebugMsg(R2S(0.06 * GetUnitState(u1, UNIT_STATE_MAX_MANA)))
		endif
	set u1 = null
endfunction
//===========================================================================
function InitTrig_C15D_effect takes nothing returns nothing
    set gg_trg_C15D_effect = CreateTrigger()
    call TriggerAddCondition(gg_trg_C15D_effect, Condition(function Trig_C15D_effectConditions))
endfunction
//===========================================================================
// Trigger: C15W
//===========================================================================
function Trig_C15WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
//for sign
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G', x , y ,0)
		call UnitApplyTimedLife(u3,'BHwe',0.01)
		call ShowUnit(u3, false)
		//for spell
		set u3 = CreateUnit(GetOwningPlayer(u1),'h01E', x , y ,0)
        call UnitApplyTimedLife(u3,'BHwe',13.00)
        call UnitAddAbility(u3,'A0AW')
        call SetUnitAbilityLevel(u3,'A0AW',GetUnitAbilityLevel(u1,'A0AV'))
        call IssuePointOrder(u3,"blizzard",x,y)
set u1 = null
set u3 = null
endfunction
function Trig_C15WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0AV' then
	    call Trig_C15WActions()
	endif
	return false
endfunction
function InitTrig_C15W takes nothing returns nothing
    set gg_trg_C15W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C15W, Condition(function Trig_C15WConditions))
endfunction
//===========================================================================
// Trigger: C15R
//===========================================================================
function Trig_C15RActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	    if GetUnitLifePercent(u1) > 10 then
	        call UnitDamageTargetBJ( u1, u1, ( 0.10 * GetUnitState(u1, UNIT_STATE_MAX_LIFE) ), ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC )
	    else
	    	call UnitDamageTargetBJ(u1,u1,(GetUnitState(u1,UNIT_STATE_LIFE)*0.95),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
	    endif
	set u1 = null
endfunction
function Trig_C15RConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0AY' then
	    call Trig_C15RActions()
    endif
    return false
endfunction
function InitTrig_C15R takes nothing returns nothing
    set gg_trg_C15R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C15R, Condition(function Trig_C15RConditions))
endfunction
//===========================================================================
// Trigger: C16
//===========================================================================
function Trig_C16Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C16E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C16R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_C16 takes nothing returns nothing
    set gg_trg_C16 = CreateTrigger()
    call TriggerAddAction(gg_trg_C16, function Trig_C16Actions)
endfunction
//===========================================================================
// Trigger: C16E
//===========================================================================
function Trig_C16EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A082'))
endfunction
function Trig_C16EActions takes nothing returns nothing
    call SetUnitLifeBJ( GetTriggerUnit(), ( GetUnitStateSwap(UNIT_STATE_LIFE, GetTriggerUnit()) + ( 25.00 + ( 75.00 * I2R(GetUnitAbilityLevel(GetTriggerUnit(), 'A082')) ) ) ) )
endfunction
//===========================================================================
function InitTrig_C16E takes nothing returns nothing
    set gg_trg_C16E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C16E, Condition(function Trig_C16EConditions))
    call TriggerAddAction(gg_trg_C16E, function Trig_C16EActions)
endfunction
//===========================================================================
// Trigger: C16R 
//
// 有人說有BUG
// 我的想法是不是 有物編問題?
// 瞬移?
//===========================================================================
function Trig_C16RConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0B4'
endfunction
function Trig_C16RActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real x = GetSpellTargetX()
local real y = GetSpellTargetY()
local unit u3 = CreateUnit(GetOwningPlayer(u1),'h01E', x , y ,0)
        call UnitApplyTimedLife(u3,'BHwe',2.00)
        call UnitAddAbility(u3,'A0NI')
        call SetUnitAbilityLevel(u3,'A0NI',GetUnitAbilityLevel(u1,'A0B4'))
        call IssueImmediateOrder(u3,"thunderclap")
set u1 = null
set u3 = null
endfunction
function InitTrig_C16R takes nothing returns nothing
    set gg_trg_C16R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C16R, Condition(function Trig_C16RConditions))
    call TriggerAddAction(gg_trg_C16R, function Trig_C16RActions)
endfunction//===========================================================================
// Trigger: C17
//===========================================================================
function Trig_C17Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C17W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C17E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C17R, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C17T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    set udg_C17W_G[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
endfunction
//===========================================================================
function InitTrig_C17 takes nothing returns nothing
    set gg_trg_C17 = CreateTrigger()
    call TriggerAddAction(gg_trg_C17, function Trig_C17Actions)
endfunction
//===========================================================================
// Trigger: C17W 
//===========================================================================
globals
real array C17W_R
real array C17W_A
real array C17W_Range
endglobals
function Trig_C17WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0B7'))
endfunction
function Trig_C17W_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
local real x 
local real y
local unit ydl_unit
	if C17W_R[i]<=69.00 then	
		set x = GetUnitX(u1) + 35.00*Cos(C17W_A[i])
		set y = GetUnitY(u1) + 35.00*Sin(C17W_A[i])
		call SetUnitX(u1,x)
		call SetUnitY(u1,y)	
		call GroupEnumUnitsInRange(udg_Group[2], x, y, C17W_Range[i], null)
    		loop
        		set ydl_unit = FirstOfGroup(udg_Group[2])
        		exitwhen ydl_unit == null
        		call GroupRemoveUnit(udg_Group[2], ydl_unit)
        			if ( IsUnitInGroup(ydl_unit, udg_C17W_G[i]) != true and IsUnitType(ydl_unit,UNIT_TYPE_DEAD)==false and IsUnitEnemy(ydl_unit, GetOwningPlayer(u1)) and IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) then
						call GroupAddUnit(udg_C17W_G[i],ydl_unit)
						call IssueTargetOrderById( u1, 852075, ydl_unit )
    					call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",ydl_unit,"origin") )
    				endif
        	endloop
        call ShowUnit(u1, false) 
        call KillUnit(u1)	
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		set C17W_R[i]=C17W_R[i]-69.00
		set x = GetUnitX(u1) + 69.00*Cos(C17W_A[i])
		set y = GetUnitY(u1) + 69.00*Sin(C17W_A[i])
		
		call SetUnitX(u1,x)
		call SetUnitY(u1,y)
		
		call GroupEnumUnitsInRange(udg_Group[2], x, y, C17W_Range[i], null)
    		loop
        		set ydl_unit = FirstOfGroup(udg_Group[2])
        		exitwhen ydl_unit == null
        		call GroupRemoveUnit(udg_Group[2], ydl_unit)
        			if ( IsUnitInGroup(ydl_unit, udg_C17W_G[i]) != true and IsUnitType(ydl_unit,UNIT_TYPE_DEAD)==false and IsUnitEnemy(ydl_unit, GetOwningPlayer(u1)) and IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false) then
						call GroupAddUnit(udg_C17W_G[i],ydl_unit)
						call IssueTargetOrderById( u1, 852075, ydl_unit )
    					call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",ydl_unit,"origin") )
    				endif
        	endloop
        set C17W_Range[i] = C17W_Range[i]+8	
	endif	
set u1 = null
set ydl_unit = null	
set t = null
endfunction
function Trig_C17WActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local unit u3 
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
//for demage Hide_caster
set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', x, y, 0)
call UnitApplyTimedLife(u3,'BHwe',6.00)
call UnitAddAbility(u3,'A05U')
call SetUnitAbilityLevel(u3,'A05U',GetUnitAbilityLevel(u1,'A0B7'))
call IssuePointOrder(u3,"breathoffire",x1,y1)
//for sign Hide_caster
set u3 = CreateUnit(GetOwningPlayer(u1), 'h02G', x, y, 0)
call UnitApplyTimedLife(u3,'BHwe',3.00)
call UnitAddAbility(u3,'A0D1')
call SetUnitAbilityLevel(u3,'A0D1',GetUnitAbilityLevel(udg_S01_hero_of_player[i],'A0B7'))
call GroupClear(udg_C17W_G[i])
set C17W_Range[i]=165.00
set C17W_R[i]=965.00
set C17W_A[i]=Atan2( y1-y, x1-x)
call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u3)
call TimerStart(t, 0.05 , true, function Trig_C17W_Timer)
set u1 = null
set u3 = null
set t = null
endfunction
//===========================================================================
function InitTrig_C17W takes nothing returns nothing
    set gg_trg_C17W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C17W, Condition(function Trig_C17WConditions))
    call TriggerAddAction(gg_trg_C17W, function Trig_C17WActions)
endfunction
//===========================================================================
// Trigger: C17E
//===========================================================================
function Trig_C17EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0LR'))
endfunction
function Trig_C17EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local integer i = GetUnitAbilityLevel(u1,'A0LR')
local real r = GetUnitState(u1, UNIT_STATE_LIFE)
local real r2 = GetUnitState(u2, UNIT_STATE_LIFE)
	if(r2<=(50.00+(100.00*I2R(i))))then
		call SetUnitLifeBJ(u1,(r+r2))
		call SetUnitLifeBJ(u2,1.00)
		call UnitDamageTargetBJ(u1,u2,500,ATTACK_TYPE_CHAOS,DAMAGE_TYPE_ACID)
	else
		call SetUnitLifeBJ(u1,(r+(50.00+(100.00*I2R(i)))))
		call UnitDamageTargetBJ(u1,u2,(50.00+(100.00*I2R(i))),ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
	endif
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_C17E takes nothing returns nothing
    set gg_trg_C17E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C17E, Condition(function Trig_C17EConditions))
    call TriggerAddAction(gg_trg_C17E, function Trig_C17EActions)
endfunction
//===========================================================================
// Trigger: C17R
//===========================================================================
function Trig_C17RConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0AX'))
endfunction
function Trig_C17RActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rume', GetUnitAbilityLevel(GetTriggerUnit(), 'A0AX'), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_C17R takes nothing returns nothing
    set gg_trg_C17R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C17R, Condition(function Trig_C17RConditions))
    call TriggerAddAction(gg_trg_C17R, function Trig_C17RActions)
endfunction
//===========================================================================
// Trigger: C17T
//===========================================================================
function Trig_C17TFunc0090023 takes nothing returns nothing
	local timer t =	GetExpiredTimer()
	local integer	h2i =	GetHandleId(t)
	local unit u1 =	LoadUnitHandle(YDHT,h2i,1)
	local group g =	LoadGroupHandle(YDHT,h2i,2)
	local real x =	GetUnitX(u1)
	local real y =	GetUnitY(u1)	
	local unit ydl_unit	=	null
		//MOVE UNIT TO HERO'S LOCATION
		loop
			set ydl_unit = FirstOfGroup(g)
		    exitwhen ydl_unit == null
			   	call GroupRemoveUnit(g, ydl_unit)
				call SetUnitPosition(ydl_unit,x,y)
		endloop
		//CLEAN
		call DestroyGroup(g)
		call DestroyTimer(t)
		call FlushChildHashtable(YDHT,h2i)
		
	set u1 =	null
	set ydl_unit	=	null
	set g =	null
	set t =	null	
endfunction
function Trig_C17TActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local group g = CreateGroup()
	local real x =	GetUnitX(u1)
	local real y =	GetUnitY(u1)
	local timer t =	CreateTimer()
	local integer	h2i =	GetHandleId(t)
	local player	p =	GetOwningPlayer(u1)
	local real time =	3.1
	local unit ydl_unit	=	null
		//避免召集戰法
		set	C17T_CHECK_B	=	true
		call UnitDamageTargetBJ(u1,u1,2.00,ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
		set	C17T_CHECK_B	=	false
		
			//CHOSE UNIT AROUND HERO
		    call GroupEnumUnitsInRange(udg_Group[2], x, y, 1000.00, null)
		    loop
		        set ydl_unit = FirstOfGroup(udg_Group[2])
		        exitwhen ydl_unit == null
		        call GroupRemoveUnit(udg_Group[2], ydl_unit)
		        	if (( IsUnitType(ydl_unit,UNIT_TYPE_DEAD)==false) and IsUnitEnemy(ydl_unit, p) and (IsUnitType(ydl_unit, UNIT_TYPE_MECHANICAL) == false) and (IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false)) then
		        		call GroupAddUnit( g, ydl_unit)
		        	endif
		    endloop
		//TIMER START
		call SaveUnitHandle(YDHT,h2i,1,u1)
		call SaveGroupHandle(YDHT,h2i,2,g)
		call TimerStart(t,time,false,function Trig_C17TFunc0090023)
	set t =	null
	set u1 = null
	set g = null
	set ydl_unit = null
endfunction
function Trig_C17TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0UF' then
	    call Trig_C17TActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_C17T takes nothing returns nothing
    set gg_trg_C17T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C17T, Condition(function Trig_C17TConditions))
endfunction
globals
boolean	C17T_CHECK_B = false
endglobals//===========================================================================
// Trigger: C18
//===========================================================================
//C18W-1-Spell Effect
function Trig_C18WActions takes nothing returns nothing
	
    call ShowUnit(GetTriggerUnit(), false)
    //連鎖函數
    set udg_C18W_Target[GetPlayerId(GetTriggerPlayer()) + 1] = GetSpellTargetUnit()
    call ChainAbility(0,"",'A0N8',"lightningshield",'e003','n007',525,5,1000,2)
    
endfunction
//C18W-2
function Trig_C18W_effect_Actions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local integer i = GetPlayerId(GetTriggerPlayer()) + 1
	local unit u2 = GetSpellTargetUnit()
	local unit u3 = udg_S01_hero_of_player[i]
	local integer level = GetUnitAbilityLevel(u3,'A0BE')
	local real dmg = (	50.00 + 50.00 * I2R(level) )
	local real mana = GetUnitState(u2,UNIT_STATE_MANA) - (0.03+(0.02*I2R(level))) * GetUnitState(u2,UNIT_STATE_MAX_MANA)
		call UnitDamageTarget(u1, u2, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)
		call SetUnitState(u2, UNIT_STATE_MANA, mana)
	    call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Monsoon\\MonsoonBoltTarget.mdl",u2,"chest") )
	    //call BJDebugMsg(R2S(dmg))
	    
	set u1 = null
	set u2 = null
	set u3 = null 
endfunction
//C18W-3
function Trig_C18W_end_Actions takes nothing returns nothing
	
	local integer i = GetPlayerId(GetOwningPlayer(GetDyingUnit())) + 1
	local unit u2 = udg_C18W_Target[i]
	local unit u3 = udg_S01_hero_of_player[i]
	
		///////////////////////////////////
		//【注意】
		//這是避免單位死亡 還可以被選取的特殊狀況
		//(死亡可以選擇單位?)
		////////////////////////////////////////
	    // Prevent dead heroes from being unhidden.
	    if GetUnitState(u3, UNIT_STATE_LIFE) > 0 then
		    
	        call ShowUnit(u3, true)
	        
			    if GetUnitState(u2, UNIT_STATE_LIFE) > 0 then
			        call SetUnitX( u3, GetUnitX(u2) )
			        call SetUnitY( u3, GetUnitY(u2) )
			        call IssueTargetOrder( u3, "attack", u2 )
			    endif
			    
			    if GetLocalPlayer() == GetOwningPlayer(u3) then
			        // Use only local code (no net traffic) within this block to avoid desyncs.
			        call ClearSelection()
			        call SelectUnit(u3, true)
			    endif
			    
	    endif
	    
	set u2 = null
	set u3 = null 
	  
endfunction
//C18R
function Trig_C18RActions takes nothing returns nothing
	
	local unit u1 = GetTriggerUnit()
	local real x = GetSpellTargetX()
	local real y = GetSpellTargetY()	
	local unit u3 = CreateUnit(GetOwningPlayer(u1),'h02G', x , y ,0)	
        call ShowUnit(u3,false)
        call UnitApplyTimedLife(u3,'BHwe',1.00)
        call UnitAddAbility(u3,'A0BJ')
        call SetUnitAbilityLevel(u3,'A0BJ',GetUnitAbilityLevel(u1,'A0GP'))
        call IssueImmediateOrder( u3, "stomp" )
	        
	set u1 = null
	set u3 = null
	
endfunction
//===================================Condition===================================
//W-1
function Trig_C18WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0BE' then
	    call Trig_C18WActions()
    endif
    return false
endfunction
//W-2
function Trig_C18W_effect_Conditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0N8' then
	    call Trig_C18W_effect_Actions()
    endif
    return false
endfunction
//W-3
function Trig_C18W_end_Conditions takes nothing returns boolean
    if GetUnitTypeId(GetDyingUnit()) == 'e003' then
	    call Trig_C18W_end_Actions()
    endif
    return false
endfunction
//R
function Trig_C18RConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0GP' then
	    call Trig_C18RActions()
    endif
    return false
endfunction
//T
function Trig_C18T_leanConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0VQ' and IsUnitIllusion(GetTriggerUnit()) != true and GetUnitAbilityLevel(GetTriggerUnit(), 'A0VQ') == 1 then
    	call TriggerRegisterUnitEvent(gg_trg_C18T, GetTriggerUnit(), EVENT_UNIT_TARGET_IN_RANGE) 
	endif
    return false
endfunction
//===================================註冊===================================
function InitTrig_C18_INIT takes trigger ltt_init returns nothing
	
	///////////////////////////////////////////////////////
	//【注意】a.一定要 h2i = ltt_init 要不然會沒有重複 h2i
	// ////////////////////////////////////////////////////
	local trigger ltt
	local integer h2i = GetHandleId(ltt_init)
		//C18W-1
		set ltt = CreateTrigger()
	    call TriggerAddCondition(ltt, Condition(function Trig_C18WConditions))
		call SaveTriggerHandle(udg_Trigger_H,h2i,1,ltt) 
		//C18W-2
		set ltt = CreateTrigger()
	    call TriggerAddCondition(ltt, Condition(function Trig_C18W_effect_Conditions))
		call SaveTriggerHandle(udg_Trigger_H,h2i,2,ltt)
		//C18W-3
		set ltt = CreateTrigger() 
		call TriggerAddCondition(ltt, Condition(function Trig_C18W_end_Conditions))
	    call SaveTriggerHandle(udg_Trigger_H,h2i,3,ltt) 
	    //C18R
	    set ltt = CreateTrigger() 
	    call TriggerAddCondition(ltt, Condition(function Trig_C18RConditions))
	    call SaveTriggerHandle(udg_Trigger_H,h2i,4,ltt) 
	    //C18T
	    set ltt = CreateTrigger() 
	    call TriggerAddCondition(ltt, Condition(function Trig_C18T_leanConditions))
	    call SaveTriggerHandle(udg_Trigger_H,h2i,5,ltt) 
	    
	set ltt = null 
	
	
endfunction
function Trig_C18Actions takes nothing returns nothing
	
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u = udg_A_common_HERO	
	
	    	/////////////////////
			//第一次註冊 TC , TA
			////////////////////
			if GetTriggerExecCount(ltt) == 1 then
				call InitTrig_C18_INIT(ltt)
		    	// -------------------------------
			    set udg_C18T_dmg[1]=75.00
			    set udg_C18T_dmg[2]=95.00
			    set udg_C18T_dmg[3]=115.00
				// -------------------------------
				set udg_C18T_ManaCheck[1]=15.00
				set udg_C18T_ManaCheck[2]=40.00
				set udg_C18T_ManaCheck[3]=70.00
				set udg_C18T_ManaCheck[4]=100.00
				// -------------------------------
				set udg_C18T_DmgBonus[1]=2.00
				set udg_C18T_DmgBonus[2]=1.50
				set udg_C18T_DmgBonus[3]=1.20
				set udg_C18T_DmgBonus[4]=1.00
			endif 
			
		/////////////
		//註冊 TE
		//////////// 
		
	    //	C18W-1	英雄施法
	    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,1)
	    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
	    
	    //	C18W-2	玩家單位施法
	    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,2)
	    call TriggerRegisterPlayerUnitEvent(ltt, GetOwningPlayer(u), EVENT_PLAYER_UNIT_SPELL_EFFECT, null)
	    
	    //	C18W-3	玩家單位死亡
		set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,3)
		call TriggerRegisterPlayerUnitEvent(ltt, GetOwningPlayer(u), EVENT_PLAYER_UNIT_DEATH, null)
		
	    //	C18R	英雄施法
		set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,4)
	    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_SPELL_EFFECT) 
	    
	    //	C18T	英雄學習技能
	    set ltt = LoadTriggerHandle(udg_Trigger_H,h2i,5)
	    call TriggerRegisterUnitEvent(ltt, u, EVENT_UNIT_HERO_SKILL) 
	    
	set u = null
	set ltt = null
  		
endfunction
//登記表
function InitTrig_C18 takes nothing returns nothing
    set gg_trg_C18 = CreateTrigger()
    call TriggerAddAction(gg_trg_C18, function Trig_C18Actions)
endfunction
//===========================================================================
// Trigger: C18T
//===========================================================================
function Trig_C18T_STARTActionsConditions takes nothing returns nothing
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
	local real dmg = 0
	local integer level = GetUnitAbilityLevel(u1,'A0VQ')
	local real mp = GetUnitStatePercent(u2, UNIT_STATE_MANA, UNIT_STATE_MAX_MANA)
	local boolean b = false
	local integer index 
	
			//扣魔
			call SetUnitState(u2, UNIT_STATE_MANA, 0.90 * GetUnitState(u2,UNIT_STATE_MANA))
			//damage check
			///////////////////////////////////////////
			//【魔量檢查】
			//a.i 越小 傷害越高
			//udg_C18T_ManaCheck[1]~[4] = 15,40,70,100
			//udg_C18T_DmgBonus[1]~[4]=2.00,1.5,1.2,1.0
			///////////////////////////////////////////
				set index = 1
				loop
					exitwhen index>4
						if mp <= udg_C18T_ManaCheck[index] and b == false then
							set dmg = udg_C18T_dmg[level]*udg_C18T_DmgBonus[index]
							set b = true
						endif
					set index = index+1
				endloop 
				
		//Avoid crash
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)
		set udg_B12R_B[i]=false
		
		//////////////
		//傷害 + 特效
		//////////////
		call DestroyEffect( AddSpecialEffectTarget("war3mapImported\\HeroMuneshigeTachibanaTarget.mdx",u2,"origin") )
	    call UnitDamageTarget(u1, u2, dmg, true, false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)
	    
	set ltt = null
	set u1 = null
    set u2 = null
endfunction
function Trig_C18T_STARTActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit() 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local triggercondition ltc
    local trigger ltt
    local integer h2i
    
    	if udg_B12R_B[i]==false and IsUnitType(u2, UNIT_TYPE_STRUCTURE) == false then
	    	
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
    		///////////
    		//參數設定
    		//////////	    	
	    	set udg_B12R_B[i]=true
		    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    set ltc = TriggerAddCondition(ltt, Condition(function Trig_C18T_STARTActionsConditions))
		    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
	    	/////////////////////////////////////////////////////////////
		    //timer check + 觸發器登記
		    /////////////////////////////////////////////////////////////
		    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
            call Normal_Attack_Timer_for_Trigger(ltt,0.30 , ltc , i)	
            
		endif
		  
	set ltc = null	
    set ltt =	null
    set u1 = null
    set u2 = null
endfunction
function InitTrig_C18T takes nothing returns nothing
    set gg_trg_C18T=CreateTrigger()
    call TriggerAddCondition(gg_trg_C18T, Condition(function Trig_C18T_STARTActions))
endfunction//===========================================================================
// Trigger: C19
//===========================================================================
function Trig_C19Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C19E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C19T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    set udg_C19T_AttactGroup[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateGroup()
endfunction
//===========================================================================
function InitTrig_C19 takes nothing returns nothing
    set gg_trg_C19 = CreateTrigger()
    call TriggerAddAction(gg_trg_C19, function Trig_C19Actions)
endfunction
//===========================================================================
// Trigger: C19E
//
// B08Q
//===========================================================================
function Trig_C19EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0FI'))
endfunction
function Trig_C19E_EFunc014T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local unit u2 =LoadUnitHandle(YDHT, h2i, 0x9C0F555E)
local real Dist =100
local real Angle =GetRandomReal(0,360)
local real x=GetUnitX(u2)+Dist*Cos(Angle*bj_DEGTORAD)
local real y=GetUnitY(u2)+Dist*Sin(Angle*bj_DEGTORAD)
if ((LoadInteger(YDHT, h2i, 0xA3098AE2)==0) or (GetUnitState(u2, UNIT_STATE_LIFE) <= 0) or (GetUnitState(u1, UNIT_STATE_LIFE) <= 0)) then
    call UnitRemoveAbility(u1,'A0N6')
    call SetUnitInvulnerable(u1,false)
	call FlushChildHashtable(YDHT, h2i)
	call DestroyTimer(t)
else
call SaveInteger(YDHT, h2i, 0xA3098AE2,LoadInteger(YDHT, h2i, 0xA3098AE2)-1)
call SetUnitX(u1,x)
call SetUnitY(u1,y)
call SetUnitFacing(u1,Angle-180)
call IssueTargetOrder(u1,"attack",u2)
endif
set u1 = null
set u2 = null
set t = null
endfunction
function Trig_C19EActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call UnitAddAbility( GetTriggerUnit(), 'A0N6' )
    call SetUnitInvulnerable( GetTriggerUnit(), true )
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, GetTriggerUnit())
    call SaveUnitHandle(YDHT, h2i, 0x9C0F555E, GetSpellTargetUnit())
    call SaveInteger(YDHT, h2i, 0xA3098AE2, (GetUnitAbilityLevel(GetTriggerUnit(),'A0FI')))
    call TimerStart(t, 0.50, true, function Trig_C19E_EFunc014T)
set t = null
endfunction
function InitTrig_C19E takes nothing returns nothing
    set gg_trg_C19E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C19E, Condition(function Trig_C19EConditions))
    call TriggerAddAction(gg_trg_C19E, function Trig_C19EActions)
endfunction//===========================================================================
// Trigger: C19T
//
// array
// 點不用 設矩陣 大小
// 整數
// 實數
// 單位
// 特效
// 不用
// 計時器要設矩陣大小
// 布爾
// 要
//===========================================================================
function C19T_Effect takes unit u, unit u2, integer i returns nothing
local real r=0
local real x=GetUnitX(u)
local real y=GetUnitY(u)
local real x2=GetUnitX(u2)
local real y2=GetUnitY(u2)
local real a=bj_RADTODEG*Atan2(y2-y,x2-x)+GetRandomReal(-30,30)
local string es="Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl"
call UnitApplyTimedLife(CreateUnit(Player(15),'h008',x,y,a),'BTLF',2)
call DestroyEffect(AddSpecialEffectTarget(es,u2,"head"))
call DestroyEffect(AddSpecialEffectTarget(es,u2,"chest"))
call DestroyEffect(AddSpecialEffectTarget(es,u2,"mount"))
call SetUnitX(u,x2+100*Cos(a*bj_DEGTORAD))
call SetUnitY(u,y2+100*Sin(a*bj_DEGTORAD))
call SetUnitFacing(u,a)
call SetUnitTimeScale(u,3)
call SetUnitAnimation(u,"Attack Slam")
if udg_C19T_LV[i]==1 then
set r=GetRandomReal(110,110)
elseif udg_C19T_LV[i]==2 then
set r=GetRandomReal(110,110)
elseif udg_C19T_LV[i]==3 then
set r=GetRandomReal(110,110)
endif
call UnitDamageTarget(u,u2,r,true,false,ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID,WEAPON_TYPE_WHOKNOWS)
endfunction
function C19T_Copy takes unit u ,integer i returns nothing	
    local unit tu = CreateUnit(Player(15),GetUnitTypeId(u),0,0,GetUnitFacing(u))
    call SetUnitX(tu,GetUnitX(u))
    call SetUnitY(tu,GetUnitY(u))
    // 透明度50% (127+1/256)
    call SetUnitVertexColor(tu,255,255,255,127)
    call UnitAddAbility(tu,'Aloc')
    call SetUnitColor(tu,GetPlayerColor(GetOwningPlayer(u)))
    call GroupAddUnit(udg_C19T_AttactGroup[i],tu) 
    set tu = null
endfunction
function C19T_Target takes nothing returns boolean
local unit u=GetFilterUnit()
local boolean b=IsUnitEnemy(u,GetOwningPlayer(LoadUnitHandle(YDHT,GetHandleId(GetExpiredTimer()), 1)))and not IsUnitType(u,UNIT_TYPE_STRUCTURE)and GetUnitState(u,UNIT_STATE_LIFE)>0 and GetUnitPointValue(u) != 1
set u=null
return b
endfunction
function C19T takes nothing returns nothing
local integer ti = 0
local unit ydl_unit	
local unit u2 
local group g = CreateGroup()
local group g2=CreateGroup()
local boolexpr b=Condition(function C19T_Target)
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u =LoadUnitHandle(YDHT, h2i, 1)
local integer i = GetConvertedPlayerId(GetOwningPlayer(u))
set bj_wantDestroyGroup=false
call GroupAddGroup(udg_C19T_AttactGroup[i],g)
	if udg_C19T_Boolean[i] then
		call C19T_Copy(u,i)
	endif
		loop
			set ydl_unit=FirstOfGroup(g)
			exitwhen ydl_unit==null	
			call GroupRemoveUnit(g,ydl_unit)
			call GroupEnumUnitsInRange(g2,GetUnitX(ydl_unit),GetUnitY(ydl_unit),450,b)
			set u2=GroupPickRandomUnit(g2)
				if u2==null then
					call GroupRemoveUnit(udg_C19T_AttactGroup[i],ydl_unit)
						if ydl_unit!=u then
							call RemoveUnit(ydl_unit)
						else
							set udg_C19T_Boolean[i]=false
						endif
				else
					call GroupRemoveUnit(g,u2)
					call C19T_Effect(u,u2,i)
				endif
		call GroupClear(g2)
	endloop
set udg_C19T_Index[i]=udg_C19T_Index[i]+1
call DestroyGroup(g)
call DestroyGroup(g2)
call DestroyBoolExpr(b)
set ydl_unit=null
set u2=null
set g=null
set g2=null
set b=null
	if udg_C19T_LV[i] ==1 then
		set ti=5
	elseif udg_C19T_LV[i] ==2 then
		set ti=6
	elseif udg_C19T_LV[i] ==3 then
		set ti=7
	endif
	//here's error is ydl_unit=null but keep use the ydl_unit
		if udg_C19T_Index[i]>=ti then
			loop
				set ydl_unit=FirstOfGroup(udg_C19T_AttactGroup[i])
				exitwhen ydl_unit==null
					call GroupRemoveUnit(udg_C19T_AttactGroup[i],ydl_unit)
						if ydl_unit!=u then
							call RemoveUnit(ydl_unit)
						endif
			endloop
			call SetUnitInvulnerable(u,false)
			call SetUnitTimeScale(u,1)
		else
			call SetUnitInvulnerable(u,true)
			call TimerStart(t,0.33,false,function C19T)
		endif
endfunction
function Trig_C19TActions takes nothing returns nothing
	local unit u = GetTriggerUnit()
	local unit u2=GetSpellTargetUnit()
    local integer i = GetConvertedPlayerId(GetOwningPlayer(u))
	local timer t = CreateTimer()
	local integer h2i = GetHandleId(t)
	
	call SaveUnitHandle(YDHT, h2i, 1, u)
	set udg_C19T_Index[i] = 1
	set udg_C19T_Boolean[i] = true
	set udg_C19T_LV[i] = GetUnitAbilityLevel(u,'A0FJ')
	call GroupAddUnit(udg_C19T_AttactGroup[i],u)
	call C19T_Copy(u,i)
	call C19T_Effect(u,u2,i)
	call TimerStart(t,1,false,function C19T)
    set u = null
    set u2 = null
    set t = null	
endfunction
function Trig_C19TConditions takes nothing returns boolean
    return GetSpellAbilityId() == 'A0FJ'
endfunction
//===========================================================================
//    初始化
//===========================================================================
function InitTrig_C19T takes nothing returns nothing
    set gg_trg_C19T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C19T, Condition(function Trig_C19TConditions))
    call TriggerAddAction(gg_trg_C19T, function Trig_C19TActions)
endfunction//===========================================================================
// Trigger: C20
//===========================================================================
function Trig_C20Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C20W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C20W_stop, udg_A_common_HERO, EVENT_UNIT_SPELL_ENDCAST)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C20E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C20D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C20R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C20T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_C20 takes nothing returns nothing
    set gg_trg_C20 = CreateTrigger()
    call TriggerAddAction(gg_trg_C20, function Trig_C20Actions)
endfunction
//===========================================================================
// Trigger: C20W
//===========================================================================
function Trig_C20WActions2 takes nothing returns nothing
	local timer	t =	GetExpiredTimer()
	local	integer	h2i =	GetHandleId(t)
	local	unit	u =	LoadUnitHandle(YDHT,h2i,1)
		//這樣是避免，極端情況
		if	GetUnitAbilityLevel(u,0x42707368)<=0 then
			call	FlushChildHashtable(YDHT,h2i)
			call	DestroyTimer(t)
			//取消無敵
			call SetUnitInvulnerable( u, false ) 
		endif 
	set t =	null
	set u =	null
endfunction
function Trig_C20WActions takes nothing returns nothing
    local unit u =	GetTriggerUnit()
    local player p = GetOwningPlayer(u)
	local	boolean	b =	false
	local real	range =	435.00
	local	real	x =	GetUnitX(u)
	local	real	y =	GetUnitY(u)
	local	integer	id =	GetSpellAbilityId()
	local integer	level =	GetUnitAbilityLevel(u,id)
	local	real	dmg =	(150.00*I2R(level)) 
    local timer	t =	CreateTimer()
    local integer	h2i =	GetHandleId(t)
    local unit ydl_unit
		call	SaveUnitHandle(YDHT,h2i,1,u)
    	call	TimerStart(t,0.1,true,function Trig_C20WActions2)
    
		//設置無敵
		call SetUnitInvulnerable( u, true )
		//確定有沒有 D 的魔法效果
		if	GetUnitAbilityLevel(u,'B071') > 0	then
			set	b	=	true
		endif	
		
	    	//傷害
	    	call GroupEnumUnitsInRange(udg_Group[7], x, y, range, null)
		    loop
		        set ydl_unit = FirstOfGroup(udg_Group[7])
		        exitwhen ydl_unit == null
		        call GroupRemoveUnit(udg_Group[7], ydl_unit)
			        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsPlayerEnemy(GetOwningPlayer(ydl_unit), p) and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false then
						if	b then
							//無視魔免傷害
							call UnitDamageTarget(u, ydl_unit, dmg, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)
							
						else
							
							call UnitDamageTarget(u, ydl_unit, dmg, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)
    						
						endif
					//effect	
					call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\GargoyleMissile\\GargoyleMissile.mdl",GetEnumUnit(),"head") )
			            
			        endif
		    endloop
	set t =	null 
    set u = null
    set ydl_unit = null
    set p = null
endfunction
function Trig_C20WConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0KJ'	then
	    call Trig_C20WActions()
	endif
    return	false
endfunction
function InitTrig_C20W takes nothing returns nothing
    set gg_trg_C20W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C20W, Condition(function Trig_C20WConditions))
endfunction
//===========================================================================
// Trigger: C20W stop
//===========================================================================
function Trig_C20W_stopConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0KJ' then
    	call SetUnitInvulnerable( GetTriggerUnit(), false ) 
	endif
	return false
endfunction
function InitTrig_C20W_stop takes nothing returns nothing
    set gg_trg_C20W_stop = CreateTrigger()
    call TriggerAddCondition(gg_trg_C20W_stop, Condition(function Trig_C20W_stopConditions))
endfunction
//===========================================================================
// Trigger: C20D 
//===========================================================================
function Trig_C20DActions2 takes nothing returns nothing
	local	timer	t	=	GetExpiredTimer()
	local	integer	h2i	=	GetHandleId(t)
	local	unit	u	=	LoadUnitHandle(YDHT,h2i,1)
		//call BJDebugMsg(R2S(TimerGetElapsed(t)))
		call	FlushChildHashtable(YDHT,h2i)
		call	DestroyTimer(t)
		call UnitRemoveAbility( u, 'A0KH' )	
		
	set t	=	null
	set u	=	null
endfunction
function Trig_C20DActions takes nothing returns nothing
	local unit u = GetTriggerUnit()
	local integer i = GetPlayerId(GetOwningPlayer(u)) + 1
	local unit u2 = udg_C20E_Target[i]
	local real x1 = GetUnitX(u)
	local real y1 = GetUnitY(u)
	local	integer level	=	GetUnitAbilityLevel(u, 'A0K9')
	local	timer t =	CreateTimer()
	local	integer h2i =	GetHandleId(t)
	local	real time	=	4.00
		//Init for	clock
		call	SaveUnitHandle(YDHT,h2i,1,u)
		call	TimerStart(t,time,false,function Trig_C20DActions2)
		
			//get ability
		    if level > 0 then
		        call UnitAddAbility( u, 'A0KH' )
		        call SetUnitAbilityLevel( u, 'A0KH', level )
		    endif
		    
		    //check"避免拉強盜王、確認有沒有魔法效果狀態
		    if u2 != gg_unit_nbld_0142 and GetUnitAbilityLevel(u2, 'B074') > 0 then
		        call SetUnitPosition(u2,x1,y1)
		    endif 
	set u = null
	set u2 = null
	set t =	null
endfunction
function Trig_C20DConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0KA'	then
	    call Trig_C20DActions()
    endif
    return	false
endfunction
function InitTrig_C20D takes nothing returns nothing
    set gg_trg_C20D = CreateTrigger()
    call TriggerAddCondition(gg_trg_C20D, Condition(function Trig_C20DConditions))
endfunction//===========================================================================
// Trigger: C20E
//===========================================================================
function Trig_C20EConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0K8' then
	    set udg_C20E_Target[GetPlayerId(GetTriggerPlayer()) + 1] = GetSpellTargetUnit()
    endif
    return	false
endfunction
function InitTrig_C20E takes nothing returns nothing
    set gg_trg_C20E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C20E, Condition(function Trig_C20EConditions))
endfunction
//===========================================================================
// Trigger: C20R learn
//===========================================================================
function Trig_C20R_learnConditions takes nothing returns boolean
    if GetLearnedSkill() == 'A0K9'	then
	    call SetPlayerTechResearched(GetTriggerPlayer(),'Reib',GetUnitAbilityLevel(GetTriggerUnit(), 'A0K9'))
	endif
    return	false
endfunction
function InitTrig_C20R_learn takes nothing returns nothing
    set gg_trg_C20R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_C20R_learn, Condition(function Trig_C20R_learnConditions))
endfunction//===========================================================================
// Trigger: C20T
//===========================================================================
function Trig_C20TActions takes nothing returns nothing
    local unit u = GetTriggerUnit()
    local player p = GetOwningPlayer(u)
    local real dmg =	0.28
    local unit ydl_unit
    
	    call GroupEnumUnitsInRange(udg_Group[2], GetUnitX(u), GetUnitY(u), 700.00, null)
	    loop
	        set ydl_unit = FirstOfGroup(udg_Group[2])
	        exitwhen ydl_unit == null
	        call GroupRemoveUnit(udg_Group[2], ydl_unit)
	        
	        	if IsUnitEnemy(ydl_unit, p) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitType(ydl_unit, UNIT_TYPE_STRUCTURE) == false then
	        		call UnitDamageTarget(u,ydl_unit,	dmg * GetUnitState(ydl_unit,UNIT_STATE_LIFE), true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)	
	        	endif
	        	
	    endloop
	    
    set p = null
    set ydl_unit =	null
    set u = null
endfunction
function Trig_C20TConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0KI' then
	    call Trig_C20TActions()
    endif
    return false
endfunction
function InitTrig_C20T takes nothing returns nothing
    set gg_trg_C20T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C20T, Condition(function Trig_C20TConditions))
endfunction
//===========================================================================
// Trigger: C22
//===========================================================================
function Trig_C22Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C22D, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C22W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C22E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C22R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C22T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C22T_check, udg_A_common_HERO, EVENT_UNIT_SPELL_CHANNEL)
endfunction
//===========================================================================
function InitTrig_C22 takes nothing returns nothing
    set gg_trg_C22 = CreateTrigger()
    call TriggerAddAction(gg_trg_C22, function Trig_C22Actions)
endfunction
//===========================================================================
// Trigger: C22W
//===========================================================================
function Trig_C22WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0HM'))
endfunction
function Trig_C22WFunc003T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local unit u2 =LoadUnitHandle(YDHT, h2i, 0x9C0F555E)
local integer i =LoadInteger(YDHT, h2i, 0xA3098AE2)
	if(i>=7)then
		call UnitShareVision(u2, GetOwningPlayer(u1) ,false)
	    call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		call SaveInteger(YDHT, h2i, 0xA3098AE2, i+1)
		call UnitDamageTargetBJ(u1,u2,(15.00+(25.00*I2R(GetUnitAbilityLevel(u1,'A0HM')))),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		call IssueImmediateOrder(u2,"stop")
		call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",u2,"chest"))
	endif
set u1 = null
set u2 = null
set t = null
endfunction
function Trig_C22WActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
	call UnitShareVision(GetSpellTargetUnit(), GetOwningPlayer(GetTriggerUnit()) ,true)
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, GetTriggerUnit())
    call SaveUnitHandle(YDHT, h2i, 0x9C0F555E, GetSpellTargetUnit())
    call SaveInteger(YDHT, h2i, 0xA3098AE2, 0)
    call TimerStart(t, 1.50, true, function Trig_C22WFunc003T) 
set t = null
endfunction
//===========================================================================
function InitTrig_C22W takes nothing returns nothing
    set gg_trg_C22W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C22W, Condition(function Trig_C22WConditions))
    call TriggerAddAction(gg_trg_C22W, function Trig_C22WActions)
endfunction
//===========================================================================
// Trigger: C22D
//===========================================================================
function Trig_C22DConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A0LS') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_C22DActions takes nothing returns nothing
    call SetUnitAbilityLevel( GetTriggerUnit(), 'A01E', ( GetUnitAbilityLevel(GetTriggerUnit(), 'A0LS') + 1 ) )
endfunction
//===========================================================================
function InitTrig_C22D takes nothing returns nothing
    set gg_trg_C22D = CreateTrigger()
    call TriggerAddCondition(gg_trg_C22D, Condition(function Trig_C22DConditions))
    call TriggerAddAction(gg_trg_C22D, function Trig_C22DActions)
endfunction
//===========================================================================
// Trigger: C22E
//===========================================================================
function Trig_C22EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0LS'))
endfunction
function Trig_C22EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local real a =(GetUnitFacing(u1)+180.00)*3.14159/180.0
local integer i 
local real x
local real y
local real x1
local real y1
	call TriggerSleepAction(0.00)
	set x = GetUnitX(u1)
	set y = GetUnitY(u1)
	set x1 = x + 700.00*Cos(a)
	set y1 = y + 700.00*Sin(a)
	set i=1
		loop
			exitwhen i>10
				if	IsTerrainPathable(x1, y1, PATHING_TYPE_WALKABILITY)then
					set x1 = x1 + 65.00*Cos(a+180.00*3.14159/180.0)
					set y1 = y1 + 65.00*Sin(a+180.00*3.14159/180.0)
				endif
			set i=i+1
		endloop 
	call SetUnitX(u1,x1)
	call SetUnitY(u1,y1)
	    if (GetLocalPlayer() == GetOwningPlayer(u1)) then
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        call PanCameraToTimed(x1, y1, 0.10)
	    endif
set u1 = null
endfunction
//===========================================================================
function InitTrig_C22E takes nothing returns nothing
    set gg_trg_C22E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C22E, Condition(function Trig_C22EConditions))
    call TriggerAddAction(gg_trg_C22E, function Trig_C22EActions)
endfunction
//===========================================================================
// Trigger: C22R
//===========================================================================
//===========================================================================
// Trigger: C22R
//===========================================================================
function Trig_C22RConditions takes nothing returns boolean
    return ( ( GetSpellAbilityId() == 'A0HL' ) )
endfunction
//================C22T Tri N.02==================
function Trig_C22RFunc004T takes nothing returns nothing
local unit ydl_unit
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local unit u2 =LoadUnitHandle(YDHT, h2i, 0x9CD60476)
local integer i =LoadInteger(YDHT, h2i, 0x9C0F555E)
local boolean b =LoadBoolean(YDHT, h2i, 0xA3098AE2) 
local integer h2i2 = GetHandleId(u1)
local integer Index_total
local integer reach
local real x 
local real y 
local real x1
local real y1
local real a 
local unit u3
local integer spellT
	if ( b==false ) then 
    	set i = i + 1
    	call SaveInteger(YDHT, h2i, 0x9C0F555E, i) 
    
    	set x = GetUnitX(u1)
		set y = GetUnitY(u1)
		set spellT = 0
		set a = GetUnitFacing(u1) *bj_DEGTORAD
    	set x1 = x + 40.00*I2R(i)*Cos(a)
    	set y1 = y + 40.00*I2R(i)*Sin(a)
    	call GroupEnumUnitsInRange(udg_Group[3], x1, y1, 122.00, null)
    		loop
    		set ydl_unit = FirstOfGroup(udg_Group[3])
    			exitwhen ((ydl_unit == null) or (spellT==1))
        		call GroupRemoveUnit(udg_Group[3], ydl_unit)
        			if ((GetOwningPlayer(ydl_unit)!=GetOwningPlayer(u1)) and (IsUnitType(ydl_unit,UNIT_TYPE_GROUND)==true) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 1 and (IsUnitType(ydl_unit,UNIT_TYPE_MECHANICAL)==false) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) and (GetUnitPointValue(ydl_unit) != 1) ) then
        				set b = true
        				set spellT = 1
        				call SaveUnitHandle(YDHT, h2i, 0x9CD60476, ydl_unit)
            				if IsUnitEnemy(ydl_unit,GetOwningPlayer(u1)) then
	        					call UnitDamageTargetBJ(u1, ydl_unit, I2R(GetUnitAbilityLevel(u1,'A0HL')) * 100.00 , ATTACK_TYPE_HERO, DAMAGE_TYPE_ACID)
								set u3 = CreateUnit(GetOwningPlayer(u1), 'h02G', GetUnitX(ydl_unit), GetUnitY(ydl_unit), 0)
								call UnitApplyTimedLife( u3, 'h02H', 2.00 )
								
            					call UnitAddAbility( u3, 'A0HO')
	        					call IssueTargetOrder(u3,"thunderbolt",ydl_unit)
            				endif 
        			endif
    		endloop
    	call GroupClear(udg_Group[3])
    
    	call SaveUnitHandle(YDHT, h2i2, i, CreateUnit(GetOwningPlayer(u1), 'u000', x1, y1, a*bj_RADTODEG))
        	if (( i > ( 6 + GetUnitAbilityLevel( u1, 'A0HL') * 6 ) ) or (b ==true)) then
        		set b = true
        		call SaveInteger(YDHT, h2i2, 0x9C0F555E, i)
        	endif
    	call SaveBoolean(YDHT, h2i, 0xA3098AE2, b) 
else
	if ( u2 != null)then
    	set reach = (LoadInteger(YDHT, h2i2, 0x9C0F555E) - i)
	
    	set u3 = LoadUnitHandle(YDHT, h2i2,reach) 
    	set x1 = GetUnitX(u3)
    	set y1 = GetUnitY(u3)
       
    	call SetUnitX(u1,x1)
    	call SetUnitY(u1,y1)
    
    	call RemoveUnit(u3)
		set i = i - 1
    	call SaveInteger(YDHT, h2i, 0x9C0F555E, i)
    
    else
    	set u3 = LoadUnitHandle(YDHT, h2i2,i) 
    	call RemoveUnit(u3)
    	set i = i - 1
    	call SaveInteger(YDHT, h2i, 0x9C0F555E, i)
    	endif
    		if ( i == - 1 ) then
				call FlushChildHashtable(YDHT, h2i)
				call FlushChildHashtable(YDHT, h2i2)
				call DestroyTimer(t)
    		endif
	endif
set u1 = null
set u2 = null
set u3 = null 
set ydl_unit = null
set t = null
endfunction
//================C22T Tri N.01==================
function Trig_C22RActions takes nothing returns nothing
    local timer t=CreateTimer()
    local integer h2i = GetHandleId(t)
	    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, GetTriggerUnit())
	    call SaveInteger(YDHT, h2i, 0x9C0F555E, 0)
	    call SaveBoolean(YDHT, h2i, 0xA3098AE2, false)
	    call SaveUnitHandle(YDHT, h2i, 0x9CD60476, null)
	    call TimerStart(t, 0.03, true, function Trig_C22RFunc004T) 
    set t=null
endfunction
//===========================================================================
function InitTrig_C22R takes nothing returns nothing
    set gg_trg_C22R=CreateTrigger()
    call TriggerAddCondition(gg_trg_C22R, Condition(function Trig_C22RConditions))
    call TriggerAddAction(gg_trg_C22R, function Trig_C22RActions)
endfunction//===========================================================================
// Trigger: C22T
//===========================================================================
globals
unit array C22T_U
integer array C22T_I
endglobals	
function Trig_C22TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0M1'))
endfunction
//==========C22T_Tri_N0.2==============
function Trig_C22T_Timer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u2 =C22T_U[i]
	if C22T_I[i] <= 0 or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 then
		set udg_C22T_check[i] = false
		call IssueImmediateOrder(u1,"stop")
		call SetUnitX(u2,GetUnitX(u1))
		call SetUnitY(u2,GetUnitY(u1))
		//for remove the Giddy ability
		call UnitRemoveAbility(u2,'BPSE')
		    // Prevent dead heroes from being unhidden.
	    	if (IsUnitType(u2, UNIT_TYPE_HERO) and GetUnitState(u2, UNIT_STATE_LIFE) <= 0) then
		    else	
	        	call ShowUnit(u2, true)
	    	endif
		call PauseUnit(u2,false)
		    if (GetLocalPlayer() == GetOwningPlayer(u2)) then
	        // Use only local code (no net traffic) within this block to avoid desyncs.
	        	call ClearSelection()
	        	call SelectUnit(u2, true)
	    	endif	
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		set C22T_I[i]=C22T_I[i]-1
		call SetUnitX(u2,GetUnitX(u1))
		call SetUnitY(u2,GetUnitY(u1))
		call SetUnitState(u1, UNIT_STATE_LIFE, (GetUnitState(u1,UNIT_STATE_LIFE)+(180.00+(45.00*I2R(GetUnitAbilityLevel(u1,'A0M1'))))))
		call UnitDamageTargetBJ(u1,u2,(310.00+(20.00*I2R(GetUnitAbilityLevel(u1,'A0M1')))),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		call UnitDamageTargetBJ(u1,u1,1.00,ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
	endif
set t = null
set u1 = null
set u2 = null
endfunction
//==========C22T_Tri_N0.1==============
function Trig_C22TActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
call ShowUnit(u2, false)
call PauseUnit(u2,true)
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
    //for check Bug
    set udg_C22T_check[i] = true
    set C22T_U[i]=u2
    set C22T_I[i]=1+1*GetUnitAbilityLevel(u1,'A0M1')
    call TimerStart(t, 1.00, true, function Trig_C22T_Timer) 
set t = null
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_C22T takes nothing returns nothing
    set gg_trg_C22T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C22T, Condition(function Trig_C22TConditions))
    call TriggerAddAction(gg_trg_C22T, function Trig_C22TActions)
endfunction
//===========================================================================
// Trigger: C22T check
//===========================================================================
function Trig_C22T_checkConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0IG') and (udg_C22T_check[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))] == true))
endfunction
function Trig_C22T_checkActions takes nothing returns nothing
    call IssueImmediateOrderById( GetTriggerUnit(), 851972 )
endfunction
//===========================================================================
function InitTrig_C22T_check takes nothing returns nothing
    set gg_trg_C22T_check = CreateTrigger()
    call TriggerAddCondition(gg_trg_C22T_check, Condition(function Trig_C22T_checkConditions))
    call TriggerAddAction(gg_trg_C22T_check, function Trig_C22T_checkActions)
endfunction
//===========================================================================
// Trigger: C23
//===========================================================================
function Trig_C23Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C23W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C23E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C23R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C23R_enable, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C23T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_C23 takes nothing returns nothing
    set gg_trg_C23 = CreateTrigger()
    call TriggerAddAction(gg_trg_C23, function Trig_C23Actions)
endfunction
//===========================================================================
// Trigger: C23W
//===========================================================================
globals
real array C23W_R
integer array C23W_I
endglobals	
function Trig_C23W_STARTConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A059'))
endfunction
function Trig_C23W_STARTFunc001T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit ydl_unit
local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local player p = GetOwningPlayer(u1)
local integer i = GetConvertedPlayerId(p)
	if (C23W_I[i]>=5)then
	    call FlushChildHashtable(YDHT, h2i)
	    call DestroyTimer(t)
	else
		set C23W_I[i]= C23W_I[i] + 1
	    call GroupEnumUnitsInRange(udg_Group[3], GetUnitX(u1), GetUnitY(u1), 380.00, null)
	    	loop
	        	set ydl_unit = FirstOfGroup(udg_Group[3])
	        	exitwhen ydl_unit == null
	        	call GroupRemoveUnit(udg_Group[3], ydl_unit)
	        		if ( GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false)) then
		        		call UnitDamageTargetBJ(u1,ydl_unit,C23W_R[i],ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
	            		call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\Blood\\BloodImpact.mdl",ydl_unit,"chest"))
	        		endif
	    	endloop 
	endif
set p = null	
set t = null
set u1 = null
set ydl_unit = null
endfunction
function Trig_C23W_STARTActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
	set C23W_I[i]=0
	set C23W_R[i]=(GetUnitState(u1,UNIT_STATE_MAX_LIFE)*0.13 + 50.00 + 50.00*I2R(GetUnitAbilityLevel(u1,'A059')))/5.00
	call TimerStart(t, 1.00, true, function Trig_C23W_STARTFunc001T) 
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_C23W takes nothing returns nothing
    set gg_trg_C23W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C23W, Condition(function Trig_C23W_STARTConditions))
    call TriggerAddAction(gg_trg_C23W, function Trig_C23W_STARTActions)
endfunction
//===========================================================================
// Trigger: C23E
//===========================================================================
function Trig_C23EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A058'))
endfunction
function Trig_C23EFunc010T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	if(LoadInteger(YDHT, h2i, 0xA3098AE2)<=0)then
		call SetUnitPathing(u1,true)
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
	    	if(GetUnitAbilityLevel(u1, 'B05U') > 0)then
	    		call SetUnitPathing(u1,false)
	    		else
	    		call SetUnitPathing(u1,true)
	    	endif
	    //check timer	
	    call SaveInteger(YDHT, h2i, 0xA3098AE2, LoadInteger(YDHT, h2i, 0xA3098AE2)-1)
	endif
set u1 = null
set t = null
endfunction
function Trig_C23EActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetSpellTargetX()
local real y1 = GetSpellTargetY()
local real x2
local real y2
local real a = Atan2(y1-y,x1-x)
local unit u3
local integer i
local integer level = GetUnitAbilityLevel(u1,'A058')
local real life = (4.00+(2.00*I2R(level)))
	set i = 1
		loop
			exitwhen i>14
			set x2 = x + 110.00*I2R(i)*Cos(a)
			set y2 = y + 110.00*I2R(i)*Sin(a)
			set u3 = CreateUnit(GetOwningPlayer(u1), 'n004', x2, y2, a*bj_RADTODEG)
	    	call UnitApplyTimedLife( u3, 'BHwe', life )
	    	call SetUnitAbilityLevel( u3, 'A0H2', level )
	    	call SetUnitX(u3,x2)
	    	call SetUnitY(u3,y2)
	    	call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Human\\HumanLargeDeathExplode\\HumanLargeDeathExplode.mdl",x2,y2))
			set i=i+1
		endloop
		    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    call SaveInteger(YDHT, h2i, 0xA3098AE2, 4 + 2*GetUnitAbilityLevel(u1,'A058'))
		    call TimerStart(t, 1.00, true, function Trig_C23EFunc010T) 
set t = null
set u1 = null
set u3 = null
endfunction
//===========================================================================
function InitTrig_C23E takes nothing returns nothing
    set gg_trg_C23E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C23E, Condition(function Trig_C23EConditions))
    call TriggerAddAction(gg_trg_C23E, function Trig_C23EActions)
endfunction
//===========================================================================
// Trigger: C23R
//===========================================================================
function Trig_C23_RConditions takes nothing returns boolean
	local integer id = GetSpellAbilityId()
    if id == 'A058' or id == 'A08I' or id == 'A059' then
	    set udg_C23_B[GetPlayerId(GetOwningPlayer(GetTriggerUnit())) + 1] = true
    endif
    return false
endfunction
//===========================================================================
function InitTrig_C23R takes nothing returns nothing
    set gg_trg_C23R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C23R, Condition(function Trig_C23_RConditions))
endfunction//===========================================================================
// Trigger: C23R enable
//===========================================================================
function Trig_C23R_enableConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A05A') and (GetUnitAbilityLevel(GetTriggerUnit(), 'A05A') == 1))
endfunction
function Trig_C23R_enableActions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C23R_reduce_damage, GetTriggerUnit(), EVENT_UNIT_DAMAGED)
endfunction
//===========================================================================
function InitTrig_C23R_enable takes nothing returns nothing
    set gg_trg_C23R_enable = CreateTrigger()
    call TriggerAddCondition(gg_trg_C23R_enable, Condition(function Trig_C23R_enableConditions))
    call TriggerAddAction(gg_trg_C23R_enable, function Trig_C23R_enableActions)
endfunction
//===========================================================================
// Trigger: C23R reduce damage
//===========================================================================
function Trig_C23_R_reduce_damageConditions takes nothing returns nothing
    local unit u1 
    local real R 
	local integer i 
	    if GetEventDamage() > 1.00 then
		    set i = GetPlayerId(GetTriggerPlayer()) + 1
			    if GetRandomInt(1, 100) <= 12 or udg_C23_B[i] then
					set u1 = GetTriggerUnit()
					set R = ( GetEventDamage() * (1.01 + ( 0.06 * I2R(GetUnitAbilityLevel(u1, 'A05A')) ) ) )
					set udg_C23_B[i] = false
	    			call DestroyEffect( AddSpecialEffectTarget("Abilities\\Weapons\\VengeanceMissile\\VengeanceMissile.mdl",u1,"chest") )
					call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1, UNIT_STATE_LIFE) + R) 
				endif	
    	endif
    set u1 = null	
endfunction
//===========================================================================
function InitTrig_C23R_reduce_damage takes nothing returns nothing
    set gg_trg_C23R_reduce_damage = CreateTrigger()
    call TriggerAddCondition(gg_trg_C23R_reduce_damage, Condition(function Trig_C23_R_reduce_damageConditions))
endfunction//===========================================================================
// Trigger: C23T
//===========================================================================
function Trig_C23T_STARTConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A08I'))
endfunction
function Trig_C23T_STARTActions takes nothing returns nothing
    local unit u1 = GetTriggerUnit()
    local unit u2 = GetSpellTargetUnit()
    local real r1 = GetUnitLifePercent(u1)
    local real r2 = GetUnitLifePercent(u2)
	    if IsUnitType(u2, UNIT_TYPE_MAGIC_IMMUNE) == false and IsUnitType(u2, UNIT_TYPE_ANCIENT) == false then
	        call SetUnitLifePercentBJ( u2, r1 )
	        call SetUnitLifePercentBJ( u1, r2 )
	    else
	        call SetUnitLifePercentBJ( u1, r2 )
	    endif
	set u1 = null
	set u2 = null
endfunction
//===========================================================================
function InitTrig_C23T takes nothing returns nothing
    set gg_trg_C23T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C23T, Condition(function Trig_C23T_STARTConditions))
    call TriggerAddAction(gg_trg_C23T, function Trig_C23T_STARTActions)
endfunction
//===========================================================================
// Trigger: C24
//===========================================================================
function Trig_C24Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C24_W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C24E_check, udg_A_common_HERO, EVENT_UNIT_SPELL_CHANNEL)
    call TriggerRegisterUnitEvent(gg_trg_C24E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C24R_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    call TriggerRegisterUnitEvent(gg_trg_C24R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C24R_attack_start, udg_A_common_HERO, EVENT_UNIT_TARGET_IN_RANGE)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C24T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
endfunction
//===========================================================================
function InitTrig_C24 takes nothing returns nothing
    set gg_trg_C24 = CreateTrigger()
    call TriggerAddAction(gg_trg_C24, function Trig_C24Actions)
endfunction
//===========================================================================
// Trigger: C24 W
//===========================================================================
//預回血
function Rosedmg takes unit u ,real r returns nothing
local real dmg = r	*	GetEventDamage()
	call SetUnitState( u, UNIT_STATE_LIFE, GetUnitState(u, UNIT_STATE_LIFE)+dmg )
endfunction 
function Trig_C24_WFunc002Conditions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
    if ((u1 != null)) then
	    //以預回血，來達成抵擋傷害的錯覺。
        call Rosedmg(u1,0.05*I2R(GetUnitAbilityLevel(u1,'A05I')))
    else
        call DestroyTrigger(GetTriggeringTrigger())
    endif
    
set u1 = null 
endfunction
function Trig_C24_WFunc003T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =	LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i =	LoadInteger(YDHT, h2i, 0xA3098AE2)
	if(i >= 3) or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 then
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		call SetUnitState(u1, UNIT_STATE_LIFE, (GetUnitState(u1,UNIT_STATE_LIFE)+(GetUnitState(u1,UNIT_STATE_MAX_LIFE)*0.03)))
		call SaveInteger(YDHT, h2i, 0xA3098AE2, i + 1)
	endif
	
set u1 = null
set t = null
endfunction
function Trig_C24_WActions takes nothing returns nothing
    local timer t = CreateTimer()
    local integer h2i = GetHandleId(t)
    local trigger tr = CreateTrigger()
    local unit u1 = GetTriggerUnit()
    local unit u2 = GetSpellTargetUnit()
    local	real dmg =	( GetUnitState(u2, UNIT_STATE_MAX_LIFE) * 0.22 )
	local	attacktype	a =	ATTACK_TYPE_NORMAL
	local	damagetype	d =	DAMAGE_TYPE_UNKNOWN
	local	weapontype	w =	WEAPON_TYPE_WHOKNOWS
    
	    	if (IsUnitType(u2,UNIT_TYPE_MECHANICAL)==false) then
	    		call	UnitDamageTarget(u1, u2, dmg,true,false,a,d,w)
	    	endif
	    	
	    //resist dmg	   
	    call TriggerRegisterUnitEvent( tr, u1, EVENT_UNIT_DAMAGED )
	    call TriggerRegisterTimerEvent(tr, 3.00, false)
	    call TriggerAddCondition(tr, Condition(function Trig_C24_WFunc002Conditions))
	    
		//recover Hp
	    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
	    call SaveInteger(YDHT, h2i, 0xA3098AE2, 0)
	    call TimerStart(t, 1.00, true, function Trig_C24_WFunc003T)
	    
    set tr = null
    set t = null
    set u1 = null
    set u2 = null
endfunction
function Trig_C24_WConditions takes nothing returns boolean
    if ((GetSpellAbilityId() == 'A05I'))	then
	    call	Trig_C24_WActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_C24_W takes nothing returns nothing
    set gg_trg_C24_W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C24_W, Condition(function Trig_C24_WConditions))
endfunction
//===========================================================================
// Trigger: C24E check
//===========================================================================
function Trig_C24E_checkConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A02A'))
endfunction
function Trig_C24E_checkActions takes nothing returns nothing
local unit ydl_unit
call GroupEnumUnitsInRange(udg_Group[3], GetSpellTargetX(), GetSpellTargetY(), 225.00, null)
    loop
    	set ydl_unit = FirstOfGroup(udg_Group[3])
    	exitwhen (ydl_unit == null)
        call GroupRemoveUnit(udg_Group[3], ydl_unit)
        	if GetUnitAbilityLevel(ydl_unit, 'B068') > 0 then
	        	call UnitRemoveAbility(ydl_unit,'B068')
	        endif 
	endloop
set ydl_unit = null
endfunction
//===========================================================================
function InitTrig_C24E_check takes nothing returns nothing
    set gg_trg_C24E_check = CreateTrigger()
    call TriggerAddCondition(gg_trg_C24E_check, Condition(function Trig_C24E_checkConditions))
    call TriggerAddAction(gg_trg_C24E_check, function Trig_C24E_checkActions)
endfunction
//===========================================================================
// Trigger: C24E
//
// call 'A0NS'
//===========================================================================
globals
real array C24E_A
real array C24E_R
endglobals	
function Trig_C24EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A02A'))
endfunction
function Trig_C24ETimer takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
local real x = GetUnitX(u1)+40.00*Cos(C24E_A[i])
local real y = GetUnitY(u1)+40.00*Sin(C24E_A[i])
set C24E_R[i] = C24E_R[i] -40
	if C24E_R[i]<=40 then
		call SetUnitPathing(u1,true)
		call SetUnitX(u1,x)
		call SetUnitY(u1,y)
		call SetUnitTimeScale(u1, 1.00)
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else 
	    call SetUnitX(u1,x)
		call SetUnitY(u1,y)
	endif
set t = null
set u1 = null
endfunction
function Trig_C24EActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x2 = GetSpellTargetX()
local real y2 = GetSpellTargetY() 
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))	
	if IsTerrainPathable(x2,y2,PATHING_TYPE_WALKABILITY)==false then	
		set C24E_R[i]=SquareRoot(Pow(y2-y,2) + Pow(x2-x,2) )
		set C24E_A[i]=Atan2(y2-y,x2-x)
		call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		call TimerStart(t, 0.01, true, function Trig_C24ETimer)
		//effect
	    call SetUnitTimeScale(u1, 60.00 * 0.01)
	    call SetUnitAnimation(u1,"attack")
	    call SetUnitPathing(u1,false)
	    //spell
		call UnitAddAbility(u1,'A0NS')
	    call SetUnitAbilityLevel(u1,'A0NS',GetUnitAbilityLevel(u1,'A02A'))
	    call YDWEPolledWaitNull(9.00) 
	    call UnitRemoveAbility(u1,'A0NS') 
	endif 
set u1 = null 
set t = null
endfunction
//===========================================================================
function InitTrig_C24E takes nothing returns nothing
    set gg_trg_C24E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C24E, Condition(function Trig_C24EConditions))
    call TriggerAddAction(gg_trg_C24E, function Trig_C24EActions)
endfunction//===========================================================================
// Trigger: C24R learn
//===========================================================================
function Trig_C24R_learnConditions takes nothing returns boolean
    return ((GetLearnedSkillBJ() == 'A008') and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_C24R_learnActions takes nothing returns nothing
    call SetPlayerTechResearchedSwap( 'Rusf', GetUnitAbilityLevelSwapped('A008', GetTriggerUnit()), GetOwningPlayer(GetTriggerUnit()) )
endfunction
//===========================================================================
function InitTrig_C24R_learn takes nothing returns nothing
    set gg_trg_C24R_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_C24R_learn, Condition(function Trig_C24R_learnConditions))
    call TriggerAddAction(gg_trg_C24R_learn, function Trig_C24R_learnActions)
endfunction
//===========================================================================
// Trigger: C24R
//===========================================================================
function Trig_C24RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A008'))
endfunction
function Trig_C24RActions takes nothing returns nothing
    set udg_C24R_I[GetConvertedPlayerId(GetTriggerPlayer())] = 0
endfunction
//===========================================================================
function InitTrig_C24R takes nothing returns nothing
    set gg_trg_C24R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C24R, Condition(function Trig_C24RConditions))
    call TriggerAddAction(gg_trg_C24R, function Trig_C24RActions)
endfunction
//===========================================================================
// Trigger: C24R attack start
//===========================================================================
function Trig_C24R_attack_startActionsFunc003Conditions takes nothing returns nothing
	local trigger ltt = GetTriggeringTrigger()
	local integer h2i = GetHandleId(ltt)
	local unit u1 = LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
	local unit u2 = GetTriggerUnit()
	local unit u3
	local unit ydl_unit
	local player p = GetOwningPlayer(u1)
	local integer i = GetPlayerId(p) + 1
	local real dmg = GetEventDamage()
		//Avoid crash
		call TriggerRemoveCondition( ltt , LoadTriggerConditionHandle(YDHT,h2i,44444) )
		call DestroyTrigger(ltt)
		call FlushChildHashtable(YDHT, h2i)
		set udg_B12R_B[i]=false
		//滿三次暈眩一次
		set udg_C24R_I[i] = udg_C24R_I[i] + 1
		//////////////
		//傷害+特效+暈眩
		//////////////
		if udg_C24R_I[i]>=3 then
			set u3 = CreateUnit(p, 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
			call UnitAddAbility( u3, 'A032' )
			call SetUnitAbilityLevel( u3, 'A032', GetUnitAbilityLevel(u1, 'A008') )
			set udg_C24R_I[i] = 0
				call GroupEnumUnitsInRange(udg_Group[10], GetUnitX(u1), GetUnitY(u1), 380.00, null)
				loop
		        	set ydl_unit=FirstOfGroup(udg_Group[10])
		        	exitwhen ydl_unit == null
		        	call GroupRemoveUnit(udg_Group[10], ydl_unit)
						if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false and GetUnitPointValue(ydl_unit) != 1 then
							call UnitDamageTarget(u1, ydl_unit, dmg, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL, WEAPON_TYPE_WHOKNOWS)
            				call IssueTargetOrder(u3,"thunderbolt",ydl_unit)
            				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\DragonHawkMissile\\DragonHawkMissile.mdl",ydl_unit,"chest"))
        				endif
    			endloop	
    	endif
    set ydl_unit = null	
	set ltt = null
	set u1 = null
    set u2 = null
	set u3 = null
	set p = null
endfunction
function Trig_C24R_attack_startActions takes nothing returns nothing
	local unit u1 = GetTriggerUnit()
	local unit u2 = GetEventTargetUnit()
    local trigger ltt
    local integer h2i 
    local integer i = GetPlayerId(GetOwningPlayer(u1)) + 1
    local triggercondition ltc
    	if udg_B12R_B[i]==false then
	    	set ltt = CreateTrigger()
	    	set h2i = GetHandleId(ltt)
    		///////////
    		//參數設定
    		//////////	    	
	    	set udg_B12R_B[i]=true
		    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
		    set ltc = TriggerAddCondition(ltt, Condition(function Trig_C24R_attack_startActionsFunc003Conditions))
		    call SaveTriggerConditionHandle(YDHT,h2i,44444,ltc)
	    	/////////////////////////////////////////////////////////////
		    //timer check + 觸發器登記
		    /////////////////////////////////////////////////////////////
		    call TriggerRegisterUnitEvent(ltt, u2, EVENT_UNIT_DAMAGED)
            call Normal_Attack_Timer_for_Trigger(ltt,0.30 , ltc , i)	
		endif 
	set ltc = null	
    set ltt=null
    set u1 = null
    set u2 = null
endfunction
function Trig_C24R_attack_startConditions takes nothing returns boolean
    if GetUnitAbilityLevel(GetTriggerUnit(), 'B02G') != 0 and udg_B12R_B[GetPlayerId(GetOwningPlayer(GetTriggerUnit())) + 1] == false then
	    call Trig_C24R_attack_startActions()
    endif
    return false
endfunction
function InitTrig_C24R_attack_start takes nothing returns nothing
    set gg_trg_C24R_attack_start = CreateTrigger()
    call TriggerAddCondition(gg_trg_C24R_attack_start, Condition(function Trig_C24R_attack_startConditions))
endfunction
//===========================================================================
// Trigger: C24T
//===========================================================================
function Trig_C24_TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A00Z'))
endfunction
function Trig_C24_TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real x
local real y
call SetUnitLifeBJ(u1,(GetUnitState(u1,UNIT_STATE_LIFE)+(GetUnitState(u1,UNIT_STATE_MAX_LIFE)*(0.20+(0.10*I2R(GetUnitAbilityLevel(u1,GetSpellAbilityId())))))))
call SetUnitLifeBJ(u2,(GetUnitState(u2,UNIT_STATE_LIFE)+(GetUnitState(u2,UNIT_STATE_MAX_LIFE)*(0.20+(0.10*I2R(GetUnitAbilityLevel(u1,GetSpellAbilityId())))))))
	//for effect
	call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",u1,"origin") )
	call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",u2,"origin") )
	call TriggerSleepAction(0.00)
	call SetUnitX(u1,GetUnitX(u2))
	call SetUnitY(u1,GetUnitY(u2))
	//give hero ability
	call UnitAddAbility(u1,'A07R')
	call UnitAddAbility(u2,'A07R')
	call YDWEPolledWaitNull(15.00)
	call UnitRemoveAbility(u1,'A07R')
	call UnitRemoveAbility(u2,'A07R')
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_C24T takes nothing returns nothing
    set gg_trg_C24T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C24T, Condition(function Trig_C24_TConditions))
    call TriggerAddAction(gg_trg_C24T, function Trig_C24_TActions)
endfunction
//===========================================================================
// Trigger: C25
//===========================================================================
function Trig_C25Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C25_learn, udg_A_common_HERO, EVENT_UNIT_HERO_SKILL)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C25W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterUnitEvent(gg_trg_C25W2, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_C25W2_attack, GetOwningPlayer(udg_A_common_HERO), EVENT_PLAYER_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C25_E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C25R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ------------------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C25T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    // ---------------------------------
    set udg_C25W_Timer[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateTimer()
    // ---------------------------------
    set udg_C25R_heal[1] = 0.00
    set udg_C25R_heal[2] = 150.00
    set udg_C25R_heal[3] = 350.00
    set udg_C25R_heal[4] = 450.00
endfunction
//===========================================================================
function InitTrig_C25 takes nothing returns nothing
    set gg_trg_C25 = CreateTrigger()
    call TriggerAddAction(gg_trg_C25, function Trig_C25Actions)
endfunction
//===========================================================================
// Trigger: C25 learn
//===========================================================================
function Trig_C25_learnConditions takes nothing returns boolean
    return (((GetLearnedSkillBJ() == 'A0RG') or (GetLearnedSkillBJ() == 'A0RI') or (GetLearnedSkillBJ() == 'A0AO')) and (IsUnitIllusionBJ(GetTriggerUnit()) != true))
endfunction
function Trig_C25_learnActions takes nothing returns nothing
    if ((GetUnitAbilityLevel(GetTriggerUnit(), 'A0AO') == 1)) then
        call UnitAddAbility( GetTriggerUnit(), 'A0DJ' )
    else
        call SetUnitAbilityLevel( GetTriggerUnit(), 'A0DJ', GetUnitAbilityLevel(GetTriggerUnit(), 'A0AO') )
    endif
    if ((GetLearnedSkillBJ() != 'A0AO')) then
        call SetUnitAbilityLevel( GetTriggerUnit(), 'A07T', GetUnitAbilityLevel(GetTriggerUnit(), GetLearnedSkill()) )
    else
    endif
endfunction
//===========================================================================
function InitTrig_C25_learn takes nothing returns nothing
    set gg_trg_C25_learn = CreateTrigger()
    call TriggerAddCondition(gg_trg_C25_learn, Condition(function Trig_C25_learnConditions))
    call TriggerAddAction(gg_trg_C25_learn, function Trig_C25_learnActions)
endfunction
//===========================================================================
// Trigger: C25W
//===========================================================================
globals
unit array C25W_U
endglobals
	
function Trig_C25WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A07T'))
endfunction
function Trig_C25WFunc010T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u2 =C25W_U[i]
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetUnitX(u2)
local real y1 = GetUnitY(u2)
local real dt = SquareRoot( ( Pow((x1-x),2)) + Pow((y1-y),2) )
	if ( (GetUnitAbilityLevel(u2, 'B08K') <= 0) or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 or GetUnitState(u2, UNIT_STATE_LIFE) <= 0 or (dt>=1001.00))then
        call UnitRemoveAbility( u2, 'B08K' )
        call UnitRemoveAbility( u1, 'A0WE' )
        call FlushChildHashtable(YDHT, h2i)
        call PauseTimer(udg_C25W_Timer[i]) 
	endif
set u1 = null
set t = null
set u2 = null 
endfunction
function Trig_C25WActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
local timer t = udg_C25W_Timer[i]
local integer h2i = GetHandleId(t)
    // ---------------------------------
    	if ((udg_C25W_Target[i] != u2)) then
        	call UnitRemoveAbility( udg_C25W_Target[i], 'B08K' )
    	endif
    // ---------------------------------
    set udg_C25W_Target[i] = u2
    set udg_C25W_I[i] = 0
    // ---------------------------------
    call UnitAddAbility(u1,'A0WE')
    // ---------------------------------
    
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
    set C25W_U[i] = u2
    call PauseTimer(udg_C25W_Timer[i])
    call TimerStart(t, 1.00, true, function Trig_C25WFunc010T)
    set u1 = null
    set u2 = null
    set t = null
endfunction
//===========================================================================
function InitTrig_C25W takes nothing returns nothing
    set gg_trg_C25W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C25W, Condition(function Trig_C25WConditions))
    call TriggerAddAction(gg_trg_C25W, function Trig_C25WActions)
endfunction
//===========================================================================
// Trigger: C25W2
//===========================================================================
function Trig_C25W2Conditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0RI'))
endfunction
function Trig_C25W2Actions takes nothing returns nothing
    // ----------------------------------
    set udg_ChainAbility_a = 0
    set udg_ChainAbility_s = "\"\""
    set udg_ChainAbility_a2 = ('A0JN')
    set udg_ChainAbility_s2 = "lightningshield"
    set udg_ChainAbility_fu = ('uplg')
    set udg_ChainAbility_fu2 = ('n007')
    set udg_ChainAbility_r = 0.00
    set udg_ChainAbility_j = 1
    set udg_ChainAbility_v = 600.00
    set udg_ChainAbility_m = 2
    set udg_ChainAbility_U = udg_C25W_Target[GetConvertedPlayerId(GetOwningPlayer(GetTriggerUnit()))]
    set udg_ChainAbility_t = 0.03
    set udg_ChainAbility_b = true
    // ----------------------------------
    call ConditionalTriggerExecute( gg_trg_ChainAbility )
    // ----------------------------------
    // ----------------------------------
endfunction
//===========================================================================
function InitTrig_C25W2 takes nothing returns nothing
    set gg_trg_C25W2 = CreateTrigger()
    call TriggerAddCondition(gg_trg_C25W2, Condition(function Trig_C25W2Conditions))
    call TriggerAddAction(gg_trg_C25W2, function Trig_C25W2Actions)
endfunction
//===========================================================================
// Trigger: C25W2 attack
//
// O要有取消的
//===========================================================================
function Trig_C25W2_attackConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0JN' ))
endfunction
function Trig_C25W2_attackActions takes nothing returns nothing
local unit u4
local unit u1 = GetTriggerUnit()
local integer i = GetConvertedPlayerId(GetOwningPlayer(u1))
local unit u2 = GetSpellTargetUnit()
local unit u3 = udg_S01_hero_of_player[i]
local integer i2 = GetUnitAbilityLevel(u3,'A07T')
set u4 = CreateUnit(GetOwningPlayer(u3), 'uplg', GetUnitX(u2), GetUnitY(u2), 0)
call KillUnit( u4 )
call UnitDamageTargetBJ(u3,u2,((60.00+(60.00*I2R(i2)))+(I2R(GetHeroInt(u3,true))*(0.70+(0.50*I2R(i2))))),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL)
set udg_C25W_I[i]=udg_C25W_I[i]+1
	if(udg_C25W_I[i]==2)then
		set udg_C25W_I[i]=0
    	set u4 = CreateUnit(GetOwningPlayer(u3), 'h02G', GetUnitX(u2), GetUnitY(u2), 0)
    	call ShowUnit(u4, false)
    	call UnitApplyTimedLife( u4, 'BHwe', 0.05 )
    	call UnitAddAbility( u4, 'A0Q7' )
    	call IssueTargetOrder(u4,"thunderbolt",u2)
	endif
set u1 = null
set u2 = null
set u3 = null 
set u4 = null 
endfunction
//===========================================================================
function InitTrig_C25W2_attack takes nothing returns nothing
    set gg_trg_C25W2_attack = CreateTrigger()
    call TriggerAddCondition(gg_trg_C25W2_attack, Condition(function Trig_C25W2_attackConditions))
    call TriggerAddAction(gg_trg_C25W2_attack, function Trig_C25W2_attackActions)
endfunction
//===========================================================================
// Trigger: C25 E
//===========================================================================
function Trig_C25_EConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0AO'))
endfunction
function Trig_C25_EFunc006Conditions takes nothing returns nothing
local trigger tr = GetTriggeringTrigger()
local integer h2i = GetHandleId(tr)
local real dmg = LoadReal(YDHT,h2i,0xA3098AE2)
local real dmg2 = GetEventDamage()
local unit u1 = GetTriggerUnit()
	if u1 == null then
		call DestroyEffect(LoadEffectHandle(YDHT,h2i,0xA1614B4D))
		call FlushChildHashtable(YDHT, h2i)
    	call DestroyTrigger(tr) 
	else
		if dmg2>=dmg then
			call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1,UNIT_STATE_LIFE)+dmg)
			call DestroyEffect(LoadEffectHandle(YDHT,h2i,0xA1614B4D))
			call FlushChildHashtable(YDHT, h2i)
    		call DestroyTrigger(tr) 
		else 
			call SaveReal(YDHT,h2i,0xA3098AE2,dmg-dmg2)
			call SetUnitState(u1, UNIT_STATE_LIFE, GetUnitState(u1,UNIT_STATE_LIFE)+dmg2)
		endif
	endif	
set u1 = null 
set tr = null
endfunction
function Trig_C25_EActions takes nothing returns nothing
local trigger tr 
local integer h2i 
local unit u1 = GetTriggerUnit()
local unit ydl_unit	
local real a = GetUnitFacing(u1)*bj_DEGTORAD
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1
local real y1
local integer i 
local integer i2 = 0
local player p = GetOwningPlayer(u1)
local real dmg = (30.00+(120.00*I2R(GetUnitAbilityLevel(u1,'A0AO'))))
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\zapmissile.mdx", u1, "chest" ))
	set i = 1
		loop
			exitwhen i>12
			set x1 = x + 50.00*I2R(i)*Cos(a)
			set y1 = y + 50.00*I2R(i)*Sin(a)
				if(i==12)then
					call SetUnitX(u1,x1)
					call SetUnitY(u1,y1)
				else
					call GroupEnumUnitsInRange(udg_Group[1], x1, y1, 185.00, null)
						loop
							set ydl_unit = FirstOfGroup(udg_Group[1])
							exitwhen ydl_unit == null or i2 == 1
							call GroupRemoveUnit(udg_Group[1], ydl_unit)
							//aviod hide caster
	    						if (GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) and (GetUnitPointValue(ydl_unit) != 1) and (IsUnitHidden(ydl_unit) == false)) then
	    							set i2 = 1
	    						endif
						endloop
						//avoid double check
						call GroupClear(udg_Group[1])	
		    				if (i2==1) then
								call SetUnitX(u1,x1)
		    					call SetUnitY(u1,y1) 
		    					call IssueImmediateOrder(u1,"stop") 
		    					call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Thunderclap\\ThunderClapCaster.mdl",u1,"origin"))
		    					call GroupEnumUnitsInRange(udg_Group[1], x1, y1, 245.00, null)
		    						loop
		    							set ydl_unit = FirstOfGroup(udg_Group[1])
		   	 							exitwhen ydl_unit == null
		    							call GroupRemoveUnit(udg_Group[1], ydl_unit)
		        							if (GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) ) then
		        								call UnitDamageTargetBJ(u1,ydl_unit,dmg,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		        							endif
		    						endloop
		    					//shied        
		    					set tr = CreateTrigger()
		    					set h2i = GetHandleId(tr)
		    					call SaveEffectHandle(YDHT,h2i,0xA1614B4D,AddSpecialEffectTarget("war3mapImported\\Defensive Barrier big.mdx",u1,"chest"))
		    					//the real for int
		   						call SaveReal(YDHT,h2i,0xA3098AE2,(I2R(GetHeroInt(u1,true))*5.00) ) 
		    					call TriggerRegisterUnitEvent( tr, u1, EVENT_UNIT_DAMAGED )
		    					call TriggerRegisterTimerEvent(tr, 10.00, false)
		    					call TriggerAddCondition(tr, Condition(function Trig_C25_EFunc006Conditions))
		    					set u1= null
		    					set tr = null
		    					set ydl_unit= null
		    					return
		    				endif
				endif 
			set i=i+1
		endloop
set p = null 
set u1= null
set tr = null
set ydl_unit= null
endfunction
//===========================================================================
function InitTrig_C25_E takes nothing returns nothing
    set gg_trg_C25_E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C25_E, Condition(function Trig_C25_EConditions))
    call TriggerAddAction(gg_trg_C25_E, function Trig_C25_EActions)
endfunction
//===========================================================================
// Trigger: C25R 
//===========================================================================
function Trig_C25RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0CT'))
endfunction
function Trig_C25RActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real x1 = GetUnitX(u2)
local real y1 = GetUnitY(u1)
local real dt = SquareRoot( ( Pow((x1-x),2)) + Pow((y1-y),2) )
local real r1 =0
local real r2 =0
	if (u1==u2) then
		call SetUnitLifeBJ(u1,(GetUnitState(u1,UNIT_STATE_LIFE)+udg_C25R_heal[GetUnitAbilityLevel(u1,GetSpellAbilityId())]))
	endif
	
    if(dt>=400.00)then
		set r1=(dt-400.00)
    	set r2=(r1/100.00)
    	set r2=(I2R(R2I(r2))*0.20)
    	set r2=(I2R((2+GetUnitAbilityLevel(u1,'A0CT')))-r2)
   			 if(r2<=0.80)then
        		set r2=0.80
    		endif
   		call YDWEPolledWaitNull(r2)
    	call UnitRemoveBuffBJ('B08L',u2)	
    endif
set u1 = null
set u2 = null
endfunction
//===========================================================================
function InitTrig_C25R takes nothing returns nothing
    set gg_trg_C25R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C25R, Condition(function Trig_C25RConditions))
    call TriggerAddAction(gg_trg_C25R, function Trig_C25RActions)
endfunction
//===========================================================================
// Trigger: C25T
//===========================================================================
function Trig_C25TConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0CW'))
endfunction
function Trig_C25T_EFunc014T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer shoot_count =LoadInteger(YDHT, h2i, 0x9C0F555E)
local integer laser =LoadInteger(YDHT, h2i, 0xA3098AE2)
local integer p =LoadInteger(YDHT, h2i, 0xFDF65382)
local real x 
local real y
local unit u3
local integer i 
local real x1
local real y1
local real a
local real a1
	if((p==1))then
	    if((shoot_count<=0) or GetUnitState(u1, UNIT_STATE_LIFE) <= 0)then
	    	call SaveInteger(YDHT, h2i, 0xFDF65382, 2)
	    	call PauseTimer(t)
	    	call TimerStart(t, 0.33, true, function Trig_C25T_EFunc014T)
	    	call SaveInteger(YDHT, h2i, 0x9C0F555E, 24)
	    
	    else
	    	call SaveInteger(YDHT, h2i, 0x9C0F555E, shoot_count-1) 
	    	set x = GetUnitX(u1)
	    	set y = GetUnitY(u1)
	    	set a = (GetUnitFacing(u1)-24.00)*bj_DEGTORAD
	    	set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', x, y, 0)
	    	call UnitApplyTimedLife( u3, 'BHwe', 3.00 )
	    	call UnitAddAbility( u3, 'A0HI' )
	    	call SetUnitAbilityLevel( u3, 'A0HI', GetUnitAbilityLevel(u1, 'A0CW') )
	    	set i=1
	    		loop
	    			exitwhen i>4
	    			set a1 = a + (16.00*I2R(i)*bj_DEGTORAD)
	    			set x1 = x + 200.00*I2R(i)*Cos(a1)
	    			set y1 = y + 200.00*I2R(i)*Sin(a1)
	    			call IssuePointOrder(u3,"breathoffrost",x1,y1)
	    			set i=i+1
	    		endloop 
	    endif
	else
	    if((shoot_count<=0) or GetUnitState(u1, UNIT_STATE_LIFE) <= 0 )then
	    	call PauseTimer(t)
			call FlushChildHashtable(YDHT, h2i)
			call DestroyTimer(t)
		else 
	    	call SaveInteger(YDHT, h2i, 0x9C0F555E, shoot_count-1)
	    	set x = GetUnitX(u1)
	    	set y = GetUnitY(u1)
	    	set a = (GetUnitFacing(u1)-12.00)*bj_DEGTORAD
	    	set u3 = CreateUnit(GetOwningPlayer(u1), 'h01E', GetUnitX(u1), GetUnitY(u1), 0)
	    	call UnitApplyTimedLife( u3, 'BHwe', 3.00 )
	   		call UnitAddAbility( u3, 'A0HI' )
	    	call SetUnitAbilityLevel( u3, 'A0HI', GetUnitAbilityLevel(u1, 'A0CW') )
	    	set i=1
	    		loop
	    			exitwhen i>2
	    			set a1 = a + (8.00*I2R(i)*bj_DEGTORAD)
	    			set x1 = x + 200.00*I2R(i)*Cos(a1)
	    			set y1 = y + 200.00*I2R(i)*Sin(a1)
	    			call IssuePointOrder(u3,"breathoffrost",x1,y1)
	    			set i=i+1
	    		endloop
	    endif
	endif
set u1 = null
set t = null
set u3 = null
endfunction
function Trig_C25TActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
    call SaveInteger(YDHT, h2i, 0x9C0F555E, 5)
    call SaveInteger(YDHT, h2i, 0xA3098AE2, 4)
    call SaveInteger(YDHT, h2i, 0xFDF65382, 1) 
    call TimerStart(t, 0.22, true, function Trig_C25T_EFunc014T)
    
set t = null
set u1 = null
endfunction
//===========================================================================
function InitTrig_C25T takes nothing returns nothing
    set gg_trg_C25T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C25T, Condition(function Trig_C25TConditions))
    call TriggerAddAction(gg_trg_C25T, function Trig_C25TActions)
endfunction//===========================================================================
// Trigger: C26
//===========================================================================
function Trig_C26Actions takes nothing returns nothing
    call TriggerRegisterUnitEvent(gg_trg_C26D, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C26W, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C26E, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C26R, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    call TriggerRegisterUnitEvent(gg_trg_C26T, udg_A_common_HERO, EVENT_UNIT_SPELL_EFFECT)
    // ---------------------------------
    set udg_C26D_Timer[GetConvertedPlayerId(GetOwningPlayer(udg_A_common_HERO))] = CreateTimer()
    // ---------------------------------
    call SetPlayerAbilityAvailable( GetOwningPlayer(udg_A_common_HERO), 'A0OL', false )
endfunction
//===========================================================================
function InitTrig_C26 takes nothing returns nothing
    set gg_trg_C26 = CreateTrigger()
    call TriggerAddAction(gg_trg_C26, function Trig_C26Actions)
endfunction
//===========================================================================
// Trigger: C26D
//===========================================================================
function Trig_C26DFunc001T takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u =	LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i =	LoadInteger(YDHT, h2i, 0xA3098AE2)
local player p = GetOwningPlayer(u)
local integer	heroInt =	GetHeroInt(u,true)
local real dmg = (	35.00	+	1.45	*	I2R(heroInt)	)
local unit ydl_unit
	if(i==0)then
		call FlushChildHashtable(YDHT,h2i)
		call PauseTimer(t)
	else
		//clock
		call SaveInteger(YDHT, h2i, 0xA3098AE2, i-1)
			//dmg
			call GroupEnumUnitsInRange(udg_Group[3], GetUnitX(u), GetUnitY(u), 370.00, null)
    		loop
    			set ydl_unit = FirstOfGroup(udg_Group[3])
    			exitwhen ydl_unit == null
        		call GroupRemoveUnit(udg_Group[3], ydl_unit)
        		
        			if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p)and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false then
        				call UnitDamageTarget(u,ydl_unit,dmg, true, false, ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC, WEAPON_TYPE_WHOKNOWS)	
        				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\SorceressMissile\\SorceressMissile.mdl",ydl_unit,"head"))
    				endif
    				
    		endloop
	endif
set p = null	
set u = null
set ydl_unit = null
set t = null
endfunction
function Trig_C26DActions takes nothing returns nothing
local unit u = GetTriggerUnit()
local player	p	=	GetOwningPlayer(u)
local integer i = GetPlayerId(p) + 1
local timer t	= udg_C26D_Timer[i]
local integer h2i = GetHandleId(t)
	call PauseTimer(t)
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u)
    call SaveInteger(YDHT, h2i, 0xA3098AE2, 4)
    call TimerStart(t, 1.00, true, function Trig_C26DFunc001T)
    
set u = null
set t = null
endfunction
function Trig_C26DConditions takes nothing returns boolean
	local integer id = GetSpellAbilityId()
    if id == 'A0OH' or id == 'A0OJ' or id == 'A0OL' or id == 'A0OV' or id == 'A0OK'	then
	    call Trig_C26DActions()
    endif
    return false
endfunction
//===========================================================================
function InitTrig_C26D takes nothing returns nothing
    set gg_trg_C26D = CreateTrigger()
    call TriggerAddCondition(gg_trg_C26D, Condition(function Trig_C26DConditions))
endfunction
//===========================================================================
// Trigger: C26W
//===========================================================================
function Trig_C26WConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0OH'))
endfunction
//================C26 Tri N.01==================
function Trig_C26W_ForGroup takes nothing returns nothing
local real x1
local real y1
local unit u1 = GetEnumUnit()
        set udg_I1[326]=(udg_I1[326]+5)
        set udg_I2[326]=(udg_I2[326]*-1)
        set x1 = udg_X[326] + 134.00*Cos(rose_real+(udg_I1[326]*udg_I2[326]*bj_DEGTORAD))
        set y1 = udg_Y[326] + 134.00*Sin(rose_real+(udg_I1[326]*udg_I2[326]*bj_DEGTORAD))
        call IssueImmediateOrder(u1,"stop")
        call SetUnitX(u1,x1)
        call SetUnitY(u1,y1)
set u1 = null
endfunction
//================C26 Tri N.02==================
function Trig_C26W_ForGroupEND takes nothing returns nothing
call SetUnitPathing(GetEnumUnit(),true)
endfunction
//================C26 Tri N.03==================
function Trig_C19W_W_Timer_Pick takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u1 =LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local group g =LoadGroupHandle(YDHT, h2i, 0x9C0F555E)
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
local real a = (GetUnitFacing(u1)+180.00)*bj_DEGTORAD
local unit ydl_unit
local player p = GetOwningPlayer(u1)
	if (GetUnitAbilityLevel(u1, 'B08Q') == 0)then
		call ForGroup(g,function Trig_C26W_ForGroupEND)
		call DestroyGroup(g)
    	call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)	
	else
		call GroupEnumUnitsInRange(udg_Group[3], x, y, 148.00, null)
    		loop
    			set ydl_unit = FirstOfGroup(udg_Group[3])
    			exitwhen ydl_unit == null
        		call GroupRemoveUnit(udg_Group[3], ydl_unit)
        			if ( (IsUnitInGroup(ydl_unit, g) != true) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and (IsUnitType(ydl_unit,UNIT_TYPE_MAGIC_IMMUNE)==false) and (IsUnitType(ydl_unit,UNIT_TYPE_MECHANICAL)==false) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) and (GetUnitPointValue(ydl_unit) != 1)) then
        				call GroupAddUnit(g,ydl_unit) 
        				call SetUnitPathing( ydl_unit, false ) 
        			endif
    		endloop
		//更新 Group 裡面
		call SaveGroupHandle(YDHT, h2i, 0x9C0F555E, g)
		//用全域 來做參數的傳導
		set udg_X[326] = x
		set udg_Y[326] = y
		set rose_real = a
		set udg_I1[326] = 0
		set udg_I2[326] = 1
		call ForGroup(g,function Trig_C26W_ForGroup) 
	endif
set p = null	
set g = null
set u1 = null
set t = null
set ydl_unit = null
endfunction
//================C26 Tri N.04==================
function Trig_C26WActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit ydl_unit
local group g = CreateGroup()
local unit u1 = GetTriggerUnit()
local real x = GetUnitX(u1)
local real y = GetUnitY(u1)
call GroupEnumUnitsInRange(udg_Group[3], x, y, 148.00, null)
    loop
    	set ydl_unit = FirstOfGroup(udg_Group[3])
    	exitwhen ydl_unit == null
        call GroupRemoveUnit(udg_Group[3], ydl_unit)
        	if (	GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and (IsUnitType(ydl_unit,UNIT_TYPE_MECHANICAL)==false) and (IsUnitType(ydl_unit,UNIT_TYPE_MAGIC_IMMUNE)==false) and IsUnitEnemy(ydl_unit,GetOwningPlayer(u1)) and (IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false) and (GetUnitPointValue(ydl_unit) != 1)) then
        		call GroupAddUnit(g,ydl_unit)
        		call SetUnitPathing(ydl_unit,false)
        	endif
    endloop
//防戰法帶回家
call UnitDamageTargetBJ(u1,u1,1.00,ATTACK_TYPE_HERO,DAMAGE_TYPE_ACID)
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u1)
    call SaveGroupHandle(YDHT, h2i, 0x9C0F555E, g)
    call TimerStart(t, 0.05/2.00, true, function Trig_C19W_W_Timer_Pick) 
set t = null
set u1 = null
set ydl_unit = null
set g = null
endfunction
//===========================================================================
function InitTrig_C26W takes nothing returns nothing
    set gg_trg_C26W = CreateTrigger()
    call TriggerAddCondition(gg_trg_C26W, Condition(function Trig_C26WConditions))
    call TriggerAddAction(gg_trg_C26W, function Trig_C26WActions)
endfunction
//===========================================================================
// Trigger: C26E
//===========================================================================
function Trig_C26EConditions takes nothing returns boolean
    return (((GetSpellAbilityId() == 'A0OJ') or (GetSpellAbilityId() == 'A0OL')))
endfunction
function Trig_C26EActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local unit u2 = GetSpellTargetUnit()
local player user = GetOwningPlayer(u1)
	call SetUnitX(u1,GetUnitX(u2))
	call SetUnitY(u1,GetUnitY(u2))
	call UnitDamageTargetBJ(u1,u2,(100.00+(I2R(GetUnitAbilityLevel(u1,'A0OJ'))*75.00)),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		if(GetSpellAbilityId() == 'A0OJ')then
			call SetPlayerAbilityAvailable(user,'A0OL',true)
			call SetPlayerAbilityAvailable(user,'A0OJ',false)
				call YDWEPolledWaitNull(4.00)
			call SetPlayerAbilityAvailable(user,'A0OL',false)
			call SetPlayerAbilityAvailable(user,'A0OJ',true)
		else
			call SetPlayerAbilityAvailable(user,'A0OL',false)
			call SetPlayerAbilityAvailable(user,'A0OJ',true)
		endif
set u1 = null
set u2 = null
set user = null
endfunction
//===========================================================================
function InitTrig_C26E takes nothing returns nothing
    set gg_trg_C26E = CreateTrigger()
    call TriggerAddCondition(gg_trg_C26E, Condition(function Trig_C26EConditions))
    call TriggerAddAction(gg_trg_C26E, function Trig_C26EActions)
endfunction//===========================================================================
// Trigger: C26R
//===========================================================================
function Trig_C26RConditions takes nothing returns boolean
    return ((GetSpellAbilityId() == 'A0OK'))
endfunction
function Trig_C26RActions takes nothing returns nothing
local unit u1 = GetTriggerUnit()
local effect e = AddSpecialEffectTarget("Abilities\\Weapons\\WitchDoctorMissile\\WitchDoctorMissile.mdl",u1,"head")
		if((GetUnitLifePercent(u1)<=10))then
			call UnitDamageTargetBJ(u1,u1,(GetUnitStateSwap(UNIT_STATE_LIFE,u1)*0.95),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		else
			call UnitDamageTargetBJ(u1,u1,(GetUnitStateSwap(UNIT_STATE_MAX_LIFE,u1)*0.10),ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC)
		endif
	call UnitRemoveBuffsBJ(bj_REMOVEBUFFS_NEGATIVE,u1)
	// ☆技能
	call UnitAddAbility( u1, 'A0OM' )
	call SetUnitAbilityLevel(u1,'A0OM',GetUnitAbilityLevel(u1,'A0OK'))
	
	call YDWEPolledWaitNull(7.50)
	
	call UnitRemoveAbility(u1,'A0OM')
	call UnitRemoveBuffsBJ(bj_REMOVEBUFFS_NEGATIVE,u1)
	call DestroyEffect(e)
set u1 = null
set e = null
endfunction
//===========================================================================
function InitTrig_C26R takes nothing returns nothing
    set gg_trg_C26R = CreateTrigger()
    call TriggerAddCondition(gg_trg_C26R, Condition(function Trig_C26RConditions))
    call TriggerAddAction(gg_trg_C26R, function Trig_C26RActions)
endfunction//===========================================================================
// Trigger: C26T
//===========================================================================
//================C26T Tri N.04==================
function Trig_C26T_Timer_Play3 takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u =	LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local unit u2 =	LoadUnitHandle(YDHT, h2i, 0xA3098AE2)
local integer	level =	GetUnitAbilityLevel(u, 'A0OV')
local real r1 = ( 30.00 + ( 30.00 * I2R(level) ) )
local real r2 = ( 50.00 + ( 50.00 * I2R(level) ) )
local real x = GetUnitX(u2)
local real y = GetUnitY(u2)
local player p = GetOwningPlayer(u)
local unit ydl_unit
	//clean
	call FlushChildHashtable(YDHT, h2i)
	call DestroyTimer(t)
	//effect
	call DestroyEffect( AddSpecialEffect("Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl",x,y) )
	call DestroyEffect( AddSpecialEffect("war3mapImported\\judgementtarget.mdx",x,y) )
	//dmg
	call GroupEnumUnitsInRange(udg_Group[8], x, y, 250.00, null)
	    loop
	    set ydl_unit = FirstOfGroup(udg_Group[8])
	    exitwhen ydl_unit == null
	        call GroupRemoveUnit(udg_Group[8], ydl_unit)
	        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false then
	        	//單位擁有魔法免疫->傷害加深
	            if(IsUnitType(ydl_unit,UNIT_TYPE_MAGIC_IMMUNE)==false) then 
		            call UnitDamageTarget(u, ydl_unit, r2, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNKNOWN, WEAPON_TYPE_WHOKNOWS) 
			    else
			    	call UnitDamageTarget(u, ydl_unit, r1, true, false, ATTACK_TYPE_NORMAL, DAMAGE_TYPE_UNKNOWN, WEAPON_TYPE_WHOKNOWS) 
	            endif
	            
	        else
	        endif
	    endloop
	    
set ydl_unit	=	null
set u = null
set u2 = null
set t = null
set p = null
endfunction
//================C26T Tri N.02==================
function Trig_C26T_Timer_Play takes nothing returns nothing
local timer t = GetExpiredTimer()
local integer h2i = GetHandleId(t)
local unit u =	LoadUnitHandle(YDHT, h2i, 0xA1614B4D)
local integer i =	LoadInteger(YDHT, h2i, 0xA3098AE2)
local real x = GetUnitX(u)
local real y = GetUnitY(u)
local integer i2 = 0
local unit ydl_unit
local timer t1 
local integer h2i2 
	if (i==3) then
		call FlushChildHashtable(YDHT, h2i)
		call DestroyTimer(t)
	else
		call SaveInteger(YDHT, h2i, 0xA3098AE2, i+1)
		call GroupEnumUnitsInRange(udg_Group[8], x, y, 1000.00, null)
		
		    loop
		    	set ydl_unit = FirstOfGroup(udg_Group[8])
		    	exitwhen (ydl_unit == null) or (i2==3) 
		        call GroupRemoveUnit(udg_Group[8], ydl_unit)
		        
			        if IsUnitType(ydl_unit, UNIT_TYPE_HERO) and GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitAlly(ydl_unit,GetOwningPlayer(u))==false and GetUnitPointValue(ydl_unit) != 1 then 
				        set i2 = i2 + 1 
				        set t1 = CreateTimer()
				        set h2i2 = GetHandleId(t1) 
				        call SaveUnitHandle(YDHT, h2i2, 0xA1614B4D, u)
				        call SaveUnitHandle(YDHT, h2i2, 0xA3098AE2, ydl_unit)
				        call TimerStart(t1, GetRandomReal(0.10, 0.40), false, function Trig_C26T_Timer_Play3) 
			        endif
			        
		    endloop
		    
	endif
	
set u = null
set t = null
set t1 = null
set ydl_unit = null
endfunction
//================C26T Tri N.01==================
function Trig_C26T_STARTActions takes nothing returns nothing
local timer t = CreateTimer()
local integer h2i = GetHandleId(t)
local unit u = GetTriggerUnit()
local real x = GetUnitX(u)
local real y = GetUnitY(u)
local player p = GetOwningPlayer(u)
local unit u3 = CreateUnit(p,'h01E', x , y ,0)
local unit ydl_unit
	//破除周圍正面Buff
    call UnitApplyTimedLife(u3,'BHwe',2.00)
    call UnitAddAbility(u3,'A0QF')
    call IssuePointOrder(u3,"dispel",x,y)
    
	//特效
	call GroupEnumUnitsInRange(udg_Group[8], x, y, 550.00, null)
	
	    loop
	    	set ydl_unit = FirstOfGroup(udg_Group[8])
	    	exitwhen ydl_unit == null
	        call GroupRemoveUnit(udg_Group[8], ydl_unit)
	        
		        if GetUnitState(ydl_unit, UNIT_STATE_LIFE) > 0 and IsUnitEnemy(ydl_unit,p) and IsUnitType(ydl_unit,UNIT_TYPE_MECHANICAL)==false and IsUnitType(ydl_unit,UNIT_TYPE_STRUCTURE)==false and GetUnitPointValue(ydl_unit) != 1 then
			        call DestroyEffect( AddSpecialEffectTarget("Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl",ydl_unit,"origin") ) 
		        endif
		        
	    endloop
	    
    call SaveUnitHandle(YDHT, h2i, 0xA1614B4D, u)
    call SaveInteger(YDHT, h2i, 0xA3098AE2, 0)
    call TimerStart(t, 1.00, true, function Trig_C26T_Timer_Play)
    
set u3 = null 
set t = null
set u = null
set ydl_unit = null
endfunction
function Trig_C26T_STARTConditions takes nothing returns boolean
    if GetSpellAbilityId() == 'A0OV' then
	    call	Trig_C26T_STARTActions()
    endif
    return	false
endfunction
//===========================================================================
function InitTrig_C26T takes nothing returns nothing
    set gg_trg_C26T = CreateTrigger()
    call TriggerAddCondition(gg_trg_C26T, Condition(function Trig_C26T_STARTConditions))
endfunction
//===========================================================================
// Trigger: C27
//===========================================================================
function Trig_C27Actions takes nothing returns nothing
endfunction
//===========================================================================
function InitTrig_C27 takes nothing returns nothing
    set gg_trg_C27 = CreateTrigger()
    call DisableTrigger(gg_trg_C27)
    call TriggerAddAction(gg_trg_C27, function Trig_C27Actions)
endfunction
//===========================================================================
// Trigger: C40
//===========================================================================
function Trig_C40Actions takes nothing returns nothing
    local integer ydl_localvar_step = LoadInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76)
    set ydl_localvar_step = ydl_localvar_step + 3
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xCFDE6C76, ydl_localvar_step)
    call SaveInteger(YDHT, GetHandleId(GetTriggeringTrigger()), 0xECE825E7, ydl_localvar_step)
    call SaveUnitHandle(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step, 0xA1614B4D, udg_A_common_HERO)
    set udg_C40_Hero = udg_A_common_HERO
    call SetPlayerAbilityAvailable( GetOwningPlayer(udg_C40_Hero), 'AEme', false )
    call FlushChildHashtable(YDHT, GetHandleId(GetTriggeringTrigger())*ydl_localvar_step)
endfunction
//===========================================================================
function InitTrig_C40 takes nothing returns nothing
    set gg_trg_C40 = CreateTrigger()
    call DisableTrigger(gg_trg_C40)
    call TriggerAddAction(gg_trg_C40, function Trig_C40Actions)
endfunction
//===========================================================================
// Trigger: 哈希初始化
//===========================================================================
function Trig________________uActions takes nothing returns nothing
    set udg_A28_H = InitHashtable()
    set udg_A36_H = InitHashtable()
    set udg_B07_H = InitHashtable()
    set udg_C18_H = InitHashtable()
    set udg_ROSE_HASH = InitHashtable()
    set udg_mana_bug_H = InitHashtable()
    set udg_Item_H = InitHashtable()
    set udg_Item_H2 = InitHashtable()
    set udg_Trigger_H = InitHashtable()
    set udg_Soul_H = InitHashtable()
endfunction
//===========================================================================
function InitTrig________________u takes nothing returns nothing
    set gg_trg________________u = CreateTrigger()
    call TriggerRegisterTimerEventSingle( gg_trg________________u, 0.00 )
    call TriggerAddAction(gg_trg________________u, function Trig________________uActions)
endfunction
//===========================================================================
// Trigger: Game Start
//
// time_s = 秒
// time_m = 分
// time_h = 小时
//===========================================================================
function Trig_Game_StartActions takes nothing returns nothing
    local integer ydul_i
    // 復活時間設定
    set udg_S02_revival_time[0] = 2.00
    set udg_S02_revival_time[1] = 4.00
    set udg_S02_revival_time[2] = 7.00
    set udg_S02_revival_time[3] = 11.00
    set udg_S02_revival_time[4] = 15.00
    set udg_S02_revival_time[5] = 19.00
    set udg_S02_revival_time[6] = 23.00
    set udg_S02_revival_time[7] = 28.00
    set udg_S02_revival_time[8] = 33.00
    set udg_S02_revival_time[9] = 38.00
    set udg_S02_revival_time[10] = 43.00
    set udg_S02_revival_time[11] = 48.00
    set udg_S02_revival_time[12] = 54.00
    set udg_S02_revival_time[13] = 59.00
    set udg_S02_revival_time[14] = 65.00
    set udg_S02_revival_time[15] = 71.00
    set udg_S02_revival_time[16] = 77.00
    set udg_S02_revival_time[17] = 81.00
    set udg_S02_revival_time[18] = 87.00
    set udg_S02_revival_time[19] = 93.00
    // 紀錄玩家名稱
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_real_name[GetForLoopIndexA()] = GetPlayerName(ConvertedPlayer(GetForLoopIndexA()))
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // HIGH模式 是否要歸死亡不扣錢判斷
    set udg_die_money = 1
    // 玩家賞金初始化
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 12
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        // 玩家金錢
        call SetPlayerState( ConvertedPlayer(GetForLoopIndexA()), PLAYER_STATE_GIVES_BOUNTY, 1 )
        set udg_S11_Money_Number[GetForLoopIndexA()] = 300
        call SetPlayerStateBJ( ConvertedPlayer(GetForLoopIndexA()), PLAYER_STATE_RESOURCE_GOLD, 1500 )
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 每秒犒賞
    set udg_Pay_money = 6
    set udg_Pay_Money2 = 6
    // 玩家色碼顏色
    set udg_S03_color_of_players[1] = "|c00FF0000"
    set udg_S03_color_of_players[2] = "|c000000FF"
    set udg_S03_color_of_players[3] = "|c0040E0D0"
    set udg_S03_color_of_players[4] = "|c00800080"
    set udg_S03_color_of_players[5] = "|c00FFFF00"
    set udg_S03_color_of_players[6] = "|c00FFA500"
    set udg_S03_color_of_players[7] = "|c0000FF00"
    set udg_S03_color_of_players[8] = "|c00FF00FF"
    set udg_S03_color_of_players[9] = "|c00C0C0C0"
    set udg_S03_color_of_players[10] = "|c00ADD8E6"
    set udg_S03_color_of_players[11] = "|c00006400"
    set udg_S03_color_of_players[12] = "|c00A52A2A"
    // ---------------------------------------------
    // 一些會用到的東西
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 10
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_N01_name3[GetForLoopIndexA()] = GetPlayerName(ConvertedPlayer(GetForLoopIndexA()))
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 倉庫
    set udg_S16_U[1] = gg_unit_hvlt_0017
    set udg_S16_U[2] = gg_unit_hvlt_0018
    set udg_S16_U[3] = gg_unit_hvlt_0019
    set udg_S16_U[4] = gg_unit_hvlt_0020
    set udg_S16_U[5] = gg_unit_hvlt_0021
    set udg_S16_U[6] = gg_unit_hvlt_0367
    set udg_S16_U[7] = gg_unit_hvlt_0368
    set udg_S16_U[8] = gg_unit_hvlt_0369
    set udg_S16_U[9] = gg_unit_hvlt_0370
    set udg_S16_U[10] = gg_unit_hvlt_0371
    // 1～10 玩家設定
    set ydul_i = 1
    loop
        exitwhen ydul_i > 10
        // 自動圈選系統
        call SetPlayerAbilityAvailableBJ( false, 'A0X6', ConvertedPlayer(ydul_i) )
        // 計分版系統
        call UnitAddAbility( udg_S16_U[ydul_i], 'A0XT' )
        call UnitAddAbility( udg_S16_U[ydul_i], 'A0XU' )
        call SetPlayerAbilityAvailable( ConvertedPlayer(ydul_i), 'A0XU', false )
        // 禁言系統
        set udg_AbilityAvailable[ydul_i] = CreateUnit(ConvertedPlayer(ydul_i), 'h006', 3108.00, 8659.00, 0)
        set ydul_i = ydul_i + 1
    endloop
    // 靈魂系統
    set udg_item_pool = CreateItemPool()
    call ItemPoolAddItemType( udg_item_pool, 'rdis', 2.00 )
    call ItemPoolAddItemType( udg_item_pool, 'rre1', 10.00 )
    call ItemPoolAddItemType( udg_item_pool, 'rres', 15.00 )
    call ItemPoolAddItemType( udg_item_pool, 'rhe1', 50.00 )
    // 設定圖示變數
    set udg_S12_Picture[222] = "ReplaceableTextures\\CommandButtons\\BTNBanditMage.blp"
    set udg_S12_Picture[225] = "ReplaceableTextures\\CommandButtons\\BTNArthas.blp"
    set udg_S12_Picture[232] = "ReplaceableTextures\\CommandButtons\\BTNPandarenBrewmaster.blp"
    set udg_S12_Picture[221] = "ReplaceableTextures\\CommandButtons\\BTNHeroDeathKnight.blp"
    set udg_S12_Picture[213] = "ReplaceableTextures\\CommandButtons\\BTNHeroYoshimotoImagawa.blp"
    set udg_S12_Picture[233] = "ReplaceableTextures\\CommandButtons\\btnheroisehime.blp"
    set udg_S12_Picture[223] = "ReplaceableTextures\\CommandButtons\\BTNGarithos.blp"
    set udg_S12_Picture[113] = "ReplaceableTextures\\CommandButtons\\btnheronene.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[226] = "ReplaceableTextures\\CommandButtons\\BTNShaman.blp"
    set udg_S12_Picture[230] = "ReplaceableTextures\\CommandButtons\\BTNBeastMaster.blp"
    set udg_S12_Picture[224] = "ReplaceableTextures\\CommandButtons\\BTNHeroDeathKnight2.blp"
    set udg_S12_Picture[236] = "ReplaceableTextures\\CommandButtons\\BTNTauren.blp"
    set udg_S12_Picture[219] = "replaceabletextures\\commandbuttons\\btnherochiyomemochizuki.blp"
    set udg_S12_Picture[227] = "ReplaceableTextures\\CommandButtons\\BTNBansheeRanger.blp"
    set udg_S12_Picture[203] = "ReplaceableTextures\\CommandButtons\\BTNThrall.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[135] = "ReplaceableTextures\\CommandButtons\\btn_a35hero.blp"
    set udg_S12_Picture[122] = "ReplaceableTextures\\CommandButtons\\BTNHeroFarseer.blp"
    set udg_S12_Picture[125] = "ReplaceableTextures\\CommandButtons\\BTNShadowHunter.blp"
    set udg_S12_Picture[121] = "replaceabletextures\\commandbuttons\\btnhumanmage.blp"
    set udg_S12_Picture[132] = "ReplaceableTextures\\CommandButtons\\BTNChaosWarlock.blp"
    set udg_S12_Picture[120] = "ReplaceableTextures\\CommandButtons\\BTNHeroBloodElfPrince.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[126] = "ReplaceableTextures\\CommandButtons\\BTNJaina.blp"
    set udg_S12_Picture[136] = "ReplaceableTextures\\CommandButtons\\BTNForestTroll.blp"
    set udg_S12_Picture[119] = "ReplaceableTextures\\CommandButtons\\BTNHeroPaladin.blp"
    set udg_S12_Picture[133] = "ReplaceableTextures\\CommandButtons\\BTNHeadHunterBerserker.blp"
    set udg_S12_Picture[116] = "ReplaceableTextures\\CommandButtons\\BTNArcher.blp"
    set udg_S12_Picture[117] = "ReplaceableTextures\\CommandButtons\\BTNHero01.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[325] = "ReplaceableTextures\\CommandButtons\\BTNHeroTinker.blp"
    set udg_S12_Picture[322] = "ReplaceableTextures\\CommandButtons\\BTNDranaiAkama.blp"
    set udg_S12_Picture[323] = "ReplaceableTextures\\CommandButtons\\BTNZombie.blp"
    set udg_S12_Picture[314] = "ReplaceableTextures\\CommandButtons\\BTNDruidOfTheClaw.blp"
    set udg_S12_Picture[315] = "ReplaceableTextures\\CommandButtons\\BTNSpellBreaker.blp"
    set udg_S12_Picture[309] = "ReplaceableTextures\\CommandButtons\\BTNHero02.blp"
    set udg_S12_Picture[313] = "ReplaceableTextures\\CommandButtons\\BTNHero11.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[210] = "ReplaceableTextures\\CommandButtons\\BTNChaosWarlord.blp"
    set udg_S12_Picture[216] = "ReplaceableTextures\\CommandButtons\\BTNHeroTaurenChieftain.blp"
    set udg_S12_Picture[218] = "ReplaceableTextures\\CommandButtons\\BTNKeeperOfTheGrove.blp"
    set udg_S12_Picture[205] = "ReplaceableTextures\\CommandButtons\\BTNFurion.blp"
    set udg_S12_Picture[231] = "ReplaceableTextures\\CommandButtons\\BTNSatyrTrickster.blp"
    set udg_S12_Picture[228] = "ReplaceableTextures\\CommandButtons\\BTNLichVersion2.blp"
    set udg_S12_Picture[204] = "ReplaceableTextures\\CommandButtons\\BTNHero17.blp"
    // ------------------------------------------------------------------------------
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[215] = "ReplaceableTextures\\CommandButtons\\BTNRevenant.blp"
    set udg_S12_Picture[212] = "ReplaceableTextures\\CommandButtons\\BTNHero16.blp"
    set udg_S12_Picture[207] = "ReplaceableTextures\\CommandButtons\\BTNMedivh.blp"
    set udg_S12_Picture[240] = "ReplaceableTextures\\CommandButtons\\btnherokanetsugunaoe.blp"
    set udg_S12_Picture[202] = "ReplaceableTextures\\CommandButtons\\BTNHero09.blp"
    // ------------------------------------------------------------------------------
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[206] = "ReplaceableTextures\\CommandButtons\\BTNHero12.blp"
    set udg_S12_Picture[234] = "ReplaceableTextures\\CommandButtons\\BTNHeroArchMage.blp"
    set udg_S12_Picture[217] = "ReplaceableTextures\\CommandButtons\\BTNKnight.blp"
    set udg_S12_Picture[208] = "ReplaceableTextures\\CommandButtons\\BTNHero06.blp"
    set udg_S12_Picture[229] = "ReplaceableTextures\\CommandButtons\\BTNDemoness.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[211] = "ReplaceableTextures\\CommandButtons\\BTNHeroKikuhime.blp"
    set udg_S12_Picture[201] = "ReplaceableTextures\\CommandButtons\\BTNHero21.blp"
    set udg_S12_Picture[214] = "ReplaceableTextures\\CommandButtons\\BTNNinja!.blp"
    set udg_S12_Picture[214] = "ReplaceableTextures\\CommandButtons\\BTNNinja!.blp"
    set udg_S12_Picture[128] = "ReplaceableTextures\\CommandButtons\\BTNMilitia.blp"
    // ------------------------------------------------------------------------------
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[106] = "ReplaceableTextures\\CommandButtons\\BTNFelGuard.blp"
    set udg_S12_Picture[131] = "ReplaceableTextures\\CommandButtons\\BTNChaosGrom.blp"
    set udg_S12_Picture[109] = "ReplaceableTextures\\CommandButtons\\BTNGuldan.blp"
    set udg_S12_Picture[107] = "ReplaceableTextures\\CommandButtons\\BTNHero03.blp"
    set udg_S12_Picture[103] = "ReplaceableTextures\\CommandButtons\\BTNDruidOfTheTalon.blp"
    // ------------------------------------------------------------------------------
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[104] = "ReplaceableTextures\\CommandButtons\\btnheroshigeharutakenaka.blp"
    set udg_S12_Picture[134] = "ReplaceableTextures\\CommandButtons\\BTNDoomGuard.blp"
    set udg_S12_Picture[114] = "ReplaceableTextures\\CommandButtons\\BTNRifleman.blp"
    set udg_S12_Picture[111] = "ReplaceableTextures\\CommandButtons\\BTNHero14.blp"
    set udg_S12_Picture[112] = "replaceabletextures\\commandbuttons\\btnherotoshiiemaeda.blp"
    set udg_S12_Picture[127] = "ReplaceableTextures\\CommandButtons\\BTNChaosWolfRider.blp"
    // ------------------------------------------------------------------------------
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[108] = "ReplaceableTextures\\CommandButtons\\BTNChaosGrunt.blp"
    set udg_S12_Picture[105] = "ReplaceableTextures\\CommandButtons\\BTNHeroPaladin2.blp"
    set udg_S12_Picture[123] = "replaceabletextures\\commandbuttons\\btnheroranmarumori.blp"
    set udg_S12_Picture[115] = "ReplaceableTextures\\CommandButtons\\btnheroyoshitakakuroda.blp"
    set udg_S12_Picture[130] = "ReplaceableTextures\\CommandButtons\\BTNHellScream.blp"
    set udg_S12_Picture[101] = "ReplaceableTextures\\CommandButtons\\BTNProudMoore.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[102] = "ReplaceableTextures\\CommandButtons\\BTNSylvanusWindrunner.blp"
    set udg_S12_Picture[129] = "ReplaceableTextures\\CommandButtons\\BTNIceTrollShadowPriest.blp"
    set udg_S12_Picture[118] = "ReplaceableTextures\\CommandButtons\\BTNHeroNouhime.blp"
    set udg_S12_Picture[110] = "ReplaceableTextures\\CommandButtons\\BTNKelThuzad.blp"
    set udg_S12_Picture[124] = "ReplaceableTextures\\CommandButtons\\BTNChaosBlademaster.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[326] = "ReplaceableTextures\\CommandButtons\\BTNSpiritWalker.blp"
    set udg_S12_Picture[303] = "ReplaceableTextures\\CommandButtons\\BTNPriestessOfTheMoon.blp"
    set udg_S12_Picture[318] = "ReplaceableTextures\\CommandButtons\\BTNHeroMuneshigeTachibana.blp"
    set udg_S12_Picture[316] = "ReplaceableTextures\\CommandButtons\\BTNAvengingWatcher.blp"
    // ------------------------------------------------------------------------------
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[310] = "ReplaceableTextures\\CommandButtons\\BTNHero07.blp"
    set udg_S12_Picture[306] = "ReplaceableTextures\\CommandButtons\\BTNHeroMatsuhime.blp"
    set udg_S12_Picture[304] = "ReplaceableTextures\\CommandButtons\\BTNAcolyte.blp"
    set udg_S12_Picture[307] = "ReplaceableTextures\\CommandButtons\\BTNEvilIllidan.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[305] = "ReplaceableTextures\\CommandButtons\\BTNHeroOichi.blp"
    set udg_S12_Picture[312] = "ReplaceableTextures\\CommandButtons\\BTNSorceress.blp"
    set udg_S12_Picture[317] = "ReplaceableTextures\\CommandButtons\\BTNHeroDemonHunter.blp"
    set udg_S12_Picture[311] = "ReplaceableTextures\\CommandButtons\\BTNHeroMountainKing.blp"
    set udg_S12_Picture[301] = "ReplaceableTextures\\CommandButtons\\BTNTichondrius.blp"
    set udg_S12_Picture[302] = "ReplaceableTextures\\CommandButtons\\BTNArchimonde.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[320] = "ReplaceableTextures\\CommandButtons\\BTNHeroKojiroSasaki.blp"
    set udg_S12_Picture[324] = "ReplaceableTextures\\CommandButtons\\BTNHeroMuneyosiYagyu.blp"
    set udg_S12_Picture[319] = "ReplaceableTextures\\CommandButtons\\BTNHeroMusashiMiyamoto.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[235] = "ReplaceableTextures\\CommandButtons\\BTNDeepLordRevenant.blp"
    // ------------------------------------------------------------------------------
    set udg_S12_Picture[220] = "ReplaceableTextures\\CommandButtons\\BTNSkeletonMage.blp"
    set udg_S12_Picture[380] = "ReplaceableTextures\\CommandButtons\\BTNHuntress.blp"
    set udg_S12_Picture[340] = "ReplaceableTextures\\CommandButtons\\BTNTreeOfEternity.blp"
    set udg_S12_Picture[327] = "ReplaceableTextures\\CommandButtons\\BTNRockGolem.blp"
    // ------------------------------------------------------------------------------
endfunction
//===========================================================================
function InitTrig_Game_Start takes nothing returns nothing
    set gg_trg_Game_Start = CreateTrigger()
    call TriggerAddAction(gg_trg_Game_Start, function Trig_Game_StartActions)
endfunction
//===========================================================================
// Trigger: F9
//===========================================================================
function Trig_F9Actions takes nothing returns nothing
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_1739", "TRIGSTR_11851", "ReplaceableTextures\\CommandButtons\\BTNSpy.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_11874", "TRIGSTR_662", "ReplaceableTextures\\CommandButtons\\BTNTome.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_REQ_DISCOVERED, "TRIGSTR_11877", "TRIGSTR_668", "ReplaceableTextures\\CommandButtons\\BTNStarWand.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_OPT_DISCOVERED, "TRIGSTR_11879", "TRIGSTR_11887", "ReplaceableTextures\\CommandButtons\\BTNSentryWard.blp" )
    call CreateQuestBJ( bj_QUESTTYPE_OPT_DISCOVERED, "TRIGSTR_11893", "TRIGSTR_11915", "ReplaceableTextures\\CommandButtons\\BTNDarkSummoning.blp" )
    call DestroyTrigger(GetTriggeringTrigger())
endfunction
//===========================================================================
function InitTrig_F9 takes nothing returns nothing
    set gg_trg_F9 = CreateTrigger()
    call TriggerAddAction(gg_trg_F9, function Trig_F9Actions)
endfunction
//===========================================================================
// Trigger: JASS INIT
//===========================================================================
globals
rect gg_rct_FU_Commotion_A=null
rect gg_rct_FU_Commotion_B01=null
rect gg_rct_FU_Commotion_B02=null
rect gg_rct_FU_Commotion_B03=null
rect gg_rct_FU_Commotion_B04=null
rect gg_rct_FU_Commotion_B05=null
rect gg_rct_FU_Commotion_B06=null
rect gg_rct_FU_Commotion_B07=null
rect gg_rct_FU_Commotion_B08=null
rect gg_rct_FU_Commotion_B09=null
rect gg_rct_FU_Commotion_B10=null
rect gg_rct_FU_Commotion_B11=null
rect gg_rct_FU_D_Trun=null
rect gg_rct_FU_U_Trun=null
rect gg_rct_FU_BarBQ_A=null
rect gg_rct_FU_BarBQ_B=null
///////////////////////////////////////////
//             rose tool
///////////////////////////////////////////
integer rose_integer=0
real rose_real=0
unit array rose_unit
unit array hero
player rose_p = null
boolean rose_b = false
///////////////////////////////////////////
endglobals	
function Trig_JASS_INITActions takes nothing returns nothing
local integer i = 1
//point
set gg_rct_FU_Commotion_A=Rect(-1184.0,-1056.0,-576.0,-448.0)
set gg_rct_FU_D_Trun=Rect(-6592.0,-6400.0,-6016.0,-5920.0)
set gg_rct_FU_U_Trun=Rect(5472.0,5632.0,6144.0,6240.0)	
set gg_rct_FU_Commotion_B01=Rect(-4064.0,-2912.0,-3456.0,-2304.0)
set gg_rct_FU_Commotion_B02=Rect(3136.0,3168.0,3872.0,3936.0)
set gg_rct_FU_Commotion_B03=Rect(6432.0,6336.0,6784.0,6560.0)
set gg_rct_FU_Commotion_B04=Rect(-128.0,32.0,160.0,352.0)
set gg_rct_FU_Commotion_B05=Rect(-6848.0,-6944.0,-6528.0,-6528.0)
set gg_rct_FU_Commotion_B06=Rect(4512.0,7552.0,4736.0,7840.0)
set gg_rct_FU_Commotion_B07=Rect(-384.0,320.0,-96.0,608.0)
set gg_rct_FU_Commotion_B08=Rect(-5568.0,-8032.0,-5248.0,-7744.0)
set gg_rct_FU_Commotion_B09=Rect(6144.0,6368.0,6432.0,6656.0)
set gg_rct_FU_Commotion_B10=Rect(-2144.0,-1376.0,-1824.0,-992.0)
set gg_rct_FU_Commotion_B11=Rect(-7200.0,-6912.0,-6848.0,-6688.0)
//出生點
set gg_rct_FU_BarBQ_A=Rect(7008.0, - 7584.0, 7296.0, - 7296.0)
set gg_rct_FU_BarBQ_B=Rect(- 7392.0, 6944.0, - 7104.0, 7232.0)
// 兩軍基準點
set udg_X_Point[3] = GetRectCenter(gg_rct_FU_BarBQ_A)
set udg_X_Point[4] = GetRectCenter(gg_rct_FU_BarBQ_B)
set udg_X_Point[11]=GetRectCenter(gg_rct_FU_U_Trun)
set udg_X_Point[12]=GetRectCenter(gg_rct_FU_Commotion_A)
set udg_X_Point[13]=GetRectCenter(gg_rct_FU_D_Trun)
//百姓暴動
set udg_X_Point[40]=GetRectCenter(gg_rct_FU_Commotion_B01)
set udg_X_Point[41]=GetRectCenter(gg_rct_FU_Commotion_B02)
set udg_X_Point[42]=GetRectCenter(gg_rct_FU_Commotion_B03)
set udg_X_Point[43]=GetRectCenter(gg_rct_FU_Commotion_B04)
set udg_X_Point[44]=GetRectCenter(gg_rct_FU_Commotion_B05)
set udg_X_Point[45]=GetRectCenter(gg_rct_FU_Commotion_B06)
set udg_X_Point[46]=GetRectCenter(gg_rct_FU_Commotion_B07)
set udg_X_Point[47]=GetRectCenter(gg_rct_FU_Commotion_B08)
set udg_X_Point[48]=GetRectCenter(gg_rct_FU_Commotion_B09)
set udg_X_Point[49]=GetRectCenter(gg_rct_FU_Commotion_B10)
set udg_X_Point[50]=GetRectCenter(gg_rct_FU_Commotion_B11)	
endfunction
//===========================================================================
function InitTrig_JASS_INIT takes nothing returns nothing
    set gg_trg_JASS_INIT = CreateTrigger()
    call TriggerAddAction(gg_trg_JASS_INIT, function Trig_JASS_INITActions)
endfunction
//===========================================================================
// Trigger: Point Init
//
// 9 10  11
// 9 10  11 進攻點 
//===========================================================================
function Trig_Point_InitActions takes nothing returns nothing
    // 織田軍路線
    set udg_S20_Point[1] = GetRectCenter(gg_rct_ADS)
    set udg_S20_Point[2] = GetRectCenter(gg_rct_AMS)
    set udg_S20_Point[3] = GetRectCenter(gg_rct_AUS)
    set udg_S20_Point[8] = GetRectCenter(gg_rct_BL)
    // 聯合軍路線
    set udg_S20_Point[4] = GetRectCenter(gg_rct_BDS)
    set udg_S20_Point[5] = GetRectCenter(gg_rct_BMS)
    set udg_S20_Point[6] = GetRectCenter(gg_rct_BUS)
    set udg_S20_Point[7] = GetRectCenter(gg_rct_AL)
    // 中間
    set udg_S20_Point[9] = GetRectCenter(gg_rct_DM)
    set udg_S20_Point[10] = GetRectCenter(gg_rct__________2)
    set udg_S20_Point[11] = GetRectCenter(gg_rct_UM)
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 11
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_X[GetForLoopIndexA()] = GetLocationX(udg_S20_Point[GetForLoopIndexA()])
        set udg_Y[GetForLoopIndexA()] = GetLocationY(udg_S20_Point[GetForLoopIndexA()])
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    set bj_forLoopAIndex = 1
    set bj_forLoopAIndexEnd = 3
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_Angel[GetForLoopIndexA()] = AngleBetweenPoints(udg_S20_Point[GetForLoopIndexA()], udg_S20_Point[( GetForLoopIndexA() + 8 )])
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    set bj_forLoopAIndex = 4
    set bj_forLoopAIndexEnd = 6
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_Angel[GetForLoopIndexA()] = AngleBetweenPoints(udg_S20_Point[GetForLoopIndexA()], udg_S20_Point[( GetForLoopIndexA() + 5 )])
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 巡邏番頭
    set udg_S20_Point[51] = GetRectCenter(gg_rct_FU_Walk_Around_A1)
    set udg_S20_Point[52] = GetRectCenter(gg_rct_FU_Walk_Around_A2)
    set udg_S20_Point[53] = GetRectCenter(gg_rct_FU_Walk_Around_A3)
    set udg_S20_Point[54] = GetRectCenter(gg_rct_FU_Walk_Around_A4)
    set udg_S20_Point[61] = GetRectCenter(gg_rct_FU_Walk_Around_B1)
    set udg_S20_Point[62] = GetRectCenter(gg_rct_FU_Walk_Around_B2)
    set udg_S20_Point[63] = GetRectCenter(gg_rct_FU_Walk_Around_B3)
    set udg_S20_Point[64] = GetRectCenter(gg_rct_FU_Walk_Around_B4)
    set bj_forLoopAIndex = 51
    set bj_forLoopAIndexEnd = 54
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_X[GetForLoopIndexA()] = GetLocationX(udg_S20_Point[GetForLoopIndexA()])
        set udg_Y[GetForLoopIndexA()] = GetLocationY(udg_S20_Point[GetForLoopIndexA()])
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    set bj_forLoopAIndex = 61
    set bj_forLoopAIndexEnd = 64
    loop
        exitwhen bj_forLoopAIndex > bj_forLoopAIndexEnd
        set udg_X[GetForLoopIndexA()] = GetLocationX(udg_S20_Point[GetForLoopIndexA()])
        set udg_Y[GetForLoopIndexA()] = GetLocationY(udg_S20_Point[GetForLoopIndexA()])
        set bj_forLoopAIndex = bj_forLoopAIndex + 1
    endloop
    // 商店
endfunction
//===========================================================================
function InitTrig_Point_Init takes nothing returns nothing
    set gg_trg_Point_Init = CreateTrigger()
    call TriggerAddAction(gg_trg_Point_Init, function Trig_Point_InitActions)
endfunction
//===========================================================================
function InitCustomTriggers takes nothing returns nothing
    call InitTrig_TIME_TEST( )
    call InitTrig_SL_System( )
    call InitTrig_Kick_sys_A( )
    call InitTrig_Kick_sys_B( )
    call InitTrig_Player_Name_Init( )
    call InitTrig_Player_VIP_Check( )
    call InitTrig_Player_Name_System( )
    call InitTrig_Auto_Choose_System( )
    call InitTrig_Surrender_Init( )
    call InitTrig_Surrender_vote_for_A( )
    call InitTrig_Surrender_vote_for_A_2( )
    call InitTrig_Surrender_vote_for_A_3( )
    call InitTrig_Surrender_vote_for_B( )
    call InitTrig_Surrender_vote_for_B_2( )
    call InitTrig_Surrender_vote_for_B_3( )
    call InitTrig_RP( )
    call InitTrig_MulitiBoard_Init( )
    call InitTrig_Player_Leave( )
    call InitTrig_GetPlayerNumber( )
    call InitTrig_Random_Hero( )
    call InitTrig_CRAZY( )
    call InitTrig_AH_Mode( )
    call InitTrig_Select_Hero( )
    call InitTrig_Hero_Init( )
    call InitTrig_Hero_Pool_Init( )
    call InitTrig_Delete_Delete_time1_time2( )
    call InitTrig_Get_last_selected_unit( )
    call InitTrig_LV( )
    call InitTrig_GOLD( )
    call InitTrig_CD( )
    call InitTrig_HM( )
    call InitTrig_HKETEST( )
    call InitTrig_new_fast( )
    call InitTrig_new_rs( )
    call InitTrig_AH_TEST( )
    call InitTrig_CR_TEST( )
    call InitTrig_ESC_______u( )
    call InitTrig_test_AI( )
    call InitTrig_itt_pool_init( )
    call InitTrig_itt_init( )
    call InitTrig_DMG( )
    call InitTrig_DEAD( )
    call InitTrig_test_init( )
    call InitTrig_Check_Stop( )
    call InitTrig_Prize2s( )
    call InitTrig_Prize150s( )
    call InitTrig_End_Game_A( )
    call InitTrig_End_Game_B( )
    call InitTrig_Tower_be_Destoried( )
    call InitTrig_Die_Basic_Guards( )
    call InitTrig_Die_Advanced_Guards( )
    call InitTrig_Barracks_are_Destoried( )
    call InitTrig_Game_OverA( )
    call InitTrig_Game_OverB( )
    call InitTrig_boom( )
    call InitTrig_Castle_Anti_Magic( )
    call InitTrig_Walk_around_Initi( )
    call InitTrig_Walk_around( )
    call InitTrig_Army_Turn_MO_OB( )
    call InitTrig_Army_Turn_Normal( )
    call InitTrig_Army_Born_01( )
    call InitTrig_Army_Born_02( )
    call InitTrig_Army_Born_03( )
    call InitTrig_Army_Born_01_OB( )
    call InitTrig_Army_Born_02__OB( )
    call InitTrig_Army_Born_03__OB( )
    call InitTrig_Army_Born_01_MO( )
    call InitTrig_Army_Born_02__MO( )
    call InitTrig_Army_Born_03__MO( )
    call InitTrig_Army( )
    call InitTrig_Upgrades_01( )
    call InitTrig_Upgrades_02( )
    call InitTrig_Upgrades_03( )
    call InitTrig_0S( )
    call InitTrig_5S( )
    call InitTrig_15S( )
    call InitTrig_50S( )
    call InitTrig_1200S( )
    call InitTrig_CP_revival_init( )
    call InitTrig_CP_revival_start( )
    call InitTrig_Boss_die( )
    call InitTrig_Boss_Walk( )
    call InitTrig_Commotion_A( )
    call InitTrig_Commotion_A_spawn( )
    call InitTrig_Commotion_B( )
    call InitTrig_Anti_Team_Attack( )
    call InitTrig_Anti_Exit_Map( )
    call InitTrig_No_HotSpring_A( )
    call InitTrig_No_HotSpring_B( )
    call InitTrig_Game_Init( )
    call InitTrig_Player_Unit_Dead( )
    call InitTrig_Computer_Unit_Dead( )
    call InitTrig_Hero_Unit_Dead( )
    call InitTrig_Hero_Demaged( )
    call InitTrig_KnockBack( )
    call InitTrig_DooConv( )
    call InitTrig_AUD_UP( )
    call InitTrig_AUD_Group( )
    call InitTrig_AUD_GUI( )
    call InitTrig_ChainAbility( )
    call InitTrig_illegal( )
    call InitTrig_AMH( )
    call InitTrig_MH( )
    call InitTrig_MH_UP( )
    call InitTrig_AMH_DEBUG( )
    call InitTrig_init_OB( )
    call InitTrig_Observer_Support( )
    call InitTrig_Tactics_Init( )
    call InitTrig_thirty_seconds_before_tactic_MP_recover( )
    call InitTrig_Click( )
    call InitTrig_MO( )
    call InitTrig_HIGH( )
    call InitTrig_SM( )
    call InitTrig_NEW( )
    call InitTrig_Hero_Spell_Item_Ability( )
    call InitTrig_Unit_Drop_or_Sell_Item( )
    call InitTrig_Unit_Pick_Item( )
    call InitTrig_Unit_Summend( )
    call InitTrig_Unit_Use_Item( )
    call InitTrig_Unit_Spell_Cast( )
    call InitTrig_Unit_Additional_Item_Ability( )
    call InitTrig_Combination_Init_HASH_I( )
    call InitTrig_Combination_Init_HASH_II( )
    call InitTrig_Combination_Core( )
    call InitTrig_Item18A( )
    call InitTrig_Item20B( )
    call InitTrig_Item22B( )
    call InitTrig_Item13_DemageA( )
    call InitTrig_B01T( )
    call InitTrig_B02W( )
    call InitTrig_B02E_R_T( )
    call InitTrig_B03( )
    call InitTrig_B03E_damage( )
    call InitTrig_B03E_kill( )
    call InitTrig_B03R_start( )
    call InitTrig_B04( )
    call InitTrig_B05R_Learn( )
    call InitTrig_B05R( )
    call InitTrig_B06( )
    call InitTrig_B06R( )
    call InitTrig_B07( )
    call InitTrig_B07_Upgrade( )
    call InitTrig_B07E( )
    call InitTrig_B07E_drop( )
    call InitTrig_B07E_die( )
    call InitTrig_B07E_spell( )
    call InitTrig_B07R_learn( )
    call InitTrig_B08( )
    call InitTrig_B08_E( )
    call InitTrig_B08_R_learn( )
    call InitTrig_B08_R_add( )
    call InitTrig_B08_R_reduce_damage( )
    call InitTrig_B10( )
    call InitTrig_B10R_learn( )
    call InitTrig_B10R( )
    call InitTrig_B10T( )
    call InitTrig_B11( )
    call InitTrig_B11D( )
    call InitTrig_B11W( )
    call InitTrig_B11E( )
    call InitTrig_B11_R_learn( )
    call InitTrig_B11_R_start( )
    call InitTrig_B11_R_damage( )
    call InitTrig_B11_T_start( )
    call InitTrig_B11_T_add( )
    call InitTrig_B12( )
    call InitTrig_B12D( )
    call InitTrig_B12D_stop( )
    call InitTrig_B12W( )
    call InitTrig_B12R_learn( )
    call InitTrig_B12R_attack_start( )
    call InitTrig_B12_R_recover( )
    call InitTrig_B13( )
    call InitTrig_B13D( )
    call InitTrig_B13W( )
    call InitTrig_B13R( )
    call InitTrig_B13T( )
    call InitTrig_B14( )
    call InitTrig_B14W( )
    call InitTrig_B14W_attack( )
    call InitTrig_B14E( )
    call InitTrig_B14R( )
    call InitTrig_B14T( )
    call InitTrig_B15E( )
    call InitTrig_B16( )
    call InitTrig_B16W( )
    call InitTrig_B16E( )
    call InitTrig_B16R_learn( )
    call InitTrig_B16R( )
    call InitTrig_B16T_Start( )
    call InitTrig_B17( )
    call InitTrig_B17E( )
    call InitTrig_B17R_learn( )
    call InitTrig_B17R( )
    call InitTrig_B17T( )
    call InitTrig_B18( )
    call InitTrig_B18_Upgrade( )
    call InitTrig_B18W( )
    call InitTrig_B18E( )
    call InitTrig_B18E_HeroDie( )
    call InitTrig_B18R( )
    call InitTrig_B18T( )
    call InitTrig_B19( )
    call InitTrig_B19D_level( )
    call InitTrig_B19D_summon( )
    call InitTrig_B19D_summon_ability_stop( )
    call InitTrig_B19D_summon_ability( )
    call InitTrig_B19D_summon_die( )
    call InitTrig_B19W_learn( )
    call InitTrig_B19W( )
    call InitTrig_B19E( )
    call InitTrig_B19T( )
    call InitTrig_B21( )
    call InitTrig_B21E( )
    call InitTrig_B21R_Upgrade( )
    call InitTrig_B21R( )
    call InitTrig_B21T( )
    call InitTrig_B22( )
    call InitTrig_B22R( )
    call InitTrig_B22T( )
    call InitTrig_B23( )
    call InitTrig_B23E( )
    call InitTrig_B23R( )
    call InitTrig_B24( )
    call InitTrig_B24_W( )
    call InitTrig_B24R( )
    call InitTrig_B24T( )
    call InitTrig_B25( )
    call InitTrig_B25W( )
    call InitTrig_B25E( )
    call InitTrig_B25R_learn( )
    call InitTrig_B25R( )
    call InitTrig_B26( )
    call InitTrig_B26W_learn( )
    call InitTrig_B26W( )
    call InitTrig_B26E_learn( )
    call InitTrig_B26E( )
    call InitTrig_B26R_learn( )
    call InitTrig_B26T( )
    call InitTrig_B27( )
    call InitTrig_B27R_U( )
    call InitTrig_B28( )
    call InitTrig_B28_Upgrade( )
    call InitTrig_B28W( )
    call InitTrig_B28T( )
    call InitTrig_B29( )
    call InitTrig_B29W( )
    call InitTrig_B29E( )
    call InitTrig_B29R( )
    call InitTrig_B30( )
    call InitTrig_B30E( )
    call InitTrig_B30R( )
    call InitTrig_B30R_count( )
    call InitTrig_B30T_learn( )
    call InitTrig_B30T( )
    call InitTrig_B31( )
    call InitTrig_B31D( )
    call InitTrig_B31W( )
    call InitTrig_B31E( )
    call InitTrig_B31_R_enable( )
    call InitTrig_B31T( )
    call InitTrig_B32( )
    call InitTrig_B32W( )
    call InitTrig_B32W_use( )
    call InitTrig_B32E( )
    call InitTrig_B32R_learn( )
    call InitTrig_B32T( )
    call InitTrig_B33( )
    call InitTrig_B33_Hero_lv_up( )
    call InitTrig_B33_D_Learn( )
    call InitTrig_B33_D_add_to_group( )
    call InitTrig_B33_D_remove_from_group( )
    call InitTrig_B33_D_reduce_damage( )
    call InitTrig_B33_W( )
    call InitTrig_B33_E( )
    call InitTrig_B33_R( )
    call InitTrig_B33_R_STOP( )
    call InitTrig_B33_T_start( )
    call InitTrig_B33_T_end( )
    call InitTrig_B34( )
    call InitTrig_B34W( )
    call InitTrig_B34E_cast( )
    call InitTrig_B34E_stop( )
    call InitTrig_B34T_damage( )
    call InitTrig_B35( )
    call InitTrig_B35W( )
    call InitTrig_B35E( )
    call InitTrig_B35R_learn( )
    call InitTrig_B35R_attack( )
    call InitTrig_B35T( )
    call InitTrig_B36( )
    call InitTrig_B36_W_start( )
    call InitTrig_B36W_end( )
    call InitTrig_B36E( )
    call InitTrig_B36R_effect( )
    call InitTrig_B36T( )
    call InitTrig_B37( )
    call InitTrig_B37W( )
    call InitTrig_B37W_move( )
    call InitTrig_B37E( )
    call InitTrig_B37R_learn( )
    call InitTrig_B37R( )
    call InitTrig_B37T_start( )
    call InitTrig_A01( )
    call InitTrig_A01_D_reduce_damage( )
    call InitTrig_A01_W( )
    call InitTrig_A01_E( )
    call InitTrig_A01_R( )
    call InitTrig_A01_T( )
    call InitTrig_A02E( )
    call InitTrig_A03W( )
    call InitTrig_A03R_Learn( )
    call InitTrig_A04( )
    call InitTrig_A04W( )
    call InitTrig_A04W_summend( )
    call InitTrig_A04R_start( )
    call InitTrig_A04T( )
    call InitTrig_A04T_end( )
    call InitTrig_A05( )
    call InitTrig_A05W( )
    call InitTrig_A05_E( )
    call InitTrig_A05_R_learn( )
    call InitTrig_A05_R( )
    call InitTrig_A05_R_2( )
    call InitTrig_A05_T( )
    call InitTrig_A06( )
    call InitTrig_A07( )
    call InitTrig_A07D( )
    call InitTrig_A07R_learn( )
    call InitTrig_A08( )
    call InitTrig_A08R( )
    call InitTrig_A09( )
    call InitTrig_A09D( )
    call InitTrig_A09D_stop( )
    call InitTrig_A09W( )
    call InitTrig_A09E( )
    call InitTrig_A09E_effect( )
    call InitTrig_A09R( )
    call InitTrig_A09T_learn( )
    call InitTrig_A10( )
    call InitTrig_A10W( )
    call InitTrig_A10R_learn( )
    call InitTrig_A10R( )
    call InitTrig_A10T_start( )
    call InitTrig_A11( )
    call InitTrig_A11D( )
    call InitTrig_A11W( )
    call InitTrig_A11E( )
    call InitTrig_A11T( )
    call InitTrig_A12( )
    call InitTrig_A12W_start( )
    call InitTrig_A12W_end( )
    call InitTrig_A12E( )
    call InitTrig_A12R_Learn( )
    call InitTrig_A12R( )
    call InitTrig_A12T( )
    call InitTrig_A13( )
    call InitTrig_A13R( )
    call InitTrig_A13T( )
    call InitTrig_A14W( )
    call InitTrig_A15( )
    call InitTrig_A15R( )
    call InitTrig_A15T( )
    call InitTrig_A16( )
    call InitTrig_A16D( )
    call InitTrig_A16E( )
    call InitTrig_A16R_learn( )
    call InitTrig_A16R_summon( )
    call InitTrig_A16T_start( )
    call InitTrig_A17( )
    call InitTrig_A17E( )
    call InitTrig_A17R( )
    call InitTrig_A17T( )
    call InitTrig_A18( )
    call InitTrig_A18D( )
    call InitTrig_A18E( )
    call InitTrig_A18R( )
    call InitTrig_A18T_Time( )
    call InitTrig_A18T_Demage( )
    call InitTrig_A19( )
    call InitTrig_A19W( )
    call InitTrig_A19E( )
    call InitTrig_A19R( )
    call InitTrig_A20( )
    call InitTrig_A20W( )
    call InitTrig_A20E( )
    call InitTrig_A20R( )
    call InitTrig_A20T( )
    call InitTrig_A20T_creat( )
    call InitTrig_A21( )
    call InitTrig_A21W( )
    call InitTrig_A21R( )
    call InitTrig_A21T( )
    call InitTrig_A22( )
    call InitTrig_A22W( )
    call InitTrig_A22W_learn( )
    call InitTrig_A22W_attack( )
    call InitTrig_A22R( )
    call InitTrig_A22T( )
    call InitTrig_A22T_stop( )
    call InitTrig_A23( )
    call InitTrig_A23W( )
    call InitTrig_A23T_learn( )
    call InitTrig_A23T( )
    call InitTrig_A24( )
    call InitTrig_A24W( )
    call InitTrig_A24W_stop( )
    call InitTrig_A24E( )
    call InitTrig_A24R( )
    call InitTrig_A24T( )
    call InitTrig_A25( )
    call InitTrig_A25_E( )
    call InitTrig_A26( )
    call InitTrig_A26_E( )
    call InitTrig_A26_T( )
    call InitTrig_A27( )
    call InitTrig_A27W( )
    call InitTrig_A27E( )
    call InitTrig_A27T( )
    call InitTrig_A28( )
    call InitTrig_A28W_learn( )
    call InitTrig_A28W_start( )
    call InitTrig_A28E( )
    call InitTrig_A28R( )
    call InitTrig_A28R_attacked( )
    call InitTrig_A29( )
    call InitTrig_A29W( )
    call InitTrig_A29E( )
    call InitTrig_A29R_START( )
    call InitTrig_A29_T( )
    call InitTrig_A30( )
    call InitTrig_A30R( )
    call InitTrig_A30T_learn( )
    call InitTrig_A30T( )
    call InitTrig_A31( )
    call InitTrig_A31E( )
    call InitTrig_A31R( )
    call InitTrig_A31_T_start( )
    call InitTrig_A32( )
    call InitTrig_A32W( )
    call InitTrig_A32E( )
    call InitTrig_A33( )
    call InitTrig_A33W( )
    call InitTrig_A33E_Special( )
    call InitTrig_A33_R_enable( )
    call InitTrig_A33_R__reduce_damage( )
    call InitTrig_A33T( )
    call InitTrig_A34( )
    call InitTrig_A34HERO_D( )
    call InitTrig_A34Hero_cast( )
    call InitTrig_A34_W_start( )
    call InitTrig_A34_E( )
    call InitTrig_A34_R_enable( )
    call InitTrig_A34T_Learn( )
    call InitTrig_A34_T( )
    call InitTrig_A35( )
    call InitTrig_A35_D_count( )
    call InitTrig_A35D( )
    call InitTrig_A35W( )
    call InitTrig_A35W_knock( )
    call InitTrig_A35E( )
    call InitTrig_A35E_PLAY( )
    call InitTrig_A35R( )
    call InitTrig_A35T( )
    call InitTrig_A35T_damage_DD( )
    call InitTrig_A36( )
    call InitTrig_A36E_init( )
    call InitTrig_A36E( )
    call InitTrig_A36_R_resist_damage( )
    call InitTrig_C01( )
    call InitTrig_C01_Hero_LV_UP( )
    call InitTrig_C01W( )
    call InitTrig_C01R_learn( )
    call InitTrig_C01R( )
    call InitTrig_C03( )
    call InitTrig_C03W( )
    call InitTrig_C03E( )
    call InitTrig_C03R( )
    call InitTrig_C03T( )
    call InitTrig_C04W( )
    call InitTrig_C05( )
    call InitTrig_C05D( )
    call InitTrig_C05W( )
    call InitTrig_C05R( )
    call InitTrig_C05T( )
    call InitTrig_C06( )
    call InitTrig_C06W( )
    call InitTrig_C06E( )
    call InitTrig_C06T( )
    call InitTrig_C07( )
    call InitTrig_C07W_PLAY( )
    call InitTrig_C07E_START( )
    call InitTrig_C07R( )
    call InitTrig_C09( )
    call InitTrig_C09W( )
    call InitTrig_C09E( )
    call InitTrig_C09R_learn( )
    call InitTrig_C10( )
    call InitTrig_C10W_Spell_for_target( )
    call InitTrig_C10R_Attack_Unit( )
    call InitTrig_C11T( )
    call InitTrig_C12( )
    call InitTrig_C12W( )
    call InitTrig_C12E_start( )
    call InitTrig_C12E_stop( )
    call InitTrig_C12R( )
    call InitTrig_C12R_stop( )
    call InitTrig_C13R( )
    call InitTrig_C13T( )
    call InitTrig_C14( )
    call InitTrig_C14D( )
    call InitTrig_C14W_start( )
    call InitTrig_C14W( )
    call InitTrig_C14R_learn( )
    call InitTrig_C14R_attack( )
    call InitTrig_C14R( )
    call InitTrig_C14T( )
    call InitTrig_C15( )
    call InitTrig_C15D_check( )
    call InitTrig_C15D_effect( )
    call InitTrig_C15W( )
    call InitTrig_C15R( )
    call InitTrig_C16( )
    call InitTrig_C16E( )
    call InitTrig_C16R( )
    call InitTrig_C17( )
    call InitTrig_C17W( )
    call InitTrig_C17E( )
    call InitTrig_C17R( )
    call InitTrig_C17T( )
    call InitTrig_C18( )
    call InitTrig_C18T( )
    call InitTrig_C19( )
    call InitTrig_C19E( )
    call InitTrig_C19T( )
    call InitTrig_C20( )
    call InitTrig_C20W( )
    call InitTrig_C20W_stop( )
    call InitTrig_C20D( )
    call InitTrig_C20E( )
    call InitTrig_C20R_learn( )
    call InitTrig_C20T( )
    call InitTrig_C22( )
    call InitTrig_C22W( )
    call InitTrig_C22D( )
    call InitTrig_C22E( )
    call InitTrig_C22R( )
    call InitTrig_C22T( )
    call InitTrig_C22T_check( )
    call InitTrig_C23( )
    call InitTrig_C23W( )
    call InitTrig_C23E( )
    call InitTrig_C23R( )
    call InitTrig_C23R_enable( )
    call InitTrig_C23R_reduce_damage( )
    call InitTrig_C23T( )
    call InitTrig_C24( )
    call InitTrig_C24_W( )
    call InitTrig_C24E_check( )
    call InitTrig_C24E( )
    call InitTrig_C24R_learn( )
    call InitTrig_C24R( )
    call InitTrig_C24R_attack_start( )
    call InitTrig_C24T( )
    call InitTrig_C25( )
    call InitTrig_C25_learn( )
    call InitTrig_C25W( )
    call InitTrig_C25W2( )
    call InitTrig_C25W2_attack( )
    call InitTrig_C25_E( )
    call InitTrig_C25R( )
    call InitTrig_C25T( )
    call InitTrig_C26( )
    call InitTrig_C26D( )
    call InitTrig_C26W( )
    call InitTrig_C26E( )
    call InitTrig_C26R( )
    call InitTrig_C26T( )
    call InitTrig_C27( )
    call InitTrig_C40( )
    call InitTrig________________u( )
    call InitTrig_Game_Start( )
    call InitTrig_F9( )
    call InitTrig_JASS_INIT( )
    call InitTrig_Point_Init( )
endfunction
//===========================================================================
function RunInitializationTriggers takes nothing returns nothing
    call ConditionalTriggerExecute( gg_trg_Player_Name_Init )
    call ConditionalTriggerExecute( gg_trg_Surrender_Init )
    call ConditionalTriggerExecute( gg_trg_Hero_Init )
    call ConditionalTriggerExecute( gg_trg_HKETEST )
    call ConditionalTriggerExecute( gg_trg_itt_init )
    call ConditionalTriggerExecute( gg_trg_0S )
    call ConditionalTriggerExecute( gg_trg_Game_Init )
    call ConditionalTriggerExecute( gg_trg_init_OB )
    call ConditionalTriggerExecute( gg_trg_Tactics_Init )
    call ConditionalTriggerExecute( gg_trg_B37R )
    call ConditionalTriggerExecute( gg_trg_Game_Start )
    call ConditionalTriggerExecute( gg_trg_F9 )
    call ConditionalTriggerExecute( gg_trg_JASS_INIT )
    call ConditionalTriggerExecute( gg_trg_Point_Init )
endfunction
//***************************************************************************
//*
//*  Players
//*
//***************************************************************************
function InitCustomPlayerSlots takes nothing returns nothing
    // Player 0
    call SetPlayerStartLocation( Player(0), 0 )
    call ForcePlayerStartLocation( Player(0), 0 )
    call SetPlayerColor( Player(0), ConvertPlayerColor(0) )
    call SetPlayerRacePreference( Player(0), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(0), true )
    call SetPlayerController( Player(0), MAP_CONTROL_USER )
    // Player 1
    call SetPlayerStartLocation( Player(1), 1 )
    call ForcePlayerStartLocation( Player(1), 1 )
    call SetPlayerColor( Player(1), ConvertPlayerColor(1) )
    call SetPlayerRacePreference( Player(1), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(1), true )
    call SetPlayerController( Player(1), MAP_CONTROL_USER )
    // Player 2
    call SetPlayerStartLocation( Player(2), 2 )
    call ForcePlayerStartLocation( Player(2), 2 )
    call SetPlayerColor( Player(2), ConvertPlayerColor(2) )
    call SetPlayerRacePreference( Player(2), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(2), true )
    call SetPlayerController( Player(2), MAP_CONTROL_USER )
    // Player 3
    call SetPlayerStartLocation( Player(3), 3 )
    call ForcePlayerStartLocation( Player(3), 3 )
    call SetPlayerColor( Player(3), ConvertPlayerColor(3) )
    call SetPlayerRacePreference( Player(3), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(3), true )
    call SetPlayerController( Player(3), MAP_CONTROL_USER )
    // Player 4
    call SetPlayerStartLocation( Player(4), 4 )
    call ForcePlayerStartLocation( Player(4), 4 )
    call SetPlayerColor( Player(4), ConvertPlayerColor(4) )
    call SetPlayerRacePreference( Player(4), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(4), true )
    call SetPlayerController( Player(4), MAP_CONTROL_USER )
    // Player 5
    call SetPlayerStartLocation( Player(5), 5 )
    call ForcePlayerStartLocation( Player(5), 5 )
    call SetPlayerColor( Player(5), ConvertPlayerColor(5) )
    call SetPlayerRacePreference( Player(5), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(5), true )
    call SetPlayerController( Player(5), MAP_CONTROL_USER )
    // Player 6
    call SetPlayerStartLocation( Player(6), 6 )
    call ForcePlayerStartLocation( Player(6), 6 )
    call SetPlayerColor( Player(6), ConvertPlayerColor(6) )
    call SetPlayerRacePreference( Player(6), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(6), true )
    call SetPlayerController( Player(6), MAP_CONTROL_USER )
    // Player 7
    call SetPlayerStartLocation( Player(7), 7 )
    call ForcePlayerStartLocation( Player(7), 7 )
    call SetPlayerColor( Player(7), ConvertPlayerColor(7) )
    call SetPlayerRacePreference( Player(7), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(7), true )
    call SetPlayerController( Player(7), MAP_CONTROL_USER )
    // Player 8
    call SetPlayerStartLocation( Player(8), 8 )
    call ForcePlayerStartLocation( Player(8), 8 )
    call SetPlayerColor( Player(8), ConvertPlayerColor(8) )
    call SetPlayerRacePreference( Player(8), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(8), true )
    call SetPlayerController( Player(8), MAP_CONTROL_USER )
    // Player 9
    call SetPlayerStartLocation( Player(9), 9 )
    call ForcePlayerStartLocation( Player(9), 9 )
    call SetPlayerColor( Player(9), ConvertPlayerColor(9) )
    call SetPlayerRacePreference( Player(9), RACE_PREF_RANDOM )
    call SetPlayerRaceSelectable( Player(9), true )
    call SetPlayerController( Player(9), MAP_CONTROL_USER )
endfunction
function InitCustomTeams takes nothing returns nothing
    // Force: TRIGSTR_1653
    call SetPlayerTeam( Player(0), 0 )
    call SetPlayerState( Player(0), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(1), 0 )
    call SetPlayerState( Player(1), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(2), 0 )
    call SetPlayerState( Player(2), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(3), 0 )
    call SetPlayerState( Player(3), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(4), 0 )
    call SetPlayerState( Player(4), PLAYER_STATE_ALLIED_VICTORY, 1 )
    //   Allied
    call SetPlayerAllianceStateAllyBJ( Player(0), Player(1), true )
    call SetPlayerAllianceStateAllyBJ( Player(0), Player(2), true )
    call SetPlayerAllianceStateAllyBJ( Player(0), Player(3), true )
    call SetPlayerAllianceStateAllyBJ( Player(0), Player(4), true )
    call SetPlayerAllianceStateAllyBJ( Player(1), Player(0), true )
    call SetPlayerAllianceStateAllyBJ( Player(1), Player(2), true )
    call SetPlayerAllianceStateAllyBJ( Player(1), Player(3), true )
    call SetPlayerAllianceStateAllyBJ( Player(1), Player(4), true )
    call SetPlayerAllianceStateAllyBJ( Player(2), Player(0), true )
    call SetPlayerAllianceStateAllyBJ( Player(2), Player(1), true )
    call SetPlayerAllianceStateAllyBJ( Player(2), Player(3), true )
    call SetPlayerAllianceStateAllyBJ( Player(2), Player(4), true )
    call SetPlayerAllianceStateAllyBJ( Player(3), Player(0), true )
    call SetPlayerAllianceStateAllyBJ( Player(3), Player(1), true )
    call SetPlayerAllianceStateAllyBJ( Player(3), Player(2), true )
    call SetPlayerAllianceStateAllyBJ( Player(3), Player(4), true )
    call SetPlayerAllianceStateAllyBJ( Player(4), Player(0), true )
    call SetPlayerAllianceStateAllyBJ( Player(4), Player(1), true )
    call SetPlayerAllianceStateAllyBJ( Player(4), Player(2), true )
    call SetPlayerAllianceStateAllyBJ( Player(4), Player(3), true )
    //   Shared Vision
    call SetPlayerAllianceStateVisionBJ( Player(0), Player(1), true )
    call SetPlayerAllianceStateVisionBJ( Player(0), Player(2), true )
    call SetPlayerAllianceStateVisionBJ( Player(0), Player(3), true )
    call SetPlayerAllianceStateVisionBJ( Player(0), Player(4), true )
    call SetPlayerAllianceStateVisionBJ( Player(1), Player(0), true )
    call SetPlayerAllianceStateVisionBJ( Player(1), Player(2), true )
    call SetPlayerAllianceStateVisionBJ( Player(1), Player(3), true )
    call SetPlayerAllianceStateVisionBJ( Player(1), Player(4), true )
    call SetPlayerAllianceStateVisionBJ( Player(2), Player(0), true )
    call SetPlayerAllianceStateVisionBJ( Player(2), Player(1), true )
    call SetPlayerAllianceStateVisionBJ( Player(2), Player(3), true )
    call SetPlayerAllianceStateVisionBJ( Player(2), Player(4), true )
    call SetPlayerAllianceStateVisionBJ( Player(3), Player(0), true )
    call SetPlayerAllianceStateVisionBJ( Player(3), Player(1), true )
    call SetPlayerAllianceStateVisionBJ( Player(3), Player(2), true )
    call SetPlayerAllianceStateVisionBJ( Player(3), Player(4), true )
    call SetPlayerAllianceStateVisionBJ( Player(4), Player(0), true )
    call SetPlayerAllianceStateVisionBJ( Player(4), Player(1), true )
    call SetPlayerAllianceStateVisionBJ( Player(4), Player(2), true )
    call SetPlayerAllianceStateVisionBJ( Player(4), Player(3), true )
    // Force: TRIGSTR_1658
    call SetPlayerTeam( Player(5), 1 )
    call SetPlayerState( Player(5), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(6), 1 )
    call SetPlayerState( Player(6), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(7), 1 )
    call SetPlayerState( Player(7), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(8), 1 )
    call SetPlayerState( Player(8), PLAYER_STATE_ALLIED_VICTORY, 1 )
    call SetPlayerTeam( Player(9), 1 )
    call SetPlayerState( Player(9), PLAYER_STATE_ALLIED_VICTORY, 1 )
    //   Allied
    call SetPlayerAllianceStateAllyBJ( Player(5), Player(6), true )
    call SetPlayerAllianceStateAllyBJ( Player(5), Player(7), true )
    call SetPlayerAllianceStateAllyBJ( Player(5), Player(8), true )
    call SetPlayerAllianceStateAllyBJ( Player(5), Player(9), true )
    call SetPlayerAllianceStateAllyBJ( Player(6), Player(5), true )
    call SetPlayerAllianceStateAllyBJ( Player(6), Player(7), true )
    call SetPlayerAllianceStateAllyBJ( Player(6), Player(8), true )
    call SetPlayerAllianceStateAllyBJ( Player(6), Player(9), true )
    call SetPlayerAllianceStateAllyBJ( Player(7), Player(5), true )
    call SetPlayerAllianceStateAllyBJ( Player(7), Player(6), true )
    call SetPlayerAllianceStateAllyBJ( Player(7), Player(8), true )
    call SetPlayerAllianceStateAllyBJ( Player(7), Player(9), true )
    call SetPlayerAllianceStateAllyBJ( Player(8), Player(5), true )
    call SetPlayerAllianceStateAllyBJ( Player(8), Player(6), true )
    call SetPlayerAllianceStateAllyBJ( Player(8), Player(7), true )
    call SetPlayerAllianceStateAllyBJ( Player(8), Player(9), true )
    call SetPlayerAllianceStateAllyBJ( Player(9), Player(5), true )
    call SetPlayerAllianceStateAllyBJ( Player(9), Player(6), true )
    call SetPlayerAllianceStateAllyBJ( Player(9), Player(7), true )
    call SetPlayerAllianceStateAllyBJ( Player(9), Player(8), true )
    //   Shared Vision
    call SetPlayerAllianceStateVisionBJ( Player(5), Player(6), true )
    call SetPlayerAllianceStateVisionBJ( Player(5), Player(7), true )
    call SetPlayerAllianceStateVisionBJ( Player(5), Player(8), true )
    call SetPlayerAllianceStateVisionBJ( Player(5), Player(9), true )
    call SetPlayerAllianceStateVisionBJ( Player(6), Player(5), true )
    call SetPlayerAllianceStateVisionBJ( Player(6), Player(7), true )
    call SetPlayerAllianceStateVisionBJ( Player(6), Player(8), true )
    call SetPlayerAllianceStateVisionBJ( Player(6), Player(9), true )
    call SetPlayerAllianceStateVisionBJ( Player(7), Player(5), true )
    call SetPlayerAllianceStateVisionBJ( Player(7), Player(6), true )
    call SetPlayerAllianceStateVisionBJ( Player(7), Player(8), true )
    call SetPlayerAllianceStateVisionBJ( Player(7), Player(9), true )
    call SetPlayerAllianceStateVisionBJ( Player(8), Player(5), true )
    call SetPlayerAllianceStateVisionBJ( Player(8), Player(6), true )
    call SetPlayerAllianceStateVisionBJ( Player(8), Player(7), true )
    call SetPlayerAllianceStateVisionBJ( Player(8), Player(9), true )
    call SetPlayerAllianceStateVisionBJ( Player(9), Player(5), true )
    call SetPlayerAllianceStateVisionBJ( Player(9), Player(6), true )
    call SetPlayerAllianceStateVisionBJ( Player(9), Player(7), true )
    call SetPlayerAllianceStateVisionBJ( Player(9), Player(8), true )
endfunction
function InitAllyPriorities takes nothing returns nothing
    call SetStartLocPrioCount( 0, 4 )
    call SetStartLocPrio( 0, 0, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 1, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 2, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 0, 3, 4, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 1, 2 )
    call SetStartLocPrio( 1, 0, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 1, 1, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 2, 2 )
    call SetStartLocPrio( 2, 0, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 2, 1, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 3, 2 )
    call SetStartLocPrio( 3, 0, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 3, 1, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 4, 3 )
    call SetStartLocPrio( 4, 0, 1, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 1, 2, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 4, 2, 3, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 5, 4 )
    call SetStartLocPrio( 5, 0, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 1, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 2, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 5, 3, 9, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 6, 4 )
    call SetStartLocPrio( 6, 0, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 1, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 2, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 6, 3, 9, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 7, 4 )
    call SetStartLocPrio( 7, 0, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 1, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 2, 8, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 7, 3, 9, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 8, 4 )
    call SetStartLocPrio( 8, 0, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 1, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 2, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 8, 3, 9, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrioCount( 9, 4 )
    call SetStartLocPrio( 9, 0, 5, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 1, 6, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 2, 7, MAP_LOC_PRIO_HIGH )
    call SetStartLocPrio( 9, 3, 8, MAP_LOC_PRIO_HIGH )
endfunction
//***************************************************************************
//*
//*  Main Initialization
//*
//***************************************************************************
//===========================================================================
function main takes nothing returns nothing
    call SetCameraBounds( -8448.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), -8320.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM), 8448.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), 8576.0 - GetCameraMargin(CAMERA_MARGIN_TOP), -8448.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), 8576.0 - GetCameraMargin(CAMERA_MARGIN_TOP), 8448.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), -8320.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM) )
    call SetDayNightModels( "Environment\\DNC\\DNCLordaeron\\DNCLordaeronTerrain\\DNCLordaeronTerrain.mdl", "Environment\\DNC\\DNCLordaeron\\DNCLordaeronUnit\\DNCLordaeronUnit.mdl" )
    call NewSoundEnvironment( "Default" )
    call SetAmbientDaySound( "AshenvaleDay" )
    call SetAmbientNightSound( "AshenvaleNight" )
    call SetMapMusic( "Music", true, 0 )
    call InitSounds( )
    call CreateRegions( )
    call CreateAllUnits( )
    call InitBlizzard( )
    call InitGlobals( )
    call InitCustomTriggers( )
    call RunInitializationTriggers( )
endfunction
//***************************************************************************
//*
//*  Map Configuration
//*
//***************************************************************************
function config takes nothing returns nothing
    call SetMapName( "TRIGSTR_003" )
    call SetMapDescription( "TRIGSTR_005" )
    call SetPlayers( 10 )
    call SetTeams( 10 )
    call SetGamePlacement( MAP_PLACEMENT_TEAMS_TOGETHER )
    call DefineStartLocation( 0, 7296.0, -7488.0 )
    call DefineStartLocation( 1, 7296.0, -7488.0 )
    call DefineStartLocation( 2, 7296.0, -7488.0 )
    call DefineStartLocation( 3, 7296.0, -7488.0 )
    call DefineStartLocation( 4, 7296.0, -7488.0 )
    call DefineStartLocation( 5, -7424.0, 7296.0 )
    call DefineStartLocation( 6, -7424.0, 7296.0 )
    call DefineStartLocation( 7, -7424.0, 7360.0 )
    call DefineStartLocation( 8, -7424.0, 7296.0 )
    call DefineStartLocation( 9, -7424.0, 7296.0 )
    // Player setup
    call InitCustomPlayerSlots( )
    call InitCustomTeams( )
    call InitAllyPriorities( )
endfunction
library YDWETriggerRegisterLeaveRectSimpleNull
globals
    region yd_NullTempRegion
endglobals
function YDWETriggerRegisterLeaveRectSimpleNull takes trigger trig, rect r returns event
    local region rectRegion = CreateRegion()
    call RegionAddRect(rectRegion, r)
    set yd_NullTempRegion = rectRegion
    set rectRegion = null
    return TriggerRegisterLeaveRegion(trig, yd_NullTempRegion, null)
endfunction
endlibrary
library YDWEMultiboardSetItemStyleBJNull
function YDWEMultiboardSetItemStyleBJNull takes multiboard mb, integer col, integer row, boolean showValue, boolean showIcon returns nothing
    local integer curRow = 0
    local integer curCol = 0
    local integer numRows = MultiboardGetRowCount(mb)
    local integer numCols = MultiboardGetColumnCount(mb)
    local multiboarditem mbitem = null
    // Loop over rows, using 1-based index
    loop
        set curRow = curRow + 1
        exitwhen curRow > numRows
        // Apply setting to the requested row, or all rows (if row is 0)
        if (row == 0 or row == curRow) then
            // Loop over columns, using 1-based index
            set curCol = 0
            loop
                set curCol = curCol + 1
                exitwhen curCol > numCols
                // Apply setting to the requested column, or all columns (if col is 0)
                if (col == 0 or col == curCol) then
                    set mbitem = MultiboardGetItem(mb, curRow - 1, curCol - 1)
                    call MultiboardSetItemStyle(mbitem, showValue, showIcon)
                    call MultiboardReleaseItem(mbitem)
                endif
            endloop
        endif
    endloop
    set mbitem = null
endfunction
endlibrary
library YDWEGetUnitsInRectMatchingNull
globals
    group yd_NullTempGroup
endglobals
function YDWEGetUnitsInRectMatchingNull takes rect r, boolexpr filter returns group
    local group g = CreateGroup()
    call GroupEnumUnitsInRect(g, r, filter)
    call DestroyBoolExpr(filter)
    set yd_NullTempGroup = g
    set g = null
    return yd_NullTempGroup
endfunction
endlibrary
library YDWEGetUnitsInRectAllNull requires YDWEGetUnitsInRectMatchingNull
function YDWEGetUnitsInRectAllNull takes rect r returns group
    return YDWEGetUnitsInRectMatchingNull(r, null)
endfunction
endlibrary
//===========================================================================  
//===========================================================================  
//Զ¼ 
//===========================================================================
//===========================================================================   
library YDWETriggerEvent 
globals
    trigger yd_DamageEventTrigger = null
    private trigger array DamageEventQueue
    private integer DamageEventNumber = 0
	
    item bj_lastMovedItemInItemSlot = null
	
    private trigger MoveItemEventTrigger = null
    private trigger array MoveItemEventQueue
    private integer MoveItemEventNumber = 0
endglobals
	
//===========================================================================  
//ⵥλ˺¼ 
//===========================================================================
function YDWEAnyUnitDamagedTriggerAction takes nothing returns nothing
    local integer i = 0
    
    loop
        exitwhen i >= DamageEventNumber
        if DamageEventQueue[i] != null and IsTriggerEnabled(DamageEventQueue[i]) and TriggerEvaluate(DamageEventQueue[i]) then
            call TriggerExecute(DamageEventQueue[i])
        endif
        set i = i + 1 
    endloop 
endfunction
function YDWEAnyUnitDamagedFilter takes nothing returns boolean 
    if GetUnitAbilityLevel(GetFilterUnit(), 'Aloc') <= 0 then 
        call TriggerRegisterUnitEvent(yd_DamageEventTrigger, GetFilterUnit(), EVENT_UNIT_DAMAGED)
    endif
    return false
endfunction
function YDWEAnyUnitDamagedEnumUnit takes nothing returns nothing 
    local trigger t = CreateTrigger()
    local region r = CreateRegion()
    local group g = CreateGroup()
    call RegionAddRect(r, GetWorldBounds())
    call TriggerRegisterEnterRegion(t, r, Condition(function YDWEAnyUnitDamagedFilter))
    call GroupEnumUnitsInRect(g, GetWorldBounds(), Condition(function YDWEAnyUnitDamagedFilter))
    call DestroyGroup(g)
    set r = null
    set t = null
    set g = null
endfunction
	
function YDWESyStemAnyUnitDamagedRegistTrigger takes trigger trg returns nothing
    if trg == null then
        return
    endif
        
    if DamageEventNumber == 0 then
        set yd_DamageEventTrigger = CreateTrigger()
        call TriggerAddAction(yd_DamageEventTrigger, function YDWEAnyUnitDamagedTriggerAction) 
        call YDWEAnyUnitDamagedEnumUnit()
    endif 
    
    set DamageEventQueue[DamageEventNumber] = trg
    set DamageEventNumber = DamageEventNumber + 1
endfunction
//===========================================================================  
//ƶƷ¼ 
//===========================================================================  
function YDWESyStemItemUnmovableTriggerAction takes nothing returns nothing
    local integer i = 0
    
    if GetIssuedOrderId() >= 852002 and GetIssuedOrderId() <= 852007 then 
		set bj_lastMovedItemInItemSlot = GetOrderTargetItem() 
    	loop
        	exitwhen i >= MoveItemEventNumber
        	if MoveItemEventQueue[i] != null and IsTriggerEnabled(MoveItemEventQueue[i]) and TriggerEvaluate(MoveItemEventQueue[i]) then
        	    call TriggerExecute(MoveItemEventQueue[i])
        	endif
        	set i = i + 1 
    	endloop 
	endif	
endfunction
function YDWESyStemItemUnmovableRegistTrigger takes trigger trg returns nothing
    if trg == null then
        return
    endif
        
    if MoveItemEventNumber == 0 then
        set MoveItemEventTrigger = CreateTrigger()
        call TriggerAddAction(MoveItemEventTrigger, function YDWESyStemItemUnmovableTriggerAction) 
        call TriggerRegisterAnyUnitEventBJ(MoveItemEventTrigger, EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
    endif 
    
    set MoveItemEventQueue[MoveItemEventNumber] = trg
    set MoveItemEventNumber = MoveItemEventNumber + 1
endfunction
function GetLastMovedItemInItemSlot takes nothing returns item
    return bj_lastMovedItemInItemSlot
endfunction
endlibrary 
library YDWEMultiboardSetItemValueBJNull
function YDWEMultiboardSetItemValueBJNull takes multiboard mb, integer col, integer row, string val returns nothing
    local integer curRow = 0
    local integer curCol = 0
    local integer numRows = MultiboardGetRowCount(mb)
    local integer numCols = MultiboardGetColumnCount(mb)
    local multiboarditem mbitem = null
    // Loop over rows, using 1-based index
    loop
        set curRow = curRow + 1
        exitwhen curRow > numRows
        // Apply setting to the requested row, or all rows (if row is 0)
        if (row == 0 or row == curRow) then
            // Loop over columns, using 1-based index
            set curCol = 0
            loop
                set curCol = curCol + 1
                exitwhen curCol > numCols
                // Apply setting to the requested column, or all columns (if col is 0)
                if (col == 0 or col == curCol) then
                    set mbitem = MultiboardGetItem(mb, curRow - 1, curCol - 1)
                    call MultiboardSetItemValue(mbitem, val)
                    call MultiboardReleaseItem(mbitem)
                endif
            endloop
        endif
    endloop
    set mbitem = null
endfunction
endlibrary
library YDWEGetPlayersEnemiesNull
globals
    force yd_NullTempForce
endglobals
function YDWEGetPlayersEnemiesNull takes player whichPlayer returns force
    local force f = CreateForce()
    call ForceEnumEnemies(f, whichPlayer, null)
    set yd_NullTempForce = f
    set f = null
    return yd_NullTempForce
endfunction
endlibrary
library YDWEBase initializer InitializeYD
//===========================================================================
//HashTable
//===========================================================================
globals
//ȫֹϣ 
endglobals
//===========================================================================
//Return bug
//===========================================================================
function YDWEH2I takes handle h returns integer
    return GetHandleId(h)
endfunction
//
function YDWEFlushAllData takes nothing returns nothing
    call FlushParentHashtable(YDHT)
endfunction
function YDWEFlushMissionByInteger takes integer i returns nothing
    call FlushChildHashtable(YDHT,i)
endfunction
function YDWEFlushMissionByString takes string s returns nothing
    call FlushChildHashtable(YDHT,StringHash(s))
endfunction
function YDWEFlushStoredIntegerByInteger takes integer i,integer j returns nothing
    call RemoveSavedInteger(YDHT,i,j)
endfunction
function YDWEFlushStoredIntegerByString takes string s1,string s2 returns nothing
    call RemoveSavedInteger(YDHT,StringHash(s1),StringHash(s2))
endfunction
function YDWEHaveSavedIntegerByInteger takes integer i,integer j returns boolean
    return HaveSavedInteger(YDHT,i,j)
endfunction
function YDWEHaveSavedIntegerByString takes string s1,string s2 returns boolean
    return HaveSavedInteger(YDHT,StringHash(s1),StringHash(s2))
endfunction
//store and get integer
function YDWESaveIntegerByInteger takes integer pTable,integer pKey,integer i returns nothing
    call SaveInteger(YDHT,pTable,pKey,i)
endfunction
function YDWESaveIntegerByString takes string pTable,string pKey,integer i returns nothing
    call SaveInteger(YDHT,StringHash(pTable),StringHash(pKey),i)
endfunction
function YDWEGetIntegerByInteger takes integer pTable,integer pKey returns integer
    return LoadInteger(YDHT,pTable,pKey)
endfunction
function YDWEGetIntegerByString takes string pTable,string pKey returns integer
    return LoadInteger(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//store and get real
function YDWESaveRealByInteger takes integer pTable,integer pKey,real r returns nothing
    call SaveReal(YDHT,pTable,pKey,r)
endfunction
function YDWESaveRealByString takes string pTable,string pKey,real r returns nothing
    call SaveReal(YDHT,StringHash(pTable),StringHash(pKey),r)
endfunction
function YDWEGetRealByInteger takes integer pTable,integer pKey returns real
    return LoadReal(YDHT,pTable,pKey)
endfunction
function YDWEGetRealByString takes string pTable,string pKey returns real
    return LoadReal(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//store and get string
function YDWESaveStringByInteger takes integer pTable,integer pKey,string s returns nothing
    call SaveStr(YDHT,pTable,pKey,s)
endfunction
function YDWESaveStringByString takes string pTable,string pKey,string s returns nothing
    call SaveStr(YDHT,StringHash(pTable),StringHash(pKey),s)
endfunction
function YDWEGetStringByInteger takes integer pTable,integer pKey returns string
    return LoadStr(YDHT,pTable,pKey)
endfunction
function YDWEGetStringByString takes string pTable,string pKey returns string
    return LoadStr(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//store and get boolean
function YDWESaveBooleanByInteger takes integer pTable,integer pKey,boolean b returns nothing
    call SaveBoolean(YDHT,pTable,pKey,b)
endfunction
function YDWESaveBooleanByString takes string pTable,string pKey,boolean b returns nothing
    call SaveBoolean(YDHT,StringHash(pTable),StringHash(pKey),b)
endfunction
function YDWEGetBooleanByInteger takes integer pTable,integer pKey returns boolean
    return LoadBoolean(YDHT,pTable,pKey)
endfunction
function YDWEGetBooleanByString takes string pTable,string pKey returns boolean
    return LoadBoolean(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Unit
function YDWESaveUnitByInteger takes integer pTable,integer pKey,unit u returns nothing
    call SaveUnitHandle(YDHT,pTable,pKey,u)
endfunction
function YDWESaveUnitByString takes string pTable,string pKey,unit u returns nothing
    call SaveUnitHandle(YDHT,StringHash(pTable),StringHash(pKey),u)
endfunction
function YDWEGetUnitByInteger takes integer pTable,integer pKey returns unit
    return LoadUnitHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetUnitByString takes string pTable,string pKey returns unit
    return LoadUnitHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert UnitID
function YDWESaveUnitIDByInteger takes integer pTable,integer pKey,integer uid returns nothing
    call SaveInteger(YDHT,pTable,pKey,uid)
endfunction
function YDWESaveUnitIDByString takes string pTable,string pKey,integer uid returns nothing
    call SaveInteger(YDHT,StringHash(pTable),StringHash(pKey),uid)
endfunction
function YDWEGetUnitIDByInteger takes integer pTable,integer pKey returns integer
    return LoadInteger(YDHT,pTable,pKey)
endfunction
function YDWEGetUnitIDByString takes string pTable,string pKey returns integer
    return LoadInteger(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert AbilityID
function YDWESaveAbilityIDByInteger takes integer pTable,integer pKey,integer abid returns nothing
    call SaveInteger(YDHT,pTable,pKey,abid)
endfunction
function YDWESaveAbilityIDByString takes string pTable,string pKey,integer abid returns nothing
    call SaveInteger(YDHT,StringHash(pTable),StringHash(pKey),abid)
endfunction
function YDWEGetAbilityIDByInteger takes integer pTable,integer pKey returns integer
    return LoadInteger(YDHT,pTable,pKey)
endfunction
function YDWEGetAbilityIDByString takes string pTable,string pKey returns integer
    return LoadInteger(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Player
function YDWESavePlayerByInteger takes integer pTable,integer pKey,player p returns nothing
    call SavePlayerHandle(YDHT,pTable,pKey,p)
endfunction
function YDWESavePlayerByString takes string pTable,string pKey,player p returns nothing
    call SavePlayerHandle(YDHT,StringHash(pTable),StringHash(pKey),p)
endfunction
function YDWEGetPlayerByInteger takes integer pTable,integer pKey returns player
    return LoadPlayerHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetPlayerByString takes string pTable,string pKey returns player
    return LoadPlayerHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Item
function YDWESaveItemByInteger takes integer pTable,integer pKey,item it returns nothing
    call SaveItemHandle(YDHT,pTable,pKey,it)
endfunction
function YDWESaveItemByString takes string pTable,string pKey,item it returns nothing
    call SaveItemHandle(YDHT,StringHash(pTable),StringHash(pKey),it)
endfunction
function YDWEGetItemByInteger takes integer pTable,integer pKey returns item
    return LoadItemHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetItemByString takes string pTable,string pKey returns item
    return LoadItemHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert ItemID
function YDWESaveItemIDByInteger takes integer pTable,integer pKey,integer itid returns nothing
    call SaveInteger(YDHT,pTable,pKey,itid)
endfunction
function YDWESaveItemIDByString takes string pTable,string pKey,integer itid returns nothing
    call SaveInteger(YDHT,StringHash(pTable),StringHash(pKey),itid)
endfunction
function YDWEGetItemIDByInteger takes integer pTable,integer pKey returns integer
    return LoadInteger(YDHT,pTable,pKey)
endfunction
function YDWEGetItemIDByString takes string pTable,string pKey returns integer
    return LoadInteger(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Timer
function YDWESaveTimerByInteger takes integer pTable,integer pKey,timer t returns nothing
    call SaveTimerHandle(YDHT,pTable,pKey,t)
endfunction
function YDWESaveTimerByString takes string pTable,string pKey,timer t returns nothing
    call SaveTimerHandle(YDHT,StringHash(pTable),StringHash(pKey),t)
endfunction
function YDWEGetTimerByInteger takes integer pTable,integer pKey returns timer
    return LoadTimerHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTimerByString takes string pTable,string pKey returns timer
    return LoadTimerHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Trigger
function YDWESaveTriggerByInteger takes integer pTable,integer pKey,trigger trg returns nothing
    call SaveTriggerHandle(YDHT,pTable,pKey,trg)
endfunction
function YDWESaveTriggerByString takes string pTable,string pKey,trigger trg returns nothing
    call SaveTriggerHandle(YDHT,StringHash(pTable),StringHash(pKey),trg)
endfunction
function YDWEGetTriggerByInteger takes integer pTable,integer pKey returns trigger
    return LoadTriggerHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTriggerByString takes string pTable,string pKey returns trigger
    return LoadTriggerHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Location
function YDWESaveLocationByInteger takes integer pTable,integer pKey,location pt returns nothing
    call SaveLocationHandle(YDHT,pTable,pKey,pt)
endfunction
function YDWESaveLocationByString takes string pTable,string pKey,location pt returns nothing
    call SaveLocationHandle(YDHT,StringHash(pTable),StringHash(pKey),pt)
endfunction
function YDWEGetLocationByInteger takes integer pTable,integer pKey returns location
    return LoadLocationHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetLocationByString takes string pTable,string pKey returns location
    return LoadLocationHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Group
function YDWESaveGroupByInteger takes integer pTable,integer pKey,group g returns nothing
    call SaveGroupHandle(YDHT,pTable,pKey,g)
endfunction
function YDWESaveGroupByString takes string pTable,string pKey,group g returns nothing
    call SaveGroupHandle(YDHT,StringHash(pTable),StringHash(pKey),g)
endfunction
function YDWEGetGroupByInteger takes integer pTable,integer pKey returns group
    return LoadGroupHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetGroupByString takes string pTable,string pKey returns group
    return LoadGroupHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Multiboard
function YDWESaveMultiboardByInteger takes integer pTable,integer pKey,multiboard m returns nothing
    call SaveMultiboardHandle(YDHT,pTable,pKey,m)
endfunction
function YDWESaveMultiboardByString takes string pTable,string pKey,multiboard m returns nothing
    call SaveMultiboardHandle(YDHT,StringHash(pTable),StringHash(pKey),m)
endfunction
function YDWEGetMultiboardByInteger takes integer pTable,integer pKey returns multiboard
    return LoadMultiboardHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetMultiboardByString takes string pTable,string pKey returns multiboard
    return LoadMultiboardHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert MultiboardItem
function YDWESaveMultiboardItemByInteger takes integer pTable,integer pKey,multiboarditem mt returns nothing
    call SaveMultiboardItemHandle(YDHT,pTable,pKey,mt)
endfunction
function YDWESaveMultiboardItemByString takes string pTable,string pKey,multiboarditem mt returns nothing
    call SaveMultiboardItemHandle(YDHT,StringHash(pTable),StringHash(pKey),mt)
endfunction
function YDWEGetMultiboardItemByInteger takes integer pTable,integer pKey returns multiboarditem
    return LoadMultiboardItemHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetMultiboardItemByString takes string pTable,string pKey returns multiboarditem
    return LoadMultiboardItemHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert TextTag
function YDWESaveTextTagByInteger takes integer pTable,integer pKey,texttag tt returns nothing
    call SaveTextTagHandle(YDHT,pTable,pKey,tt)
endfunction
function YDWESaveTextTagByString takes string pTable,string pKey,texttag tt returns nothing
    call SaveTextTagHandle(YDHT,StringHash(pTable),StringHash(pKey),tt)
endfunction
function YDWEGetTextTagByInteger takes integer pTable,integer pKey returns texttag
    return LoadTextTagHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTextTagByString takes string pTable,string pKey returns texttag
    return LoadTextTagHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Lightning
function YDWESaveLightningByInteger takes integer pTable,integer pKey,lightning ln returns nothing
    call SaveLightningHandle(YDHT,pTable,pKey,ln)
endfunction
function YDWESaveLightningByString takes string pTable,string pKey,lightning ln returns nothing
    call SaveLightningHandle(YDHT,StringHash(pTable),StringHash(pKey),ln)
endfunction
function YDWEGetLightningByInteger takes integer pTable,integer pKey returns lightning
    return LoadLightningHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetLightningByString takes string pTable,string pKey returns lightning
    return LoadLightningHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Region
function YDWESaveRegionByInteger takes integer pTable,integer pKey,region rn returns nothing
    call SaveRegionHandle(YDHT,pTable,pKey,rn)
endfunction
function YDWESaveRegionByString takes string pTable,string pKey,region rt returns nothing
    call SaveRegionHandle(YDHT,StringHash(pTable),StringHash(pKey),rt)
endfunction
function YDWEGetRegionByInteger takes integer pTable,integer pKey returns region
    return LoadRegionHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetRegionByString takes string pTable,string pKey returns region
    return LoadRegionHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Rect
function YDWESaveRectByInteger takes integer pTable,integer pKey,rect rn returns nothing
    call SaveRectHandle(YDHT,pTable,pKey,rn)
endfunction
function YDWESaveRectByString takes string pTable,string pKey,rect rt returns nothing
    call SaveRectHandle(YDHT,StringHash(pTable),StringHash(pKey),rt)
endfunction
function YDWEGetRectByInteger takes integer pTable,integer pKey returns rect
    return LoadRectHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetRectByString takes string pTable,string pKey returns rect
    return LoadRectHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Leaderboard
function YDWESaveLeaderboardByInteger takes integer pTable,integer pKey,leaderboard lb returns nothing
    call SaveLeaderboardHandle(YDHT,pTable,pKey,lb)
endfunction
function YDWESaveLeaderboardByString takes string pTable,string pKey,leaderboard lb returns nothing
    call SaveLeaderboardHandle(YDHT,StringHash(pTable),StringHash(pKey),lb)
endfunction
function YDWEGetLeaderboardByInteger takes integer pTable,integer pKey returns leaderboard
    return LoadLeaderboardHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetLeaderboardByString takes string pTable,string pKey returns leaderboard
    return LoadLeaderboardHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Effect
function YDWESaveEffectByInteger takes integer pTable,integer pKey,effect e returns nothing
    call SaveEffectHandle(YDHT,pTable,pKey,e)
endfunction
function YDWESaveEffectByString takes string pTable,string pKey,effect e returns nothing
    call SaveEffectHandle(YDHT,StringHash(pTable),StringHash(pKey),e)
endfunction
function YDWEGetEffectByInteger takes integer pTable,integer pKey returns effect
    return LoadEffectHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetEffectByString takes string pTable,string pKey returns effect
    return LoadEffectHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert Destructable
function YDWESaveDestructableByInteger takes integer pTable,integer pKey,destructable da returns nothing
    call SaveDestructableHandle(YDHT,pTable,pKey,da)
endfunction
function YDWESaveDestructableByString takes string pTable,string pKey,destructable da returns nothing
    call SaveDestructableHandle(YDHT,StringHash(pTable),StringHash(pKey),da)
endfunction
function YDWEGetDestructableByInteger takes integer pTable,integer pKey returns destructable
    return LoadDestructableHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetDestructableByString takes string pTable,string pKey returns destructable
    return LoadDestructableHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert triggercondition
function YDWESaveTriggerConditionByInteger takes integer pTable,integer pKey,triggercondition tc returns nothing
    call SaveTriggerConditionHandle(YDHT,pTable,pKey,tc)
endfunction
function YDWESaveTriggerConditionByString takes string pTable,string pKey,triggercondition tc returns nothing
    call SaveTriggerConditionHandle(YDHT,StringHash(pTable),StringHash(pKey),tc)
endfunction
function YDWEGetTriggerConditionByInteger takes integer pTable,integer pKey returns triggercondition
    return LoadTriggerConditionHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTriggerConditionByString takes string pTable,string pKey returns triggercondition
    return LoadTriggerConditionHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert triggeraction
function YDWESaveTriggerActionByInteger takes integer pTable,integer pKey,triggeraction ta returns nothing
    call SaveTriggerActionHandle(YDHT,pTable,pKey,ta)
endfunction
function YDWESaveTriggerActionByString takes string pTable,string pKey,triggeraction ta returns nothing
    call SaveTriggerActionHandle(YDHT,StringHash(pTable),StringHash(pKey),ta)
endfunction
function YDWEGetTriggerActionByInteger takes integer pTable,integer pKey returns triggeraction
    return LoadTriggerActionHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTriggerActionByString takes string pTable,string pKey returns triggeraction
    return LoadTriggerActionHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert event
function YDWESaveTriggerEventByInteger takes integer pTable,integer pKey,event et returns nothing
    call SaveTriggerEventHandle(YDHT,pTable,pKey,et)
endfunction
function YDWESaveTriggerEventByString takes string pTable,string pKey,event et returns nothing
    call SaveTriggerEventHandle(YDHT,StringHash(pTable),StringHash(pKey),et)
endfunction
function YDWEGetTriggerEventByInteger takes integer pTable,integer pKey returns event
    return LoadTriggerEventHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTriggerEventByString takes string pTable,string pKey returns event
    return LoadTriggerEventHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert force
function YDWESaveForceByInteger takes integer pTable,integer pKey,force fc returns nothing
    call SaveForceHandle(YDHT,pTable,pKey,fc)
endfunction
function YDWESaveForceByString takes string pTable,string pKey,force fc returns nothing
    call SaveForceHandle(YDHT,StringHash(pTable),StringHash(pKey),fc)
endfunction
function YDWEGetForceByInteger takes integer pTable,integer pKey returns force
    return LoadForceHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetForceByString takes string pTable,string pKey returns force
    return LoadForceHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert boolexpr
function YDWESaveBoolexprByInteger takes integer pTable,integer pKey,boolexpr be returns nothing
    call SaveBooleanExprHandle(YDHT,pTable,pKey,be)
endfunction
function YDWESaveBoolexprByString takes string pTable,string pKey,boolexpr be returns nothing
    call SaveBooleanExprHandle(YDHT,StringHash(pTable),StringHash(pKey),be)
endfunction
function YDWEGetBoolexprByInteger takes integer pTable,integer pKey returns boolexpr
    return LoadBooleanExprHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetBoolexprByString takes string pTable,string pKey returns boolexpr
    return LoadBooleanExprHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert sound
function YDWESaveSoundByInteger takes integer pTable,integer pKey,sound sd returns nothing
    call SaveSoundHandle(YDHT,pTable,pKey,sd)
endfunction
function YDWESaveSoundByString takes string pTable,string pKey,sound sd returns nothing
    call SaveSoundHandle(YDHT,StringHash(pTable),StringHash(pKey),sd)
endfunction
function YDWEGetSoundByInteger takes integer pTable,integer pKey returns sound
    return LoadSoundHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetSoundByString takes string pTable,string pKey returns sound
    return LoadSoundHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert timerdialog
function YDWESaveTimerDialogByInteger takes integer pTable,integer pKey,timerdialog td returns nothing
    call SaveTimerDialogHandle(YDHT,pTable,pKey,td)
endfunction
function YDWESaveTimerDialogByString takes string pTable,string pKey,timerdialog td returns nothing
    call SaveTimerDialogHandle(YDHT,StringHash(pTable),StringHash(pKey),td)
endfunction
function YDWEGetTimerDialogByInteger takes integer pTable,integer pKey returns timerdialog
    return LoadTimerDialogHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTimerDialogByString takes string pTable,string pKey returns timerdialog
    return LoadTimerDialogHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert trackable
function YDWESaveTrackableByInteger takes integer pTable,integer pKey,trackable ta returns nothing
    call SaveTrackableHandle(YDHT,pTable,pKey,ta)
endfunction
function YDWESaveTrackableByString takes string pTable,string pKey,trackable ta returns nothing
    call SaveTrackableHandle(YDHT,StringHash(pTable),StringHash(pKey),ta)
endfunction
function YDWEGetTrackableByInteger takes integer pTable,integer pKey returns trackable
    return LoadTrackableHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetTrackableByString takes string pTable,string pKey returns trackable
    return LoadTrackableHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert dialog
function YDWESaveDialogByInteger takes integer pTable,integer pKey,dialog d returns nothing
    call SaveDialogHandle(YDHT,pTable,pKey,d)
endfunction
function YDWESaveDialogByString takes string pTable,string pKey,dialog d returns nothing
    call SaveDialogHandle(YDHT,StringHash(pTable),StringHash(pKey),d)
endfunction
function YDWEGetDialogByInteger takes integer pTable,integer pKey returns dialog
    return LoadDialogHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetDialogByString takes string pTable,string pKey returns dialog
    return LoadDialogHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert button
function YDWESaveButtonByInteger takes integer pTable,integer pKey,button bt returns nothing
    call SaveButtonHandle(YDHT,pTable,pKey,bt)
endfunction
function YDWESaveButtonByString takes string pTable,string pKey,button bt returns nothing
    call SaveButtonHandle(YDHT,StringHash(pTable),StringHash(pKey),bt)
endfunction
function YDWEGetButtonByInteger takes integer pTable,integer pKey returns button
    return LoadButtonHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetButtonByString takes string pTable,string pKey returns button
    return LoadButtonHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert quest
function YDWESaveQuestByInteger takes integer pTable,integer pKey,quest qt returns nothing
    call SaveQuestHandle(YDHT,pTable,pKey,qt)
endfunction
function YDWESaveQuestByString takes string pTable,string pKey,quest qt returns nothing
    call SaveQuestHandle(YDHT,StringHash(pTable),StringHash(pKey),qt)
endfunction
function YDWEGetQuestByInteger takes integer pTable,integer pKey returns quest
    return LoadQuestHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetQuestByString takes string pTable,string pKey returns quest
    return LoadQuestHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
//Covert questitem
function YDWESaveQuestItemByInteger takes integer pTable,integer pKey,questitem qi returns nothing
    call SaveQuestItemHandle(YDHT,pTable,pKey,qi)
endfunction
function YDWESaveQuestItemByString takes string pTable,string pKey,questitem qi returns nothing
    call SaveQuestItemHandle(YDHT,StringHash(pTable),StringHash(pKey),qi)
endfunction
function YDWEGetQuestItemByInteger takes integer pTable,integer pKey returns questitem
    return LoadQuestItemHandle(YDHT,pTable,pKey)
endfunction
function YDWEGetQuestItemByString takes string pTable,string pKey returns questitem
    return LoadQuestItemHandle(YDHT,StringHash(pTable),StringHash(pKey))
endfunction
function YDWES2I takes string s returns integer
    return StringHash(s)
endfunction
function YDWESaveAbilityHandleBJ takes integer AbilityID, integer key, integer missionKey, hashtable table returns nothing
    call SaveInteger(table,missionKey,key,AbilityID)
endfunction
function YDWESaveAbilityHandle takes hashtable table, integer parentKey, integer childKey, integer AbilityID returns nothing
    call SaveInteger(table,parentKey,childKey,AbilityID)
endfunction
function YDWELoadAbilityHandleBJ takes integer key, integer missionKey, hashtable table returns integer
    return LoadInteger(table,missionKey,key)
endfunction
function YDWELoadAbilityHandle takes hashtable table, integer parentKey, integer childKey returns integer
    return LoadInteger(table,parentKey,childKey)
endfunction
globals
	string bj_AllString=".................................!.#$%&'()*+,-./0123456789:;<=>.@ABCDEFGHIJKLMNOPQRSTUVWXYZ[.]^_`abcdefghijklmnopqrstuvwxyz{|}~................................................................................................................................"
//全局系统变量
    unit bj_lastAbilityCastingUnit=null
    unit bj_lastAbilityTargetUnit=null
    unit bj_lastPoolAbstractedUnit=null
    unitpool bj_lastCreatedUnitPool=null
    item bj_lastPoolAbstractedItem=null
    itempool bj_lastCreatedItemPool=null
    attacktype bj_lastSetAttackType = ATTACK_TYPE_NORMAL
    damagetype bj_lastSetDamageType = DAMAGE_TYPE_NORMAL
    weapontype bj_lastSetWeaponType = WEAPON_TYPE_WHOKNOWS
    real yd_MapMaxX = 0
    real yd_MapMinX = 0
    real yd_MapMaxY = 0
    real yd_MapMinY = 0
    private string array yd_PlayerColor
endglobals
//===========================================================================
//返回参数
//===========================================================================
//地图边界判断
function YDWECoordinateX takes real x returns real
    return RMinBJ(RMaxBJ(x, yd_MapMinX), yd_MapMaxX)
endfunction
function YDWECoordinateY takes real y returns real
    return RMinBJ(RMaxBJ(y, yd_MapMinY), yd_MapMaxY)
endfunction
//两个单位之间的距离
function YDWEDistanceBetweenUnits takes unit a,unit b returns real
    return SquareRoot((GetUnitX(a)-GetUnitX(b))*(GetUnitX(a)-GetUnitX(b))+(GetUnitY(a)-GetUnitY(b))*(GetUnitY(a)-GetUnitY(b)))
endfunction
//两个单位之间的角度
function YDWEAngleBetweenUnits takes unit fromUnit, unit toUnit returns real
    return bj_RADTODEG * Atan2(GetUnitY(toUnit) - GetUnitY(fromUnit), GetUnitX(toUnit) - GetUnitX(fromUnit))
endfunction
//生成区域
function YDWEGetRect takes real x,real y,real width, real height returns rect
    return Rect( x - width*0.5, y - height*0.5, x + width*0.5, y + height*0.5 )
endfunction
//===========================================================================
//设置单位可以飞行
//===========================================================================
function YDWEFlyEnable takes unit u returns nothing
    call UnitAddAbility(u,'Amrf')
    call UnitRemoveAbility(u,'Amrf')
endfunction
//===========================================================================
//字符窜与ID转换
//===========================================================================
function YDWEId2S takes integer value returns string
    local string charMap=bj_AllString
    local string result = ""
    local integer remainingValue = value
    local integer charValue
    local integer byteno
    set byteno = 0
    loop
        set charValue = ModuloInteger(remainingValue, 256)
        set remainingValue = remainingValue / 256
        set result = SubString(charMap, charValue, charValue + 1) + result
        set byteno = byteno + 1
        exitwhen byteno == 4
    endloop
    return result
endfunction
function YDWES2Id takes string targetstr returns integer
    local string originstr=bj_AllString
    local integer strlength=StringLength(targetstr)
    local integer a=0 //分部当前数字
local integer b=0 //当前处理字
local integer numx=1 //位权
local integer result=0
    loop
    exitwhen b>strlength-1
        set numx=R2I(Pow(256,strlength-1-b))
        set a=1
        loop
            exitwhen a>255
            if SubString(targetstr,b,b+1)==SubString(originstr,a,a+1) then
                set result=result+a*numx
                set a=256
            endif
            set a=a+1
        endloop
        set b=b+1
    endloop
    return result
endfunction
function YDWES2UnitId takes string targetstr returns integer
    return YDWES2Id(targetstr)
endfunction
function YDWES2ItemId takes string targetstr returns integer
    return YDWES2Id(targetstr)
endfunction
function GetLastAbilityCastingUnit takes nothing returns unit
    return bj_lastAbilityCastingUnit
endfunction
function GetLastAbilityTargetUnit takes nothing returns unit
    return bj_lastAbilityTargetUnit
endfunction
function YDWESetMapLimitCoordinate takes real MinX,real MaxX,real MinY,real MaxY returns nothing
    set yd_MapMaxX=MaxX
    set yd_MapMinX=MinX
    set yd_MapMaxY=MaxY
    set yd_MapMinY=MinY
endfunction
//===========================================================================
//===========================================================================
//地图初始化
//===========================================================================
//YDWE特殊技能结束事件 
globals
    private trigger array AbilityCastingOverEventQueue
    private integer array AbilityCastingOverEventType
    private integer AbilityCastingOverEventNumber = 0
endglobals
function YDWESyStemAbilityCastingOverTriggerAction takes unit hero, integer index returns nothing
	local integer i = 0
    loop
        exitwhen i >= AbilityCastingOverEventNumber
        if AbilityCastingOverEventType[i] == index then
            set bj_lastAbilityCastingUnit = hero 
			if AbilityCastingOverEventQueue[i] != null and TriggerEvaluate(AbilityCastingOverEventQueue[i]) and IsTriggerEnabled(AbilityCastingOverEventQueue[i]) then
				call TriggerExecute(AbilityCastingOverEventQueue[i])
			endif
		endif
        set i = i + 1 
    endloop
endfunction
//===========================================================================  
//YDWE技能捕捉事件 
//===========================================================================  
function YDWESyStemAbilityCastingOverRegistTrigger takes trigger trg,integer index returns nothing 
	set AbilityCastingOverEventQueue[AbilityCastingOverEventNumber] = trg
	set AbilityCastingOverEventType[AbilityCastingOverEventNumber] = index
	set AbilityCastingOverEventNumber = AbilityCastingOverEventNumber + 1 
endfunction 
//===========================================================================
//系统函数完善
//===========================================================================
function YDWECreateUnitPool takes nothing returns nothing
    set bj_lastCreatedUnitPool=CreateUnitPool()
endfunction
function YDWEPlaceRandomUnit takes unitpool up,player p,real x,real y,real face returns nothing //unitpool,player,real,real,real
set bj_lastPoolAbstractedUnit=PlaceRandomUnit(up,p,x,y,face)
endfunction
function YDWEGetLastUnitPool takes nothing returns unitpool
    return bj_lastCreatedUnitPool
endfunction
function YDWEGetLastPoolAbstractedUnit takes nothing returns unit
    return bj_lastPoolAbstractedUnit
endfunction
function YDWECreateItemPool takes nothing returns nothing
    set bj_lastCreatedItemPool=CreateItemPool()
endfunction
function YDWEPlaceRandomItem takes itempool ip,real x,real y returns nothing //unitpool,player,real,real,real
set bj_lastPoolAbstractedItem=PlaceRandomItem(ip,x,y)
endfunction
function YDWEGetLastItemPool takes nothing returns itempool
    return bj_lastCreatedItemPool
endfunction
function YDWEGetLastPoolAbstractedItem takes nothing returns item
    return bj_lastPoolAbstractedItem
endfunction
function YDWESetAttackDamageWeaponType takes attacktype at,damagetype dt,weapontype wt returns nothing
    set bj_lastSetAttackType=at
    set bj_lastSetDamageType=dt
    set bj_lastSetWeaponType=wt
endfunction
//unitpool bj_lastCreatedPool=null
//unit bj_lastPoolAbstractedUnit=null
function YDWEGetPlayerColorString takes player p, string s returns string
    return yd_PlayerColor[GetHandleId(GetPlayerColor(p))] + s + "|r"
endfunction
//===========================================================================
//===========================================================================
//系统函数补充
//===========================================================================
//===========================================================================
function YDWEGetUnitItemSoftId takes unit hero,item it returns integer
    local integer i = 0
    loop
         exitwhen i > 5
         if UnitItemInSlot(hero, i) == it then
            return i + 1
         endif
         set i = i + 1
    endloop
    return 0
endfunction
//===========================================================================
//===========================================================================
//地图初始化
//===========================================================================
//===========================================================================
//显示版本
function YDWEVersion_Display takes nothing returns boolean
    call DisplayTimedTextToPlayer(GetTriggerPlayer(), 0, 0, 30,"|cFF1E90FF当前编辑器版本为： |r|cFF00FF00YDWE " + "1.28.7.1100")
    return false
endfunction
function YDWEVersion_Init takes nothing returns nothing
    local trigger t = CreateTrigger()
    local integer i = 0
    loop
        exitwhen i == 12
        call TriggerRegisterPlayerChatEvent(t, Player(i), "YDWE Version", true)
        set i = i + 1
    endloop
    call TriggerAddCondition(t, Condition(function YDWEVersion_Display))
    set t = null
endfunction
function InitializeYD takes nothing returns nothing
	//=================设置变量=====================
	set yd_MapMinX = GetCameraBoundMinX() - GetCameraMargin(CAMERA_MARGIN_LEFT)
	set yd_MapMinY = GetCameraBoundMinY() - GetCameraMargin(CAMERA_MARGIN_BOTTOM)
	set yd_MapMaxX = GetCameraBoundMaxX() + GetCameraMargin(CAMERA_MARGIN_RIGHT)
	set yd_MapMaxY = GetCameraBoundMaxY() + GetCameraMargin(CAMERA_MARGIN_TOP)
	
    set yd_PlayerColor [0] = "|cFFFF0303"
    set yd_PlayerColor [1] = "|cFF0042FF"
    set yd_PlayerColor [2] = "|cFF1CE6B9"
    set yd_PlayerColor [3] = "|cFF540081"
    set yd_PlayerColor [4] = "|cFFFFFC01"
    set yd_PlayerColor [5] = "|cFFFE8A0E"
    set yd_PlayerColor [6] = "|cFF20C000"
    set yd_PlayerColor [7] = "|cFFE55BB0"
    set yd_PlayerColor [8] = "|cFF959697"
    set yd_PlayerColor [9] = "|cFF7EBFF1"
    set yd_PlayerColor[10] = "|cFF106246"
    set yd_PlayerColor[11] = "|cFF4E2A04"
    set yd_PlayerColor[12] = "|cFF282828"
    set yd_PlayerColor[13] = "|cFF282828"
    set yd_PlayerColor[14] = "|cFF282828"
    set yd_PlayerColor[15] = "|cFF282828"
    //=================显示版本=====================
    call YDWEVersion_Init()
endfunction
endlibrary
library YDWEStringFormula initializer Init requires YDWEBase
globals
    item bj_lastCombinedItem=null
endglobals
function GetLastCombinedItem takes nothing returns item
    return bj_lastCombinedItem
endfunction
//===========================================================================
//Ʒϳ
globals
    private trigger array ItemCombineEventQueue
    private integer ItemCombineEventNumber = 0
endglobals
function YDWESyStemItemCombineTriggerAction takes nothing returns nothing
	local integer i = 0
    loop
        exitwhen i >= ItemCombineEventNumber
        if ItemCombineEventQueue[i] != null and TriggerEvaluate(ItemCombineEventQueue[i]) and IsTriggerEnabled(ItemCombineEventQueue[i]) then
            call TriggerExecute(ItemCombineEventQueue[i])
        endif
        set i = i + 1 
    endloop
endfunction
//GetLastMovedItemInItemSlot 
//===========================================================================  
//Ʒϳ¼ 
//===========================================================================  
function YDWESyStemItemCombineRegistTrigger takes trigger trg returns nothing
	set ItemCombineEventQueue[ItemCombineEventNumber] = trg
	set ItemCombineEventNumber = ItemCombineEventNumber + 1 
endfunction
    private struct Inventory 
        method reset takes nothing returns nothing
            call YDWEFlushMissionByString("YDWEStringFormula."+I2S(this))
        endmethod
        
        method onDestroy takes nothing returns nothing
            call YDWEFlushMissionByString("YDWEStringFormula."+I2S(this))
        endmethod
    endstruct 
    
    private struct StringTable extends Inventory 
        method operator [] takes string key returns integer
            return YDWEGetIntegerByString("YDWEStringFormula."+I2S(this), key)
        endmethod
        
        method operator []= takes string key, integer value returns nothing
            call YDWESaveIntegerByString("YDWEStringFormula."+I2S(this), key, value)
        endmethod
        
        method flush takes string key returns nothing
            call YDWEFlushStoredIntegerByString("YDWEStringFormula."+I2S(this), key)
        endmethod
        
        method exists takes string key returns boolean
            return YDWEHaveSavedIntegerByString("YDWEStringFormula."+I2S(this), key)
        endmethod 
    endstruct
//***************************************************************
//* StringFormula 2.0 - Fetrix_sai
//* ------------
//*
//***************************************************************
    private keyword ItemIdMatrix
    private keyword FormulaMatrix
    private keyword Sorting
    globals
        private constant integer MAX_INSTANCES = 8100
        private constant integer SEGMENT_LENGTH = 4
    endglobals
    
    private function Convert takes integer value, integer length returns string
        local string Char = I2S(value)
        local integer slen = StringLength(Char)
            
        loop
            exitwhen slen >= length
            set Char = "0" + Char
            set slen = slen + 1
        endloop
        
        return Char
    endfunction
   
   
////////////////////////////////////////////////////////////
//////////////////// __ItemId Matrix__ /////////////////////
    private struct ItemIdMatrix extends array [MAX_INSTANCES]
    
        static StringTable Data
        static integer Total = 1
        integer itemId 
        
        string keyStr
        integer keyLen
        
        static method get takes integer id returns thistype
            return .Data[I2S(id)]
        endmethod
        
        static method exists takes integer id returns boolean
            return .Data.exists(I2S(id))
        endmethod
                 
        method sub takes integer segment returns integer
            local integer start = .keyLen * segment + 1
            return S2I(SubString(.keyStr, start, (start + .keyLen)))
        endmethod
        
        static method assigns takes integer id returns thistype
            local thistype this = 0
            if id == null or id == 0 then
                return 0
            endif
            
            set this = thistype.get(id)
                
            if integer(this) > 0 then
                return this
            endif
            
            set this = thistype[.Total]
            set this.itemId = id
            set this.keyStr = I2S(SEGMENT_LENGTH)
            set this.keyLen = SEGMENT_LENGTH
            set .Data[I2S(id)] = integer(this)
            set .Total = .Total + 1
            return this
        endmethod
        
        method memory takes string key returns nothing
            set .keyStr = .keyStr + key
            //debug call BJDebugMsg("|cff00ff00KEY: |r" + .keyStr)
        endmethod
        
        private static method onInit takes nothing returns nothing
            set .Data = StringTable.create()
        endmethod
        
    endstruct
////////////////// __End of ItemId Matrix__ ////////////////
////////////////////////////////////////////////////////////
    
    
////////////////////////////////////////////////////////////
//////////////////// __Formula Matrix__ ////////////////////
    
    globals
        private FormulaMatrix FormulaData = 0
    endglobals
    
    private struct FormulaMatrix extends array [MAX_INSTANCES]
        
        static StringTable Data
        static integer Total = 1
        
        string formula
        integer segmLen
        
        string model
        string message
        integer chance
        boolean delete
        
        static method exists takes string s returns boolean
            return .Data.exists(s)
        endmethod
        
        method sub takes integer segment returns integer
            local integer start = .segmLen * segment + 1
            return S2I(SubString(.formula, start, (start + .segmLen)))
        endmethod
        
        static method memory takes integer lingth, string formStr, ItemIdMatrix eventually returns thistype
            local thistype this = 0
            
            if FormulaMatrix.exists(formStr) then
                //debug call BJDebugMsg("|cffff0000Registration cannot be repeated !!|r")
                return 0
            endif
            
            set this = thistype[thistype.Total]
            set this.formula = formStr + Convert(eventually, SEGMENT_LENGTH)
            set this.segmLen = lingth
            
            set this.model = null //"Abilities\\Spells\\Items\\AIam\\AIamTarget.mdl"
set this.message = null //"|cff00ff00ϳˣ|r" 
set this.chance = 100
            set this.delete = false
            set .Data[formStr] = integer(this) 
            set .Total = .Total + 1
            
            //debug call BJDebugMsg("|cff00ff00Formula Register: |r" + I2S(integer(this)) + ". " + this.formula)
            return this
        endmethod
        
        private static method onInit takes nothing returns nothing
            set .Data = StringTable.create()
        endmethod
        
    endstruct
    
////////////////// __End of Formula Matrix__ ///////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
//////////////////// __Formula Sorting__ ///////////////////
    private struct Sorting
        ItemIdMatrix array stack[8]
        integer array count[8]
        integer total = 7
        
        method onDestroy takes nothing returns nothing
            local integer i = 0
            loop
                exitwhen i == stack.size
                set .stack[i] = 0
                set .count[i] = 0
                set i = i + 1
            endloop
            set .char = ""
        endmethod
        
        static method create takes integer type1, integer n1, integer type2, integer n2, integer type3, integer n3,/*
     */integer type4, integer n4, integer type5, integer n5, integer type6, integer n6, integer type7, integer n7 returns thistype
            local thistype this = thistype.allocate()
            
            set this.stack[1] = ItemIdMatrix.assigns(type1)
            set this.stack[2] = ItemIdMatrix.assigns(type2)
            set this.stack[3] = ItemIdMatrix.assigns(type3)
            set this.stack[4] = ItemIdMatrix.assigns(type4)
            set this.stack[5] = ItemIdMatrix.assigns(type5)
            set this.stack[6] = ItemIdMatrix.assigns(type6)
            set this.stack[7] = ItemIdMatrix.assigns(type7)
            
            set this.count[1] = n1
            set this.count[2] = n2
            set this.count[3] = n3
            set this.count[4] = n4
            set this.count[5] = n5
            set this.count[6] = n6
            set this.count[7] = n7
            
            return this
        endmethod
        
        string char
        method convert takes nothing returns string
            local integer i = 1
            local integer j 
            local integer k
              
            set .char = ""
            loop
                exitwhen i > .total
                if .stack[i] == 0 or .count[i] == 0 then
                    set .stack[i] = .stack[.total]
                    set .count[i] = .count[.total]
                    set .total = .total - 1
                    set i = i - 1
                else
                    set j = i + 1
                    loop
                        exitwhen j > .total
                        if .stack[j] == 0 or .count[j] == 0 then
                            set .stack[j] = .stack[.total]
                            set .count[j] = .count[.total]
                            set .total = .total - 1
                            set j = j - 1
                        elseif integer(.stack[i]) > integer(.stack[j]) then
                            set k = .stack[i]
                            set .stack[i] = .stack[j]
                            set .stack[j] = k
                            set k = .count[i]
                            set .count[i] = .count[j]
                            set .count[j] = k
                        elseif integer(.stack[i]) == integer(.stack[j]) then
                            set .count[i] = .count[i] + .count[j]
                            set .stack[j] = 0
                            set j = j - 1
                        endif
                        set j = j + 1
                    endloop
                
                    set j = .count[i]
                    loop
                        exitwhen j == 0
                        set .char = .char + Convert(.stack[i], SEGMENT_LENGTH)
                        set j = j - 1
                    endloop
                endif
                set i = i + 1
            endloop
            
            return .char
        endmethod
        
    endstruct
////////////////// __End of Formula Sorting__ //////////////
////////////////////////////////////////////////////////////
    
    
////////////////////////////////////////////////////////////
/////////////////////// __Craft Item__ /////////////////////
    
    private function Adaptation takes nothing returns boolean
        return true
    endfunction
        
    private function verify takes nothing returns boolean
        return ItemIdMatrix.exists(GetItemTypeId(GetManipulatedItem()))
    endfunction
        
    private function GetCharges takes item it returns integer 
        local integer charges = GetItemCharges(it)
        if charges == 0 then
            set charges = 1
        endif
        return charges
    endfunction
        
    private function CraftItem takes nothing returns nothing
        local FormulaMatrix forx = 0
        local ItemIdMatrix itmx = ItemIdMatrix.get(GetItemTypeId(GetManipulatedItem()))
        local integer size = StringLength(itmx.keyStr) / itmx.keyLen
        local integer inst = 0
        local integer numb = 0
        local integer sum = 0
        
        local integer tmpid = 0 
        local integer i = 0
        local integer j = 0
        local boolean b = false 
        local item it = null
        
        local item article = GetManipulatedItem()
        local unit caster = GetTriggerUnit()
        
        local item array items 
        local integer array typeid
        local integer array amount 
        local integer array surplus 
        //* Check Slots
        set i = 0
        loop
            exitwhen i == 6
            set it = UnitItemInSlot(caster, i)
                
            if it != null then
                set sum:items = it
                set sum:typeid = GetItemTypeId(it)
                set sum:amount = GetCharges(it)
                if it == article then
                    set b = true
                endif
                set sum = sum + 1
            endif
                
            set i = i + 1
            set it = null
        endloop
            
        if b == false then
            set sum:items = article
            set sum:typeid = GetItemTypeId(article)
            set sum:amount = 1
            set sum = sum + 1
        endif
        //* Check Formulas
        loop
            exitwhen inst == size
            set forx = FormulaMatrix(itmx.sub(inst))
            set numb = StringLength(forx.formula) / forx.segmLen - 1
            
            set i = 0
            loop
                exitwhen i == sum
                set i:surplus = i:amount 
                set i = i + 1
            endloop
                
            //! Check Formula
            set i = 0
            loop
                set tmpid = ItemIdMatrix(forx.sub(i)).itemId
                exitwhen i == numb
                
                set j = 0
                loop
                    exitwhen j == sum
                    
                    if j:typeid == tmpid and j:surplus > 0 then
                        set j:surplus = j:surplus - 1
                        exitwhen true 
                    endif
                        
                    set j = j + 1
                endloop
                
                exitwhen j == sum
                set i = i + 1
            endloop
            //! Merge item
            if i == numb then
                if GetRandomInt(0, 99) < forx.chance then
                    //! effect and text
                    if forx.model != null then
                        call DestroyEffect(AddSpecialEffectTarget(forx.model, caster, "origin"))
                    endif
                    
                    if forx.message != null then
                        call DisplayTimedTextToPlayer(GetTriggerPlayer(), 0, 0, 30, forx.message)
                    endif
                
                    //! remove item
                    set i = 0
                    loop
                        exitwhen i == sum
                        if i:surplus > 0 and GetItemCharges(i:items) > 0 then
                            call SetItemCharges(i:items, i:surplus)
                        elseif i:surplus == 0 then
                            call RemoveItem(i:items)
                        endif
                        set i = i + 1
                    endloop
                    
                    //! add item
                    set it = CreateItem(tmpid, GetUnitX(caster), GetUnitY(caster))
            
                    if GetItemCharges(it) > 0 then
                        call SetItemCharges(it, 1)
                
                        set i = 0
                        loop
                            exitwhen i == sum
                            if i:typeid == tmpid then
                                call RemoveItem(i:items)
                                call SetItemCharges(it, i:surplus + 1)
                            endif
                            set i = i + 1
                        endloop
                    endif
            
                    call UnitAddItem(caster, it)
                    set bj_lastCombinedItem = it 
                    call YDWESyStemItemCombineTriggerAction()
                elseif forx.delete then
                    //! remove item
                    set i = 0
                    loop
                        exitwhen i == sum
                        if i:surplus > 0 and GetItemCharges(i:items) > 0 then
                            call SetItemCharges(i:items, i:surplus)
                        elseif i:surplus == 0 then
                            call RemoveItem(i:items)
                        endif
                        set i = i + 1
                    endloop
                endif
                    
                set it = null
                exitwhen true
            endif
                
            set inst = inst + 1
        endloop
        if b == false /*and GetItemType(article) == ITEM_TYPE_POWERUP*/then
            call RemoveItem(article)
        endif
        
        set i = 0
        loop
            exitwhen i == sum
            set i:items = null
            set i = i + 1
        endloop
            
        set article = null
        set caster = null
        set it = null
    endfunction
    private function Init takes nothing returns nothing
        local filterfunc f = Filter(function Adaptation)
        local trigger t = CreateTrigger()
        local integer i = 0
        
        loop
            exitwhen i > 15
            call TriggerRegisterPlayerUnitEvent(t, Player(i), EVENT_PLAYER_UNIT_PICKUP_ITEM, f)
            set i = i + 1
        endloop
        
        call TriggerAddCondition(t, Condition(function verify))
        call TriggerAddAction(t, function CraftItem)
        call DestroyFilter(f)
        
        set f = null
        set t = null 
    endfunction
    
///////////////////// __End of Craft Item__ ////////////////
////////////////////////////////////////////////////////////
    
    // call YDWENewItemsFormula('rat6', 6, 'rat9', 5, 'ratc', 4, 'rde1', 3, 'rde2', 2, 'rde3', 1, 'mcou')
    function YDWENewItemsFormula takes integer type1, integer n1, integer type2, integer n2, integer type3, integer n3, /*
    */integer type4, integer n4, integer type5, integer n5, integer type6, integer n6, integer eventually returns nothing
        local Sorting sort = Sorting.create(type1, n1, type2, n2, type3, n3, type4, n4, type5, n5, type6, n6, 0, 0)
        local ItemIdMatrix itmx = ItemIdMatrix.assigns(eventually)
        local string f = I2S(SEGMENT_LENGTH) + sort.convert()
        local string s = ""
        local integer i = 0
        
        set FormulaData = FormulaMatrix.memory(SEGMENT_LENGTH, f, itmx)
        if integer(FormulaData) > 0 then
            set s = Convert(integer(FormulaData), SEGMENT_LENGTH)
            
            set i = 0
            loop
                exitwhen i > sort.total
                call sort.stack[i].memory(s)
                set i = i + 1
            endloop
            
            call itmx.memory(s)
        endif
        
        call sort.destroy()
        set f = ""
        set s = ""
    endfunction
endlibrary
library YDWEMultiboardSetItemWidthBJNull
function YDWEMultiboardSetItemWidthBJNull takes multiboard mb, integer col, integer row, real width returns nothing
    local integer curRow = 0
    local integer curCol = 0
    local integer numRows = MultiboardGetRowCount(mb)
    local integer numCols = MultiboardGetColumnCount(mb)
    local multiboarditem mbitem = null
    // Loop over rows, using 1-based index
    loop
        set curRow = curRow + 1
        exitwhen curRow > numRows
        // Apply setting to the requested row, or all rows (if row is 0)
        if (row == 0 or row == curRow) then
            // Loop over columns, using 1-based index
            set curCol = 0
            loop
                set curCol = curCol + 1
                exitwhen curCol > numCols
                // Apply setting to the requested column, or all columns (if col is 0)
                if (col == 0 or col == curCol) then
                    set mbitem = MultiboardGetItem(mb, curRow - 1, curCol - 1)
                    call MultiboardSetItemWidth(mbitem, width/100.0)
                    call MultiboardReleaseItem(mbitem)
                endif
            endloop
        endif
    endloop
    set mbitem = null
endfunction
endlibrary
library YDWEPlaySoundNull
function YDWEPlaySoundNull takes string soundName returns nothing
    local sound soundHandle = CreateSound(soundName, false, false, true, 12700, 12700, "")
    call StartSound(soundHandle)
    call KillSoundWhenDone(soundHandle)
    set soundHandle = null
endfunction
endlibrary
library YDWELocalVariable requires YDWEBase
function YDWELocalVariableInitiliation takes nothing returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"GlobalsTriggerRunSteps")
    set TriggerRunSteps=TriggerRunSteps+1
    call YDWESaveIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"GlobalsTriggerRunSteps",TriggerRunSteps)
    call YDWESaveIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps",TriggerRunSteps)
endfunction
function YDWEWaitForLocalVariable takes real time returns nothing
    local integer TriggerRunSteps=YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
// call BJDebugMsg("等待之前TriggerRunSteps= "+I2S(TriggerRunSteps))
    call TriggerSleepAction(time)
// call BJDebugMsg("等待之后TriggerRunSteps= "+I2S(TriggerRunSteps))
    call YDWESaveIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps",TriggerRunSteps)
endfunction
function YDWELocalVariableEnd takes nothing returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWEFlushMissionByString(dir)
endfunction
//integer
function YDWESetLocalVariableInteger takes string s,integer i returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s,i)
endfunction
function YDWEGetLocalVariableInteger takes string s returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s)
endfunction
function YDWESetLocalVariableIntegerArray takes string s,integer index,integer i returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s+I2S(index),i)
endfunction
function YDWEGetLocalVariableIntegerArray takes string s,integer index returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s+I2S(index))
endfunction
//real
function YDWESetLocalVariableReal takes string s,real R returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveRealByString(dir,s,R)
endfunction
function YDWEGetLocalVariableReal takes string s returns real
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetRealByString(dir,s)
endfunction
function YDWESetLocalVariableRealArray takes string s,integer index,real R returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveRealByString(dir,s+I2S(index),R)
endfunction
function YDWEGetLocalVariableRealArray takes string s,integer index returns real
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetRealByString(dir,s+I2S(index))
endfunction
//string
function YDWESetLocalVariableString takes string s,string str returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveStringByString(dir,s,str)
endfunction
function YDWEGetLocalVariableString takes string s returns string
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetStringByString(dir,s)
endfunction
function YDWESetLocalVariableStringArray takes string s,integer index,string str returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveStringByString(dir,s+I2S(index),str)
endfunction
function YDWEGetLocalVariableStringArray takes string s,integer index returns string
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetStringByString(dir,s+I2S(index))
endfunction
//boolean
function YDWESetLocalVariableBoolean takes string s,boolean bl returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveBooleanByString(dir,s,bl)
endfunction
function YDWEGetLocalVariableBoolean takes string s returns boolean
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetBooleanByString(dir,s)
endfunction
function YDWESetLocalVariableBooleanArray takes string s,integer index,boolean bl returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveBooleanByString(dir,s+I2S(index),bl)
endfunction
function YDWEGetLocalVariableBooleanArray takes string s,integer index returns boolean
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetBooleanByString(dir,s+I2S(index))
endfunction
//unit
function YDWESetLocalVariableUnit takes string s,unit u returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveUnitByString(dir,s,u)
endfunction
function YDWEGetLocalVariableUnit takes string s returns unit
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetUnitByString(dir,s)
endfunction
function YDWESetLocalVariableUnitArray takes string s,integer index,unit u returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveUnitByString(dir,s+I2S(index),u)
endfunction
function YDWEGetLocalVariableUnitArray takes string s,integer index returns unit
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetUnitByString(dir,s+I2S(index))
endfunction
//unit code
function YDWESetLocalVariableUnitID takes string s,integer uid returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s,uid)
endfunction
function YDWEGetLocalVariableUnitID takes string s returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s)
endfunction
function YDWESetLocalVariableUnitIDArray takes string s,integer index,integer uid returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s+I2S(index),uid)
endfunction
function YDWEGetLocalVariableUnitIDArray takes string s,integer index returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s+I2S(index))
endfunction
//ability code
function YDWESetLocalVariableAbilityID takes string s,integer abid returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s,abid)
endfunction
function YDWEGetLocalVariableAbilityID takes string s returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s)
endfunction
function YDWESetLocalVariableAbilityIDArray takes string s,integer index,integer abid returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s+I2S(index),abid)
endfunction
function YDWEGetLocalVariableAbilityIDArray takes string s,integer index returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s+I2S(index))
endfunction
//item
function YDWESetLocalVariableItem takes string s,item it returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveItemByString(dir,s,it)
endfunction
function YDWEGetLocalVariableItem takes string s returns item
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetItemByString(dir,s)
endfunction
function YDWESetLocalVariableItemArray takes string s,integer index,item it returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveItemByString(dir,s+I2S(index),it)
endfunction
function YDWEGetLocalVariableItemArray takes string s,integer index returns item
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetItemByString(dir,s+I2S(index))
endfunction
//item code
function YDWESetLocalVariableItemID takes string s,integer itid returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s,itid)
endfunction
function YDWEGetLocalVariableItemID takes string s returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s)
endfunction
function YDWESetLocalVariableItemIDArray takes string s,integer index,integer itid returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveIntegerByString(dir,s+I2S(index),itid)
endfunction
function YDWEGetLocalVariableItemIDArray takes string s,integer index returns integer
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetIntegerByString(dir,s+I2S(index))
endfunction
//location
function YDWESetLocalVariableLocation takes string s,location point returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveLocationByString(dir,s,point)
endfunction
function YDWEGetLocalVariableLocation takes string s returns location
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetLocationByString(dir,s)
endfunction
function YDWESetLocalVariableLocationArray takes string s,integer index,location point returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveLocationByString(dir,s+I2S(index),point)
endfunction
function YDWEGetLocalVariableLocationArray takes string s,integer index returns location
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetLocationByString(dir,s+I2S(index))
endfunction
//group
function YDWESetLocalVariableGroup takes string s,group g returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveGroupByString(dir,s,g)
endfunction
function YDWEGetLocalVariableGroup takes string s returns group
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetGroupByString(dir,s)
endfunction
function YDWESetLocalVariableGroupArray takes string s,integer index,group g returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveGroupByString(dir,s+I2S(index),g)
endfunction
function YDWEGetLocalVariableGroupArray takes string s,integer index returns group
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetGroupByString(dir,s+I2S(index))
endfunction
//effect
function YDWESetLocalVariableEffect takes string s,effect e returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveEffectByString(dir,s,e)
endfunction
function YDWEGetLocalVariableEffect takes string s returns effect
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetEffectByString(dir,s)
endfunction
function YDWESetLocalVariableEffectArray takes string s,integer index,effect e returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveEffectByString(dir,s+I2S(index),e)
endfunction
function YDWEGetLocalVariableEffectArray takes string s,integer index returns effect
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetEffectByString(dir,s+I2S(index))
endfunction
//rect
function YDWESetLocalVariableRect takes string s,rect rt returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveRectByString(dir,s,rt)
endfunction
function YDWEGetLocalVariableRect takes string s returns rect
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetRectByString(dir,s)
endfunction
function YDWESetLocalVariableRectArray takes string s,integer index,rect rt returns nothing
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    call YDWESaveRectByString(dir,s+I2S(index),rt)
endfunction
function YDWEGetLocalVariableRectArray takes string s,integer index returns rect
    local integer TriggerRunSteps = YDWEGetIntegerByString(I2S(YDWEH2I(GetTriggeringTrigger())),"TriggerRunSteps")
    local string dir = I2S(YDWEH2I(GetTriggeringTrigger()))+I2S(TriggerRunSteps)
    return YDWEGetRectByString(dir,s+I2S(index))
endfunction
endlibrary 
library YDWEGetPlayersMatchingNull
globals
endglobals
function YDWEGetPlayersMatchingNull takes boolexpr filter returns force
    local force f = CreateForce()
    call ForceEnumPlayers(f, filter)
    call DestroyBoolExpr(filter)
    set yd_NullTempForce = f
    set f =null
    return yd_NullTempForce
endfunction
endlibrary
library YDWESetUnitFacingToFaceLocTimedNull
function YDWESetUnitFacingToFaceLocTimedNull takes unit whichUnit, location target, real duration returns nothing
    local location unitLoc = GetUnitLoc(whichUnit)
    call SetUnitFacingTimed(whichUnit, AngleBetweenPoints(unitLoc, target), duration)
    call RemoveLocation(unitLoc)
    set unitLoc = null
endfunction
endlibrary
library YDWESetUnitFacingToFaceUnitTimedNull requires YDWESetUnitFacingToFaceLocTimedNull
function YDWESetUnitFacingToFaceUnitTimedNull takes unit whichUnit, unit target, real duration returns nothing
    local location unitLoc = GetUnitLoc(target)
    call YDWESetUnitFacingToFaceLocTimedNull(whichUnit, unitLoc, duration)
    call RemoveLocation(unitLoc)
    set unitLoc = null
endfunction
endlibrary
library YDWEItemAbilitySystem initializer YDWEItemAbilitySystemInit requires YDWEBase
//===========================================================================
//Ʒϵ
//===========================================================================
function YDWEItemAbilityStorage takes integer itid,integer ab returns nothing
    local integer index = YDWEGetIntegerByString(I2S(itid),"AbilityStorageIndex")
    set index = index + 1
    call YDWESaveIntegerByString(I2S(itid),"AbilityStorage"+I2S(index),ab)
    call YDWESaveIntegerByString(I2S(itid),"AbilityStorageIndex",index)
endfunction
//===========================================================================
//ʰȡƷ
//===========================================================================
function YDWEItemAbilitySystemByAbility_CON takes nothing returns boolean
    local unit hero = GetTriggerUnit()
    local item it=GetManipulatedItem()
    local trigger trg=YDWEGetTriggerByString(I2S(YDWEH2I(hero)), "MulItemSlotByAbility")
    local integer itid=GetItemTypeId(it)
    local integer index = YDWEGetIntegerByString(I2S(itid),"AbilityStorageIndex")
    local integer array skills
    local integer i=0
    local integer N=YDWEGetIntegerByString(I2S(YDWEH2I(trg)), "ItemSlotNum")
    local boolean OnOff=YDWEGetBooleanByString(I2S(YDWEH2I(hero)), "YDWEItemAbilitySystemTriggerClose")
    if index==0 or OnOff==true then
        set it=null
        set hero=null
        set trg=null
        return false
    endif
    loop
        set i=i+1
        exitwhen i>index
        set skills[i] = YDWEGetIntegerByString(I2S(itid),"AbilityStorage"+I2S(i))
        if GetTriggerEventId()==EVENT_PLAYER_UNIT_DROP_ITEM then 
            call UnitRemoveAbility(hero,skills[i])
          elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
            call UnitAddAbility(hero,skills[i])
            call UnitMakeAbilityPermanent(hero,true,skills[i])
        endif
    endloop
    set it=null
    set hero=null
    set trg=null
    return false
endfunction
 function YDWEItemAbilitySystemInit takes nothing returns nothing
    local trigger trg = CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(trg,EVENT_PLAYER_UNIT_PICKUP_ITEM)
    call TriggerRegisterAnyUnitEventBJ(trg,EVENT_PLAYER_UNIT_DROP_ITEM)
    call TriggerAddCondition(trg, Condition(function YDWEItemAbilitySystemByAbility_CON))
    set trg=null
endfunction
endlibrary
library YDWEPolledWaitNull
function YDWEPolledWaitNull takes real duration returns nothing
    local timer t
    local real timeRemaining
    if (duration > 0) then
        set t = CreateTimer()
        call TimerStart(t, duration, false, null)
        loop
            set timeRemaining = TimerGetRemaining(t)
            exitwhen timeRemaining <= 0
            // If we have a bit of time left, skip past 10% of the remaining
            // duration instead of checking every interval, to minimize the
            // polling on long waits.
            if (timeRemaining > bj_POLLED_WAIT_SKIP_THRESHOLD) then
                call TriggerSleepAction(0.1 * timeRemaining)
            else
                call TriggerSleepAction(bj_POLLED_WAIT_INTERVAL)
            endif
        endloop
        call DestroyTimer(t)
    endif
    set t = null
endfunction
endlibrary
library YDWEGetRandomSubGroupEnumNull
function YDWEGetRandomSubGroupEnumNull takes nothing returns nothing
    if (bj_randomSubGroupWant > 0) then
        if (bj_randomSubGroupWant >= bj_randomSubGroupTotal) or (GetRandomInt(1,bj_randomSubGroupTotal) <= bj_randomSubGroupWant) then
            // We either need every remaining unit, or the unit passed its chance check.
            call GroupAddUnit(bj_randomSubGroupGroup, GetEnumUnit())
            set bj_randomSubGroupWant = bj_randomSubGroupWant - 1
        endif
    endif
    set bj_randomSubGroupTotal = bj_randomSubGroupTotal - 1
endfunction
endlibrary
library YDWEGetRandomSubGroupNull requires YDWEGetRandomSubGroupEnumNull
function YDWEGetRandomSubGroupNull takes integer count, group sourceGroup returns group
    set bj_randomSubGroupGroup = CreateGroup()
    set bj_randomSubGroupWant = count
    set bj_randomSubGroupTotal = CountUnitsInGroup(sourceGroup)
    if (bj_randomSubGroupWant <= 0 or bj_randomSubGroupTotal <= 0) then
        return bj_randomSubGroupGroup
    endif
    call ForGroup(sourceGroup, function YDWEGetRandomSubGroupEnumNull)
    return bj_randomSubGroupGroup
endfunction
endlibrary
library YDWEGetUnitsOfPlayerMatchingNull
globals
endglobals
function YDWEGetUnitsOfPlayerMatchingNull takes player whichPlayer, boolexpr filter returns group
    local group g = CreateGroup()
    call GroupEnumUnitsOfPlayer(g, whichPlayer, filter)
    call DestroyBoolExpr(filter)
    set yd_NullTempGroup = g
    set g = null
    return yd_NullTempGroup
endfunction
endlibrary
library YDWEGetUnitsOfPlayerAllNull requires YDWEGetUnitsOfPlayerMatchingNull
function YDWEGetUnitsOfPlayerAllNull takes player whichPlayer returns group
    return YDWEGetUnitsOfPlayerMatchingNull(whichPlayer, null)
endfunction
endlibrary
library YDWEGetUnitsOfPlayerAndTypeIdNull
globals
endglobals
function YDWEGetUnitsOfPlayerAndTypeIdNull takes player whichPlayer, integer unitid returns group
    local group g = CreateGroup()
    set bj_groupEnumTypeId = unitid
    call GroupEnumUnitsOfPlayer(g, whichPlayer, filterGetUnitsOfPlayerAndTypeId)
    set yd_NullTempGroup = g
    set g = null
    return yd_NullTempGroup
endfunction
endlibrary
library YDWEGetItemOfTypeFromUnitBJNull
globals
    item yd_NullTempItem
endglobals
function YDWEGetItemOfTypeFromUnitBJNull takes unit whichUnit, integer itemId returns item
    local integer index = 0
    loop
        set yd_NullTempItem = UnitItemInSlot(whichUnit, index)
        if GetItemTypeId(yd_NullTempItem) == itemId then
            return yd_NullTempItem
        endif
        set index = index + 1
        exitwhen index >= bj_MAX_INVENTORY
    endloop
    return null
endfunction
endlibrary
library YDWETriggerRegisterEnterRectSimpleNull
globals
endglobals
function YDWETriggerRegisterEnterRectSimpleNull takes trigger trig, rect r returns event
    local region rectRegion = CreateRegion()
    call RegionAddRect(rectRegion, r)
    set yd_NullTempRegion = rectRegion
    set rectRegion = null
    return TriggerRegisterEnterRegion(trig, yd_NullTempRegion, null)
endfunction
endlibrary
library YDWESetPlayerColorBJNull
function YDWESetPlayerColorBJNull takes player whichPlayer, playercolor color, boolean changeExisting returns nothing
    local group g
    call SetPlayerColor(whichPlayer, color)
    if changeExisting then
        set bj_setPlayerTargetColor = color
        set g = CreateGroup()
        call GroupEnumUnitsOfPlayer(g, whichPlayer, null)
        call ForGroup(g, function SetPlayerColorBJEnum)
        call DestroyGroup(g)
    endif
    set g = null
endfunction
endlibrary
library YDWEGetPlayersAlliesNull
globals
endglobals
function YDWEGetPlayersAlliesNull takes player whichPlayer returns force
    local force f = CreateForce()
    call ForceEnumAllies(f, whichPlayer, null)
    set yd_NullTempForce = f
    set f = null
    return yd_NullTempForce
endfunction
endlibrary
library YDWEMultiboardSetItemColorBJNull
function YDWEMultiboardSetItemColorBJNull takes multiboard mb, integer col, integer row, real red, real green, real blue, real transparency returns nothing
    local integer curRow = 0
    local integer curCol = 0
    local integer numRows = MultiboardGetRowCount(mb)
    local integer numCols = MultiboardGetColumnCount(mb)
    local multiboarditem mbitem = null
    // Loop over rows, using 1-based index
    loop
        set curRow = curRow + 1
        exitwhen curRow > numRows
        // Apply setting to the requested row, or all rows (if row is 0)
        if (row == 0 or row == curRow) then
            // Loop over columns, using 1-based index
            set curCol = 0
            loop
                set curCol = curCol + 1
                exitwhen curCol > numCols
                // Apply setting to the requested column, or all columns (if col is 0)
                if (col == 0 or col == curCol) then
                    set mbitem = MultiboardGetItem(mb, curRow - 1, curCol - 1)
                    call MultiboardSetItemValueColor(mbitem, PercentTo255(red), PercentTo255(green), PercentTo255(blue), PercentTo255(100.0-transparency))
                    call MultiboardReleaseItem(mbitem)
                endif
            endloop
        endif
    endloop
    set mbitem = null
endfunction
endlibrary
library YDWEMultiboardSetItemIconBJNull
function YDWEMultiboardSetItemIconBJNull takes multiboard mb, integer col, integer row, string iconFileName returns nothing
    local integer curRow = 0
    local integer curCol = 0
    local integer numRows = MultiboardGetRowCount(mb)
    local integer numCols = MultiboardGetColumnCount(mb)
    local multiboarditem mbitem = null
    // Loop over rows, using 1-based index
    loop
        set curRow = curRow + 1
        exitwhen curRow > numRows
        // Apply setting to the requested row, or all rows (if row is 0)
        if (row == 0 or row == curRow) then
            // Loop over columns, using 1-based index
            set curCol = 0
            loop
                set curCol = curCol + 1
                exitwhen curCol > numCols
                // Apply setting to the requested column, or all columns (if col is 0)
                if (col == 0 or col == curCol) then
                    set mbitem = MultiboardGetItem(mb, curRow - 1, curCol - 1)
                    call MultiboardSetItemIcon(mbitem, iconFileName)
                    call MultiboardReleaseItem(mbitem)
                endif
            endloop
        endif
    endloop
    set mbitem = null
endfunction
endlibrary
/**/
